#include "stdafx.h"
#include <assert.h>
#include "IPCCMessage.h"
//#include "GlobalOperation.h"


///////////////////////////////////////////////////////////////////////////////
///CIPCCMsgExchanger
CIPCCMsgExchanger::CIPCCMsgExchanger()
{
}

CIPCCMsgExchanger::~CIPCCMsgExchanger()
{
}

bool CIPCCMsgExchanger::static_GetMsgHeader(const char* msg, int msgsize, __EIPCCMsgClass& msgclass, __EIPCCMsgType& msgtype)
{
	if(msgsize < 8)	return false;

	memmove(&msgclass, msg, sizeof(int));
	memmove(&msgtype, msg+sizeof(int), sizeof(int));

	return true;
}
void CIPCCMsgExchanger::static_SerializeMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::static_DeSerializeMsg(char* pmsg, int msgsize, SIPCCMessage& msg, unsigned long ip/*=0*/, unsigned short port/*=0*/)
{
	if(msgsize < 8)	return;
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

bool CIPCCMsgExchanger::GetMsgHeader(const char* msg, int msgsize, __EIPCCMsgClass& msgclass, __EIPCCMsgType& msgtype)
{
	if(msgsize < 8)	return false;
	
	memmove(&msgclass, msg, sizeof(int));
	memmove(&msgtype, msg+sizeof(int), sizeof(int));
	
	return true;
}

void CIPCCMsgExchanger::SerializeMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgClass msgClass = (__EIPCCMsgClass)msg.msgClass;
	
	switch(msgClass)
	{
	case Class_Login:
		SerializeLoginMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Guide:
		SerializeGuideMsg(msg, thebuf, thebufcontent);
		break;
	case Class_ACD:
		SerializeACDMsg(msg, thebuf, thebufcontent);
		break;
	case Class_DataCollection:
		SerializeDataCollectionMsg(msg, thebuf, thebufcontent);
		break;
	case Class_UserMark:
		//		SerializeUserMarkMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Relay:
		SerializeRelayMsg(msg, thebuf, thebufcontent);
		break;
	case Class_SysManage:
		SerializeSysManageMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Client:
		SerializeClientMsg(msg, thebuf, thebufcontent);
		break;
	case Class_P2P:
		SerializeP2PMsg(msg, thebuf, thebufcontent);
		break;
	case Class_EndEgn:
		SerializeEndEgnMsg(msg, thebuf, thebufcontent);
		break;
	case Class_HeartBeat:
		SerializeHeartBeatMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Transmit:
		SerializeTransmitMsg(msg, thebuf, thebufcontent);
		break;
	case Class_File:
		SerializeFileMsg(msg, thebuf, thebufcontent);
		break;
	case Class_UState:
		SerializeUStateMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Record:
		SerializeRecordMsg(msg, thebuf, thebufcontent);
		break;
	case Class_SmartRoute:
		SerializeSmartRouteMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Gateway:
		SerializeGatewayMsg(msg, thebuf, thebufcontent);
		break;
	case Class_TextChat:
		SerializeTextMsg(msg, thebuf, thebufcontent);
		break;
	case Class_GwMonit:
		SerializeGwMonitMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Redirect:
		SerializeRedirectMsg(msg, thebuf, thebufcontent);
		break;
	case Class_DlyStrategy:
		SerializeDlyStrategyMsg(msg, thebuf, thebufcontent);
		break;
	case Class_TollQuery:
		SerializeTollQueryMsg(msg, thebuf, thebufcontent);
		break;
	case Class_SMS:
		SerializeSmsMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Toll:
		SerializeTollMsg(msg, thebuf, thebufcontent);
		break;
	case Class_PhoneSearch:
	case Class_DataRoute:
	case Class_DataTrans:
		SerializePhoneSearchMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Wap:
		SerializeWapMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Alert:
		SerializeAlertMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Autodetector:
		SerializeAutodetectorMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Operator:
		SerializeOperatorMsg(msg, thebuf, thebufcontent);
		break;
	case Class_Log:
		SerializeLogMsg(msg, thebuf, thebufcontent);
		break;
	case Class_ServerProxy:
		SerializeLogMsg(msg, thebuf, thebufcontent);
	case Class_SAMPLER:
		SerializeSamplerMsg(msg, thebuf, thebufcontent);
		break;
	case Class_ClientCapture:
		SerializeClientCaptureMsg(msg,thebuf,thebufcontent);
		break;
	case Class_VoiceRecognition:
		SerializeVoiceRecognitionMsg(msg,thebuf,thebufcontent);
		break;
	case Class_TTS:
		SerializeTTSMsg(msg,thebuf,thebufcontent);
		break;
	default:
		thebufcontent = msg.FillBuf( thebuf );
		break;
	}
}

void CIPCCMsgExchanger::SerializePhoneSearchMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::SerializeWapMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::SerializeGwMonitMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::SerializeDataRouteMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::SerializeDataTransMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::SerializeAlertMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::SerializeRedirectMsg(SIPCCMessage &msg, char *&thebuf, int &thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Redirect_LoadCorpInfo:
		thebufcontent = ((SIPCCMsg_Redirect_LoadCorpInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_LoadCorpInfoConf:
		thebufcontent = ((SIPCCMsg_Redirect_LoadCorpInfoConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_LoadPlatformInfo:
		thebufcontent = ((SIPCCMsg_Redirect_LoadPlatformInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_LoadPlatformInfoConf:
		thebufcontent = ((SIPCCMsg_Redirect_LoadPlatformInfoConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_SearchPlatform:
		thebufcontent = ((SIPCCMsg_Redirect_SearchPlatform*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_SearchPlatformConf:
		thebufcontent = ((SIPCCMsg_Redirect_SearchPlatformConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_GetPlatformList:
		thebufcontent = ((SIPCCMsg_Redirect_GetPlatformList*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_GetPlatformListConf:
		thebufcontent = ((SIPCCMsg_Redirect_GetPlatformListConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_CorpRegister:
		thebufcontent = ((SIPCCMsg_Redirect_CorpRegister*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_GetCorpInfo:
		thebufcontent = ((SIPCCMsg_Redirect_GetCorpInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_GetCorpInfoConf:
		thebufcontent = ((SIPCCMsg_Redirect_GetCorpInfoConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_AddCorpInfo:
		thebufcontent = ((SIPCCMsg_Redirect_AddCorpInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_DelCorpInfo:
		thebufcontent = ((SIPCCMsg_Redirect_DelCorpInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_AddPlatformInfo:
		thebufcontent = ((SIPCCMsg_Redirect_AddPlatformInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Redirect_DelPlatformInfo:
		thebufcontent = ((SIPCCMsg_Redirect_DelPlatformInfo*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeLoginMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Login_UserLoginFailed:
		thebufcontent = ((SIPCCMsg_Login_UserLoginFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_UserLoginSucc:
		thebufcontent = ((SIPCCMsg_Login_UserLoginSucc*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_ServerRegister:
		thebufcontent = ((SIPCCMsg_Login_ServerRegister*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_ServerRegisterConf:
		thebufcontent = ((SIPCCMsg_Login_ServerRegisterConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_AgentLoadURLConf:
		thebufcontent = ((SIPCCMsg_Login_AgentLoadURLConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_GetParkReasonsConf:
		thebufcontent = ((SIPCCMsg_Login_GetParkReasonsConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_ChangePasswordConf:
		thebufcontent = ((SIPCCMsg_Login_ChangePasswordConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_QueryIncrementFuncConf:
		thebufcontent = ((SIPCCMsg_Login_QueryIncrementFuncConf*)&msg)->FillBuf(thebuf);
		break;
	case  Type_Login_SendStrMsg:
		thebufcontent = ((SIPCCMsg_Login_SendStrMsg*)&msg)->FillBuf(thebuf);
		break;
	case Type_Login_NotifyAgentLoginConf:
		thebufcontent = ((SIPCCMsg_Login_NotifyAgentLoginConf*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeGuideMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Guide_ACDInfo:
		thebufcontent = ((SIPCCMsg_Guide_ACDInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Guide_AddKeyConf:
		thebufcontent = ((SIPCCMsg_Guide_AddKeyConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Guide_LoadKeyWords:
		thebufcontent = ((SIPCCMsg_Guide_LoadKeyWords*)&msg)->FillBuf(thebuf);
		break;
	case Type_Guide_DelKeyConf:
		thebufcontent = ((SIPCCMsg_Guide_DelKeyConf*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeHeartBeatMsg(SIPCCMessage &msg, char *&thebuf, int &thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	switch(msgType)
	{
	case Type_HeartBeat:
		thebufcontent = ((SIPCCMsg_HeartBeat*)&msg)->FillBuf(thebuf);
		break;
	case Type_HeartBeatResponse:
		thebufcontent = ((SIPCCMsg_HeartBeatResponse*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeACDMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_ACD_SetTalkSpan:
		thebufcontent = ((SIPCCMsg_ACD_SetTalkSpan*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_SetAgentCount:
		thebufcontent = ((SIPCCMsg_ACD_SetAgentCount*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_DelDepartment:
		thebufcontent = ((SIPCCMsg_ACD_DelDepartment*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentLoginSucc:
		thebufcontent = ((SIPCCMsg_ACD_AgentLoginSucc*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentLoginFailed:
		thebufcontent = ((SIPCCMsg_ACD_AgentLoginFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentLogoutConf:
		thebufcontent = ((SIPCCMsg_ACD_AgentLogoutConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentParkConf:
		thebufcontent = ((SIPCCMsg_ACD_AgentParkConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentUnParkConf:
		thebufcontent = ((SIPCCMsg_ACD_AgentUnParkConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AddDepartmentConf:
		thebufcontent = ((SIPCCMsg_ACD_AddDepartmentConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_DelDepartmentConf:
		thebufcontent = ((SIPCCMsg_ACD_DelDepartmentConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_UserMakeCallConf:
		thebufcontent = ((SIPCCMsg_ACD_UserMakeCallConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallDelivered:
		thebufcontent = ((SIPCCMsg_ACD_CallDelivered*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallEstablished:
		thebufcontent = ((SIPCCMsg_ACD_CallEstablished*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallAnswered:
		thebufcontent = ((SIPCCMsg_ACD_CallAnswered*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallReleased:
		thebufcontent = ((SIPCCMsg_ACD_CallReleased*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallHanguped:
		thebufcontent = ((SIPCCMsg_ACD_CallHanguped*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentStateInfo:
		thebufcontent = ((SIPCCMsg_ACD_AgentStateInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_MediaRequest:
		thebufcontent = ((SIPCCMsg_ACD_MediaRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_MediaRequestConf:
		thebufcontent = ((SIPCCMsg_ACD_MediaRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_LoadDepartments:
		thebufcontent = ((SIPCCMsg_ACD_LoadDepartments*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallingQueueInfo:
		thebufcontent = ((SIPCCMsg_ACD_CallingQueueInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallArriveToAgent:
		thebufcontent = ((SIPCCMsg_ACD_CallArriveToAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentQueryStateConf:
		thebufcontent = ((SIPCCMsg_ACD_AgentQueryStateConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentMakeCallConf:
		thebufcontent = ((SIPCCMsg_ACD_AgentMakeCallConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallUserConf:
		thebufcontent = ((SIPCCMsg_ACD_CallUserConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentHoldCall:
		thebufcontent = ((SIPCCMsg_ACD_AgentHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentUnHoldCall:
		thebufcontent = ((SIPCCMsg_ACD_AgentUnHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentHoldCallConf:
		thebufcontent = ((SIPCCMsg_ACD_AgentHoldCallConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_NotifyDataCollect:
		thebufcontent = ((SIPCCMsg_ACD_NotifyDataCollect*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallUserFailed:
		thebufcontent = ((SIPCCMsg_ACD_CallUserFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_PrepareTransfer:
		thebufcontent = ((SIPCCMsg_ACD_PrepareTransfer*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_TransReady:
		thebufcontent = ((SIPCCMsg_ACD_TransReady*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_TransferCall:
		thebufcontent = ((SIPCCMsg_ACD_TransferCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_TransferCall_WpAgent:
		thebufcontent = ((SIPCCMsg_ACD_TransferCall_WpAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_BeforeTransferCall_WpAgent:
		thebufcontent = ((SIPCCMsg_ACD_BeforeTransferCall_WpAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_ClearPreConnection:
		thebufcontent = ((SIPCCMsg_ACD_ClearPreConnection*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_DepartNAgentInfo:
		thebufcontent = ((SIPCCMsg_ACD_DepartNAgentInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_GroupInfo:
		thebufcontent = ((SIPCCMsg_ACD_GroupInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_NotifyAgentStateEvent:
		thebufcontent = ((SIPCCMsg_ACD_NotifyAgentStateEvent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_VDNStatusInfo:
		thebufcontent = ((SIPCCMsg_ACD_VDNStatusInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_MediaReady:
		thebufcontent = ((SIPCCMsg_ACD_MediaReady*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_ForceLogout:
		thebufcontent = ((SIPCCMsg_ACD_ForceLogout*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_UserMakeCallPSTN:
		thebufcontent = ((SIPCCMsg_ACD_UserMakeCallPSTN*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_UserMakeCallPSTN2:
		thebufcontent = ((SIPCCMsg_ACD_UserMakeCallPSTN2*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_RingAgentExt:
		thebufcontent = ((SIPCCMsg_ACD_RingAgentExt*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_RingAgentExt2:
		thebufcontent = ((SIPCCMsg_ACD_RingAgentExt2*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_StopRingAgentExt:
		thebufcontent = ((SIPCCMsg_ACD_StopRingAgentExt*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_QueryGW:
		thebufcontent = ((SIPCCMsg_ACD_QueryGW*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_IsAgentLoginConf:
		thebufcontent = ((SIPCCMsg_ACD_IsAgentLoginConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_NotifyAgent:
		thebufcontent = ((SIPCCMsg_ACD_NotifyAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AddCorpNDeptInfo:
		thebufcontent = ((SIPCCMsg_ACD_AddCorpNDeptInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_SetClientAgentState:
		thebufcontent = ((SIPCCMsg_ACD_SetClientAgentState*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallAnswered_WebPstnAgent:
		thebufcontent = ((SIPCCMsg_ACD_CallAnswered_WebPstnAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallReleased_WpAgent:
		thebufcontent = ((SIPCCMsg_ACD_CallReleased_WpAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_RingWpAgentExtFailed:
		thebufcontent = ((SIPCCMsg_ACD_RingWpAgentExtFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallWpAgentConf:
		thebufcontent = ((SIPCCMsg_ACD_CallWpAgentConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallWpAgentExtFailed:
		thebufcontent = ((SIPCCMsg_ACD_CallWpAgentExtFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallEnterVDN:
		thebufcontent = ((SIPCCMsg_ACD_CallEnterVDN*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallLeaveVDN:
		thebufcontent = ((SIPCCMsg_ACD_CallLeaveVDN*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_GetTalkingAgentConf:
		thebufcontent = ((SIPCCMsg_ACD_GetTalkingAgentConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_RecInfo2Client:
		thebufcontent = ((SIPCCMsg_ACD_RecInfo2Client*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_SuperDisconnect:
		thebufcontent = ((SIPCCMsg_ACD_SuperDisconnect*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_MonitRequest:
		thebufcontent = ((SIPCCMsg_ACD_MonitRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_MediaRequest_Monit:
		thebufcontent = ((SIPCCMsg_ACD_MediaRequest_Monit*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_MediaReady_Monit:
		thebufcontent = ((SIPCCMsg_ACD_MediaReady_Monit*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_StopMonit:
		thebufcontent = ((SIPCCMsg_ACD_StopMonit*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_MonitRequestConf:
		thebufcontent = ((SIPCCMsg_ACD_MonitRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_GetDeptWaitingAgentNumConf:
		thebufcontent = ((SIPCCMsg_ACD_GetDeptWaitingAgentNumConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_GetAgentStateConf:
		thebufcontent = ((SIPCCMsg_ACD_GetAgentStateConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_GetDeptQueueNumConf:
		thebufcontent = ((SIPCCMsg_ACD_GetDeptQueueNumConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_GetDeptOverflowConf:
		thebufcontent = ((SIPCCMsg_ACD_GetDeptOverflowConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_SendStrMsg:
		thebufcontent = ((SIPCCMsg_ACD_SendStrMsg*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_ReturnToAgent:
		thebufcontent = ((SIPCCMsg_ACD_ReturnToAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_GetDeptLoginAgentNumConf:
		thebufcontent = ((SIPCCMsg_ACD_GetDeptLoginAgentNumConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_AgentLogoutDepartsConf:
		thebufcontent = ((SIPCCMsg_ACD_AgentLogoutDepartsConf*)&msg)->FillBuf(thebuf);
		break;

	default:
		thebufcontent =msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeDataCollectionMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_ACD_AddDepartmentConf:
		
		break;
	case Type_Collect_RegisteConf:
		thebufcontent = ((SIPCCMsg_Collect_RegisteConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Collect_StatProcess:
		thebufcontent = ((SIPCCMsg_Collect_StatProcess*)&msg)->FillBuf(thebuf);
		break;
	case Type_Storage_Registe:
		thebufcontent = ((SIPCCMsg_Storage_Registe*)&msg)->FillBuf(thebuf);
		break;
	case Type_Storage_UnRegiste:
		thebufcontent = ((SIPCCMsg_Storage_UnRegiste*)&msg)->FillBuf(thebuf);
		break;
	case Type_Collect_StatProcessConf:
		thebufcontent = ((SIPCCMsg_Collect_StatProcessConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Collect_BeatHeart:
		thebufcontent = ((SIPCCMsg_Collect_BeatHeart*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeRelayMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	/*
	switch(msgType)
	{
	default:
	break;
	}
	*/
}

void CIPCCMsgExchanger::SerializeSysManageMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_SysManage_AddDepartment:
		thebufcontent = ((SIPCCMsg_SysManage_AddDepartment*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_AddKey:
		thebufcontent = ((SIPCCMsg_SysManage_AddKey*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_DelDepartment:
		thebufcontent = ((SIPCCMsg_SysManage_DelDepartment*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_DelKey:
		thebufcontent = ((SIPCCMsg_SysManage_DelKey*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_ModifyKeyword:
		thebufcontent = ((SIPCCMsg_SysManage_ModifyKeyword*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_ModifyKeyDepart:
		thebufcontent = ((SIPCCMsg_SysManage_ModifyKeyDepart*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_ModifyDepart:
		thebufcontent = ((SIPCCMsg_SysManage_ModifyDepart*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_AddGatewayInfo:
		thebufcontent = ((SIPCCMsg_SysManage_AddGatewayInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_DelGatewayInfo:
		thebufcontent = ((SIPCCMsg_SysManage_DelGatewayInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_AddGWCorp:
		thebufcontent = ((SIPCCMsg_SysManage_AddGWCorp*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_AddGWTG:
		thebufcontent = ((SIPCCMsg_SysManage_AddGWTG*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_AddDeptTG:
		thebufcontent = ((SIPCCMsg_SysManage_AddDeptTG*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_AddDialRule:
		thebufcontent = ((SIPCCMsg_SysManage_AddDialRule*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_DelACDCorp:
		thebufcontent = ((SIPCCMsg_SysManage_DelACDCorp*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_DelGWCorp:
		thebufcontent = ((SIPCCMsg_SysManage_DelGWCorp*)&msg)->FillBuf(thebuf);
		break;
	case Type_SysManage_NotifyACDLicence:
		thebufcontent = ((SIPCCMsg_SysManage_NotifyACDLicence*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeClientMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Client_SetOutdialCase:
		thebufcontent = ((SIPCCMsg_Client_SetOutdialCase*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_SetOutDialResult:
		thebufcontent = ((SIPCCMsg_Client_SetOutDialResult*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_GetTrunkCount:
		thebufcontent = ((SIPCCMsg_Client_GetTrunkCount*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserLogin:
		thebufcontent = ((SIPCCMsg_Client_UserLogin*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserQueryCall:
		thebufcontent = ((SIPCCMsg_Client_UserQueryCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserMakeCall:
		thebufcontent = ((SIPCCMsg_Client_UserMakeCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserHangupCall:
		thebufcontent = ((SIPCCMsg_Client_UserHangupCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentLogin:
		thebufcontent = ((SIPCCMsg_Client_AgentLogin*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentLogout:
		thebufcontent = ((SIPCCMsg_Client_AgentLogout*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentPark:
		thebufcontent = ((SIPCCMsg_Client_AgentPark*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentUnPark:
		thebufcontent = ((SIPCCMsg_Client_AgentUnPark*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentAnswerCall:
		thebufcontent = ((SIPCCMsg_Client_AgentAnswerCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentHangupCall:
		thebufcontent = ((SIPCCMsg_Client_AgentHangupCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_MediaRequest:
		thebufcontent = ((SIPCCMsg_Client_MediaRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_MediaRequestConf:
		thebufcontent = ((SIPCCMsg_Client_MediaRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_TextChatWords:
		thebufcontent = ((SIPCCMsg_Client_TextChatWords*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_MediaReady:
		thebufcontent = ((SIPCCMsg_Client_MediaReady*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_GetCallingQueueInfo:
		thebufcontent = ((SIPCCMsg_Client_GetCallingQueueInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentCallReceived:
		thebufcontent = ((SIPCCMsg_Client_AgentCallReceived*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentQueryState:
		thebufcontent = ((SIPCCMsg_Client_AgentQueryState*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserQueryState:
		thebufcontent = ((SIPCCMsg_Client_UserQueryState*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentMakeCall:
		thebufcontent = ((SIPCCMsg_Client_AgentMakeCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentMakeCall2:
		thebufcontent = ((SIPCCMsg_Client_AgentMakeCall2*)&msg)->FillBuf(thebuf);
		break;	
	case Type_Client_UserMakeCallPSTN:
		thebufcontent = ((SIPCCMsg_Client_UserMakeCallPSTN*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserMakeCallPSTN2:
		thebufcontent = ((SIPCCMsg_Client_UserMakeCallPSTN2*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserReset:
		thebufcontent = ((SIPCCMsg_Client_UserReset*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentReset:
		thebufcontent = ((SIPCCMsg_Client_AgentReset*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserLoginStateSvr:
		thebufcontent = ((SIPCCMsg_Client_UserLoginStateSvr*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserLogoutStateSvr:
		thebufcontent = ((SIPCCMsg_Client_UserLogoutStateSvr*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserAnswerCall:
		thebufcontent = ((SIPCCMsg_Client_UserAnswerCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_UserAnswerCall_Real:
		thebufcontent = ((SIPCCMsg_Client_UserAnswerCall_Real*)&msg)->FillBuf(thebuf);
		break;
	case Type_ACD_CallEstablished_Real:
		thebufcontent = ((SIPCCMsg_ACD_CallEstablished_Real*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_CallUserConf:
		thebufcontent = ((SIPCCMsg_Client_CallUserConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentHoldCall:
		thebufcontent = ((SIPCCMsg_Client_AgentHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentUnHoldCall:
		thebufcontent = ((SIPCCMsg_Client_AgentUnHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_CallUserFailed:
		thebufcontent = ((SIPCCMsg_Client_CallUserFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_QueryRouteTactic:
		thebufcontent = ((SIPCCMsg_Client_QueryRouteTactic*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_PrepareTransfer:
		thebufcontent = ((SIPCCMsg_Client_PrepareTransfer*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_TransReady:
		thebufcontent = ((SIPCCMsg_Client_TransReady*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_TransferCall:
		thebufcontent = ((SIPCCMsg_Client_TransferCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_ClearPreConnection:
		thebufcontent = ((SIPCCMsg_Client_ClearPreConnection*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentTestNet:
		thebufcontent = ((SIPCCMsg_Client_AgentTestNet*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentTestNetConf:
		thebufcontent = ((SIPCCMsg_Client_AgentTestNetConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_LanPortApprize:
		thebufcontent = ((SIPCCMsg_Client_LanPortApprize*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_QueryGW:
		thebufcontent = ((SIPCCMsg_Client_QueryGW*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_QueryGWLanInfo:
		thebufcontent = ((SIPCCMsg_Client_QueryGWLanInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_GetDepartNAgentInfo:
		thebufcontent = ((SIPCCMsg_Client_GetDepartNAgentInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_GetGroupRequest:
		thebufcontent = ((SIPCCMsg_Client_GetGroupRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_LoginToText:
		thebufcontent = ((SIPCCMsg_Client_LoginToText*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_LogoutFromText:
		thebufcontent = ((SIPCCMsg_Client_LogoutFromText*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_TextChat:
		thebufcontent = ((SIPCCMsg_Client_TextChat*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_BeforeTransfer:
		thebufcontent = ((SIPCCMsg_Client_BeforeTransfer*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_WebPSTNDial:
		thebufcontent = ((SIPCCMsg_Client_WebPSTNDial*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_WebPSTNAgentHoldCall:
		thebufcontent = ((SIPCCMsg_Client_WebPSTNAgentHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_WebPSTNAgentUnHoldCall:
		thebufcontent = ((SIPCCMsg_Client_WebPSTNAgentUnHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_WpAgentTrans2VoipAgent:
		thebufcontent = ((SIPCCMsg_Client_WpAgentTrans2VoipAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_EchoRemoveCtrl:
		thebufcontent = ((SIPCCMsg_Client_EchoRemoveCtrl*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_QueryTransServer:
		thebufcontent = ((SIPCCMsg_Client_QueryTransServer*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentLoadURL:
		thebufcontent = ((SIPCCMsg_Client_AgentLoadURL*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_MonitRequest:
		thebufcontent = ((SIPCCMsg_Client_MonitRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_MonitRequestConf:
		thebufcontent = ((SIPCCMsg_Client_MonitRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_GetTalkingAgent:
		thebufcontent = ((SIPCCMsg_Client_GetTalkingAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_StopMonit:
		thebufcontent = ((SIPCCMsg_Client_StopMonit*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_SuperDisconnect:
		thebufcontent = ((SIPCCMsg_Client_SuperDisconnect*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_GetParkReasons:
		thebufcontent = ((SIPCCMsg_Client_GetParkReasons*)&msg)->FillBuf(thebuf);
		break;

	case Type_Client_MediaRequest_Monit:
		thebufcontent = ((SIPCCMsg_Client_MediaRequest_Monit*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_MediaReady_Monit:
		thebufcontent = ((SIPCCMsg_Client_MediaReady_Monit*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_SendDtmf:
		thebufcontent = ((SIPCCMsg_Client_SendDtmf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_ChangePassword:
		thebufcontent = ((SIPCCMsg_Client_ChangePassword*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_ReceiveDtmf:
		thebufcontent = ((SIPCCMsg_Client_ReceiveDtmf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_SendStrMsg:
		thebufcontent = ((SIPCCMsg_Client_SendStrMsg*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_QueryIncrementFunc:
		thebufcontent = ((SIPCCMsg_Client_QueryIncrementFunc*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_ReturnToAgent:
		thebufcontent = ((SIPCCMsg_Client_ReturnToAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_NotifyAgentLogin:
		thebufcontent = ((SIPCCMsg_Client_NotifyAgentLogin*)&msg)->FillBuf(thebuf);
		break;
	case Type_Client_AgentLogoutDeparts:
		thebufcontent = ((SIPCCMsg_Client_AgentLogoutDeparts*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeP2PMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_P2P_ConnRequest:
		thebufcontent = ((SIPCCMsg_P2P_ConnRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_MakeHoleCmd:
		thebufcontent = ((SIPCCMsg_P2P_MakeHoleCmd*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_MakeHoleCmdConf:
		thebufcontent = ((SIPCCMsg_P2P_MakeHoleCmdConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_MakeHoleMsg:
		thebufcontent = ((SIPCCMsg_P2P_MakeHoleMsg*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_ConnRequestConf:
		thebufcontent = ((SIPCCMsg_P2P_ConnRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_TestMsg:
		thebufcontent = ((SIPCCMsg_P2P_TestMsg*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_TestMsgConf:
		thebufcontent = ((SIPCCMsg_P2P_TestMsgConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_DirectConn:
		thebufcontent = ((SIPCCMsg_P2P_DirectConn*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_ConnDifficultMsg:
		thebufcontent = ((SIPCCMsg_P2P_ConnDifficultMsg*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_ChechNatRequest:
		thebufcontent = ((SIPCCMsg_P2P_CheckNatRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_ChechNatConf:
		thebufcontent = ((SIPCCMsg_P2P_CheckNatConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_ReInitSockCmd:
		thebufcontent = ((SIPCCMsg_P2P_ReInitSockCmd*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_ReInitSockFailed:
		thebufcontent = ((SIPCCMsg_P2P_ReInitSockFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_MediaNegotiate:
		thebufcontent = ((SIPCCMsg_P2P_MediaNegotiate*)&msg)->FillBuf(thebuf);
		break;
	case Type_P2P_MediaNegotiateConf:
		thebufcontent = ((SIPCCMsg_P2P_MediaNegotiateConf*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeEndEgnMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = ((SIPCCMsg_EndEgn*)&msg)->FillBuf(thebuf);
}

void CIPCCMsgExchanger::SerializeTransmitMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Trans_TransmitRequest:
		thebufcontent = ((SIPCCMsg_Trans_TransmitRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_Trans_TransmitRequestConf:
		thebufcontent = ((SIPCCMsg_Trans_TransmitRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Trans_TransmitStopRequest:
		thebufcontent = ((SIPCCMsg_Trans_TransmitStopRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_Trans_TransmitRejected:
		thebufcontent = ((SIPCCMsg_Trans_TransmitRejected*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeFileMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_File_TransRequest:
		thebufcontent = ((SIPCCMsg_File_TransRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_TransRequestConf:
		thebufcontent = ((SIPCCMsg_File_TransRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_TransReady:
		thebufcontent = ((SIPCCMsg_File_TransReady*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_UnConnect:
		thebufcontent = ((SIPCCMsg_File_UnConnect*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_FileRequest:
		thebufcontent = ((SIPCCMsg_File_FileRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_FileRequestConf:
		thebufcontent = ((SIPCCMsg_File_FileRequestConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_FileReceived:
		thebufcontent = ((SIPCCMsg_File_FileReceived*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_FileStopped:
		thebufcontent = ((SIPCCMsg_File_FileStopped*)&msg)->FillBuf(thebuf);
		break;
	case Type_File_FileReceiveInfo:
		thebufcontent = ((SIPCCMsg_File_FileReceiveInfo*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeRecordMsg(SIPCCMessage &msg, char *&thebuf, int &thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Record_Login:
		thebufcontent = ((SIPCCMsg_Record_Login*)&msg)->FillBuf(thebuf);
		break;
	case Type_Record_LoginConf:
		thebufcontent = ((SIPCCMsg_Record_LoginConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Record_StartRecord:
		thebufcontent = ((SIPCCMsg_Record_StartRecord*)&msg)->FillBuf(thebuf);
		break;
	case Type_Record_StopRecord:
		thebufcontent = ((SIPCCMsg_Record_StopRecord*)&msg)->FillBuf(thebuf);
		break;
	case Type_Record_StartRecordConf:
		thebufcontent = ((SIPCCMsg_Record_StartRecordConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Record_RecInfo2ACD:
		thebufcontent = ((SIPCCMsg_Record_RecInfo2ACD*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeSmartRouteMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_SmartRoute_QueryUserStatus:	//查询用户身份
		thebufcontent = ((SIPCCMsg_SmartRoute_QueryUserStatus*)&msg)->FillBuf(thebuf);
		break;
	case Type_SmartRoute_QueryUserStatusConf:
		thebufcontent = ((SIPCCMsg_SmartRoute_QueryUserStatusConf*)&msg)->FillBuf(thebuf);
		break;		
	case Type_SmartRoute_LoadSmartRouteTactic:
		thebufcontent = ((SIPCCMsg_SmartRoute_LoadSmartRouteTactic*)&msg)->FillBuf(thebuf);
		break;
	case Type_SmartRoute_BlackListTactic:
		thebufcontent = ((SIPCCMsg_SmartRoute_BlackListTactic*)&msg)->FillBuf(thebuf);
		break;
	case Type_SmartRoute_NewUserTactic:
		thebufcontent = ((SIPCCMsg_SmartRoute_NewUserTactic*)&msg)->FillBuf(thebuf);
		break;
	case Type_SmartRoute_OldUserTactic:
		thebufcontent = ((SIPCCMsg_SmartRoute_OldUserTactic*)&msg)->FillBuf(thebuf);
		break;
	case Type_SmartRoute_RouteTactic:		//返回路有策略
		thebufcontent = ((SIPCCMsg_SmartRoute_RouteTactic*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeGatewayMsg(SIPCCMessage &msg, char *&thebuf, int &thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Gateway_GetDeptOverflow:
		thebufcontent = ((SIPCCMsg_Gateway_GetDeptOverflow*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_Login:
		thebufcontent = ((SIPCCMsg_Gateway_Login*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetTrunkCountConf:
		thebufcontent = ((SIPCCMsg_Gateway_GetTrunkCountConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_Logout:
		thebufcontent = ((SIPCCMsg_Gateway_Logout*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_LoginConf:
		thebufcontent = ((SIPCCMsg_Gateway_LoginConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_LoadInfo:
		thebufcontent = ((SIPCCMsg_Gateway_LoadInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_SetBaseInfo:
		thebufcontent = ((SIPCCMsg_Gateway_SetBaseInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AddPrefixNoInfo:
		thebufcontent = ((SIPCCMsg_Gateway_AddPrefixNoInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_SetCorporationInfo:
		thebufcontent = ((SIPCCMsg_Gateway_SetCorporationInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_DelCorporationInfo:
		thebufcontent = ((SIPCCMsg_Gateway_DelCorporationInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_QueryGWConf:
		thebufcontent = ((SIPCCMsg_Gateway_QueryGWConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallInQuery:			//呼入查询
		thebufcontent = ((SIPCCMsg_Gateway_CallInQuery*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallInQueryConf:
		thebufcontent = ((SIPCCMsg_Gateway_CallInQueryConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_SetTrunkState:
		thebufcontent = ((SIPCCMsg_Gateway_SetTrunkState*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AgentTestNetConf:
		thebufcontent = ((SIPCCMsg_Gateway_AgentTestNetConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_QueryGWLanInfoConf:
		thebufcontent = ((SIPCCMsg_Gateway_QueryGWLanInfoConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_SyncTrunkState:
		thebufcontent = ((SIPCCMsg_Gateway_SyncTrunkState*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_ReConnect:
		thebufcontent = ((SIPCCMsg_Gateway_ReConnect*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AgentTalkBegin:
		thebufcontent = ((SIPCCMsg_Gateway_AgentTalkBegin*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AgentTalkEnd:
		thebufcontent = ((SIPCCMsg_Gateway_AgentTalkEnd*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_SetRecord:
		thebufcontent = ((SIPCCMsg_Gateway_SetRecord*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_SetRecordConf:
		thebufcontent = ((SIPCCMsg_Gateway_SetRecordConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetTrunkState:
		thebufcontent = ((SIPCCMsg_Gateway_GetTrunkState*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetTrunkStateConf:
		thebufcontent = ((SIPCCMsg_Gateway_GetTrunkStateConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_ForceHangup:
		thebufcontent = ((SIPCCMsg_Gateway_ForceHangup*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_DisableSth:
		thebufcontent = ((SIPCCMsg_Gateway_DisableSth*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_400CallBackCmd:
		thebufcontent = ((SIPCCMsg_Gateway_400CallBackCmd*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_RingAgentExtConf:
		thebufcontent = ((SIPCCMsg_Gateway_RingAgentExtConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_RingAgentExtFailed:
		thebufcontent = ((SIPCCMsg_Gateway_RingAgentExtFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AgentAnswerCall:
		thebufcontent = ((SIPCCMsg_Gateway_AgentAnswerCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AgentHangupCall:
		thebufcontent = ((SIPCCMsg_Gateway_AgentHangupCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_StopRingAgentExtConf:
		thebufcontent = ((SIPCCMsg_Gateway_StopRingAgentExtConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_QueryAgentInfo:
		thebufcontent = ((SIPCCMsg_Gateway_QueryAgentInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CancelRingAgentExt:
		thebufcontent = ((SIPCCMsg_Gateway_CancelRingAgentExt*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_IsAgentLogin:
		thebufcontent = ((SIPCCMsg_Gateway_IsAgentLogin*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallAgentExtFailed:
		thebufcontent = ((SIPCCMsg_Gateway_CallAgentExtFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AgentExtCallerFailed:
		thebufcontent = ((SIPCCMsg_Gateway_AgentExtCallerFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AgentExtCallSucc:
		thebufcontent = ((SIPCCMsg_Gateway_AgentExtCallSucc*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_UnAnsweredCall:
		thebufcontent = ((SIPCCMsg_Gateway_UnAnsweredCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_UserHangupCall:
		thebufcontent = ((SIPCCMsg_Gateway_UserHangupCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallAgentConf:
		thebufcontent = ((SIPCCMsg_Gateway_CallAgentConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallAgentFailed:
		thebufcontent = ((SIPCCMsg_Gateway_CallAgentFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallUserFailed_WpAgent:
		thebufcontent = ((SIPCCMsg_Gateway_CallUserFailed_WpAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallCleared:
		thebufcontent = ((SIPCCMsg_Gateway_CallCleared*)&msg)->FillBuf(thebuf);
		break;
		// + [1/27/2008 lixg]
	case Type_Gateway_Valid:
		thebufcontent = ((SIPCCMsg_Gateway_Valid*)&msg)->FillBuf(thebuf);
		break;		
	case Type_Gateway_GetGetwayInfo:
		thebufcontent = ((SIPCCMsg_Gateway_GetGetwayInfo*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetGetwayInfoConf:
		thebufcontent = ((SIPCCMsg_Gateway_GetGetwayInfoConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_AddRecordForTH:
		thebufcontent = ((SIPCCMsg_Gateway_AddRecordForTH*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_DelRecordForTH:
		thebufcontent = ((SIPCCMsg_Gateway_DelRecordForTH*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_DelAllRecordForTH:
		thebufcontent = ((SIPCCMsg_Gateway_DelAllRecordForTH*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetDeptWaitingAgentNum:
		thebufcontent = ((SIPCCMsg_Gateway_GetDeptWaitingAgentNum*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetDeptQueueNum:
		thebufcontent = ((SIPCCMsg_Gateway_GetDeptQueueNum*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetAgentState:
		thebufcontent = ((SIPCCMsg_Gateway_GetAgentState*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_LoadDataConf:
		thebufcontent = ((SIPCCMsg_Gateway_LoadDataConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_GetDeptLoginAgentNum:
		thebufcontent = ((SIPCCMsg_Gateway_GetDeptLoginAgentNum*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_TrunkStat:
		thebufcontent = ((SIPCCMsg_Gateway_TrunkStat*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_TrunkSeizeRate:
		thebufcontent = ((SIPCCMsg_Gateway_TrunkSeizeRate*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallInStat:
		thebufcontent = ((SIPCCMsg_Gateway_CallInStat*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallInOutStat:
		thebufcontent = ((SIPCCMsg_Gateway_CallInOutStat*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_CallOutStat:
		thebufcontent = ((SIPCCMsg_Gateway_CallOutStat*)&msg)->FillBuf(thebuf);
		break;
	case Type_Gateway_NotifyTrunkState:
		thebufcontent = ((SIPCCMsg_Gateway_NotifyTrunkState*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::SerializeTextMsg(SIPCCMessage &msg, char *&thebuf, int &thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_Text_TextChat:
		thebufcontent = ((SIPCCMsg_Text_TextChat*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

/////////////////////////////////////////////////////////////////////////////////////////////
void CIPCCMsgExchanger::DeSerializeMsg(char* pmsg, int msgsize, SIPCCMessage& msg, unsigned long ip, unsigned short port)
{
	if(msgsize < 8)	return;
	
	__EIPCCMsgClass msgClass = (__EIPCCMsgClass)msg.msgClass;
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgClass)
	{
	case Class_Login:
		DeSerializeLoginMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Guide:
		DeSerializeGuideMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_ACD:
		DeSerializeACDMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_DataCollection:
		DeSerializeDataCollectionMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_UserMark:
		DeSerializeUserMarkMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Relay:
		DeSerializeRelayMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_SysManage:
		DeSerializeSysManageMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Client:
		DeSerializeClientMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_P2P:
		DeSerializeP2PMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_EndEgn:
		DeSerializeEndEgnMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_HeartBeat:
		DeSerializeHeartBeatMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Transmit:
		DeSerializeTransmitMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_File:
		DeSerializeFileMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_UState:
		DeSerializeUStateMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Record:
		DeSerializeRecordMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_SmartRoute:
		DeSerializeSmartRouteMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Gateway:
		DeSerializeGatewayMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_TextChat:
		DeSerializeTextMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_GwMonit:
		DeSerializeGwMonitMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Redirect:
		DeSerializeRedirectMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_DlyStrategy:
		DeSerializeDlyStrategyMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_TollQuery:
		DeSerializeTollQueryMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_SMS:
		DeSerializeSmsMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Toll:
		DeSerializeTollMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_PhoneSearch:
	case Class_DataRoute:
	case Class_DataTrans:
		DeSerializePhoneSearchMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Wap:
		DeSerializeWapMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Alert:
		DeSerializeAlertMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
		break;
	case Class_Autodetector:
		DeSerializeAutodetectorMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
	case Class_Operator:
		DeSerializeOperatorMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
	case Class_Log:
		DeSerializeLogMsg(pmsg, msgsize, (int&)msgType, msg, ip, port);
	case Class_SAMPLER:
		DeSerializeSamplerMsg(pmsg,msgsize,(int&)msgType,msg,ip,port);
		break;
	case Class_ClientCapture:
		DeSerializeClientCaptureMsg(pmsg,msgsize,(int&)msgType,msg,ip,port);
		break;
	case Class_VoiceRecognition:
		DeSerializeVoiceRecognitionMsg(pmsg,msgsize,(int&)msgType,msg,ip,port);
		break;
	case Class_TTS:
		DeSerializeTTSMsg(pmsg,msgsize,(int&)msgType,msg,ip,port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeAlertMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::DeSerializeLoginMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_Login_UserLoginFailed:
		((SIPCCMsg_Login_UserLoginFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Login_UserLoginSucc:
		((SIPCCMsg_Login_UserLoginSucc*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Login_ServerRegister:
		((SIPCCMsg_Login_ServerRegister*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Login_ServerRegisterConf:
		((SIPCCMsg_Login_ServerRegisterConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Login_AgentLoadURLConf:
		((SIPCCMsg_Login_AgentLoadURLConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Login_GetParkReasonsConf:
		((SIPCCMsg_Login_GetParkReasonsConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_Login_ChangePasswordConf:
		((SIPCCMsg_Login_ChangePasswordConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Login_QueryIncrementFuncConf:
		((SIPCCMsg_Login_QueryIncrementFuncConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case  Type_Login_SendStrMsg:
		((SIPCCMsg_Login_SendStrMsg*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Login_NotifyAgentLoginConf:
		((SIPCCMsg_Login_NotifyAgentLoginConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeGuideMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_Guide_ACDInfo:
		((SIPCCMsg_Guide_ACDInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Guide_AddKeyConf:
		((SIPCCMsg_Guide_AddKeyConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Guide_LoadKeyWords:
		((SIPCCMsg_Guide_LoadKeyWords*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Guide_DelKeyConf:
		((SIPCCMsg_Guide_DelKeyConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeHeartBeatMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{	
	case Type_HeartBeat:
		((SIPCCMsg_HeartBeat*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_HeartBeatResponse:
		((SIPCCMsg_HeartBeatResponse*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeACDMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_ACD_SetTalkSpan:
		((SIPCCMsg_ACD_SetTalkSpan*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_SetAgentCount:
		((SIPCCMsg_ACD_SetAgentCount*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_DelDepartment:
		((SIPCCMsg_ACD_DelDepartment*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentLoginSucc:
		((SIPCCMsg_ACD_AgentLoginSucc*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentLoginFailed:
		((SIPCCMsg_ACD_AgentLoginFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentLogoutConf:
		((SIPCCMsg_ACD_AgentLogoutConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentParkConf:
		((SIPCCMsg_ACD_AgentParkConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentUnParkConf:
		((SIPCCMsg_ACD_AgentUnParkConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AddDepartmentConf:
		((SIPCCMsg_ACD_AddDepartmentConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_DelDepartmentConf:
		((SIPCCMsg_ACD_DelDepartmentConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_UserMakeCallConf:
		((SIPCCMsg_ACD_UserMakeCallConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallDelivered:
		((SIPCCMsg_ACD_CallDelivered*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallEstablished:
		((SIPCCMsg_ACD_CallEstablished*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallAnswered:
		((SIPCCMsg_ACD_CallAnswered*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallReleased:
		((SIPCCMsg_ACD_CallReleased*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallHanguped:
		((SIPCCMsg_ACD_CallHanguped*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentStateInfo:
		((SIPCCMsg_ACD_AgentStateInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_MediaRequest:
		((SIPCCMsg_ACD_MediaRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_MediaRequestConf:
		((SIPCCMsg_ACD_MediaRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_LoadDepartments:
		((SIPCCMsg_ACD_LoadDepartments*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallingQueueInfo:
		((SIPCCMsg_ACD_CallingQueueInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallArriveToAgent:
		((SIPCCMsg_ACD_CallArriveToAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentQueryStateConf:
		((SIPCCMsg_ACD_AgentQueryStateConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentMakeCallConf:
		((SIPCCMsg_ACD_AgentMakeCallConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;	
	case Type_ACD_CallUserConf:
		((SIPCCMsg_ACD_CallUserConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentHoldCall:
		((SIPCCMsg_ACD_AgentHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentUnHoldCall:
		((SIPCCMsg_ACD_AgentUnHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AgentHoldCallConf:
		((SIPCCMsg_ACD_AgentHoldCallConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_NotifyDataCollect:
		((SIPCCMsg_ACD_NotifyDataCollect*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallUserFailed:
		((SIPCCMsg_ACD_CallUserFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_PrepareTransfer:
		((SIPCCMsg_ACD_PrepareTransfer*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_TransReady:
		((SIPCCMsg_ACD_TransReady*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_TransferCall:
		((SIPCCMsg_ACD_TransferCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_TransferCall_WpAgent:
		((SIPCCMsg_ACD_TransferCall_WpAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_BeforeTransferCall_WpAgent:
		((SIPCCMsg_ACD_BeforeTransferCall_WpAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_ClearPreConnection:
		((SIPCCMsg_ACD_ClearPreConnection*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_DepartNAgentInfo:
		((SIPCCMsg_ACD_DepartNAgentInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_GroupInfo:
		((SIPCCMsg_ACD_GroupInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_NotifyAgentStateEvent:
		((SIPCCMsg_ACD_NotifyAgentStateEvent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_VDNStatusInfo:
		((SIPCCMsg_ACD_VDNStatusInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_MediaReady:
		((SIPCCMsg_ACD_MediaReady*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_ForceLogout:
		((SIPCCMsg_ACD_ForceLogout*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_StopRingAgentExt:
		((SIPCCMsg_ACD_StopRingAgentExt*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_QueryGW:
		((SIPCCMsg_ACD_QueryGW*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_RingAgentExt:
		((SIPCCMsg_ACD_RingAgentExt*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_RingAgentExt2:
		((SIPCCMsg_ACD_RingAgentExt2*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_IsAgentLoginConf:
		((SIPCCMsg_ACD_IsAgentLoginConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_NotifyAgent:
		((SIPCCMsg_ACD_NotifyAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_AddCorpNDeptInfo:
		((SIPCCMsg_ACD_AddCorpNDeptInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_SetClientAgentState:
		((SIPCCMsg_ACD_SetClientAgentState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallAnswered_WebPstnAgent:
		((SIPCCMsg_ACD_CallAnswered_WebPstnAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallReleased_WpAgent:
		((SIPCCMsg_ACD_CallReleased_WpAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_RingWpAgentExtFailed:
		((SIPCCMsg_ACD_RingWpAgentExtFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallWpAgentConf:
		((SIPCCMsg_ACD_CallWpAgentConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallWpAgentExtFailed:
		((SIPCCMsg_ACD_CallWpAgentExtFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallEnterVDN:
		((SIPCCMsg_ACD_CallEnterVDN*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallLeaveVDN:
		((SIPCCMsg_ACD_CallLeaveVDN*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_GetTalkingAgentConf:
		((SIPCCMsg_ACD_GetTalkingAgentConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_RecInfo2Client:
		((SIPCCMsg_ACD_RecInfo2Client*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_SuperDisconnect:
		((SIPCCMsg_ACD_SuperDisconnect*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_MonitRequest:
		((SIPCCMsg_ACD_MonitRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_MonitRequestConf:
		((SIPCCMsg_ACD_MonitRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_MediaRequest_Monit:
		((SIPCCMsg_ACD_MediaRequest_Monit*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_MediaReady_Monit:
		((SIPCCMsg_ACD_MediaReady_Monit*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_StopMonit:
		((SIPCCMsg_ACD_StopMonit*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_GetDeptWaitingAgentNumConf:
		((SIPCCMsg_ACD_GetDeptWaitingAgentNumConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_GetDeptQueueNumConf:
		((SIPCCMsg_ACD_GetDeptQueueNumConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_GetAgentStateConf:
		((SIPCCMsg_ACD_GetAgentStateConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_GetDeptOverflowConf:
		((SIPCCMsg_ACD_GetDeptOverflowConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_SendStrMsg:
		((SIPCCMsg_ACD_SendStrMsg*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_ReturnToAgent:
		((SIPCCMsg_ACD_ReturnToAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_GetDeptLoginAgentNumConf:
		((SIPCCMsg_ACD_GetDeptLoginAgentNumConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;	
	case Type_ACD_AgentLogoutDepartsConf:
		((SIPCCMsg_ACD_AgentLogoutDepartsConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeDataCollectionMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_Collect_RegisteConf:
		((SIPCCMsg_Collect_RegisteConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Collect_StatProcess:
		((SIPCCMsg_Collect_StatProcess*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Storage_Registe:
		((SIPCCMsg_Storage_Registe*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Storage_UnRegiste:
		((SIPCCMsg_Storage_UnRegiste*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Collect_StatProcessConf:
		((SIPCCMsg_Collect_StatProcessConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Collect_BeatHeart:
		((SIPCCMsg_Collect_BeatHeart*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
	
}

void CIPCCMsgExchanger::DeSerializeUserMarkMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
/*
switch(msgtype)
{
default:
break;
}
	*/
}

void CIPCCMsgExchanger::DeSerializeRelayMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
/*
switch(msgtype)
{
default:
break;
}
	*/
}

void CIPCCMsgExchanger::DeSerializeSysManageMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_SysManage_AddDepartment:
		((SIPCCMsg_SysManage_AddDepartment*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_AddKey:
		((SIPCCMsg_SysManage_AddKey*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_DelDepartment:
		((SIPCCMsg_SysManage_DelDepartment*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_DelKey:
		((SIPCCMsg_SysManage_DelKey*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_AddGatewayInfo:
		((SIPCCMsg_SysManage_AddGatewayInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_DelGatewayInfo:
		((SIPCCMsg_SysManage_DelGatewayInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_AddGWCorp:
		((SIPCCMsg_SysManage_AddGWCorp*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_AddGWTG:
		((SIPCCMsg_SysManage_AddGWTG*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_AddDeptTG:
		((SIPCCMsg_SysManage_AddDeptTG*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_AddDialRule:
		((SIPCCMsg_SysManage_AddDialRule*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_DelACDCorp:
		((SIPCCMsg_SysManage_DelACDCorp*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_DelGWCorp:
		((SIPCCMsg_SysManage_DelGWCorp*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_SysManage_NotifyACDLicence:
		((SIPCCMsg_SysManage_NotifyACDLicence*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeClientMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_Client_SetOutDialResult:
		((SIPCCMsg_Client_SetOutDialResult*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_SetOutdialCase:
		((SIPCCMsg_Client_SetOutdialCase*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserLogin:
		((SIPCCMsg_Client_UserLogin*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserQueryCall:
		((SIPCCMsg_Client_UserQueryCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserMakeCall:
		((SIPCCMsg_Client_UserMakeCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserHangupCall:
		((SIPCCMsg_Client_UserHangupCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentLogin:
		((SIPCCMsg_Client_AgentLogin*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentLogout:
		((SIPCCMsg_Client_AgentLogout*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentPark:
		((SIPCCMsg_Client_AgentPark*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentUnPark:
		((SIPCCMsg_Client_AgentUnPark*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentAnswerCall:
		((SIPCCMsg_Client_AgentAnswerCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentHangupCall:
		((SIPCCMsg_Client_AgentHangupCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_MediaRequest:
		((SIPCCMsg_Client_MediaRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_MediaRequestConf:
		((SIPCCMsg_Client_MediaRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_TextChatWords:
		((SIPCCMsg_Client_TextChatWords*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_MediaReady:
		((SIPCCMsg_Client_MediaReady*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_GetCallingQueueInfo:
		((SIPCCMsg_Client_GetCallingQueueInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentCallReceived:
		((SIPCCMsg_Client_AgentCallReceived*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentQueryState:
		((SIPCCMsg_Client_AgentQueryState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserQueryState:
		((SIPCCMsg_Client_UserQueryState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;	
	case Type_Client_AgentMakeCall:
		((SIPCCMsg_Client_AgentMakeCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentMakeCall2:
		((SIPCCMsg_Client_AgentMakeCall2*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserMakeCallPSTN:
		((SIPCCMsg_Client_UserMakeCallPSTN*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserMakeCallPSTN2:
		((SIPCCMsg_Client_UserMakeCallPSTN2*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserReset:
		((SIPCCMsg_Client_UserReset*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentReset:
		((SIPCCMsg_Client_AgentReset*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserLoginStateSvr:
		((SIPCCMsg_Client_UserLoginStateSvr*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserLogoutStateSvr:
		((SIPCCMsg_Client_UserLogoutStateSvr*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserAnswerCall:
		((SIPCCMsg_Client_UserAnswerCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_UserAnswerCall_Real:
		((SIPCCMsg_Client_UserAnswerCall_Real*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_ACD_CallEstablished_Real:
		((SIPCCMsg_ACD_CallEstablished_Real*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_CallUserConf:
		((SIPCCMsg_Client_CallUserConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentHoldCall:
		((SIPCCMsg_Client_AgentHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentUnHoldCall:
		((SIPCCMsg_Client_AgentUnHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_CallUserFailed:
		((SIPCCMsg_Client_CallUserFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_QueryRouteTactic:
		((SIPCCMsg_Client_QueryRouteTactic*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_PrepareTransfer:
		((SIPCCMsg_Client_PrepareTransfer*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_TransReady:
		((SIPCCMsg_Client_TransReady*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_TransferCall:
		((SIPCCMsg_Client_TransferCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_ClearPreConnection:
		((SIPCCMsg_Client_ClearPreConnection*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentTestNet:
		((SIPCCMsg_Client_AgentTestNet*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentTestNetConf:
		((SIPCCMsg_Client_AgentTestNetConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_LanPortApprize:
		((SIPCCMsg_Client_LanPortApprize*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_QueryGW:
		((SIPCCMsg_Client_QueryGW*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_QueryGWLanInfo:
		((SIPCCMsg_Client_QueryGWLanInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_GetDepartNAgentInfo:
		((SIPCCMsg_Client_GetDepartNAgentInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_GetGroupRequest:
		((SIPCCMsg_Client_GetGroupRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_LoginToText:
		((SIPCCMsg_Client_LoginToText*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_LogoutFromText:
		((SIPCCMsg_Client_LogoutFromText*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_TextChat:
		((SIPCCMsg_Client_TextChat*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_BeforeTransfer:
		((SIPCCMsg_Client_BeforeTransfer*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_WebPSTNDial:
		((SIPCCMsg_Client_WebPSTNDial*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_WebPSTNAgentHoldCall:
		((SIPCCMsg_Client_WebPSTNAgentHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_WebPSTNAgentUnHoldCall:
		((SIPCCMsg_Client_WebPSTNAgentUnHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_WpAgentTrans2VoipAgent:
		((SIPCCMsg_Client_WpAgentTrans2VoipAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_EchoRemoveCtrl:
		((SIPCCMsg_Client_EchoRemoveCtrl*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_QueryTransServer:
		((SIPCCMsg_Client_QueryTransServer*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentLoadURL:
		((SIPCCMsg_Client_AgentLoadURL*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_MonitRequest:
		((SIPCCMsg_Client_MonitRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_MonitRequestConf:
		((SIPCCMsg_Client_MonitRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_GetTalkingAgent:
		((SIPCCMsg_Client_GetTalkingAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_StopMonit:
		((SIPCCMsg_Client_StopMonit*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_SuperDisconnect:
		((SIPCCMsg_Client_SuperDisconnect*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_GetParkReasons:
		((SIPCCMsg_Client_GetParkReasons*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;

	case Type_Client_MediaRequest_Monit:
		((SIPCCMsg_Client_MediaRequest_Monit*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_MediaReady_Monit:
		((SIPCCMsg_Client_MediaReady_Monit*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_SendDtmf:
		((SIPCCMsg_Client_SendDtmf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_GetTrunkCount:
		((SIPCCMsg_Client_GetTrunkCount*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_ChangePassword:
		((SIPCCMsg_Client_ChangePassword*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_ReceiveDtmf:
		((SIPCCMsg_Client_ReceiveDtmf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_SendStrMsg:
		((SIPCCMsg_Client_SendStrMsg*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_QueryIncrementFunc:
		((SIPCCMsg_Client_QueryIncrementFunc*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_ReturnToAgent:
		((SIPCCMsg_Client_ReturnToAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_NotifyAgentLogin:
		((SIPCCMsg_Client_NotifyAgentLogin*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Client_AgentLogoutDeparts:
		((SIPCCMsg_Client_AgentLogoutDeparts*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeP2PMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_P2P_ConnRequest:
		((SIPCCMsg_P2P_ConnRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_MakeHoleCmd:
		((SIPCCMsg_P2P_MakeHoleCmd*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_MakeHoleCmdConf:
		((SIPCCMsg_P2P_MakeHoleCmdConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_MakeHoleMsg:
		((SIPCCMsg_P2P_MakeHoleMsg*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_ConnRequestConf:
		((SIPCCMsg_P2P_ConnRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_TestMsg:
		((SIPCCMsg_P2P_TestMsg*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_TestMsgConf:
		((SIPCCMsg_P2P_TestMsgConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_DirectConn:
		((SIPCCMsg_P2P_DirectConn*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;	
	case Type_P2P_ConnDifficultMsg:
		((SIPCCMsg_P2P_ConnDifficultMsg*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_ChechNatRequest:
		((SIPCCMsg_P2P_CheckNatRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_ChechNatConf:
		((SIPCCMsg_P2P_CheckNatConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_ReInitSockCmd:
		((SIPCCMsg_P2P_ReInitSockCmd*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_ReInitSockFailed:
		((SIPCCMsg_P2P_ReInitSockFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_MediaNegotiate:
		((SIPCCMsg_P2P_MediaNegotiate*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_P2P_MediaNegotiateConf:
		((SIPCCMsg_P2P_MediaNegotiateConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeEndEgnMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	((SIPCCMsg_EndEgn*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::DeSerializeDataRouteMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::DeSerializeDataTransMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::DeSerializeTransmitMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_Trans_TransmitRequest:
		((SIPCCMsg_Trans_TransmitRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Trans_TransmitRequestConf:
		((SIPCCMsg_Trans_TransmitRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Trans_TransmitStopRequest:
		((SIPCCMsg_Trans_TransmitStopRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Trans_TransmitRejected:
		((SIPCCMsg_Trans_TransmitRejected*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeFileMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_File_TransRequest:
		((SIPCCMsg_File_TransRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_TransRequestConf:
		((SIPCCMsg_File_TransRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_TransReady:
		((SIPCCMsg_File_TransReady*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_UnConnect:
		((SIPCCMsg_File_UnConnect*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_FileRequest:
		((SIPCCMsg_File_FileRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_FileRequestConf:
		((SIPCCMsg_File_FileRequestConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_FileReceived:
		((SIPCCMsg_File_FileReceived*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_FileStopped:
		((SIPCCMsg_File_FileStopped*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_File_FileReceiveInfo:
		((SIPCCMsg_File_FileReceiveInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeRecordMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_Record_Login:
		((SIPCCMsg_Record_Login*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Record_LoginConf:
		((SIPCCMsg_Record_LoginConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Record_StartRecord:
		((SIPCCMsg_Record_StartRecord*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Record_StopRecord:
		((SIPCCMsg_Record_StopRecord*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Record_StartRecordConf:
		((SIPCCMsg_Record_StartRecordConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Record_RecInfo2ACD:
		((SIPCCMsg_Record_RecInfo2ACD*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeSmartRouteMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_SmartRoute_QueryUserStatus:	//查询用户身份
		((SIPCCMsg_SmartRoute_QueryUserStatus*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_SmartRoute_QueryUserStatusConf:
		((SIPCCMsg_SmartRoute_QueryUserStatusConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;		
	case Type_SmartRoute_LoadSmartRouteTactic:
		((SIPCCMsg_SmartRoute_LoadSmartRouteTactic*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_SmartRoute_BlackListTactic:
		((SIPCCMsg_SmartRoute_BlackListTactic*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_SmartRoute_NewUserTactic:
		((SIPCCMsg_SmartRoute_NewUserTactic*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_SmartRoute_OldUserTactic:
		((SIPCCMsg_SmartRoute_OldUserTactic*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_SmartRoute_RouteTactic:		//返回路有策略
		((SIPCCMsg_SmartRoute_RouteTactic*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeGatewayMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{	
	case Type_Gateway_GetDeptOverflow:
		((SIPCCMsg_Gateway_GetDeptOverflow*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_Login:
		((SIPCCMsg_Gateway_Login*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_Logout:
		((SIPCCMsg_Gateway_Logout*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_LoginConf:
		((SIPCCMsg_Gateway_LoginConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_LoadInfo:
		((SIPCCMsg_Gateway_LoadInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_SetBaseInfo:
		((SIPCCMsg_Gateway_SetBaseInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_SetCorporationInfo:
		((SIPCCMsg_Gateway_SetCorporationInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_DelCorporationInfo:
		((SIPCCMsg_Gateway_DelCorporationInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AddPrefixNoInfo:
		((SIPCCMsg_Gateway_AddPrefixNoInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_QueryGWConf:
		((SIPCCMsg_Gateway_QueryGWConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallInQuery:			//呼入查询
		((SIPCCMsg_Gateway_CallInQuery*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallInQueryConf:
		((SIPCCMsg_Gateway_CallInQueryConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_SetTrunkState:
		((SIPCCMsg_Gateway_SetTrunkState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_QueryGWLanInfoConf:
		((SIPCCMsg_Gateway_QueryGWLanInfoConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_SyncTrunkState:
		((SIPCCMsg_Gateway_SyncTrunkState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_ReConnect:
		((SIPCCMsg_Gateway_ReConnect*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AgentTalkBegin:
		((SIPCCMsg_Gateway_AgentTalkBegin*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AgentTalkEnd:
		((SIPCCMsg_Gateway_AgentTalkEnd*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_SetRecord:
		((SIPCCMsg_Gateway_SetRecord*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_SetRecordConf:
		((SIPCCMsg_Gateway_SetRecordConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetTrunkState:
		((SIPCCMsg_Gateway_GetTrunkState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetTrunkStateConf:
		((SIPCCMsg_Gateway_GetTrunkStateConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_ForceHangup:
		((SIPCCMsg_Gateway_ForceHangup*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_DisableSth:
		((SIPCCMsg_Gateway_DisableSth*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_400CallBackCmd:
		((SIPCCMsg_Gateway_400CallBackCmd*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_RingAgentExtConf:
		((SIPCCMsg_Gateway_RingAgentExtConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_RingAgentExtFailed:
		((SIPCCMsg_Gateway_RingAgentExtFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AgentAnswerCall:
		((SIPCCMsg_Gateway_AgentAnswerCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AgentHangupCall:
		((SIPCCMsg_Gateway_AgentHangupCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_StopRingAgentExtConf:
		((SIPCCMsg_Gateway_StopRingAgentExtConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_QueryAgentInfo:
		((SIPCCMsg_Gateway_QueryAgentInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CancelRingAgentExt:
		((SIPCCMsg_Gateway_CancelRingAgentExt*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_IsAgentLogin:
		((SIPCCMsg_Gateway_IsAgentLogin*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallAgentExtFailed:
		((SIPCCMsg_Gateway_CallAgentExtFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AgentExtCallerFailed:
		((SIPCCMsg_Gateway_AgentExtCallerFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AgentExtCallSucc:
		((SIPCCMsg_Gateway_AgentExtCallSucc*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_UnAnsweredCall:
		((SIPCCMsg_Gateway_UnAnsweredCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_UserHangupCall:
		((SIPCCMsg_Gateway_UserHangupCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallAgentConf:
		((SIPCCMsg_Gateway_CallAgentConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallAgentFailed:
		((SIPCCMsg_Gateway_CallAgentFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallUserFailed_WpAgent:
		((SIPCCMsg_Gateway_CallUserFailed_WpAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallCleared:
		((SIPCCMsg_Gateway_CallCleared*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
		// + [1/27/2008 lixg]
	case Type_Gateway_Valid:
		((SIPCCMsg_Gateway_Valid*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetGetwayInfo:
		((SIPCCMsg_Gateway_GetGetwayInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetGetwayInfoConf:
		((SIPCCMsg_Gateway_GetGetwayInfoConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_AddRecordForTH:
		((SIPCCMsg_Gateway_AddRecordForTH*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_DelRecordForTH:
		((SIPCCMsg_Gateway_DelRecordForTH*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_DelAllRecordForTH:
		((SIPCCMsg_Gateway_DelAllRecordForTH*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetDeptWaitingAgentNum:
		((SIPCCMsg_Gateway_GetDeptWaitingAgentNum*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetAgentState:
		((SIPCCMsg_Gateway_GetAgentState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetDeptQueueNum:
		((SIPCCMsg_Gateway_GetDeptQueueNum*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetTrunkCountConf:
		((SIPCCMsg_Gateway_GetTrunkCountConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_LoadDataConf:
		((SIPCCMsg_Gateway_LoadDataConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_GetDeptLoginAgentNum:
		((SIPCCMsg_Gateway_GetDeptLoginAgentNum*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_TrunkStat:
		((SIPCCMsg_Gateway_TrunkStat*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_TrunkSeizeRate:
		((SIPCCMsg_Gateway_TrunkSeizeRate*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallInStat:
		((SIPCCMsg_Gateway_CallInStat*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallInOutStat:
		((SIPCCMsg_Gateway_CallInOutStat*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_CallOutStat:
		((SIPCCMsg_Gateway_CallOutStat*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Gateway_NotifyTrunkState:
		((SIPCCMsg_Gateway_NotifyTrunkState*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeTextMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{	
	case Type_Text_TextChat:
		((SIPCCMsg_Text_TextChat*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeGwMonitMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::DeSerializePhoneSearchMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::DeSerializeWapMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::DeSerializeRedirectMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_Redirect_LoadCorpInfo:
		((SIPCCMsg_Redirect_LoadCorpInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_LoadCorpInfoConf:
		((SIPCCMsg_Redirect_LoadCorpInfoConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_LoadPlatformInfo:
		((SIPCCMsg_Redirect_LoadPlatformInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_LoadPlatformInfoConf:
		((SIPCCMsg_Redirect_LoadPlatformInfoConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_SearchPlatform:
		((SIPCCMsg_Redirect_SearchPlatform*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_SearchPlatformConf:
		((SIPCCMsg_Redirect_SearchPlatformConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_GetPlatformList:
		((SIPCCMsg_Redirect_GetPlatformList*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_GetPlatformListConf:
		((SIPCCMsg_Redirect_GetPlatformListConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_CorpRegister:
		((SIPCCMsg_Redirect_CorpRegister*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_GetCorpInfo:
		((SIPCCMsg_Redirect_GetCorpInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_GetCorpInfoConf:
		((SIPCCMsg_Redirect_GetCorpInfoConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_AddCorpInfo:
		((SIPCCMsg_Redirect_AddCorpInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_DelCorpInfo:
		((SIPCCMsg_Redirect_DelCorpInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_AddPlatformInfo:
		((SIPCCMsg_Redirect_AddPlatformInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_Redirect_DelPlatformInfo:
		((SIPCCMsg_Redirect_DelPlatformInfo*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

//ClientCapture
void CIPCCMsgExchanger::DeSerializeClientCaptureMsg(char* pmsg,int msgsize,int &msgtype,SIPCCMessage &msg,unsigned long ip/* =0 */,unsigned short port/* =0 */)
{
	switch(msgtype)
	{
	case Type_ClientCapture_SessionEnd:
		((SIPCCMsg_ClientCapture_SessionEnd*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	case Type_ClientCapture_SRSend:
		((SIPCCMsg_ClientCapture_SRSend*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	case Type_ClientCapture_RRSend:
		((SIPCCMsg_ClientCapture_RRSend*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	case Type_ClientCapture_GetRtpStatistics:
		((SIPCCMsg_ClientCapture_GetRtpStatistics*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	default:
		msg.AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	}
}

void CIPCCMsgExchanger::SerializeClientCaptureMsg(SIPCCMessage& msg,char*& thebuf,int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;

	switch(msgType)
	{
	case Type_ClientCapture_SessionEnd:
		thebufcontent = ((SIPCCMsg_ClientCapture_SessionEnd*)&msg)->FillBuf(thebuf);
		break;
	case Type_ClientCapture_SRSend:
		thebufcontent = ((SIPCCMsg_ClientCapture_SRSend*)&msg)->FillBuf(thebuf);
		break;
	case Type_ClientCapture_RRSend:
		thebufcontent = ((SIPCCMsg_ClientCapture_RRSend*)&msg)->FillBuf(thebuf);
		break;
	case Type_ClientCapture_GetRtpStatistics:
		thebufcontent = ((SIPCCMsg_ClientCapture_GetRtpStatistics*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

//voice recognition
void CIPCCMsgExchanger::DeSerializeVoiceRecognitionMsg(char* pmsg,int msgsize,int &msgtype,SIPCCMessage &msg,unsigned long ip/* =0 */,unsigned short port/* =0 */)
{
	switch(msgtype)
	{
	case Type_VoiceRecognition_RequestRecognition:
		((SIPCCMsg_VoiceRecognition_RequestRec*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	case Type_VoiceRecognition_ResponseRecognition:
		((SIPCCMsg_VoiceRecognition_ResponseRec*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	case Type_voiceRecognition_AudioPacket:
		((SIPCCMsg_VoiceRecognition_AudioPacket*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	default:
		msg.AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	}
}

void CIPCCMsgExchanger::SerializeVoiceRecognitionMsg(SIPCCMessage& msg,char*& thebuf,int& thebufcontent)
{
	__EIPCCMsgType msgType=(__EIPCCMsgType)msg.msgType;
	switch(msgType)
	{
	case Type_VoiceRecognition_RequestRecognition:
		thebufcontent=((SIPCCMsg_VoiceRecognition_RequestRec*)&msg)->FillBuf(thebuf);
		break;
	case Type_VoiceRecognition_ResponseRecognition:
		thebufcontent=((SIPCCMsg_VoiceRecognition_ResponseRec*)&msg)->FillBuf(thebuf);
		break;
	case Type_voiceRecognition_AudioPacket:
		thebufcontent=((SIPCCMsg_VoiceRecognition_AudioPacket*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent=msg.FillBuf(thebuf);
		break;
	}
}

//TTS
void CIPCCMsgExchanger::DeSerializeTTSMsg(char* pmsg,int msgsize,int &msgtype,SIPCCMessage &msg,unsigned long ip/* =0 */,unsigned short port/* =0 */)
{
	switch(msgtype)
	{
	case Type_TTS_Request:
		((SIPCCMsg_TTS_Request*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	case Type_TTS_Result:
		((SIPCCMsg_TTS_Result*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	case Type_TTS_Cancel:
		((SIPCCMsg_TTS_Cancel*)&msg)->AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	default:
		msg.AnalyzeBuf(pmsg,msgsize,ip,port);
		break;
	}
}


void CIPCCMsgExchanger::SerializeTTSMsg(SIPCCMessage& msg,char*& thebuf,int& thebufcontent) {
	__EIPCCMsgType msgType=(__EIPCCMsgType)msg.msgType;
	switch(msgType)
	{
	case Type_TTS_Request:
		thebufcontent=((SIPCCMsg_TTS_Request*)&msg)->FillBuf(thebuf);
		break;
	case Type_TTS_Result:
		thebufcontent=((SIPCCMsg_TTS_Result*)&msg)->FillBuf(thebuf);
		break;
	case  Type_TTS_Cancel:
		thebufcontent=((SIPCCMsg_TTS_Cancel*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent=msg.FillBuf(thebuf);
		break;
	}
}


/////////////////////////////////////////////////////////////////////////////////
///SIPCCMessage
int SIPCCMessage::FillMsgHead(char*& thebuf)
{
	int iMsgHeadMemSize = 2*sizeof(int);
	
	int theBufContent = 0;
	//msgClass
	memmove(thebuf+theBufContent, &this->msgClass, sizeof(int));
	theBufContent += sizeof(int);
	//msgType
	memmove(thebuf+theBufContent, &this->msgType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMessage::AnalyzeMsgHead(char* thebuf)
{
	int theBufContent = 0;
	
	//msgCalss
	memmove(&msgClass, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//msgType
	memmove(&msgType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

/////////////////////////////////////////////////////////////////////////////////
///class_ACD
SIPCCMsg_ACD::SIPCCMsg_ACD()
{
	msgClass = Class_ACD;
}

///Type_ACD_AgentLoginFailed
SIPCCMsg_ACD_AgentLoginFailed::SIPCCMsg_ACD_AgentLoginFailed()
{
	msgType = Type_ACD_AgentLoginFailed;
	failedCause = "";
}

void SIPCCMsg_ACD_AgentLoginFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_AgentLoginFailed";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	if(theBufContent == msgsize)
		return;
	
	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	failedCause = thebuf + theBufContent;
	theBufContent += failedCause.length()+1;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_AgentLoginFailed::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length() + 1);
	theBufContent += agentId.length() + 1;
	
	memcpy(thebuf+theBufContent, failedCause.c_str(), failedCause.length() + 1);
	theBufContent += failedCause.length() + 1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentLoginFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentId.length()+1;
	memSize += failedCause.length()+1;

	memSize += handleId.length()+1;			//handleId

	return memSize;
}


///Type_ACD_AgentLoginSucc
SIPCCMsg_ACD_AgentLoginSucc::SIPCCMsg_ACD_AgentLoginSucc()
{
	msgType = Type_ACD_AgentLoginSucc;
	bAgentExist = false;
	iLoginSuccMode = 0;

	deptNickname = "";
}

void SIPCCMsg_ACD_AgentLoginSucc::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_AgentLoginSucc";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	if(theBufContent == msgsize)
		return;
	
	memcpy(&bAgentExist, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	if(theBufContent == msgsize)
		return;
	
	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;

	if(theBufContent == msgsize)
		return;

	memmove(&this->iLoginSuccMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

	if ( theBufContent >= msgsize )
		return;

	deptNickname = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptNickname.length()+1, msgsize, strMsg, "deptNickname.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(deptNickname.length(), NICKNAME_LEN, strMsg, "deptNickname", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += deptNickname.length()+1;
}

int SIPCCMsg_ACD_AgentLoginSucc::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &bAgentExist, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length() + 1);
	theBufContent += agentId.length() + 1;
	
	//iLoginSuccMode
	memmove(thebuf+theBufContent, &this->iLoginSuccMode, sizeof(int));
	theBufContent += sizeof(int);

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	//deptNickname
	memcpy(thebuf+theBufContent, deptNickname.c_str(), deptNickname.length()+1);
	theBufContent += deptNickname.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_AgentLoginSucc::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);			//bAgentExist
	memSize += agentId.length()+1;
	memSize += sizeof(int);				//iLoginSuccMode

	memSize += handleId.length()+1;			//handleId

	memSize += deptNickname.length()+1;		//deptNickname

	return memSize;
}

///Type_ACD_AgentLogoutConf
SIPCCMsg_ACD_AgentLogoutConf::SIPCCMsg_ACD_AgentLogoutConf()
{
	msgType = Type_ACD_AgentLogoutConf;
}

void SIPCCMsg_ACD_AgentLogoutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_AgentLogoutConf";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	if(theBufContent == msgsize)
		return;
	
	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_AgentLogoutConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length() + 1);
	theBufContent += agentId.length() + 1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentLogoutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentId.length()+1;

	memSize += handleId.length()+1;			//handleId

	return memSize;
}

// [scq/start/2010-04-23]
///Type_ACD_AgentLogoutDepartsConf
SIPCCMsg_ACD_AgentLogoutDepartsConf::SIPCCMsg_ACD_AgentLogoutDepartsConf()
{
	msgType = Type_ACD_AgentLogoutDepartsConf;
	agentId = "";
	theDepartmentFailed = "";
	theDepartmentSuccess = "";
	bLogoutSuccess = false;
}

void SIPCCMsg_ACD_AgentLogoutDepartsConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent == msgsize)
	{
		return;
	}

	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;

	if(theBufContent == msgsize)
	{
		return;
	}

	theDepartmentFailed = thebuf + theBufContent;
	theBufContent += theDepartmentFailed.length()+1;

	if(theBufContent == msgsize)
	{
		return;
	}

	theDepartmentSuccess = thebuf + theBufContent;
	theBufContent += theDepartmentSuccess.length()+1;

	if(theBufContent == msgsize)
	{
		return;
	}

	memmove(&this->bLogoutSuccess, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);
}

int SIPCCMsg_ACD_AgentLogoutDepartsConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length() + 1);
	theBufContent += agentId.length() + 1;

	memcpy(thebuf+theBufContent, theDepartmentFailed.c_str(), theDepartmentFailed.length() + 1);
	theBufContent += theDepartmentFailed.length() + 1;

	memcpy(thebuf+theBufContent, theDepartmentSuccess.c_str(), theDepartmentSuccess.length() + 1);
	theBufContent += theDepartmentSuccess.length() + 1;

	memmove(thebuf+theBufContent, &this->bLogoutSuccess, sizeof(bool));
	theBufContent += sizeof(bool);

	return theBufContent;
}

int SIPCCMsg_ACD_AgentLogoutDepartsConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentId.length()+1;
	memSize += theDepartmentFailed.length()+1;
	memSize += theDepartmentSuccess.length()+1;
	memSize += sizeof(bool);

	return memSize;
}
// [scq/end/2010-04-23]

///Type_ACD_AgentParkConf
SIPCCMsg_ACD_AgentParkConf::SIPCCMsg_ACD_AgentParkConf()
{
	msgType = Type_ACD_AgentParkConf;
}

void SIPCCMsg_ACD_AgentParkConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_ACD_AgentParkConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentParkConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_ACD_AgentUnParkConf
SIPCCMsg_ACD_AgentUnParkConf::SIPCCMsg_ACD_AgentUnParkConf()
{
	msgType = Type_ACD_AgentUnParkConf;
}

void SIPCCMsg_ACD_AgentUnParkConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_ACD_AgentUnParkConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentUnParkConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_ACD_AddDepartmentConf
SIPCCMsg_ACD_AddDepartmentConf::SIPCCMsg_ACD_AddDepartmentConf()
{
	msgType = Type_ACD_AddDepartmentConf;
	this->theDepartment = NULL;
	this->theDepartmentLen = 0;
}

void SIPCCMsg_ACD_AddDepartmentConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	if(theBufContent == msgsize)
		return;

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_ACD_AddDepartmentConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length() + 1);
	theBufContent += invokeID.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_AddDepartmentConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize +=  invokeID.length() + 1;
	return memSize;
}

void SIPCCMsg_ACD_AddDepartmentConf::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	
	if(iTheDepartmentLen > 0)
	{
		this->theDepartmentLen = iTheDepartmentLen + 1;
		theDepartment = new char[theDepartmentLen];
		memset(theDepartment, 0, theDepartmentLen);
		memmove(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
	}
}

///Type_ACD_DelDepartmentConf
SIPCCMsg_ACD_DelDepartmentConf::SIPCCMsg_ACD_DelDepartmentConf()
{
	msgType = Type_ACD_DelDepartmentConf;
	this->theDepartment = NULL;
	this->theDepartmentLen = 0;
}

void SIPCCMsg_ACD_DelDepartmentConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;
}

int SIPCCMsg_ACD_DelDepartmentConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	
	return theBufContent;
}

int SIPCCMsg_ACD_DelDepartmentConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	
	return memSize;
}

void SIPCCMsg_ACD_DelDepartmentConf::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	
	if(iTheDepartmentLen > 0)
	{
		this->theDepartmentLen = iTheDepartmentLen + 1;
		theDepartment = new char[theDepartmentLen];
		memset(theDepartment, 0, theDepartmentLen);
		memmove(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
	}
}

///Type_ACD_CallDelivered
SIPCCMsg_ACD_CallDelivered::SIPCCMsg_ACD_CallDelivered()
{
	msgType = Type_ACD_CallDelivered;
	callID = NULL;
	callIDLen = 0;
	callerName = NULL;
	callerNameLen = 0;
	callerType = CallParty_UnKnown;
	keyWord = NULL;
	keyWordLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	audioIP = 0;
	audioPort = 0;
	lanIP = 0;
	lanMainSockPort = 0;
	
	gwPartNo = "";
	
	userLineNo = "";
	userLineIP = 0;
	userLinePort = 0;

	sipBoardIP = 0;
	sipBoardRtpPort = 0;
	sipBoardRtcpPort = 0;
    sipTransIP = 0;   //中转IP
    sipTransRtpPort = 0;  //中转RtpPort
    sipTransRtcpPort = 0;  //中转rtcpPort

	sipAgentPhoneIP1 = 0;   	//主叫座席端话机IP
	sipAgentPhoneRtpPort1 = 0;  //主叫座席端话机RtpPort
	sipAgentPhoneRtcpPort1 = 0; //主叫座席端话机rtcpPort

	comSymbol = "";
	uuiData2 = "";

	bIsFromDept = 0;

	originalData = "";
	trans = "";
	codec = "";
	unit = 0;

	conferencePort1 = 0;
	conferencePort2 = 0;

	SkillGroupID = "";
	SkillGroupName = "";
}

void SIPCCMsg_ACD_CallDelivered::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//keyWordLen
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;
	//callerNameLen
	memmove(&this->callerNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callerName
	callerName = new char[callerNameLen];
	memset(callerName, 0, callerNameLen);
	memmove(callerName, thebuf+theBufContent, callerNameLen);
	theBufContent += callerNameLen;
	
	if(theBufContent >= msgsize)
		return;
	
	//callerType
	memmove(&this->callerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//uuiDataLen
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	//audioIP
	memmove(&this->audioIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(&this->audioPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//lanIP
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	memmove(&this->lanMainSockPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);	
	
	if(theBufContent == msgsize)
		return;
	
	//gwPartNo
	gwPartNo = thebuf+theBufContent;
	theBufContent += ( gwPartNo.length() + 1 );	
	
	if(theBufContent == msgsize)
		return;
	
	//wPstnAgentLineNo
	wPstnAgentLineNo = thebuf+theBufContent;
	theBufContent += ( wPstnAgentLineNo.length() + 1 );	
	//userLineNo
	userLineNo = thebuf+theBufContent;
	theBufContent += ( userLineNo.length() + 1 );	
	//userLineIP
	memmove(&this->userLineIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//userLinePort
	memmove(&this->userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	if(theBufContent == msgsize)
		return;
	//comSymbol
	comSymbol = thebuf+theBufContent;
	theBufContent += ( comSymbol.length() + 1 );	
	
	if(theBufContent == msgsize)
		return;
	
	uuiData2 = thebuf+theBufContent;
	theBufContent += ( uuiData2.length() + 1 );

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//bIsFromDept
	memmove(&this->bIsFromDept, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
		return;
	memmove(&sipBoardIP,thebuf+theBufContent,sizeof(sipBoardIP));
	theBufContent += sizeof(sipBoardIP);

	memmove(&sipBoardRtpPort,thebuf+theBufContent,sizeof(sipBoardRtpPort));
	theBufContent += sizeof(sipBoardRtpPort);

	memmove(&sipBoardRtcpPort,thebuf+theBufContent,sizeof(sipBoardRtcpPort));
	theBufContent += sizeof(sipBoardRtcpPort);

	//sipTransIP
	memmove(&sipTransIP,thebuf+theBufContent,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//sipTransRtpPort
	memmove(&sipTransRtpPort,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipTransRtcpPort
	memmove(&sipTransRtcpPort,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
		
	//sipAgentPhoneIP1
	memmove(&sipAgentPhoneIP1,thebuf+theBufContent,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//sipAgentPhoneRtpPort1
	memmove(&sipAgentPhoneRtpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//sipAgentPhoneRtcpPort1
	memmove(&sipAgentPhoneRtcpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// 开始 [2/23/2009 lixg]
	if ( theBufContent >= msgsize )
		return;
	// agentUUIDataLen
	int byAgentUUIDataLen = 0;
	memmove(&byAgentUUIDataLen,thebuf+theBufContent,sizeof(int));
	theBufContent += sizeof(int);

	// agentUUIData
	char acAgentUUIData[BUFSIZ] = {0};
	memmove(acAgentUUIData,thebuf+theBufContent,byAgentUUIDataLen);
	theBufContent += byAgentUUIDataLen;
	acAgentUUIData[BUFSIZ-1] = 0;
	agentUUIData = acAgentUUIData;
	// 结束 [2/23/2009 lixg]

	if(theBufContent == msgsize)
		return;

	//originalData
	originalData = thebuf+theBufContent;
	theBufContent += ( originalData.length() + 1 );	

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//20090806 haoy
	trans = thebuf + theBufContent;
	theBufContent += trans.length() + 1;
	codec = thebuf + theBufContent;
	theBufContent += codec.length() + 1;
	memmove(&unit,thebuf+theBufContent,sizeof(size_t));
	theBufContent += sizeof(size_t);

	if(theBufContent == msgsize)
		return;

	//conferencePort1
	memmove(&this->conferencePort1, thebuf+theBufContent, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	memmove(&this->conferencePort2, thebuf+theBufContent, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += ( SkillGroupID.length() + 1 );	

	//SkillGroupName
	SkillGroupName = thebuf+theBufContent;
	theBufContent += ( SkillGroupName.length() + 1 );	

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_ACD_CallDelivered::FillBuf(char*&  thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	//callerNameLen
	memmove(thebuf+theBufContent, &this->callerNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//callerName
	memmove(thebuf+theBufContent, this->callerName, this->callerNameLen);
	theBufContent += callerNameLen;
	
	//callerType
	memmove(thebuf+theBufContent, &this->callerType, sizeof(int));
	theBufContent += sizeof(int);
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	//audioIP
	memmove(thebuf+theBufContent, &this->audioIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(thebuf+theBufContent, &this->audioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	memmove(thebuf+theBufContent, &this->lanMainSockPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, gwPartNo.c_str(), gwPartNo.length() + 1 );
	theBufContent += ( gwPartNo.length() + 1 );
	
	//wPstnAgentLineNo
	memcpy(thebuf+theBufContent, wPstnAgentLineNo.c_str(), wPstnAgentLineNo.length() + 1 );
	theBufContent += ( wPstnAgentLineNo.length() + 1 );
	//userLineNo
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length() + 1 );
	theBufContent += ( userLineNo.length() + 1 );
	//userLineIP
	memmove(thebuf+theBufContent, &this->userLineIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//userLinePort
	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//comSymbol
	memcpy(thebuf+theBufContent, comSymbol.c_str(), comSymbol.length() + 1 );
	theBufContent += ( comSymbol.length() + 1 );
	
	//uuiData2
	memcpy(thebuf+theBufContent, uuiData2.c_str(), uuiData2.length() + 1 );
	theBufContent += ( uuiData2.length() + 1 );
	
	//bIsFromDept
	memmove(thebuf+theBufContent, &this->bIsFromDept, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent,&(this->sipBoardIP),sizeof(this->sipBoardIP));
	theBufContent += sizeof(this->sipBoardIP);

	memmove(thebuf+theBufContent,&(this->sipBoardRtpPort),sizeof(this->sipBoardRtpPort));
	theBufContent += sizeof(this->sipBoardRtpPort);

	memmove(thebuf+theBufContent,&(this->sipBoardRtcpPort),sizeof(this->sipBoardRtcpPort));
	theBufContent += sizeof(this->sipBoardRtcpPort);

	//sipTransIP
	memmove(thebuf+theBufContent,&sipTransIP,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//sipTransRtpPort
	memmove(thebuf+theBufContent,&sipTransRtpPort,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipTransRtcpPort
	memmove(thebuf+theBufContent,&sipTransRtcpPort,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipAgentPhoneIP1
	memmove(thebuf+theBufContent,&sipAgentPhoneIP1,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//sipAgentPhoneRtpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//sipAgentPhoneRtcpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtcpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// 开始 [2/23/2009 lixg]
	// agentUUIDataLen
	int agentUUIDataLen = agentUUIData.size();
	memmove(thebuf+theBufContent,&agentUUIDataLen,sizeof(int));
	theBufContent += sizeof(int);
	
	// agentUUIData
	memmove(thebuf+theBufContent,agentUUIData.c_str(),agentUUIData.size());
	theBufContent += agentUUIData.size();
	// 结束 [2/23/2009 lixg]

	//originalData
	memcpy(thebuf+theBufContent, originalData.c_str(), originalData.length() + 1 );
	theBufContent += ( originalData.length() + 1 );

	//Media Info
	memcpy(thebuf+theBufContent,trans.c_str(),trans.length()+1);
	theBufContent += (trans.length() + 1);

	memcpy(thebuf+theBufContent,codec.c_str(),codec.length()+1);
	theBufContent += (codec.length() + 1);

	memcpy(thebuf+theBufContent,&unit,sizeof(size_t));
	theBufContent += (sizeof(size_t));

	//conferencePort1
	memmove(thebuf+theBufContent, &conferencePort1, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	memmove(thebuf+theBufContent, &conferencePort2, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);

	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );

	//SkillGroupName
	memcpy(thebuf+theBufContent, SkillGroupName.c_str(), SkillGroupName.length() + 1 );
	theBufContent += ( SkillGroupName.length() + 1 );

    theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_ACD_CallDelivered::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//keyWordLen
	memSize += this->keyWordLen;		//keyWord
	memSize += sizeof(int);				//callerNameLen
	memSize += this->callerNameLen;		//callerName
	memSize += sizeof(int);				//callerType
	memSize += sizeof(int);				//uuiDataLen
	memSize += this->uuiDataLen;		//uuiData
	memSize += sizeof(unsigned long);	//audioIP
	memSize += sizeof(unsigned short);	//audioPort
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(unsigned short);	//lanMainSockPort
	memSize += gwPartNo.length() + 1;	//gwPartNo
	
	memSize += wPstnAgentLineNo.length() + 1;	//wPstnAgentLineNo
	memSize += userLineNo.length() + 1;			//userLineNo
	memSize += sizeof(unsigned long);			//userLineIP
	memSize += sizeof(unsigned short);			//userLinePort
	
	memSize += comSymbol.length() + 1;		//comSymbol
	memSize += uuiData2.length() + 1;		//uuiData2

	memSize += sizeof(char);				//bIsFromDept

	memSize += sizeof(unsigned long);			
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned short);
	
	memSize += sizeof(unsigned long);	//sipTransIP
	memSize += sizeof(unsigned short);	//sipTransRtpPort
	memSize += sizeof(unsigned short);	//sipTransRtcpPort

	memSize += sizeof(unsigned long);	//sipAgentPhoneIP1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtpPort1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtcpPort1

	//  [2/23/2009 lixg]
	memSize += sizeof(int);			//	agentUUIDataLen
	memSize += agentUUIData.size();		//	agentUUIData

	memSize += originalData.length() + 1;		//originalData
	
	//20090806 haoy
	memSize += trans.length() + 1;
	memSize += codec.length() + 1;
	memSize += sizeof(size_t);

	memSize += sizeof(conferencePort1);	//conferencePort1
	memSize += sizeof(conferencePort2);	//conferencePort2

	memSize += SkillGroupID.length() + 1;		//SkillGroupID
	memSize += SkillGroupName.length() + 1;		//SkillGroupName

    memSize += audioStreamDescription.GetMemSize();

	return memSize;
}

void SIPCCMsg_ACD_CallDelivered::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_ACD_CallDelivered::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

void SIPCCMsg_ACD_CallDelivered::SetCallerName(string callername)
{
	int iCallerNameLen = callername.length();
	this->callerNameLen = iCallerNameLen + 1;
	this->callerName = new char[callerNameLen];
	memset(callerName, 0, callerNameLen);
	memcpy(callerName, callername.c_str(), iCallerNameLen);
}

void SIPCCMsg_ACD_CallDelivered::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_ACD_CallDelivered::ReleaseMemory()
{
	if(callID!=NULL)	delete callID;
	callID = NULL;
	callIDLen = 0;
	if(callerName!=NULL)	delete callerName;
	callerName = NULL;
	callerNameLen = 0;
	callerType = CallParty_UnKnown;
	if(keyWord!=NULL)	delete keyWord;
	keyWord = NULL;
	keyWordLen = 0;
	if(uuiData!=NULL)	delete uuiData;
	uuiData = NULL;
	uuiDataLen = 0;
	audioIP = 0;
	audioPort = 0;
	comSymbol = "";
	uuiData2 = "";
	bIsFromDept = 0;

	sipBoardIP = 0;
	sipBoardRtpPort = 0;
	sipBoardRtcpPort = 0;
	
}

///Type_ACD_UserMakeCallConf
SIPCCMsg_ACD_UserMakeCallConf::SIPCCMsg_ACD_UserMakeCallConf()
{
	msgType = Type_ACD_UserMakeCallConf;
	callingState = 0;
	userName = NULL;
	userNameLen = 0;
	userNumInQueue = 0;
	agentID = NULL;
	agentIDLen = 0;
}

void SIPCCMsg_ACD_UserMakeCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_UserMakeCallConf";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callingState
	memmove(&this->callingState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	//userNumInQueue
	memmove(&this->userNumInQueue, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_UserMakeCallConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callingState
	memmove(thebuf+theBufContent, &this->callingState, sizeof(int));
	theBufContent += sizeof(int);
	//userNumInQueue
	memmove(thebuf+theBufContent, &this->userNumInQueue, sizeof(int));
	theBufContent += sizeof(int);
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_UserMakeCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callingState
	memSize += sizeof(int);				//userNumInQueue
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID

	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

void SIPCCMsg_ACD_UserMakeCallConf::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_ACD_UserMakeCallConf::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

///Type_ACD_CallEstablished
SIPCCMsg_ACD_CallEstablished::SIPCCMsg_ACD_CallEstablished()
{
	msgType = Type_ACD_CallEstablished;
	theOtherParty = NULL;
	theOtherPartyLen = 0;
	relayIP = 0;
	relayPort = 0;
	remoteNatType = NatType_Unknown;
	
	outDialType = OutDialType_Normal;

	nickName = "";
}

void SIPCCMsg_ACD_CallEstablished::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_CallEstablished";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theOtherPartyLen
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	//relayIP
	memmove(&this->relayIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//relayPort
	memmove(&this->relayPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//remoteNatType
	memmove(&this->remoteNatType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent == msgsize)
		return;
	
	memmove(&outDialType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	ipPhoneNo_User = thebuf+theBufContent;
	theBufContent += ( ipPhoneNo_User.length() + 1 );
	
	ipPhoneNo_AgentExt = thebuf+theBufContent;
	theBufContent += ( ipPhoneNo_AgentExt.length() + 1 );
	
	if(theBufContent == msgsize)
		return;
	
	userLineNo = thebuf+theBufContent;
	theBufContent += ( userLineNo.length() + 1 );
	
	memmove(&userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

	if(theBufContent >= msgsize)
		return;

	nickName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickName.length()+1, msgsize, strMsg, "nickName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(nickName.length(), NICKNAME_LEN, strMsg, "nickName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += nickName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_ACD_CallEstablished::FillBuf(char*&  thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherPartyLen
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	//relayIP
	memmove(thebuf+theBufContent, &this->relayIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//relayPort
	memmove(thebuf+theBufContent, &this->relayPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//remoteNatType
	memmove(thebuf+theBufContent, &this->remoteNatType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, ipPhoneNo_User.c_str(), ipPhoneNo_User.length() + 1 );
	theBufContent += ( ipPhoneNo_User.length() + 1 );
	
	memcpy(thebuf+theBufContent, ipPhoneNo_AgentExt.c_str(), ipPhoneNo_AgentExt.length() + 1 );
	theBufContent += ( ipPhoneNo_AgentExt.length() + 1 );
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length() + 1 );
	theBufContent += ( userLineNo.length() + 1 );
	
	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length()+1);
	theBufContent += nickName.length()+1;

    theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_ACD_CallEstablished::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	memSize += sizeof(unsigned long);	//relayIP
	memSize += sizeof(unsigned short);	//relayPort
	
	memSize += sizeof(int);				//remoteNatType
	
	memSize += sizeof(int);
	memSize += ipPhoneNo_User.length() + 1;
	memSize += ipPhoneNo_AgentExt.length() + 1;
	
	memSize += userLineNo.length() + 1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += handleId.length()+1;			//handleId

	memSize += nickName.length()+1;		//nickName

    memSize += audioStreamDescription.GetMemSize();

	return memSize;
}

void SIPCCMsg_ACD_CallEstablished::SetTheOtherParty(string theotherparty)
{
	int iTheOtherPartyLen = theotherparty.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, theotherparty.c_str(), iTheOtherPartyLen);
}

///Type_ACD_CallArriveToAgent
SIPCCMsg_ACD_CallArriveToAgent::SIPCCMsg_ACD_CallArriveToAgent()
{
	msgType = Type_ACD_CallArriveToAgent;
	
	agentID = NULL;
	agentIDLen = 0;
	
	lanIP = 0;
	lanMainSockPort = 0;
	
	sipAgentPhoneIP1 = 0;   	//主叫座席端话机IP
	sipAgentPhoneRtpPort1 = 0;  //主叫座席端话机RtpPort
	sipAgentPhoneRtcpPort1 = 0; //主叫座席端话机rtcpPort
}

void SIPCCMsg_ACD_CallArriveToAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	
	//lanIP
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	memmove(&this->lanMainSockPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);	
	
	if(theBufContent >= msgsize)
		return;
	
	agentExtNo = thebuf + theBufContent;
	theBufContent += agentExtNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	//sipAgentPhoneIP1
	memmove(&sipAgentPhoneIP1,thebuf+theBufContent,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//sipAgentPhoneRtpPort1
	memmove(&sipAgentPhoneRtpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//sipAgentPhoneRtcpPort1
	memmove(&sipAgentPhoneRtcpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_ACD_CallArriveToAgent::FillBuf(char*&  thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	memmove(thebuf+theBufContent, &this->lanMainSockPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, agentExtNo.c_str(), agentExtNo.length()+1);
	theBufContent += agentExtNo.length()+1;

	//sipAgentPhoneIP1
	memmove(thebuf+theBufContent,&sipAgentPhoneIP1,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//sipAgentPhoneRtpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//sipAgentPhoneRtcpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtcpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
    theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_ACD_CallArriveToAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(unsigned short);	//lanMainSockPort
	
	memSize += agentExtNo.length()+1;

	memSize += sizeof(unsigned long);	//sipAgentPhoneIP1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtpPort1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtcpPort1
		
    memSize += audioStreamDescription.GetMemSize();

	return memSize;
}

void SIPCCMsg_ACD_CallArriveToAgent::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

///Type_ACD_CallAnswered
SIPCCMsg_ACD_CallAnswered::SIPCCMsg_ACD_CallAnswered()
{
	msgType = Type_ACD_CallAnswered;
	relayIP = 0;
	relayPort = 0;
	userName = NULL;
	userNameLen = 0;
	
	remoteNatType = NatType_Unknown;
	callId = "";
}

void SIPCCMsg_ACD_CallAnswered::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_CallAnswered";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//relayIP
	memmove(&this->relayIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//relayPort
	memmove(&this->relayPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//remoteNatType
	memmove(&this->remoteNatType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	callId = thebuf + theBufContent;
	theBufContent += callId.length() + 1;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_CallAnswered::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//relayIP
	memmove(thebuf+theBufContent, &this->relayIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//relayPort
	memmove(thebuf+theBufContent, &this->relayPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//remoteNatType
	memmove(thebuf+theBufContent, &this->remoteNatType, sizeof(int));
	theBufContent += sizeof(int);
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	memmove( thebuf + theBufContent, callId.c_str(), callId.length() + 1 );
	theBufContent += callId.length() + 1;
	
	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_CallAnswered::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned long);	//relayIP
	memSize += sizeof(unsigned short);	//relayPort
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	
	memSize += sizeof(int);				//remoteNatType
	memSize += callId.length() + 1;

	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

void SIPCCMsg_ACD_CallAnswered::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_ACD_CallReleased
SIPCCMsg_ACD_CallReleased::SIPCCMsg_ACD_CallReleased()
{
	msgType = Type_ACD_CallReleased;
	releasedParty = NULL;
	releasedPartyLen = 0;
	bIsPresideAgent=0;

	callID = "";
	agentName = "";
}

void SIPCCMsg_ACD_CallReleased::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//releasedPartyLen
	memmove(&this->releasedPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//releasedParty
	releasedParty = new char[releasedPartyLen];
	memset(releasedParty, 0, releasedPartyLen);
	memmove(releasedParty, thebuf+theBufContent, releasedPartyLen);
	theBufContent += releasedPartyLen;

	memmove(&this->bIsPresideAgent, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent == msgsize)
		return;

	//callID
	callID = thebuf + theBufContent;
	theBufContent += callID.length()+1;

	//agentName
	agentName = thebuf + theBufContent;
	theBufContent += agentName.length()+1;
}

int SIPCCMsg_ACD_CallReleased::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//releasedPartyLen
	memmove(thebuf+theBufContent, &this->releasedPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//releasedParty
	memmove(thebuf+theBufContent, this->releasedParty, this->releasedPartyLen);
	theBufContent += releasedPartyLen;


	memmove(thebuf+theBufContent, &this->bIsPresideAgent, sizeof(char));
	theBufContent += sizeof(char);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//agentName
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_CallReleased::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);				//releasedPartyLen
	memSize += this->releasedPartyLen;	//releasedParty
	memSize += sizeof(char);
	memSize += callID.length()+1;		//callID
	memSize += agentName.length()+1;	//agentName
	
	return memSize;
}

void SIPCCMsg_ACD_CallReleased::SetReleasedParty(string releasedparty)
{
	int iReleasedParty = releasedparty.length();
	this->releasedPartyLen = iReleasedParty + 1;
	this->releasedParty = new char[releasedPartyLen];
	memset(releasedParty, 0, releasedPartyLen);
	memcpy(releasedParty, releasedparty.c_str(), iReleasedParty);
}

///Type_ACD_CallHanguped
SIPCCMsg_ACD_CallHanguped::SIPCCMsg_ACD_CallHanguped()
{
	msgType = Type_ACD_CallHanguped;
	userName = NULL;
	userNameLen = 0;
	releasedParty = NULL;
	releasedPartyLen = 0;
}

void SIPCCMsg_ACD_CallHanguped::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_CallHanguped";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	if(msgsize == theBufContent)
		return;
	
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	if(msgsize == theBufContent)
		return;	
	
	//releasedPartyLen
	memmove(&this->releasedPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//releasedParty
	releasedParty = new char[releasedPartyLen];
	memset(releasedParty, 0, releasedPartyLen);
	memmove(releasedParty, thebuf+theBufContent, releasedPartyLen);
	theBufContent += releasedPartyLen;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_CallHanguped::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//releasedPartyLen
	memmove(thebuf+theBufContent, &this->releasedPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//releasedParty
	memmove(thebuf+theBufContent, this->releasedParty, this->releasedPartyLen);
	theBufContent += releasedPartyLen;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_ACD_CallHanguped::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_ACD_CallHanguped::SetReleasedParty(string releasedparty)
{
	int iReleasedParty = releasedparty.length();
	this->releasedPartyLen = iReleasedParty + 1;
	this->releasedParty = new char[releasedPartyLen];
	memset(releasedParty, 0, releasedPartyLen);
	memcpy(releasedParty, releasedparty.c_str(), iReleasedParty);
}

int SIPCCMsg_ACD_CallHanguped::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//releasedPartyLen
	memSize += this->releasedPartyLen;	//releasedParty

	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

///Type_ACD_AgentStateInfo
SIPCCMsg_ACD_AgentStateInfo::SIPCCMsg_ACD_AgentStateInfo()
{
	msgType = Type_ACD_AgentStateInfo;
	
	this->agentID = NULL;
	this->agentIDLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	this->theDepartment = NULL;
	this->theDepartmentLen = 0;
	this->callID = NULL;
	this->callIDLen = 0;
	this->curTime = NULL;
	this->curTimeLen = 0;
	this->keyWord = NULL;
	this->keyWordLen = 0;
	this->userName = NULL;
	this->userNameLen = 0;
	
	this->bCallIn = true;
	this->bInnerCall = false;
	this->bPSTNCall = true;
	parkReasonID = -1;		//报表用
	parkReason = NULL;		//监控用
	parkReasonLen=0;
	callerID = "";
	calleeID = "";

	managerid = "";
	deptid = "";

	this->bAgentLogin = false;

	extNo = "";

	SkillGroupID = "";
	SkillGroupName = "";

	SkillGroupID_Original = "";
	SkillGroupName_Original = "";

	UserLevel = 3;
	sData="";
}

void SIPCCMsg_ACD_AgentStateInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_AgentStateInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, USERNAME_LEN, strMsg, "agentIDLen", ip, port)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, strMsg, "corporationNameLen", ip, port)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, strMsg, "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	//agentState
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentState", ip, port)) ) {return;}
	memmove(&this->agentState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//if ( !(VerifyData(agentState, AGENTSTATE_LEN, strMsg, "agentState", ip, port)) ) {return;}

	//curTimeLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "curTimeLen", ip, port)) ) {return;}
	memmove(&this->curTimeLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(curTimeLen, CURTIME_LEN, strMsg, "curTimeLen", ip, port)) ) {return;}

	//curTime
	if ( !(VerifyTotalLen(theBufContent+curTimeLen, msgsize, strMsg, "curTime", ip, port)) ) {return;}
	curTime = new char[curTimeLen];
	memset(curTime, 0, curTimeLen);
	memmove(curTime, thebuf+theBufContent, curTimeLen);
	theBufContent += curTimeLen;	

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callIDLen", ip, port)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, strMsg, "callIDLen", ip, port)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, strMsg, "callID", ip, port)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//keyWordLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "keyWordLen", ip, port)) ) {return;}
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(keyWordLen, KEYWORD_LEN, strMsg, "keyWordLen", ip, port)) ) {return;}

	//keyWord
	if ( !(VerifyTotalLen(theBufContent+keyWordLen, msgsize, strMsg, "keyWord", ip, port)) ) {return;}
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	//bCallIn
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bCallIn", ip, port)) ) {return;}
	memmove(&this->bCallIn, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	//bInnerCall
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bInnerCall", ip, port)) ) {return;}
	memmove(&this->bInnerCall, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	//bPSTNCall
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bPSTNCall", ip, port)) ) {return;}
	memmove(&this->bPSTNCall, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;
	//parkReasonID
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "parkReasonID", ip, port)) ) {return;}
	memmove(&parkReasonID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//parkReasonLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "parkReasonLen", ip, port)) ) {return;}
	memmove(&parkReasonLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(parkReasonLen, PARKREASON_LEN, strMsg, "parkReasonLen", ip, port)) ) {return;}

	//parkReason
	if ( !(VerifyTotalLen(theBufContent+parkReasonLen, msgsize, strMsg, "parkReason", ip, port)) ) {return;}
	parkReason = new char[parkReasonLen];
	memset(parkReason, 0, parkReasonLen);
	memmove(parkReason, thebuf + theBufContent, parkReasonLen);
	theBufContent += parkReasonLen;

	if(theBufContent >= msgsize)
		return;
	callerID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerID.length()+1, msgsize, strMsg, "callerID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerID.length(), CALLEDNO_LEN, strMsg, "callerID", ip, port)) ) {return;}
	theBufContent += callerID.length() + 1;

	calleeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calleeID.length()+1, msgsize, strMsg, "calleeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(calleeID.length(), CALLEDNO_LEN, strMsg, "calleeID", ip, port)) ) {return;}
	theBufContent += calleeID.length() + 1;

	if(theBufContent >= msgsize)
		return;

	//bAgentLogin
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bAgentLogin", ip, port)) ) {return;}
	memmove(&this->bAgentLogin, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;

	managerid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerid.length()+1, msgsize, strMsg, "managerid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(managerid.length(), MANAGERID_LEN, strMsg, "managerid", ip, port)) ) {return;}
	theBufContent += managerid.length() + 1;

	deptid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptid.length()+1, msgsize, strMsg, "deptid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(deptid.length(), DEPTID_LEN, strMsg, "deptid", ip, port)) ) {return;}
	theBufContent += deptid.length() + 1;

	if(theBufContent >= msgsize)
		return;

	//bCallOutTypeUnderHold
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bCallOutTypeUnderHold", ip, port)) ) {return;}
	memmove(&this->bCallOutTypeUnderHold, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;

	nickName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickName.length()+1, msgsize, strMsg, "nickName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(nickName.length(), MANAGERID_LEN, strMsg, "nickName", ip, port)) ) {return;}
	theBufContent += nickName.length() + 1;

	if(theBufContent >= msgsize)
		return;

	extNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extNo.length()+1, msgsize, strMsg, "extNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(extNo.length(), MANAGERID_LEN, strMsg, "extNo", ip, port)) ) {return;}
	theBufContent += extNo.length() + 1;

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += SkillGroupID.length()+1;

	//SkillGroupName
	SkillGroupName = thebuf+theBufContent;
	theBufContent += SkillGroupName.length()+1;

	if(theBufContent == msgsize)
		return;

	//SkillGroupID_Original
	SkillGroupID_Original = thebuf+theBufContent;
	theBufContent += SkillGroupID_Original.length()+1;

	//SkillGroupName_Original
	SkillGroupName_Original = thebuf+theBufContent;
	theBufContent += SkillGroupName_Original.length()+1;

	if(theBufContent == msgsize)
		return;

	//UserLevel
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "UserLevel", ip, port)) ) {return;}
	memmove(&UserLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);



	if ( theBufContent >= msgsize )
	{
		return;
	}


	//sData
	sData = thebuf+theBufContent;
	theBufContent += sData.length()+1;
}

int SIPCCMsg_ACD_AgentStateInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	//agentState
	memmove(thebuf+theBufContent, &this->agentState, sizeof(int));
	theBufContent += sizeof(int);
	//curTimeLen
	memmove(thebuf+theBufContent, &this->curTimeLen, sizeof(int));
	theBufContent += sizeof(int);
	//curTime
	memmove(thebuf+theBufContent, this->curTime, this->curTimeLen);
	theBufContent += curTimeLen;
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	//bCallIn
	memmove(thebuf+theBufContent, &this->bCallIn, sizeof(char));
	theBufContent += sizeof(char);
	//bInnerCall
	memmove(thebuf+theBufContent, &this->bInnerCall, sizeof(char));
	theBufContent += sizeof(char);
	//bPSTNCall
	memmove(thebuf+theBufContent, &this->bPSTNCall, sizeof(char));
	theBufContent += sizeof(char);
	
	//parkReasonID
	memmove(thebuf+theBufContent, &parkReasonID, sizeof(int));
	theBufContent += sizeof(int);
	//parkReasonLen
	memmove(thebuf+theBufContent, &parkReasonLen, sizeof(int));
	theBufContent += sizeof(int);
	//parkReason
	memmove(thebuf+theBufContent, parkReason, parkReasonLen);
	theBufContent += parkReasonLen;

	//callerID
	memmove(thebuf+theBufContent, callerID.c_str(), callerID.length()+1);
	theBufContent += callerID.length()+1;

	//calleeID
	memmove(thebuf+theBufContent, calleeID.c_str(), calleeID.length()+1);
	theBufContent += calleeID.length()+1;

	//bAgentLogin
	memmove(thebuf+theBufContent, &this->bAgentLogin, sizeof(char));
	theBufContent += sizeof(char);

	//managerid
	memmove(thebuf+theBufContent, managerid.c_str(), managerid.length()+1);
	theBufContent += managerid.length()+1;

	//deptid
	memmove(thebuf+theBufContent, deptid.c_str(), deptid.length()+1);
	theBufContent += deptid.length()+1;

	//bPSTNCall
	memmove(thebuf+theBufContent, &this->bCallOutTypeUnderHold, sizeof(char));
	theBufContent += sizeof(char);

	//nickName
	memmove(thebuf+theBufContent, nickName.c_str(), nickName.length()+1);
	theBufContent += nickName.length()+1;

	//extNo
	memmove(thebuf+theBufContent, extNo.c_str(), extNo.length()+1);
	theBufContent += extNo.length()+1;

	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );

	//SkillGroupName
	memcpy(thebuf+theBufContent, SkillGroupName.c_str(), SkillGroupName.length() + 1 );
	theBufContent += ( SkillGroupName.length() + 1 );

	//SkillGroupID_Original
	memcpy(thebuf+theBufContent, SkillGroupID_Original.c_str(), SkillGroupID_Original.length() + 1 );
	theBufContent += ( SkillGroupID_Original.length() + 1 );

	//SkillGroupName_Original
	memcpy(thebuf+theBufContent, SkillGroupName_Original.c_str(), SkillGroupName_Original.length() + 1 );
	theBufContent += ( SkillGroupName_Original.length() + 1 );

	//UserLevel
	memmove(thebuf+theBufContent, &UserLevel, sizeof(int));
	theBufContent += sizeof(int);


	//sData
	memcpy(thebuf+theBufContent, sData.c_str(), sData.length() + 1 );
	theBufContent += ( sData.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_ACD_AgentStateInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//agentState
	memSize += sizeof(int);				//curTimeLen
	memSize += this->curTimeLen;		//curTime
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//keywordLen
	memSize += this->keyWordLen;		//keyword
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(char);				//bCallIn
	memSize += sizeof(char);				//bInnerCall
	memSize += sizeof(char);				//bPSTNCall
	memSize += sizeof(int);				//parkReasonID
	memSize += sizeof(int);				//parkReasonLen
	memSize += parkReasonLen;			//parkReason
	memSize += this->callerID.length() + 1;
	memSize += this->calleeID.length() + 1;
	memSize += sizeof(char);				//bAgentLogin
	memSize += this->managerid.length() + 1;
	memSize += this->deptid.length() + 1;
	memSize += sizeof(char);
	memSize += this->nickName.length() + 1;
	memSize += this->extNo.length() + 1;

	memSize += SkillGroupID.length()+1;			//SkillGroupID
	memSize += SkillGroupName.length()+1;		//SkillGroupName
	memSize += SkillGroupID_Original.length()+1;		//SkillGroupID_Original
	memSize += SkillGroupName_Original.length()+1;		//SkillGroupName_Original
	memSize += sizeof(int);						//UserLevel

	memSize += (this->sData.length() + 1);	    //sData

	return memSize;

}

void SIPCCMsg_ACD_AgentStateInfo::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_ACD_AgentStateInfo::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

void SIPCCMsg_ACD_AgentStateInfo::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	if(iTheDepartmentLen == 0)
		return;
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

void SIPCCMsg_ACD_AgentStateInfo::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_ACD_AgentStateInfo::SetCurTime(string curtime)
{
	int iCurTimeLen = curtime.length();
	this->curTimeLen = iCurTimeLen + 1;
	this->curTime = new char[curTimeLen];
	memset(curTime, 0, curTimeLen);
	memcpy(curTime, curtime.c_str(), iCurTimeLen);
}

void SIPCCMsg_ACD_AgentStateInfo::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

void SIPCCMsg_ACD_AgentStateInfo::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_ACD_MediaRequest
SIPCCMsg_ACD_MediaRequest::SIPCCMsg_ACD_MediaRequest()
{
	msgType = Type_ACD_MediaRequest;
	callID = NULL;
	callIDLen = 0;
	mediaType = -1;
	seq = 0;
}

void SIPCCMsg_ACD_MediaRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_MediaRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(thebuf+theBufContent, &this->mediaType, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_MediaRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//mediaType
	memSize += sizeof(int);				//seq
	
	return memSize;
}

void SIPCCMsg_ACD_MediaRequest::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

///Type_ACD_MediaRequestConf
SIPCCMsg_ACD_MediaRequestConf::SIPCCMsg_ACD_MediaRequestConf()
{
	msgType = Type_ACD_MediaRequestConf;
	callID = NULL;
	callIDLen = 0;
	mediaType = -1;
}

void SIPCCMsg_ACD_MediaRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_MediaRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(thebuf+theBufContent, &this->mediaType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_MediaRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//mediaType
	
	return memSize;
}

void SIPCCMsg_ACD_MediaRequestConf::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

///Type_ACD_LoadDepartments
SIPCCMsg_ACD_LoadDepartments::SIPCCMsg_ACD_LoadDepartments()
{
	msgType = Type_ACD_LoadDepartments;

	serverIP = "";
	acdserverID = -1;
}

void SIPCCMsg_ACD_LoadDepartments::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent == msgsize)
		return;

	//serverIP
	serverIP = thebuf+theBufContent;
	theBufContent += serverIP.length()+1;

	if(theBufContent == msgsize)
		return;

	memmove(&this->acdserverID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_LoadDepartments::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//serverIP
	memmove(thebuf+theBufContent, serverIP.c_str(), serverIP.length()+1);
	theBufContent += serverIP.length()+1;

	memmove(thebuf+theBufContent, &this->acdserverID, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_ACD_LoadDepartments::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += serverIP.length()+1;		//serverIP
	memSize += sizeof(int);				//acdserverID
	return memSize;
}

///Type_ACD_CallingQueueInfo
SIPCCMsg_ACD_CallingQueueInfo::SIPCCMsg_ACD_CallingQueueInfo()
{
	msgType = Type_ACD_CallingQueueInfo;
	userNumInQueue = 0;
	agentNumInTheDepartment = 0;
	invokeID = "";

	userNumInQueues = "";
	agentNumInSkillGroups = "";
}

void SIPCCMsg_ACD_CallingQueueInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNumInQueue
	memmove(&this->userNumInQueue, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//agentNumInTheDepartment
	memmove(&this->agentNumInTheDepartment, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;

	if(theBufContent == msgsize)
		return;

	//userNumInQueues
	userNumInQueues = thebuf+theBufContent;
	theBufContent += userNumInQueues.length()+1;

	//agentNumInSkillGroups
	agentNumInSkillGroups = thebuf+theBufContent;
	theBufContent += agentNumInSkillGroups.length()+1;
}

int SIPCCMsg_ACD_CallingQueueInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNumInQueue
	memmove(thebuf+theBufContent, &this->userNumInQueue, sizeof(int));
	theBufContent += sizeof(int);
	
	//agentNumInTheDepartment
	memmove(thebuf+theBufContent, &this->agentNumInTheDepartment, sizeof(int));
	theBufContent += sizeof(int);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	//userNumInQueues
	memmove(thebuf+theBufContent, userNumInQueues.c_str(), userNumInQueues.length()+1);
	theBufContent += userNumInQueues.length()+1;

	//agentNumInSkillGroups
	memmove(thebuf+theBufContent, agentNumInSkillGroups.c_str(), agentNumInSkillGroups.length()+1);
	theBufContent += agentNumInSkillGroups.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_CallingQueueInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNumInQueue
	memSize += sizeof(int);				//agentNumInTheDepartment
	memSize += invokeID.length()+1;		//invokeID

	memSize += userNumInQueues.length()+1;				//userNumInQueues
	memSize += agentNumInSkillGroups.length()+1;		//agentNumInSkillGroups

	return memSize;
}

///Type_ACD_AgentQueryStateConf
SIPCCMsg_ACD_AgentQueryStateConf::SIPCCMsg_ACD_AgentQueryStateConf()
{
	msgType = Type_ACD_AgentQueryStateConf;
	agentState = Agent_NoLogin;
	bQuerySucess = 0;
	
	additionalInfo = NULL;
	additionalInfoLen = 0;

	 callTransID = "";
	 handleId="";		//操作唯一标识
}

void SIPCCMsg_ACD_AgentQueryStateConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentState
	memmove(&this->agentState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//bQuerySucess
	memmove(&this->bQuerySucess, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//additionalInfoLen
	memmove(&this->additionalInfoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//additionalInfo
	additionalInfo = new char[additionalInfoLen];
	memset(additionalInfo, 0, additionalInfoLen);
	memmove(additionalInfo, thebuf+theBufContent, additionalInfoLen);
	theBufContent += additionalInfoLen;

	if (theBufContent >= msgsize)
	{
		return;
	}

	callTransID = thebuf + theBufContent;
	theBufContent += callTransID.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}
	//handleId
	handleId = thebuf + theBufContent;	
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_AgentQueryStateConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentState
	memmove(thebuf+theBufContent, &this->agentState, sizeof(int));
	theBufContent += sizeof(int);
	//bQuerySucess
	memmove(thebuf+theBufContent, &this->bQuerySucess, sizeof(char));
	theBufContent += sizeof(char);
	//additionalInfoLen
	memmove(thebuf+theBufContent, &this->additionalInfoLen, sizeof(int));
	theBufContent += sizeof(int);
	//additionalInfo
	memmove(thebuf+theBufContent, this->additionalInfo, this->additionalInfoLen);
	theBufContent += additionalInfoLen;
	//callTransID
	memcpy(thebuf+theBufContent, callTransID.c_str(), callTransID.length()+1);
	theBufContent += callTransID.length()+1;


	// handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentQueryStateConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentState
	memSize += sizeof(char);			//bQuerySucess
	memSize += sizeof(int);				//additionalInfoLen
	memSize += this->additionalInfoLen;	//additionalInfo
	memSize += callTransID.length() + 1;	//callTransID
	
		memSize += handleId.length()+1;	//handleId
	return memSize;
}

void SIPCCMsg_ACD_AgentQueryStateConf::SetAdditionalInfo(string additionalinfo)
{
	int iAdditionalInfoLen = additionalinfo.length();
	this->additionalInfoLen = iAdditionalInfoLen + 1;
	this->additionalInfo = new char[additionalInfoLen];
	memset(additionalInfo, 0, additionalInfoLen);
	memcpy(additionalInfo, additionalinfo.c_str(), iAdditionalInfoLen);
}

///Type_ACD_AgentMakeCallConf
SIPCCMsg_ACD_AgentMakeCallConf::SIPCCMsg_ACD_AgentMakeCallConf()
{
	msgType = Type_ACD_AgentMakeCallConf;
	callingState = AgentCalling_AgentNoLogin;
	
	userNumInQueue = 0;
	audioIP = 0;
	audioPort = 0;
	calledParty = NULL;
	calledPartyLen = 0;
	lanIP = 0;
	lanMainSockPort = 0;
}

void SIPCCMsg_ACD_AgentMakeCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callingState
	memmove(&this->callingState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userNumInQueue
	memmove(&this->userNumInQueue, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//audioIP
	memmove(&this->audioIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(&this->audioPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//calledPartyLen
	memmove(&this->calledPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//calledParty
	calledParty = new char[calledPartyLen];
	memset(calledParty, 0, calledPartyLen);
	memmove(calledParty, thebuf+theBufContent, calledPartyLen);
	theBufContent += calledPartyLen;
	
	//lanIP
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	memmove(&this->lanMainSockPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	if(theBufContent >= msgsize)
		return;
	
	agentExtNo = thebuf + theBufContent;
	theBufContent += agentExtNo.length()+1;
}

int SIPCCMsg_ACD_AgentMakeCallConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callingState
	memmove(thebuf+theBufContent, &this->callingState, sizeof(int));
	theBufContent += sizeof(int);
	//userNumInQueue
	memmove(thebuf+theBufContent, &this->userNumInQueue, sizeof(int));
	theBufContent += sizeof(int);	
	//audioIP
	memmove(thebuf+theBufContent, &this->audioIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(thebuf+theBufContent, &this->audioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//calledPartyLen
	memmove(thebuf+theBufContent, &this->calledPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//calledParty
	memmove(thebuf+theBufContent, this->calledParty, this->calledPartyLen);
	theBufContent += calledPartyLen;
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	memmove(thebuf+theBufContent, &this->lanMainSockPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, agentExtNo.c_str(), agentExtNo.length()+1);
	theBufContent += agentExtNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentMakeCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callingState
	memSize += sizeof(int);				//userNumInQueue
	memSize += sizeof(unsigned long);	//audioIP
	memSize += sizeof(unsigned short);	//audioPort
	memSize += sizeof(int);				//calledPartyLen
	memSize += this->calledPartyLen;	//calledPartyID
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(unsigned short);	//lanMainSockPort	
	
	memSize += agentExtNo.length()+1;
	
	return memSize;
}

void SIPCCMsg_ACD_AgentMakeCallConf::SetCalledParty(string calledparty)
{
	int iCalledPartyLen = calledparty.length();
	this->calledPartyLen = iCalledPartyLen + 1;
	this->calledParty = new char[calledPartyLen];
	memset(calledParty, 0, calledPartyLen);
	memcpy(calledParty, calledparty.c_str(), iCalledPartyLen);
}

//Type_ACD_CallUserConf
SIPCCMsg_ACD_CallUserConf::SIPCCMsg_ACD_CallUserConf()
{
	msgType = Type_ACD_CallUserConf;
	userName = NULL;
	userNameLen = 0;
	bCallFailed = 1;
	audioIP = 0;
	audioPort = 0;
	lanIP = 0;
	failedCause = -1;
	invokeID = "";
	sipBoardIP = 0;   //交换机ip板IP
	sipBoardRtpPort = 0;  //交换机ip板RtpPort
	sipBoardRtcpPort = 0;  //交换机ip板rtcpPort
	sipTransIP = 0;   //中转IP
	sipTransRtpPort = 0;  //中转RtpPort
	sipTransRtcpPort = 0;  //中转rtcpPort

	trans = "";
	codec = "";
	unit = 0;

	conferencePort1 = 0;
	conferencePort2 = 0;
}

void SIPCCMsg_ACD_CallUserConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	//bCallFailed
	memmove(&this->bCallFailed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//audioIP
	memmove(&this->audioIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(&this->audioPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//failedCause
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	if(theBufContent == msgsize)
		return;
	
	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;

	if(theBufContent == msgsize)
		return;

	memmove(&this->sipBoardIP, thebuf+theBufContent, sizeof(sipBoardIP));
	theBufContent += sizeof(sipBoardIP);

	memmove(&this->sipBoardRtpPort, thebuf+theBufContent, sizeof(sipBoardRtpPort));
	theBufContent += sizeof(sipBoardRtpPort);

	memmove(&this->sipBoardRtcpPort, thebuf+theBufContent, sizeof(sipBoardRtcpPort));
	theBufContent += sizeof(sipBoardRtcpPort);

	memmove(&this->sipTransIP, thebuf+theBufContent, sizeof(sipTransIP));
	theBufContent += sizeof(sipTransIP);

	memmove(&this->sipTransRtpPort, thebuf+theBufContent, sizeof(sipTransRtpPort));
	theBufContent += sizeof(sipTransRtpPort);

	memmove(&this->sipTransRtcpPort, thebuf+theBufContent, sizeof(sipTransRtcpPort));
	theBufContent += sizeof(sipTransRtcpPort);

	//20090806 haoy
	if ( theBufContent >= msgsize )
	{
		return;
	}
	trans = thebuf + theBufContent;
	theBufContent += trans.length() + 1;
	codec = thebuf + theBufContent;
	theBufContent += codec.length() + 1;
	memmove(&unit,thebuf+theBufContent,sizeof(size_t));
	theBufContent += sizeof(size_t);

	if(theBufContent == msgsize)
		return;

	//conferencePort1
	memmove(&this->conferencePort1, thebuf+theBufContent, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	memmove(&this->conferencePort2, thebuf+theBufContent, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);
}

int SIPCCMsg_ACD_CallUserConf::FillBuf(char*& thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//bCallFailed
	memmove(thebuf+theBufContent, &this->bCallFailed, sizeof(char));
	theBufContent += sizeof(char);
	//audioIP
	memmove(thebuf+theBufContent, &this->audioIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(thebuf+theBufContent, &this->audioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	//sipBoardIP
	memmove(thebuf+theBufContent, &sipBoardIP, sizeof(sipBoardIP));
	theBufContent += sizeof(sipBoardIP);

	//sipBoardRtpPort
	memmove(thebuf+theBufContent, &sipBoardRtpPort, sizeof(sipBoardRtpPort));
	theBufContent += sizeof(sipBoardRtpPort);

	//sipBoardRtcpPort
	memmove(thebuf+theBufContent, &sipBoardRtcpPort, sizeof(sipBoardRtcpPort));
	theBufContent += sizeof(sipBoardRtcpPort);

	//sipTransIP
	memmove(thebuf+theBufContent, &sipTransIP, sizeof(sipTransIP));
	theBufContent += sizeof(sipTransIP);

	//sipTransRtpPort
	memmove(thebuf+theBufContent, &sipTransRtpPort, sizeof(sipTransRtpPort));
	theBufContent += sizeof(sipTransRtpPort);

	//sipTransRtcpPort
	memmove(thebuf+theBufContent, &sipTransRtcpPort, sizeof(sipTransRtcpPort));
	theBufContent += sizeof(sipTransRtcpPort);

	//Media Info
	memcpy(thebuf+theBufContent,trans.c_str(),trans.length()+1);
	theBufContent += (trans.length() + 1);
	
	memcpy(thebuf+theBufContent,codec.c_str(),codec.length()+1);
	theBufContent += (codec.length() + 1);
	
	memcpy(thebuf+theBufContent,&unit,sizeof(size_t));
	theBufContent += (sizeof(size_t));

	//conferencePort1
	memmove(thebuf+theBufContent, &conferencePort1, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	memmove(thebuf+theBufContent, &conferencePort2, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);

	return theBufContent;
}

int SIPCCMsg_ACD_CallUserConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(char);			//bCallFailed
	memSize += sizeof(unsigned long);	//audioIP
	memSize += sizeof(unsigned short);	//audioPort
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(int);				//failedCause
	memSize += invokeID.length()+1;		//invokeID
	memSize += sizeof(sipBoardIP);		//sipBoardIP
	memSize += sizeof(sipBoardRtpPort);	//sipBoardRtpPort
	memSize += sizeof(sipBoardRtcpPort);//sipBoardRtcpPort
	memSize += sizeof(sipTransIP);		//sipTransIP
	memSize += sizeof(sipTransRtpPort);	//sipTransRtpPort
	memSize += sizeof(sipTransRtcpPort);//sipTransRtcpPort
	
	//20090806 haoy
	memSize += trans.length() + 1;
	memSize += codec.length() + 1;
	memSize += sizeof(size_t);

	memSize += sizeof(conferencePort1);	//conferencePort1
	memSize += sizeof(conferencePort2);	//conferencePort2

	return memSize;
}

void SIPCCMsg_ACD_CallUserConf::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

//Type_ACD_CallUserFailed
SIPCCMsg_ACD_CallUserFailed::SIPCCMsg_ACD_CallUserFailed()
{
	msgType = Type_ACD_CallUserFailed;
	userName = NULL;
	userNameLen = 0;
	failedCause = -1;
}

void SIPCCMsg_ACD_CallUserFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	//failedCause
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_CallUserFailed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_CallUserFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//failedCause
	
	return memSize;
}

void SIPCCMsg_ACD_CallUserFailed::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_ACD_AgentHoldCall
SIPCCMsg_ACD_AgentHoldCall::SIPCCMsg_ACD_AgentHoldCall()
{
	msgType = Type_ACD_AgentHoldCall;
	heldParty = NULL;
	heldPartyLen = 0;
}

void SIPCCMsg_ACD_AgentHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//heldPartyLen
	memmove(&this->heldPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memmove(heldParty, 	thebuf+theBufContent, heldPartyLen);
	theBufContent += heldPartyLen;
}

int SIPCCMsg_ACD_AgentHoldCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//heldPartyLen
	memmove(thebuf+theBufContent, &this->heldPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	memmove(thebuf+theBufContent, this->heldParty, this->heldPartyLen);
	theBufContent += heldPartyLen;
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//heldPartyLen
	memSize += this->heldPartyLen;		//heldParty
	
	return memSize;
}

void SIPCCMsg_ACD_AgentHoldCall::SetHeldParty(string heldparty)
{
	int iHeldPartyLen = heldparty.length();
	this->heldPartyLen = iHeldPartyLen + 1;
	this->heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memcpy(heldParty, heldparty.c_str(), iHeldPartyLen);
}

///Type_ACD_AgentUnHoldCall
SIPCCMsg_ACD_AgentUnHoldCall::SIPCCMsg_ACD_AgentUnHoldCall()
{
	msgType = Type_ACD_AgentUnHoldCall;
	heldParty = NULL;
	heldPartyLen = 0;
}

void SIPCCMsg_ACD_AgentUnHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//heldPartyLen
	memmove(&this->heldPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memmove(heldParty, 	thebuf+theBufContent, heldPartyLen);
	theBufContent += heldPartyLen;
}

int SIPCCMsg_ACD_AgentUnHoldCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//heldPartyLen
	memmove(thebuf+theBufContent, &this->heldPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	memmove(thebuf+theBufContent, this->heldParty, this->heldPartyLen);
	theBufContent += heldPartyLen;
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentUnHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//heldPartyLen
	memSize += this->heldPartyLen;		//heldParty
	
	return memSize;
}

void SIPCCMsg_ACD_AgentUnHoldCall::SetHeldParty(string heldparty)
{
	int iHeldPartyLen = heldparty.length();
	this->heldPartyLen = iHeldPartyLen + 1;
	this->heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memcpy(heldParty, heldparty.c_str(), iHeldPartyLen);
}

///Type_ACD_AgentHoldCallConf
SIPCCMsg_ACD_AgentHoldCallConf::SIPCCMsg_ACD_AgentHoldCallConf()
{
	msgType = Type_ACD_AgentHoldCallConf;
	bHoldSucc = 0;
}

void SIPCCMsg_ACD_AgentHoldCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//bHoldSucc
	memmove(&this->bHoldSucc, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_ACD_AgentHoldCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//bHoldSucc
	memmove(thebuf+theBufContent, &this->bHoldSucc, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_ACD_AgentHoldCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);			//bHoldSucc
	
	return memSize;
}

///Type_ACD_NotifyDataCollect
SIPCCMsg_ACD_NotifyDataCollect::SIPCCMsg_ACD_NotifyDataCollect()
{
	msgType = Type_ACD_NotifyDataCollect;
	theMinute = -1;
	CurrentHour = 0;
	collectDate = "";
	sData="";
}

void SIPCCMsg_ACD_NotifyDataCollect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_NotifyDataCollect";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theMinute
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theMinute", ip, port)) ) {return;}
	memmove(&this->theMinute, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//if ( !(VerifyData(theMinute, MINUTE_LEN, strMsg, "theMinute", ip, port)) ) {return;}

	//CurrentHour
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "CurrentHour", ip, port)) ) {return;}
	memmove(&this->CurrentHour, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//if ( !(VerifyData(CurrentHour, CURRENTHOUR_LEN, strMsg, "CurrentHour", ip, port)) ) {return;}

	if(msgsize == theBufContent)
		return;

	collectDate = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+collectDate.length()+1, msgsize, strMsg, "collectDate.length()", ip, port)) ) {return;}
	if ( !(VerifyData(collectDate.length(), COLLECTDATE_LEN, strMsg, "collectDate", ip, port)) ) {return;}
	theBufContent += ( collectDate.length() + 1 );


	if(msgsize == theBufContent)
		return;


	//sData
	sData = thebuf+theBufContent;
	theBufContent += ( sData.length() + 1 );

}

int SIPCCMsg_ACD_NotifyDataCollect::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theMinute
	memmove(thebuf+theBufContent, &this->theMinute, sizeof(int));
	theBufContent += sizeof(int);
	//CurrentHour
	memmove(thebuf+theBufContent, &this->CurrentHour, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, collectDate.c_str(), collectDate.length()+1);
	theBufContent += collectDate.length()+1;


	//sData
	memmove(thebuf+theBufContent, sData.c_str(), sData.length()+1);
	theBufContent += sData.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_NotifyDataCollect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);	//msgclass+msgtype
	memSize += sizeof(int);			//theMinute
	memSize += sizeof(int);			//CurrentHour
	memSize += collectDate.length() + 1;
	memSize += sData.length() + 1;  //sData
	return memSize;
}

///Type_ACD_PrepareTransfer
SIPCCMsg_ACD_PrepareTransfer::SIPCCMsg_ACD_PrepareTransfer()
{
	msgType = Type_ACD_PrepareTransfer;
	callID = NULL;
	callIDLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	otherPartyType = CallParty_UnKnown;
	AudioIp = 0;
	AudioPort = 0;
	lanIP = 0;
}

void SIPCCMsg_ACD_PrepareTransfer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, 	thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//otherPartyLen
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(&this->otherPartyType, thebuf + theBufContent, sizeof(int) );
	theBufContent += sizeof(int);
	
	//AudioIp
	memmove(&this->AudioIp, thebuf + theBufContent, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);
	//AudioPort
	memmove(&this->AudioPort, thebuf + theBufContent, sizeof(unsigned short) );
	theBufContent += sizeof(unsigned short);
	//lanIP
	memmove(&this->lanIP, thebuf + theBufContent, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_ACD_PrepareTransfer::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	//AudioIp
	memmove(thebuf+theBufContent, &this->AudioIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//AudioPort
	memmove(thebuf+theBufContent, &this->AudioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	return theBufContent;
}

int SIPCCMsg_ACD_PrepareTransfer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	
	memSize += sizeof(int);				//otherPartyType
	memSize += sizeof(unsigned long);	//AudioIp
	memSize += sizeof(unsigned short);	//AudioPort
	memSize += sizeof(unsigned long);	//lanIp
	
	return memSize;
}

void SIPCCMsg_ACD_PrepareTransfer::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_ACD_PrepareTransfer::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

///Type_ACD_TransReady
SIPCCMsg_ACD_TransReady::SIPCCMsg_ACD_TransReady()
{
	msgType = Type_ACD_TransReady;
	readyParty = NULL;
	readyPartyLen = 0;
}

void SIPCCMsg_ACD_TransReady::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//readyPartyLen
	memmove(&this->readyPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//readyParty
	readyParty = new char[readyPartyLen];
	memset(readyParty, 0, readyPartyLen);
	memmove(readyParty, 	thebuf+theBufContent, readyPartyLen);
	theBufContent += readyPartyLen;
}

int SIPCCMsg_ACD_TransReady::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//readyPartyLen
	memmove(thebuf+theBufContent, &this->readyPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//readyParty
	memmove(thebuf+theBufContent, this->readyParty, this->readyPartyLen);
	theBufContent += readyPartyLen;
	
	return theBufContent;
}

int SIPCCMsg_ACD_TransReady::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//readyPartyLen
	memSize += this->readyPartyLen;		//readyParty
	
	return memSize;
}

void SIPCCMsg_ACD_TransReady::SetReadyParty(string readyparty)
{
	int iReadyPartyLen = readyparty.length();
	this->readyPartyLen = iReadyPartyLen + 1;
	this->readyParty = new char[readyPartyLen];
	memset(this->readyParty, 0, readyPartyLen);
	memcpy(this->readyParty, readyparty.c_str(), iReadyPartyLen);
}

///Type_ACD_TransferCall
SIPCCMsg_ACD_TransferCall::SIPCCMsg_ACD_TransferCall()
{
	msgType = Type_ACD_TransferCall;
	presideAgent = NULL;
	presideAgentLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	theParty = NULL;
	thePartyLen = 0;
	
	otherPartyType = CallParty_UnKnown;
	
	userLineIp = 0;
	userLinePort = 0;

	trans = "";
	codec = "";
	unit = 0;
}

void SIPCCMsg_ACD_TransferCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//presideAgentLen
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;
	
	if(msgsize == theBufContent)
		return;
	
	//thePartyLen
	memmove(&this->thePartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	theParty = new char[thePartyLen];
	memset(theParty, 0, thePartyLen);
	memmove(theParty, 	thebuf+theBufContent, thePartyLen);
	theBufContent += thePartyLen;
	
	if ( theBufContent >= msgsize)
	{
		return;
	}
	
	//otherPartyType
	memmove(&this->otherPartyType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if ( theBufContent >= msgsize)
	{
		return;
	}
	
	userLineNo = thebuf+theBufContent;
	theBufContent += userLineNo.length()+1;
	
	memmove(&this->userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&this->userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if (theBufContent >= msgsize){
		return;
	}

	//20090806 haoy
	trans = thebuf + theBufContent;
	theBufContent += trans.length() + 1;
	codec = thebuf + theBufContent;
	theBufContent += codec.length() + 1;
	memmove(&unit,thebuf+theBufContent,sizeof(size_t));
	theBufContent += sizeof(size_t);
	
}

int SIPCCMsg_ACD_TransferCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//thePartyLen
	memmove(thebuf+theBufContent, &this->thePartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	memmove(thebuf+theBufContent, this->theParty, this->thePartyLen);
	theBufContent += thePartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length()+1);
	theBufContent += userLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	
	//Media Info
	memcpy(thebuf+theBufContent,trans.c_str(),trans.length()+1);
	theBufContent += (trans.length() + 1);
	memcpy(thebuf+theBufContent,codec.c_str(),codec.length()+1);
	theBufContent += (codec.length() + 1);
	memcpy(thebuf+theBufContent,&unit,sizeof(size_t));
	theBufContent += (sizeof(size_t));
	
	return theBufContent;
}

int SIPCCMsg_ACD_TransferCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	memSize += sizeof(int);				//thePartyLen
	memSize += this->thePartyLen;		//theParty
	
	memSize += sizeof(int);				//otherPartyType
	
	memSize += userLineNo.length()+1;
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);	

	memSize += trans.length() + 1;
	memSize += codec.length() + 1;
	memSize += sizeof(size_t);
	
	return memSize;
}

void SIPCCMsg_ACD_TransferCall::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_ACD_TransferCall::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

void SIPCCMsg_ACD_TransferCall::SetTheParty(string theparty)
{
	int iThePartyLen = theparty.length();
	this->thePartyLen = iThePartyLen + 1;
	this->theParty = new char[thePartyLen];
	memset(this->theParty, 0, thePartyLen);
	memcpy(this->theParty, theparty.c_str(), iThePartyLen);
}

///Type_ACD_ClearPreConnection
SIPCCMsg_ACD_ClearPreConnection::SIPCCMsg_ACD_ClearPreConnection()
{
	msgType = Type_ACD_ClearPreConnection;
	notifier = NULL;
	notifierLen = 0;
}

void SIPCCMsg_ACD_ClearPreConnection::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//notifierLen
	memmove(&this->notifierLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//notifier
	notifier = new char[notifierLen];
	memset(notifier, 0, notifierLen);
	memmove(notifier, 	thebuf+theBufContent, notifierLen);
	theBufContent += notifierLen;
}

int SIPCCMsg_ACD_ClearPreConnection::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//notifierLen
	memmove(thebuf+theBufContent, &this->notifierLen, sizeof(int));
	theBufContent += sizeof(int);
	//notifier
	memmove(thebuf+theBufContent, this->notifier, this->notifierLen);
	theBufContent += notifierLen;
	
	return theBufContent;
}

int SIPCCMsg_ACD_ClearPreConnection::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//notifierLen
	memSize += this->notifierLen;		//notifier
	
	return memSize;
}

void SIPCCMsg_ACD_ClearPreConnection::SetNotifier(string theNotifier)
{
	int iNotifier = theNotifier.length();
	this->notifierLen = iNotifier + 1;
	this->notifier = new char[notifierLen];
	memset(this->notifier, 0, notifierLen);
	memcpy(this->notifier, theNotifier.c_str(), iNotifier);
}

///Type_ACD_DepartNAgentInfo
SIPCCMsg_ACD_DepartNAgentInfo::SIPCCMsg_ACD_DepartNAgentInfo()
{
	msgType = Type_ACD_DepartNAgentInfo;
	theInfo = NULL;
	theInfoLen = 0;
	bEnd = 0;
	invokeID = "";
	deptNickname = "";
}

void SIPCCMsg_ACD_DepartNAgentInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theInfoLen
	memmove(&this->theInfoLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theInfo
	theInfo = new char[theInfoLen];
	memset(theInfo, 0, theInfoLen);
	memmove(theInfo, 	thebuf+theBufContent, theInfoLen);
	theBufContent += theInfoLen;
	
	//bEnd
	memmove(&bEnd, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;

	if(theBufContent == msgsize)
		return;

	//deptNickname
	deptNickname = thebuf+theBufContent;
	theBufContent += deptNickname.length()+1;
}

int SIPCCMsg_ACD_DepartNAgentInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theInfoLen
	memmove(thebuf+theBufContent, &this->theInfoLen, sizeof(int));
	theBufContent += sizeof(int);
	//theInfo
	memmove(thebuf+theBufContent, this->theInfo, this->theInfoLen);
	theBufContent += theInfoLen;
	
	//bEnd
	memmove(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	//deptNickname
	memmove(thebuf+theBufContent, deptNickname.c_str(), deptNickname.length()+1);
	theBufContent += deptNickname.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_DepartNAgentInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//theInfoLen
	memSize += this->theInfoLen;		//theInfo
	
	memSize += sizeof(char);			//bEnd
	memSize += invokeID.length()+1;		//invokeID

	memSize += deptNickname.length()+1;	//deptNickname
	
	return memSize;
}

void SIPCCMsg_ACD_DepartNAgentInfo::SetTheInfo(string theinfo)
{
	int iTheInfoLen = theinfo.length();
	this->theInfoLen = iTheInfoLen + 1;
	this->theInfo = new char[theInfoLen];
	memset(this->theInfo, 0, theInfoLen);
	memcpy(this->theInfo, theinfo.c_str(), iTheInfoLen);
}

///Type_ACD_GroupInfo
SIPCCMsg_ACD_GroupInfo::SIPCCMsg_ACD_GroupInfo()
{
	msgType = Type_ACD_GroupInfo;
	corporationName = NULL;
	corporationNameLen = 0;
	theInfo = NULL;
	theInfoLen = 0;
	groupNum = 0;
	currentTime = 0;
	invokeID = "";
}

void SIPCCMsg_ACD_GroupInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	//theInfoLen
	memmove(&this->theInfoLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theInfo
	theInfo = new char[theInfoLen];
	memset(theInfo, 0, theInfoLen);
	memmove(theInfo, 	thebuf+theBufContent, theInfoLen);
	theBufContent += theInfoLen;
	
	//groupNum
	memmove(&groupNum, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//currentTime
	memmove(&currentTime, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_ACD_GroupInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//theInfoLen
	memmove(thebuf+theBufContent, &this->theInfoLen, sizeof(int));
	theBufContent += sizeof(int);
	//theInfo
	memmove(thebuf+theBufContent, this->theInfo, this->theInfoLen);
	theBufContent += theInfoLen;
	
	//groupNum
	memmove(thebuf+theBufContent, &groupNum, sizeof(int));
	theBufContent += sizeof(int);
	
	//currentTime
	memmove(thebuf+theBufContent, &currentTime, sizeof(int));
	theBufContent += sizeof(int);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_GroupInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	memSize += sizeof(int);				//theInfoLen
	memSize += this->theInfoLen;		//theInfo
	memSize += sizeof(int);				//groupNum
	memSize += sizeof(int);				//currentTime
	memSize += invokeID.length()+1;		//invokeID
	
	return memSize;
}

void SIPCCMsg_ACD_GroupInfo::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

void SIPCCMsg_ACD_GroupInfo::SetTheInfo(string theinfo)
{
	int iTheInfoLen = theinfo.length();
	this->theInfoLen = iTheInfoLen + 1;
	this->theInfo = new char[theInfoLen];
	memset(this->theInfo, 0, theInfoLen);
	memcpy(this->theInfo, theinfo.c_str(), iTheInfoLen);
}

///Type_ACD_NotifyAgentStateEvent
SIPCCMsg_ACD_NotifyAgentStateEvent::SIPCCMsg_ACD_NotifyAgentStateEvent()
{
	msgType = Type_ACD_NotifyAgentStateEvent;
	corporationName = NULL;
	corporationNameLen = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	curTime = NULL;
	curTimeLen = 0;
	callTarger = NULL;
	callTargerLen = 0;
}

void SIPCCMsg_ACD_NotifyAgentStateEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_NotifyAgentStateEvent";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, strMsg, "corporationNameLen", ip, port)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, strMsg, "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	
	//curTimeLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "curTimeLen", ip, port)) ) {return;}
	memmove(&this->curTimeLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(curTimeLen, CURTIME_LEN, strMsg, "curTimeLen", ip, port)) ) {return;}

	//curTime
	if ( !(VerifyTotalLen(theBufContent+curTimeLen, msgsize, strMsg, "curTime", ip, port)) ) {return;}
	curTime = new char[curTimeLen];
	memset(curTime, 0, curTimeLen);
	memmove(curTime, thebuf+theBufContent, curTimeLen);
	theBufContent += curTimeLen;
	
	//callTargerLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callTargerLen", ip, port)) ) {return;}
	memmove(&this->callTargerLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callTargerLen, CALLTARGER_LEN, strMsg, "curTimeLen", ip, port)) ) {return;}

	//callTarger
	if ( !(VerifyTotalLen(theBufContent+callTargerLen, msgsize, strMsg, "callTarger", ip, port)) ) {return;}
	callTarger = new char[callTargerLen];
	memset(callTarger, 0, callTargerLen);
	memmove(callTarger, thebuf+theBufContent, callTargerLen);
	theBufContent += callTargerLen;
	
	//stateEvent
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "stateEvent", ip, port)) ) {return;}
	memmove(&stateEvent, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_NotifyAgentStateEvent::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//curTimeLen
	memmove(thebuf+theBufContent, &this->curTimeLen, sizeof(int));
	theBufContent += sizeof(int);
	//curTime
	memmove(thebuf+theBufContent, this->curTime, this->curTimeLen);
	theBufContent += curTimeLen;
	
	//callTargerLen
	memmove(thebuf+theBufContent, &this->callTargerLen, sizeof(int));
	theBufContent += sizeof(int);
	//callTarger
	memmove(thebuf+theBufContent, this->callTarger, this->callTargerLen);
	theBufContent += callTargerLen;
	
	//stateEvent
	memmove(thebuf+theBufContent, &stateEvent, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_NotifyAgentStateEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//curTimeLen
	memSize += this->curTimeLen;		//curTime
	memSize += sizeof(int);				//callTargerLen
	memSize += this->callTargerLen;		//callTarger
	memSize += sizeof(int);				//stateEvent
	
	return memSize;
}

void SIPCCMsg_ACD_NotifyAgentStateEvent::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

void SIPCCMsg_ACD_NotifyAgentStateEvent::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	if(iTheDepartmentLen == 0)
		return;
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

void SIPCCMsg_ACD_NotifyAgentStateEvent::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_ACD_NotifyAgentStateEvent::SetCurrentTime(string currenttime)
{
	int iCurTimeLen = currenttime.length();
	this->curTimeLen = iCurTimeLen + 1;
	this->curTime = new char[curTimeLen];
	memset(curTime, 0, curTimeLen);
	memcpy(curTime, currenttime.c_str(), iCurTimeLen);
}

void SIPCCMsg_ACD_NotifyAgentStateEvent::SetCallTarger(string calltarger)
{
	int iCallTargerLen = calltarger.length();
	this->callTargerLen = iCallTargerLen + 1;
	this->callTarger = new char[callTargerLen];
	memset(callTarger, 0, callTargerLen);
	memcpy(callTarger, calltarger.c_str(), iCallTargerLen);
}

///Type_ACD_VDNStatusInfo
SIPCCMsg_ACD_VDNStatusInfo::SIPCCMsg_ACD_VDNStatusInfo()
{
	msgType = Type_ACD_VDNStatusInfo;
	
	endTime = NULL;
	endTimeLen = 0;
	callerNo = NULL;
	callerNoLen = 0;
	calledNo = NULL;
	calledNoLen = 0;
	corporationName = NULL;
	corporationNameLen =0;
	theDepartment = NULL;
	theDepartmentLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	
	callType = IPCCCallType_PSTN;
	endCause = VDNEndCause_Normal;
}

void SIPCCMsg_ACD_VDNStatusInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//endTimeLen
	memmove(&this->endTimeLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//endTime
	endTime = new char[endTimeLen];
	memset(endTime, 0, endTimeLen);
	memmove(endTime, thebuf+theBufContent, endTimeLen);
	theBufContent += endTimeLen;
	//callerNoLen
	memmove(&this->callerNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callerNo
	callerNo = new char[callerNoLen];
	memset(callerNo, 0, callerNoLen);
	memmove(callerNo, thebuf+theBufContent, callerNoLen);
	theBufContent += callerNoLen;
	//calledNoLen
	memmove(&this->calledNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//calledNo
	calledNo = new char[calledNoLen];
	memset(calledNo, 0, calledNoLen);
	memmove(calledNo, thebuf+theBufContent, calledNoLen);
	theBufContent += calledNoLen;
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	//theDepartmentLen
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	
	//callType
	memmove(&this->callType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//endCause
	memmove(&endCause, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//queueTimeSpan
	memmove(&this->queueTimeSpan, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//responseTimeSpan
	memmove(&responseTimeSpan, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_VDNStatusInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//endTimeLen
	memmove(thebuf+theBufContent, &this->endTimeLen, sizeof(int));
	theBufContent += sizeof(int);
	//endTime
	memmove(thebuf+theBufContent, this->endTime, this->endTimeLen);
	theBufContent += endTimeLen;
	//callerNoLen
	memmove(thebuf+theBufContent, &this->callerNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//callerNo
	memmove(thebuf+theBufContent, this->callerNo, this->callerNoLen);
	theBufContent += callerNoLen;
	//calledNoLen
	memmove(thebuf+theBufContent, &this->calledNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo, this->calledNoLen);
	theBufContent += calledNoLen;
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//callType
	memmove(thebuf+theBufContent, &this->callType, sizeof(int));
	theBufContent += sizeof(int);
	//endCause
	memmove(thebuf+theBufContent, &this->endCause, sizeof(int));
	theBufContent += sizeof(int);
	//queueTimeSpan
	memmove(thebuf+theBufContent, &this->queueTimeSpan, sizeof(int));
	theBufContent += sizeof(int);
	//responseTimeSpan
	memmove(thebuf+theBufContent, &this->responseTimeSpan, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_VDNStatusInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//endTimeLen
	memSize += this->endTimeLen;		//endTime
	memSize += sizeof(int);				//callerNoLen
	memSize += this->callerNoLen;		//callerNo
	memSize += sizeof(int);				//calledNoLen
	memSize += this->calledNoLen;		//calledNo
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//callType
	memSize += sizeof(int);				//endCause
	memSize += sizeof(int);				//queueTimeSpan
	memSize += sizeof(int);				//responseTimeSpan
	
	return memSize;
}

void SIPCCMsg_ACD_VDNStatusInfo::SetEndTime(string endtime)
{
	int iEndTimeLen = endtime.length();
	this->endTimeLen = iEndTimeLen + 1;
	this->endTime = new char[endTimeLen];
	memset(endTime, 0, endTimeLen);
	memcpy(endTime, endtime.c_str(), iEndTimeLen);
}

void SIPCCMsg_ACD_VDNStatusInfo::SetCallerNo(string callerno)
{
	int iCallerNoLen = callerno.length();
	this->callerNoLen = iCallerNoLen + 1;
	this->callerNo = new char[callerNoLen];
	memset(callerNo, 0, callerNoLen);
	memcpy(callerNo, callerno.c_str(), iCallerNoLen);
}

void SIPCCMsg_ACD_VDNStatusInfo::SetCalledNo(string calledno)
{
	int iCalledNoLen = calledno.length();
	this->calledNoLen = iCalledNoLen + 1;
	this->calledNo = new char[calledNoLen];
	memset(calledNo, 0, calledNoLen);
	memcpy(calledNo, calledno.c_str(), iCalledNoLen);
}

void SIPCCMsg_ACD_VDNStatusInfo::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

void SIPCCMsg_ACD_VDNStatusInfo::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	if(iTheDepartmentLen == 0)
		return;
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

void SIPCCMsg_ACD_VDNStatusInfo::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

///Type_ACD_MediaReady
SIPCCMsg_ACD_MediaReady::SIPCCMsg_ACD_MediaReady()
{
	msgType = Type_ACD_MediaReady;
}

void SIPCCMsg_ACD_MediaReady::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_ACD_MediaReady::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_ACD_MediaReady::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_ACD_ForceLogout
SIPCCMsg_ACD_ForceLogout::SIPCCMsg_ACD_ForceLogout()
{
	msgType = Type_ACD_ForceLogout;
	cause = ForceLogoutCause_ReLogin;
}

void SIPCCMsg_ACD_ForceLogout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentName = thebuf + theBufContent;
	theBufContent += ( agentName.length() + 1 );
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	//cause
	memmove(&this->cause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_ForceLogout::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, agentName.c_str(), agentName.length() + 1 );
	theBufContent += ( agentName.length() + 1 );
	
	//cause
	memmove(thebuf+theBufContent, &this->cause, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_ForceLogout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	memSize += ( agentName.length() + 1 );	//agentName
	memSize += sizeof(int);					//cause
	
	return memSize;
}


///Type_ACD_UserMakeCallPSTN
SIPCCMsg_ACD_UserMakeCallPSTN::SIPCCMsg_ACD_UserMakeCallPSTN()
{
	msgType = Type_ACD_UserMakeCallPSTN;
	callID = NULL;
	callIDLen = 0;
	userName = NULL;
	userNameLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";
}

void SIPCCMsg_ACD_UserMakeCallPSTN::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//userNameLen
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	//targetType
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	
	
	//targetPositionLen
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	
	if(theBufContent == msgsize)
		return;
	
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	//curVersion
	curVersion = thebuf+theBufContent;
	theBufContent += curVersion.length()+1;
}

int SIPCCMsg_ACD_UserMakeCallPSTN::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_UserMakeCallPSTN::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//userNameLen
	memSize += this->userNameLen;			//userName
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	
	return memSize;
}

void SIPCCMsg_ACD_UserMakeCallPSTN::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_ACD_UserMakeCallPSTN::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_ACD_UserMakeCallPSTN::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_ACD_UserMakeCallPSTN::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_ACD_UserMakeCallPSTN::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}


///Type_ACD_UserMakeCallPSTN2
SIPCCMsg_ACD_UserMakeCallPSTN2::SIPCCMsg_ACD_UserMakeCallPSTN2()
{
	msgType = Type_ACD_UserMakeCallPSTN2;
	callID = NULL;
	callIDLen = 0;
	userName = NULL;
	userNameLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";
	invokeID = "";
}

void SIPCCMsg_ACD_UserMakeCallPSTN2::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//userNameLen
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	//targetType
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	
	
	//targetPositionLen
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;
	
	
	//uuiDataLen
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	
	if(theBufContent == msgsize)
		return;
	
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	//curVersion
	curVersion = thebuf+theBufContent;
	theBufContent += curVersion.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
	
}

int SIPCCMsg_ACD_UserMakeCallPSTN2::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_UserMakeCallPSTN2::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//userNameLen
	memSize += this->userNameLen;			//userName
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	
	memSize += invokeID.length()+1;			//invokeID
	
	return memSize;
}

void SIPCCMsg_ACD_UserMakeCallPSTN2::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_ACD_UserMakeCallPSTN2::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_ACD_UserMakeCallPSTN2::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_ACD_UserMakeCallPSTN2::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_ACD_UserMakeCallPSTN2::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}



///Type_ACD_RingAgentExt
SIPCCMsg_ACD_RingAgentExt::SIPCCMsg_ACD_RingAgentExt()
{
	msgType = Type_ACD_RingAgentExt;
	callID = NULL;
	callIDLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";

	IsOutCall = 0;
}

void SIPCCMsg_ACD_RingAgentExt::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_ACD_RingAgentExt", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt", "callIDLen", ip, port)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, "SIPCCMsg_ACD_RingAgentExt", "callIDLen", ip, port)) ) {return;}
	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, "SIPCCMsg_ACD_RingAgentExt", "callID", ip, port)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt", "agentIDLen", ip, port)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, "SIPCCMsg_ACD_RingAgentExt", "agentIDLen", ip, port)) ) {return;}
	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, "SIPCCMsg_ACD_RingAgentExt", "agentID", ip, port)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	
	//targetType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt", "targetType", ip, port)) ) {return;}
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	
	
	//targetPositionLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt", "targetPositionLen", ip, port)) ) {return;}
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetPositionLen, TARGETPOSITION_LEN, "SIPCCMsg_ACD_RingAgentExt", "targetPositionLen", ip, port)) ) {return;}
	//targetPosition
	if ( !(VerifyTotalLen(theBufContent+targetPositionLen, msgsize, "SIPCCMsg_ACD_RingAgentExt", "targetPosition", ip, port)) ) {return;}
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt", "uuiDataLen", ip, port)) ) {return;}
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(uuiDataLen, UUIDATA_LEN, "SIPCCMsg_ACD_RingAgentExt", "uuiDataLen", ip, port)) ) {return;}
	//uuiData
	if ( !(VerifyTotalLen(theBufContent+uuiDataLen, msgsize, "SIPCCMsg_ACD_RingAgentExt", "uuiData", ip, port)) ) {return;}
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt", "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, "SIPCCMsg_ACD_RingAgentExt", "corporationNameLen", ip, port)) ) {return;}
	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, "SIPCCMsg_ACD_RingAgentExt", "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	
	if(theBufContent == msgsize)
		return;
	
	callerNoForSend = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerNoForSend.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt", "callerNoForSend.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerNoForSend.length(), CALLERNOFORSEND_LEN, "SIPCCMsg_ACD_RingAgentExt", "callerNoForSend", ip, port)) ) {return;}
	theBufContent += callerNoForSend.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	//curVersion
	curVersion = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+curVersion.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt", "curVersion.length()", ip, port)) ) {return;}
	if ( !(VerifyData(curVersion.length(), CURVERSION_LEN, "SIPCCMsg_ACD_RingAgentExt", "curVersion", ip, port)) ) {return;}
	theBufContent += curVersion.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	ipPhoneNo_User = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ipPhoneNo_User.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt", "ipPhoneNo_User.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ipPhoneNo_User.length(), IPPHONENO_LEN, "SIPCCMsg_ACD_RingAgentExt", "ipPhoneNo_User", ip, port)) ) {return;}
	theBufContent += ( ipPhoneNo_User.length() + 1 );

	if(theBufContent == msgsize)
		return;

	// IsOutCall
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, "SIPCCMsg_ACD_RingAgentExt", "IsOutCall", ip, port)) ) {return;}
	memmove(&this->IsOutCall, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt", "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, "SIPCCMsg_ACD_RingAgentExt", "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;
}

int SIPCCMsg_ACD_RingAgentExt::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	memcpy(thebuf+theBufContent, ipPhoneNo_User.c_str(), ipPhoneNo_User.length() + 1 );
	theBufContent += ( ipPhoneNo_User.length() + 1 );
	
	// IsOutCall
	memmove(thebuf+theBufContent, &this->IsOutCall, sizeof(char));
	theBufContent += sizeof(char);

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_RingAgentExt::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//agentIDLen
	memSize += this->agentIDLen;			//agentID
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	
	memSize += ipPhoneNo_User.length() + 1;

	memSize += sizeof(char);

	memSize += managerId.length()+1;		//managerId

	return memSize;
}

void SIPCCMsg_ACD_RingAgentExt::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_ACD_RingAgentExt::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_ACD_RingAgentExt::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_ACD_RingAgentExt::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_ACD_RingAgentExt::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_ACD_RingAgentExt2
SIPCCMsg_ACD_RingAgentExt2::SIPCCMsg_ACD_RingAgentExt2()
{
	msgType = Type_ACD_RingAgentExt2;
	callID = NULL;
	callIDLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";
	invokeID = "";
	usableTime = 0;
	
	lanIp = 0;
	
	outDialType = OutDialType_Normal;

	callTransID = "";
}

void SIPCCMsg_ACD_RingAgentExt2::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "callIDLen", ip, port)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, "SIPCCMsg_ACD_RingAgentExt2", "callIDLen", ip, port)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "callID", ip, port)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "agentIDLen", ip, port)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, "SIPCCMsg_ACD_RingAgentExt2", "agentIDLen", ip, port)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "agentID", ip, port)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//targetType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "targetType", ip, port)) ) {return;}
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//targetPositionLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "targetPositionLen", ip, port)) ) {return;}
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetPositionLen, TARGETPOSITION_LEN, "SIPCCMsg_ACD_RingAgentExt2", "targetPositionLen", ip, port)) ) {return;}

	//targetPosition
	if ( !(VerifyTotalLen(theBufContent+targetPositionLen, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "targetPosition", ip, port)) ) {return;}
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;

	//uuiDataLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "uuiDataLen", ip, port)) ) {return;}
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(uuiDataLen, UUIDATA_LEN, "SIPCCMsg_ACD_RingAgentExt2", "uuiDataLen", ip, port)) ) {return;}

	//uuiData
	if ( !(VerifyTotalLen(theBufContent+uuiDataLen, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "uuiData", ip, port)) ) {return;}
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;

	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, "SIPCCMsg_ACD_RingAgentExt2", "corporationNameLen", ip, port)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	callerNoForSend = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerNoForSend.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "callerNoForSend.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerNoForSend.length(), CALLERNOFORSEND_LEN, "SIPCCMsg_ACD_RingAgentExt2", "callerNoForSend", ip, port)) ) {return;}
	theBufContent += callerNoForSend.length()+1;

	//curVersion
	curVersion = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+curVersion.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "curVersion.length()", ip, port)) ) {return;}
	if ( !(VerifyData(curVersion.length(), CURVERSION_LEN, "SIPCCMsg_ACD_RingAgentExt2", "curVersion", ip, port)) ) {return;}
	theBufContent += curVersion.length()+1;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "invokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, "SIPCCMsg_ACD_RingAgentExt2", "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length()+1;

	//usableTime
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "usableTime", ip, port)) ) {return;}
	memmove(&this->usableTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

	if(theBufContent >= msgsize)
		return;

	//lanIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "lanIp", ip, port)) ) {return;}
	memmove(&this->lanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);	

	if ( theBufContent >= msgsize )
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "outDialType", ip, port)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	CalledAgentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CalledAgentID.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "CalledAgentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(CalledAgentID.length(), AGENTID_LEN, "SIPCCMsg_ACD_RingAgentExt2", "CalledAgentID", ip, port)) ) {return;}
	theBufContent += CalledAgentID.length()+1;

	calledAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledAgentLineNo.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "calledAgentLineNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(calledAgentLineNo.length(), AGENTLINENO_LEN, "SIPCCMsg_ACD_RingAgentExt2", "calledAgentLineNo", ip, port)) ) {return;}
	theBufContent += calledAgentLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "calledAgentLineIp", ip, port)) ) {return;}
	memmove(&this->calledAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_ACD_RingAgentExt2", "calledAgentLinePort", ip, port)) ) {return;}
	memmove(&this->calledAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	callTransID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callTransID.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "callTransID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callTransID.length(), CALLTRANSID_LEN, "SIPCCMsg_ACD_RingAgentExt2", "callTransID", ip, port)) ) {return;}
	theBufContent += callTransID.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, "SIPCCMsg_ACD_RingAgentExt2", "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, "SIPCCMsg_ACD_RingAgentExt2", "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;
}

int SIPCCMsg_ACD_RingAgentExt2::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	//usableTime
	memmove(thebuf+theBufContent, &this->usableTime, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIp
	memmove(thebuf+theBufContent, &this->lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, CalledAgentID.c_str(), CalledAgentID.length()+1);
	theBufContent += CalledAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, calledAgentLineNo.c_str(), calledAgentLineNo.length()+1);
	theBufContent += calledAgentLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->calledAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->calledAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, callTransID.c_str(), callTransID.length()+1);
	theBufContent += callTransID.length()+1;

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_RingAgentExt2::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//agentIDLen
	memSize += this->agentIDLen;			//agentID
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	memSize += invokeID.length()+1;			//invokeID
	
	memSize += sizeof(int);					//usableTime
	
	memSize += sizeof(unsigned long);					//lanIp
	
	memSize += sizeof(int);
	memSize += CalledAgentID.length()+1;
	memSize += calledAgentLineNo.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += callTransID.length()+1;		//callTransID

	memSize += managerId.length()+1;		//managerId	
	
	return memSize;
}

void SIPCCMsg_ACD_RingAgentExt2::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_ACD_RingAgentExt2::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_ACD_RingAgentExt2::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_ACD_RingAgentExt2::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_ACD_RingAgentExt2::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_ACD_QueryGW
SIPCCMsg_ACD_QueryGW::SIPCCMsg_ACD_QueryGW()
{
	msgType = Type_ACD_QueryGW;
	corporationName = "";
	departName = "";
	calledNo = "";
}

void SIPCCMsg_ACD_QueryGW::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_ACD_QueryGW";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corporationName
	corporationName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corporationName.length()+1, msgsize, strMsgName, "corporationName", ip, port)) ) {return;}
	if ( !(VerifyData(corporationName.length(), CORPNAME_LEN, strMsgName, "corporationName", ip, port)) ) {return;}
	theBufContent += (corporationName.length()+1);
	//departName
	departName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+departName.length()+1, msgsize, strMsgName, "departName", ip, port)) ) {return;}
	if ( !(VerifyData(departName.length(), CORPNDEPT_LEN, strMsgName, "departName", ip, port)) ) {return;}
	theBufContent += (departName.length()+1);
	//calledNo
	calledNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsgName, "calledNo", ip, port)) ) {return;}
	if ( !(VerifyData(calledNo.length(), CALLEDNO_LEN, strMsgName, "calledNo", ip, port)) ) {return;}
	theBufContent += (calledNo.length()+1);
	
	if(theBufContent >= msgsize)
		return;
	
	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsgName, "agentID", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsgName, "agentID", ip, port)) ) {return;}
	theBufContent += (agentID.length()+1);	
}

int SIPCCMsg_ACD_QueryGW::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName.c_str(), this->corporationName.length()+1);
	theBufContent += (this->corporationName.length()+1);
	//departName
	memmove(thebuf+theBufContent, this->departName.c_str(), this->departName.length()+1);
	theBufContent += (this->departName.length()+1);
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo.c_str(), this->calledNo.length()+1);
	theBufContent += (this->calledNo.length()+1);
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += (this->agentID.length()+1);
	return theBufContent;
}

int SIPCCMsg_ACD_QueryGW::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype
	
	memSize += (this->corporationName.length() + 1);	//corporationName
	memSize += (this->departName.length() + 1);			//departName
	memSize += (this->calledNo.length() + 1);			//calledNo
	memSize += (this->agentID.length() + 1);			//agentID
	
	return memSize;
}

///Type_ACD_IsAgentLoginConf
SIPCCMsg_ACD_IsAgentLoginConf::SIPCCMsg_ACD_IsAgentLoginConf()
{
	msgType = Type_ACD_IsAgentLoginConf;
	agentID = "";
	bIsAgentLogin = 0;
	agentState = 0;
	loginType = 0;
	
	invokeType = 0;
}

void SIPCCMsg_ACD_IsAgentLoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_IsAgentLoginConf";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentID
	agentID = thebuf+theBufContent;
	theBufContent += (agentID.length()+1);
	//bIsAgentLogin
	memmove(&bIsAgentLogin, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	if (theBufContent >= msgsize)
	{
		return;
	}
	
	memmove(&agentState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&loginType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->invokeType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_IsAgentLoginConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += (this->agentID.length()+1);
	
	//bIsAgentLogin
	memmove(thebuf+theBufContent, &this->bIsAgentLogin, sizeof(char));
	theBufContent += sizeof(char);
	
	memmove(thebuf+theBufContent, &this->agentState, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->loginType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->invokeType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_IsAgentLoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype
	
	memSize += (this->agentID.length() + 1);			//agentID
	memSize += sizeof(char);							//bIsAgentLogin 
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	memSize += sizeof(int);				//RequestID
	memSize += invokeId.length()+1;	//AgentName

	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

///Type_ACD_NotifyAgent
SIPCCMsg_ACD_NotifyAgent::SIPCCMsg_ACD_NotifyAgent()
{
	msgType = Type_ACD_NotifyAgent;
	notificationInfo = "";
}

void SIPCCMsg_ACD_NotifyAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//notificationInfo
	notificationInfo = thebuf+theBufContent;
	theBufContent += (notificationInfo.length()+1);
}

int SIPCCMsg_ACD_NotifyAgent::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//notificationInfo
	memmove(thebuf+theBufContent, this->notificationInfo.c_str(), this->notificationInfo.length()+1);
	theBufContent += (this->notificationInfo.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_ACD_NotifyAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype
	
	memSize += (this->notificationInfo.length() + 1);	//notificationInfo
	
	return memSize;
}

///Type_ACD_CallEnterVDN
void SIPCCMsg_ACD_CallEnterVDN::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_CallEnterVDN";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsg, "corpName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsg, "corpName", ip, port)) ) {return;}
	theBufContent += (corpName.length()+1);
	
	//vdnNo
	vdnNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+vdnNo.length()+1, msgsize, strMsg, "vdnNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(vdnNo.length(), DEPTID_LEN, strMsg, "vdnNo", ip, port)) ) {return;}
	theBufContent += (vdnNo.length()+1);
	
	//vdnName
	vdnName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+vdnName.length()+1, msgsize, strMsg, "vdnName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(vdnName.length(), DEPTID_LEN, strMsg, "vdnName", ip, port)) ) {return;}
	theBufContent += (vdnName.length()+1);
	
	//callID
	callID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callID.length()+1, msgsize, strMsg, "callID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callID.length(), CALLID_LEN, strMsg, "callID", ip, port)) ) {return;}
	theBufContent += (callID.length()+1);
	
	//callerID
	callerID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerID.length()+1, msgsize, strMsg, "callerID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerID.length(), CALLEDNO_LEN, strMsg, "callerID", ip, port)) ) {return;}
	theBufContent += (callerID.length()+1);
	
	//calleeID
	calleeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calleeID.length()+1, msgsize, strMsg, "calleeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(calleeID.length(), CALLEDNO_LEN, strMsg, "calleeID", ip, port)) ) {return;}
	theBufContent += (calleeID.length()+1);
	
	//callSrc
	callSrc = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callSrc.length()+1, msgsize, strMsg, "callSrc.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callSrc.length(), CALLEDNO_LEN, strMsg, "callSrc", ip, port)) ) {return;}
	theBufContent += (callSrc.length()+1);
	
	//extDevID
	extDevID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extDevID.length()+1, msgsize, strMsg, "extDevID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(extDevID.length(), EXTPHONENO_LEN, strMsg, "extDevID", ip, port)) ) {return;}
	theBufContent += (extDevID.length()+1);
	
	//enterTime
	enterTime = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+enterTime.length()+1, msgsize, strMsg, "enterTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(enterTime.length(), CURTIME_LEN, strMsg, "enterTime", ip, port)) ) {return;}
	theBufContent += (enterTime.length()+1);
	
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "status", ip, port)) ) {return;}
	memmove(&this->status, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callType", ip, port)) ) {return;}
	memmove(&this->callType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//bIsOverflow
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bIsOverflow", ip, port)) ) {return;}
	memmove(&this->bIsOverflow, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	managerid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerid.length()+1, msgsize, strMsg, "managerid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(managerid.length(), MANAGERID_LEN, strMsg, "managerid", ip, port)) ) {return;}
	theBufContent += managerid.length()+1;

	deptid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptid.length()+1, msgsize, strMsg, "deptid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(deptid.length(), DEPTID_LEN, strMsg, "deptid", ip, port)) ) {return;}
	theBufContent += deptid.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "CurQueueNum", ip, port)) ) {return;}
	memmove(&this->CurQueueNum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//bInnerCall
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bInnerCall", ip, port)) ) {return;}
	memmove(&this->bInnerCall, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//bIntoQueue
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bIntoQueue", ip, port)) ) {return;}
	memmove(&this->bIntoQueue, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += SkillGroupID.length()+1;

	//SkillGroupName
	SkillGroupName = thebuf+theBufContent;
	theBufContent += SkillGroupName.length()+1;

	if(theBufContent == msgsize)
		return;

	//UserLevel
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "UserLevel", ip, port)) ) {return;}
	memmove(&UserLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if ( theBufContent >= msgsize )
	{
		return;
	}


	//sData
	sData = thebuf+theBufContent;
	theBufContent += sData.length()+1;
}

int SIPCCMsg_ACD_CallEnterVDN::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), this->corpName.length()+1);
	theBufContent += (this->corpName.length()+1);
	
	//vdnNo
	memmove(thebuf+theBufContent, this->vdnNo.c_str(), this->vdnNo.length()+1);
	theBufContent += (this->vdnNo.length()+1);
	
	//vdnName
	memmove(thebuf+theBufContent, this->vdnName.c_str(), this->vdnName.length()+1);
	theBufContent += (this->vdnName.length()+1);
	
	//callID
	memmove(thebuf+theBufContent, this->callID.c_str(), this->callID.length()+1);
	theBufContent += (this->callID.length()+1);
	
	//callerID
	memmove(thebuf+theBufContent, this->callerID.c_str(), this->callerID.length()+1);
	theBufContent += (this->callerID.length()+1);
	
	//calleeID
	memmove(thebuf+theBufContent, this->calleeID.c_str(), this->calleeID.length()+1);
	theBufContent += (this->calleeID.length()+1);
	
	//callSrc
	memmove(thebuf+theBufContent, this->callSrc.c_str(), this->callSrc.length()+1);
	theBufContent += (this->callSrc.length()+1);
	
	//extDevID
	memmove(thebuf+theBufContent, this->extDevID.c_str(), this->extDevID.length()+1);
	theBufContent += (this->extDevID.length()+1);
	
	//enterTime
	memmove(thebuf+theBufContent, this->enterTime.c_str(), this->enterTime.length()+1);
	theBufContent += (this->enterTime.length()+1);
	
	//status
	memmove(thebuf+theBufContent, &this->status, sizeof(int));
	theBufContent += sizeof(int);
	
	//callType
	memmove(thebuf+theBufContent, &this->callType, sizeof(int));
	theBufContent += sizeof(int);
	
	//bIsOverflow
	memmove(thebuf+theBufContent, &this->bIsOverflow, sizeof(char));
	theBufContent += sizeof(char);

	//managerid
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;

	//deptid
	memcpy(thebuf+theBufContent, deptid.c_str(), deptid.length() + 1);
	theBufContent += deptid.length() + 1;

	//CurQueueNum
	memmove(thebuf+theBufContent, &this->CurQueueNum, sizeof(int));
	theBufContent += sizeof(int);

	//bInnerCall
	memmove(thebuf+theBufContent, &this->bInnerCall, sizeof(char));
	theBufContent += sizeof(char);

	//bIntoQueue
	memmove(thebuf+theBufContent, &this->bIntoQueue, sizeof(char));
	theBufContent += sizeof(char);

	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );

	//SkillGroupName
	memcpy(thebuf+theBufContent, SkillGroupName.c_str(), SkillGroupName.length() + 1 );
	theBufContent += ( SkillGroupName.length() + 1 );

	//UserLevel
	memmove(thebuf+theBufContent, &UserLevel, sizeof(int));
	theBufContent += sizeof(int);



	//sData
	memcpy(thebuf+theBufContent, sData.c_str(), sData.length() + 1 );
	theBufContent += ( sData.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_ACD_CallEnterVDN::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype
	
	memSize += (this->vdnNo.length() + 1);		//vdnNo
	memSize += (this->corpName.length() + 1);	//corpName
	memSize += (this->vdnName.length() + 1);	//vdnName
	memSize += (this->callID.length() + 1);		//callID
	memSize += (this->callerID.length() + 1);	//callerID
	memSize += (this->calleeID.length() + 1);	//calleeID
	memSize += (this->callSrc.length() + 1);	//callSrc
	memSize += (this->extDevID.length() + 1);	//extDevID
	memSize += (this->enterTime.length() + 1);	//enterTime
	memSize += sizeof(int);						//status
	memSize += sizeof(int);						//callType
	memSize += sizeof(char);					//bIsOverflow
	memSize +=  managerid.length() + 1;			//managerid
	memSize +=  deptid.length() + 1;			//deptid
	memSize += sizeof(int);						//CurQueueNum
	memSize += sizeof(char);					//bInnerCall
	memSize += sizeof(char);					//bIntoQueue

	memSize += SkillGroupID.length()+1;			//SkillGroupID
	memSize += SkillGroupName.length()+1;		//SkillGroupName
	memSize += sizeof(int);						//UserLevel

	memSize += (this->sData.length() + 1);	    //sData

	return memSize;
}

///Type_ACD_CallLeaveVDN
void SIPCCMsg_ACD_CallLeaveVDN::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_CallLeaveVDN";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//vdnNo
	vdnNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+vdnNo.length()+1, msgsize, strMsg, "vdnNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(vdnNo.length(), DEPTID_LEN, strMsg, "vdnNo", ip, port)) ) {return;}
	theBufContent += (vdnNo.length()+1);
	
	//callID
	callID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callID.length()+1, msgsize, strMsg, "callID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callID.length(), CALLID_LEN, strMsg, "callID", ip, port)) ) {return;}
	theBufContent += (callID.length()+1);
	
	//leaveTime
	leaveTime = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+leaveTime.length()+1, msgsize, strMsg, "leaveTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(leaveTime.length(), CURTIME_LEN, strMsg, "leaveTime", ip, port)) ) {return;}
	theBufContent += (leaveTime.length()+1);
	
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "leaveCause", ip, port)) ) {return;}
	memmove(&this->leaveCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsg, "corpName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsg, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	managerid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerid.length()+1, msgsize, strMsg, "managerid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(managerid.length(), MANAGERID_LEN, strMsg, "managerid", ip, port)) ) {return;}
	theBufContent += managerid.length()+1;

	deptid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptid.length()+1, msgsize, strMsg, "deptid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(deptid.length(), DEPTID_LEN, strMsg, "deptid", ip, port)) ) {return;}
	theBufContent += deptid.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	LeaveQueueTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+LeaveQueueTime.length()+1, msgsize, strMsg, "LeaveQueueTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(LeaveQueueTime.length(), MANAGERID_LEN, strMsg, "LeaveQueueTime", ip, port)) ) {return;}
	theBufContent += LeaveQueueTime.length()+1;

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), DEPTID_LEN, strMsg, "agentID", ip, port)) ) {return;}
	theBufContent += agentID.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//bIntoQueue
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bIntoQueue", ip, port)) ) {return;}
	memmove(&this->bIntoQueue, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "CurQueueNum", ip, port)) ) {return;}
	memmove(&this->CurQueueNum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += SkillGroupID.length()+1;

	//SkillGroupName
	SkillGroupName = thebuf+theBufContent;
	theBufContent += SkillGroupName.length()+1;

	if(theBufContent == msgsize)
		return;

	//UserLevel
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "UserLevel", ip, port)) ) {return;}
	memmove(&UserLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);




	if ( theBufContent >= msgsize )
	{
		return;
	}


	//sData
	sData = thebuf+theBufContent;
	theBufContent += sData.length()+1;
}

int SIPCCMsg_ACD_CallLeaveVDN::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//vdnNo
	memmove(thebuf+theBufContent, this->vdnNo.c_str(), this->vdnNo.length()+1);
	theBufContent += (this->vdnNo.length()+1);
	
	//callID
	memmove(thebuf+theBufContent, this->callID.c_str(), this->callID.length()+1);
	theBufContent += (this->callID.length()+1);
	
	//leaveTime
	memmove(thebuf+theBufContent, this->leaveTime.c_str(), this->leaveTime.length()+1);
	theBufContent += (this->leaveTime.length()+1);
	
	//leaveCause
	memmove(thebuf+theBufContent, &this->leaveCause, sizeof(int));
	theBufContent += sizeof(int);

	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), this->corpName.length()+1);
	theBufContent += (this->corpName.length()+1);
	
	//managerid
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;

	//deptid
	memcpy(thebuf+theBufContent, deptid.c_str(), deptid.length() + 1);
	theBufContent += deptid.length() + 1;

	//LeaveQueueTime
	memcpy(thebuf+theBufContent, LeaveQueueTime.c_str(), LeaveQueueTime.length() + 1);
	theBufContent += LeaveQueueTime.length() + 1;

	//agentID
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length() + 1);
	theBufContent += agentID.length() + 1;

	//bIntoQueue
	memmove(thebuf+theBufContent, &this->bIntoQueue, sizeof(char));
	theBufContent += sizeof(char);

	//CurQueueNum
	memmove(thebuf+theBufContent, &this->CurQueueNum, sizeof(int));
	theBufContent += sizeof(int);

	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );

	//SkillGroupName
	memcpy(thebuf+theBufContent, SkillGroupName.c_str(), SkillGroupName.length() + 1 );
	theBufContent += ( SkillGroupName.length() + 1 );

	//UserLevel
	memmove(thebuf+theBufContent, &UserLevel, sizeof(int));
	theBufContent += sizeof(int);

	//sData
	memcpy(thebuf+theBufContent, sData.c_str(), sData.length() + 1 );
	theBufContent += ( sData.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_ACD_CallLeaveVDN::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype
	
	memSize += (this->vdnNo.length() + 1);		//vdnNo
	memSize += (this->callID.length() + 1);		//callID
	memSize += (this->leaveTime.length() + 1);	//leaveTime
	memSize += sizeof(int);						//leaveCause
	memSize += (this->corpName.length() + 1);	//corpName
	memSize +=  managerid.length() + 1;			//managerid
	memSize +=  deptid.length() + 1;			//deptid

	memSize +=  LeaveQueueTime.length() + 1;	//LeaveQueueTime
	memSize +=  agentID.length() + 1;			//agentID

	memSize += sizeof(char);					//bIntoQueue

	memSize += sizeof(int);						//CurQueueNum
	
	memSize += SkillGroupID.length()+1;			//SkillGroupID
	memSize += SkillGroupName.length()+1;		//SkillGroupName
	memSize += sizeof(int);						//UserLevel
	
	memSize += (this->sData.length() + 1);	    //sData

	return memSize;
}

///Type_ACD_RecInfo2Client
void SIPCCMsg_ACD_RecInfo2Client::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += (invokeID.length()+1);
	
	//fullPathFileName
	fullPathFileName = thebuf+theBufContent;
	theBufContent += (fullPathFileName.length()+1);
}

int SIPCCMsg_ACD_RecInfo2Client::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);
	
	//fullPathFileName
	memmove(thebuf+theBufContent, fullPathFileName.c_str(), fullPathFileName.length()+1);
	theBufContent += (fullPathFileName.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_ACD_RecInfo2Client::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype
	
	memSize += (invokeID.length() + 1);				//invokeID
	memSize += (fullPathFileName.length() + 1);		//fullPathFileName
	
	return memSize;
}

///Type_ACD_SuperDisconnect
void SIPCCMsg_ACD_SuperDisconnect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

}

int SIPCCMsg_ACD_SuperDisconnect::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	
	return theBufContent;
}

int SIPCCMsg_ACD_SuperDisconnect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype
		
	return memSize;
}

///Type_ACD_ReturnToAgent
SIPCCMsg_ACD_ReturnToAgent::SIPCCMsg_ACD_ReturnToAgent()
{
	msgType=Type_ACD_ReturnToAgent;
	IVRUUIData = "";
	bIsSuccess = 0;
	bIsAgentWaiting = 0;
}

void SIPCCMsg_ACD_ReturnToAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_ReturnToAgent";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//IVRUUIData
	IVRUUIData = thebuf+theBufContent;
	theBufContent += (IVRUUIData.length()+1);

	//bIsSuccess
	memmove(&this->bIsSuccess, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	//bIsAgentWaiting
	memmove(&this->bIsAgentWaiting, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_ReturnToAgent::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//IVRUUIData
	memmove(thebuf+theBufContent, IVRUUIData.c_str(), IVRUUIData.length()+1);
	theBufContent += (IVRUUIData.length()+1);

	//bIsSuccess
	memmove(thebuf+theBufContent, &this->bIsSuccess, sizeof(char));
	theBufContent += sizeof(char);

	//bIsAgentWaiting
	memmove(thebuf+theBufContent, &this->bIsAgentWaiting, sizeof(char));
	theBufContent += sizeof(char);

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_ReturnToAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype

	memSize += (IVRUUIData.length() + 1);				//IVRUUIData
	memSize += sizeof(char);							//bIsSuccess
	memSize += sizeof(char);							//bIsAgentWaiting

	memSize += handleId.length()+1;			//handleId

	return memSize;
}

///Class_ACD
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_Client
SIPCCMsg_Client::SIPCCMsg_Client()
{
	msgClass = Class_Client;
}

///Type_Client_UserLogin
SIPCCMsg_Client_UserLogin::SIPCCMsg_Client_UserLogin()
{
	msgType = Type_Client_UserLogin;
	
	this->localIP = 0;
	this->localPort = 0;
	this->thePassword = NULL;
	this->thePasswordLen = 0;
	this->userName = NULL;
	this->userNameLen = 0;
	this->userType = ClientType_Agent;
	this->loginType=LoginType_OnlyWeb;
	corpInfo = "";
	userOrigin = "";
	versionType = ClientType_Enterprise;

	bMultiGroup = false;
	localtime = "";
	handleId="";

	token = "";
}

void SIPCCMsg_Client_UserLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNameLen
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	//thePasswordLen
	memmove(&this->thePasswordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	thePassword = new char[thePasswordLen];
	memset(thePassword, 0, thePasswordLen);
	memmove(this->thePassword, thebuf+theBufContent, thePasswordLen);
	theBufContent += thePasswordLen;
	//localIP
	memmove(&this->localIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	memmove(&this->localPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	if(theBufContent == msgsize)
		return;
	
	//userType
	memmove(&this->userType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent == msgsize)
		return;
	//loginType
	memmove(&this->loginType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	corpInfo = thebuf + theBufContent;
	theBufContent += corpInfo.length()+1;

	userOrigin = thebuf + theBufContent;
	theBufContent += userOrigin.length()+1;

	if(theBufContent == msgsize)
		return;

	//versionType
	memmove(&versionType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent == msgsize)
		return;

	memmove(&this->bMultiGroup, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	if(theBufContent >= msgsize)
		return;
	//localtime
	localtime = thebuf + theBufContent;
	theBufContent += localtime.length()+1;

	if(theBufContent == msgsize)
		return;
    //handleId
	handleId = thebuf + theBufContent;
	theBufContent += handleId.length()+1;

	if(theBufContent == msgsize)
		return;

	//token
	token = thebuf + theBufContent;
	theBufContent += token.length()+1;

}

int SIPCCMsg_Client_UserLogin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	//thePasswordLen
	memmove(thebuf+theBufContent, &this->thePasswordLen, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	memmove(thebuf+theBufContent, this->thePassword, thePasswordLen);
	theBufContent += thePasswordLen;
	//localIP
	memmove(thebuf+theBufContent, &this->localIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	memmove(thebuf+theBufContent, &this->localPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//userType
	memmove(thebuf+theBufContent, &this->userType, sizeof(int));
	theBufContent += sizeof(int);
	//loginType
	memmove(thebuf+theBufContent, &this->loginType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, corpInfo.c_str(), corpInfo.length()+1);
	theBufContent += corpInfo.length()+1;

	memcpy(thebuf+theBufContent, userOrigin.c_str(), userOrigin.length()+1);
	theBufContent += userOrigin.length()+1;
	
	//versionType
	memmove(thebuf+theBufContent, &versionType, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->bMultiGroup, sizeof(char));
	theBufContent += sizeof(char);
	//localtime
	memcpy(thebuf+theBufContent, localtime.c_str(), localtime.length()+1);
	theBufContent += localtime.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	//token
	memcpy(thebuf+theBufContent, token.c_str(), token.length()+1);
	theBufContent += token.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_UserLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//thePasswordLen
	memSize += this->thePasswordLen;	//thePassword
	memSize += sizeof(unsigned long);	//localIP
	memSize += sizeof(unsigned short);	//localPort
	memSize += sizeof(int);				//userType
	memSize += sizeof(int);				//loginType
	memSize += corpInfo.length()+1;

	memSize += userOrigin.length()+1;
	memSize += sizeof(int);				//versionType
	memSize += sizeof(char);	
	memSize += localtime.length()+1;    //localtime

	memSize += handleId.length()+1;    //handleId

	memSize += token.length()+1;    //token

	return memSize;
}

void SIPCCMsg_Client_UserLogin::SetThePassword(char* thepassword, int thepasswordlen)
{
	if(thepasswordlen > 0)
	{
		thePassword = new char[thepasswordlen];
		this->thePasswordLen = thepasswordlen;
		memmove(thePassword, thepassword, thePasswordLen);
	}
}

void SIPCCMsg_Client_UserLogin::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_Client_UserMark
SIPCCMsg_Client_UserMark::SIPCCMsg_Client_UserMark()
{
	msgType = Type_Client_UserMark;
	/*
	callID = NULL;
	callIDLen = 0;
	userName = NULL;
	userNameLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	markLevel = -1;
	*/
}

void SIPCCMsg_Client_UserMark::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
}

int SIPCCMsg_Client_UserMark::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Client_UserMark::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}



///Type_Client_UserQueryCall
SIPCCMsg_Client_UserQueryCall::SIPCCMsg_Client_UserQueryCall()
{
	msgType = Type_Client_UserQueryCall;
	keyWord = NULL;
	keyWordLen = 0;
	invokeID = 0;
}

void SIPCCMsg_Client_UserQueryCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//keyWordLen
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;
	
	//invokeID
	memmove(&this->invokeID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_UserQueryCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	
	//invokeID
	memmove(thebuf+theBufContent, &this->invokeID, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Client_UserQueryCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//keyWordLen
	memSize += this->keyWordLen;		//keyWord
	memSize += sizeof(int);				//invokeID
	
	return memSize;
}

void SIPCCMsg_Client_UserQueryCall::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

///Type_Client_UserMakeCall
SIPCCMsg_Client_UserMakeCall::SIPCCMsg_Client_UserMakeCall()
{
	msgType = Type_Client_UserMakeCall;
	userName = NULL;
	userNameLen = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
	keyWord = NULL;
	keyWordLen = 0;
	natType = NatType_Unknown;
	uuiData = NULL;
	uuiDataLen = 0;
	userType = -1;
	audioIP = 0;
	audioPort = 0;
	lanIP = 0;
	gwPartNo = "";
	comSymbol = "";
	callTransID = "";
	sipBoardIP = 0;
	sipBoardRtpPort = 0;
	sipBoardRtcpPort = 0;

	sipTransIP = 0;   //中转IP
	sipTransRtpPort = 0;  //中转RtpPort
	sipTransRtcpPort = 0;  //中转rtcpPort

	trans = "";
	codec = "";
	unit = 0;

	conferencePort1 = 0;
	conferencePort2 = 0;

	SkillGroupID = "";
	UserLevel = 3;
	CallTargetType = 0;
}

void SIPCCMsg_Client_UserMakeCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_UserMakeCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//keyWordLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "keyWordLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(keyWordLen, KEYWORD_LEN, strMsg, "keyWordLen", ip, port, g_bIsACDServer)) ) {return;}

	//keyWord
	if ( !(VerifyTotalLen(theBufContent+keyWordLen, msgsize, strMsg, "keyWord", ip, port, g_bIsACDServer)) ) {return;}
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//natType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "natType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	//uuiDataLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "uuiDataLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(uuiDataLen, UUIDATA_LEN, strMsg, "uuiDataLen", ip, port, g_bIsACDServer)) ) {return;}

	//uuiData
	if ( !(VerifyTotalLen(theBufContent+uuiDataLen, msgsize, strMsg, "uuiData", ip, port, g_bIsACDServer)) ) {return;}
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;

	//userType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//audioIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "audioIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->audioIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "audioPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->audioPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//lanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "lanIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent == msgsize)
		return;

	//gwPartNo
	gwPartNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwPartNo.length()+1, msgsize, strMsg, "gwPartNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwPartNo.length(), GWPARTNO_LEN, strMsg, "gwPartNo", ip, port, true)) ) {return;}
	theBufContent += ( gwPartNo.length() + 1 );

	if(theBufContent == msgsize)
		return;

	//comSymbol
	comSymbol = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+comSymbol.length()+1, msgsize, strMsg, "comSymbol.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(comSymbol.length(), COMSYMBOL_LEN, strMsg, "comSymbol", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( comSymbol.length() + 1 );

	if(theBufContent == msgsize)
		return;

	callTransID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callTransID.length()+1, msgsize, strMsg, "callTransID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(callTransID.length(), CALLTRANSID_LEN, strMsg, "callTransID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( callTransID.length() + 1 );

	if ( theBufContent >= msgsize )
		return;
	//sipBoardIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipBoardIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipBoardIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//sipBoardPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipBoardRtpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipBoardRtpPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipPhoneRtcpPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipBoardRtcpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipBoardRtcpPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipTransIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipTransIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&sipTransIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//sipTransRtpPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipTransRtpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&sipTransRtpPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipTransRtcpPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipTransRtcpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&sipTransRtcpPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(theBufContent >= msgsize){
		return;
	}

	//20090806 haoy
	trans = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+trans.length()+1, msgsize, strMsg, "trans.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(trans.length(), TRANS_LEN, strMsg, "trans", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += trans.length() + 1;

	codec = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+codec.length()+1, msgsize, strMsg, "codec.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(codec.length(), CODEC_LEN, strMsg, "codec", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += codec.length() + 1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(size_t), msgsize, strMsg, "unit", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&unit,thebuf+theBufContent,sizeof(size_t));
	theBufContent += sizeof(size_t);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

	if(theBufContent == msgsize)
		return;

	//conferencePort1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "conferencePort1", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferencePort1, thebuf+theBufContent, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "conferencePort2", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferencePort2, thebuf+theBufContent, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += SkillGroupID.length()+1;

	//UserLevel
	memmove(&this->UserLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//CallTargetType
	memmove(&this->CallTargetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_Client_UserMakeCall::FillBuf(char*& thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//userType
	memmove(thebuf+theBufContent, &this->userType, sizeof(int));
	theBufContent += sizeof(int);
	//audioIP
	memmove(thebuf+theBufContent, &this->audioIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(thebuf+theBufContent, &this->audioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(thebuf+theBufContent, gwPartNo.c_str(), gwPartNo.length() + 1 );
	theBufContent += ( gwPartNo.length() + 1 );
	
	//comSymbol
	memcpy(thebuf+theBufContent, comSymbol.c_str(), comSymbol.length() + 1 );
	theBufContent += ( comSymbol.length() + 1 );
	
	//callTransID
	memcpy(thebuf+theBufContent, callTransID.c_str(), callTransID.length() + 1 );
	theBufContent += ( callTransID.length() + 1 );

	//sipBoardIP
	memcpy(thebuf+theBufContent, &sipBoardIP, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);

	//sipBoardPort
	memcpy(thebuf+theBufContent, &sipBoardRtpPort, sizeof(unsigned short) );
	theBufContent += sizeof(unsigned short);

	//sipPhoneRtcpPort
	memcpy(thebuf+theBufContent, &sipBoardRtcpPort, sizeof(unsigned short) );
	theBufContent += sizeof(unsigned short);


	//sipTransIP
	memcpy(thebuf+theBufContent, &sipTransIP, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);

	//sipTransRtpPort
	memcpy(thebuf+theBufContent, &sipTransRtpPort, sizeof(unsigned short) );
	theBufContent += sizeof(unsigned short);

	//sipTransRtcpPort
	memcpy(thebuf+theBufContent, &sipTransRtcpPort, sizeof(unsigned short) );
	theBufContent += sizeof(unsigned short);

	//Media Info
	memcpy(thebuf+theBufContent,trans.c_str(),trans.length()+1);
	theBufContent += (trans.length() + 1);
	
	memcpy(thebuf+theBufContent,codec.c_str(),codec.length()+1);
	theBufContent += (codec.length() + 1);
	
	memcpy(thebuf+theBufContent,&unit,sizeof(size_t));
	theBufContent += (sizeof(size_t));

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	//conferencePort1
	memmove(thebuf+theBufContent, &conferencePort1, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	memmove(thebuf+theBufContent, &conferencePort2, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);

	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );

	//UserLevel
	memmove(thebuf+theBufContent, &this->UserLevel, sizeof(int));
	theBufContent += sizeof(int);

	//CallTargetType
	memmove(thebuf+theBufContent, &this->CallTargetType, sizeof(int));
	theBufContent += sizeof(int);

    theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_Client_UserMakeCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//keyWordLen
	memSize += this->keyWordLen;		//keyWord
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//natType
	memSize += sizeof(int);				//uuiDataLen
	memSize += this->uuiDataLen;		//uuiData
	memSize += sizeof(int);				//userType
	memSize += sizeof(unsigned long);	//audioIP
	memSize += sizeof(unsigned short);	//audioPort
	memSize += sizeof(unsigned long);	//lanIP
	memSize += gwPartNo.length() + 1;	//gwPartNo
	memSize += comSymbol.length() + 1;	//comSymbol
	memSize += callTransID.length() + 1;//callTransID
	memSize += sizeof(unsigned long);	//sipBoardIP
	memSize += sizeof(unsigned short);	//sipBoardPort
	memSize += sizeof(unsigned short);	//sipPhoneRtcpPort
	memSize += sizeof(unsigned long);	//sipTransIP
	memSize += sizeof(unsigned short);	//sipTransRtpPort
	memSize += sizeof(unsigned short);	//sipTransRtcpPort
	//20090806 haoy
	memSize += trans.length() + 1;
	memSize += codec.length() + 1;
	memSize += sizeof(size_t);

	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	memSize += sizeof(conferencePort1);	//conferencePort1
	memSize += sizeof(conferencePort2);	//conferencePort2

	memSize += SkillGroupID.length()+1;	//SkillGroupID
	memSize += sizeof(int);				//UserLevel
	memSize += sizeof(int);				//CallTargetType

    memSize += audioStreamDescription.GetMemSize();

	return memSize;
}

void SIPCCMsg_Client_UserMakeCall::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

void SIPCCMsg_Client_UserMakeCall::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

void SIPCCMsg_Client_UserMakeCall::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_UserMakeCall::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

//Type_Client_UserHangupCall
SIPCCMsg_Client_UserHangupCall::SIPCCMsg_Client_UserHangupCall()
{
	msgType = Type_Client_UserHangupCall;
	userName = NULL;
	userNameLen = 0;
	theOtherParty = NULL;
	theOtherPartyLen = 0;
	bAgentAssigned = 0;
	
	outDialType = OutDialType_Normal;

	toAcdOrUserState = -1; // [scq/2010-05-24]

	bIvrHangupCall = 0;

	netPath = "";
}

void SIPCCMsg_Client_UserHangupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_UserHangupCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//theOtherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theOtherPartyLen, THEOTHERPARTY_LEN, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//theOtherParty
	if ( !(VerifyTotalLen(theBufContent+theOtherPartyLen, msgsize, strMsg, "theOtherParty", ip, port, g_bIsACDServer)) ) {return;}
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//bAgentAssigned
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bAgentAssigned", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->bAgentAssigned, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if ( theBufContent >= msgsize )
	{
		return;
	}
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//bIvrHangupCall
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bIvrHangupCall", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->bIvrHangupCall, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

	if (theBufContent >= msgsize)
		return;

	//callID
	callID = thebuf + theBufContent;
	theBufContent += callID.length() + 1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1;
}

int SIPCCMsg_Client_UserHangupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	
	//bAgentAssigned
	memmove(thebuf+theBufContent, &this->bAgentAssigned, sizeof(char));
	theBufContent += sizeof(char);
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	//bIvrHangupCall
	memmove(thebuf+theBufContent, &this->bIvrHangupCall, sizeof(char));
	theBufContent += sizeof(char);

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	//callID
	memcpy(thebuf + theBufContent, callID.c_str(), callID.length() + 1);
	theBufContent += callID.length() + 1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_UserHangupCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	memSize += sizeof(char);			//bAgentAssigned
	
	memSize += sizeof(int);

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	memSize += sizeof(char);			//bIvrHangupCall

	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId
	memSize += callID.length() + 1;			//callID

	memSize += netPath.length()+1;			//netPath
	
	return memSize;
}

void SIPCCMsg_Client_UserHangupCall::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_UserHangupCall::SetTheOtherParty(string oppname)
{
	int iTheOtherPartyLen = oppname.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, oppname.c_str(), iTheOtherPartyLen);
}

///Type_Client_AgentLogin	
SIPCCMsg_Client_AgentLogin::SIPCCMsg_Client_AgentLogin()
{
	msgType = Type_Client_AgentLogin;
	agentID = NULL;
	agentIDLen = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
	
	lanIP = 0;
	lanMainSockPort = 0;
	
	natType = NatType_Unknown;
	
	loginType = LoginType_OnlyWeb;
	
	iLoginSuccMode = 0;

	extNo = "";

	SkillGroupID = "";

	HaveHBtoACD = 1;
}

void SIPCCMsg_Client_AgentLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentLogin";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	//natType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "natType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//lanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "lanIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "lanMainSockPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->lanMainSockPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);	

	if(theBufContent == msgsize)
		return;

	//loginType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "loginType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->loginType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//agentPhoneNo
	agentPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentPhoneNo.length()+1, msgsize, strMsg, "agentPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentPhoneNo.length(), AGENTPHONENO_LEN, strMsg, "agentPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentPhoneNo.length() + 1;

	if(theBufContent == msgsize)
		return;

	//nickName
	nickName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickName.length()+1, msgsize, strMsg, "nickName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(nickName.length(), NICKNAME_LEN, strMsg, "nickName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += nickName.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "iNeedDisposal", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->iNeedDisposal, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	memmove(&this->iLoginSuccMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

	if(theBufContent == msgsize)
		return;

	//extNo
	extNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extNo.length()+1, msgsize, strMsg, "extNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(extNo.length(), NICKNAME_LEN, strMsg, "extNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += extNo.length()+1;

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += SkillGroupID.length()+1;

	if(theBufContent == msgsize)
		return;

	//HaveHBtoACD
	memmove(&this->HaveHBtoACD, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
}

int SIPCCMsg_Client_AgentLogin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	
	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanMainSockPort
	memmove(thebuf+theBufContent, &this->lanMainSockPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//loginType
	memmove(thebuf+theBufContent, &this->loginType, sizeof(int));
	theBufContent += sizeof(int);
	
	//agentPhoneNo
	memmove( thebuf + theBufContent, agentPhoneNo.c_str(), agentPhoneNo.length() + 1 );
	theBufContent += agentPhoneNo.length() + 1;
	
	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length() + 1 );
	theBufContent += ( nickName.length() + 1 );

	//iNeedDisposal
	memmove(thebuf+theBufContent, &this->iNeedDisposal, sizeof(int));
	theBufContent += sizeof(int);

	//iLoginSuccMode
	memmove(thebuf+theBufContent, &this->iLoginSuccMode, sizeof(int));
	theBufContent += sizeof(int); 

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	//extNo
	memcpy(thebuf+theBufContent, extNo.c_str(), extNo.length() + 1 );
	theBufContent += ( extNo.length() + 1 );

	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );

	//HaveHBtoACD
	memmove(thebuf+theBufContent, &this->HaveHBtoACD, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//natType
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(unsigned short);	//lanMainSockPort
	memSize += sizeof(int);				//loginType
	memSize += agentPhoneNo.length() + 1;				//agentPhoneNo
	memSize += nickName.length()+1;
	memSize += sizeof(int);				//iNeedDisposal
	memSize += sizeof(int);				//iLoginSuccMode

	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	memSize += extNo.length()+1;			//extNo

	memSize += SkillGroupID.length()+1;		//SkillGroupID
	
	memSize += sizeof(int);				//HaveHBtoACD
	
	return memSize;
}

void SIPCCMsg_Client_AgentLogin::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentLogin::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

///Type_Client_AgentLogout
SIPCCMsg_Client_AgentLogout::SIPCCMsg_Client_AgentLogout()
{
	msgType = Type_Client_AgentLogout;
	agentID = NULL;
	agentIDLen = 0;
	loginType = LoginType_OnlyWeb;
} 

void SIPCCMsg_Client_AgentLogout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentLogout";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	if(theBufContent == msgsize)
		return;

	//loginType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "loginType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->loginType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Client_AgentLogout::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//loginType
	memmove(thebuf+theBufContent, &this->loginType, sizeof(int));
	theBufContent += sizeof(int);

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentLogout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);	

	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

void SIPCCMsg_Client_AgentLogout::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

// [scq/start/2010-04-23] 
// Type_Client_AgentLogoutDeparts
SIPCCMsg_Client_AgentLogoutDeparts::SIPCCMsg_Client_AgentLogoutDeparts()
{
	msgType = Type_Client_AgentLogoutDeparts;
	agentID = NULL;
	agentIDLen = 0;
	loginType = LoginType_OnlyWeb;
	theDepartment = NULL;
	theDepartmentLen = 0;
}

void SIPCCMsg_Client_AgentLogoutDeparts::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentLogoutDeparts";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	if(theBufContent == msgsize)
		return;

	//loginType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "loginType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->loginType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_AgentLogoutDeparts::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;

	//loginType
	memmove(thebuf+theBufContent, &this->loginType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Client_AgentLogoutDeparts::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//loginType

	return memSize;
}

void SIPCCMsg_Client_AgentLogoutDeparts::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentLogoutDeparts::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}
// [scq/end/2010-04-23]

///Type_Client_AgentPark
SIPCCMsg_Client_AgentPark::SIPCCMsg_Client_AgentPark()
{
	msgType = Type_Client_AgentPark;
	agentID = NULL;
	agentIDLen = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
}

void SIPCCMsg_Client_AgentPark::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentPark";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;
}

int SIPCCMsg_Client_AgentPark::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentPark::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	
	return memSize;
}

void SIPCCMsg_Client_AgentPark::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentPark::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

///Type_Client_AgentUnPark
SIPCCMsg_Client_AgentUnPark::SIPCCMsg_Client_AgentUnPark()
{
	msgType = Type_Client_AgentUnPark;
	agentID = NULL;
	agentIDLen = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
}

void SIPCCMsg_Client_AgentUnPark::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentUnPark";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;
}

int SIPCCMsg_Client_AgentUnPark::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentUnPark::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	
	return memSize;
}

void SIPCCMsg_Client_AgentUnPark::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentUnPark::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

CAudioStreamDescription::item_type & CAudioStreamDescription::operator[] (size_type n)
{
    return streamAttributes[n];
}

CAudioStreamDescription::size_type CAudioStreamDescription::size() const
{
    return streamAttributes.size();
}

void CAudioStreamDescription::push_back (const item_type& val)
{
    streamAttributes.push_back(val);
}

void CAudioStreamDescription::clear()
{
    streamAttributes.clear();
}

bool CAudioStreamDescription::empty()
{
    return streamAttributes.empty();
}

CAudioStreamDescription::value_type CAudioStreamDescription::getFirst(const key_type & key)
{
    for(size_t i=0; i<streamAttributes.size(); i++)
    {
        if (key == streamAttributes[i].first)
        {
            return streamAttributes[i].second;
        }
    }
    return value_type();
}

void CAudioStreamDescription::getAll(const key_type & key, vector<value_type> &values)
{
    for(size_t i=0; i<streamAttributes.size(); i++)
    {
        if (key == streamAttributes[i].first)
        {
            values.push_back(streamAttributes[i].second);
        }
    }
}

int CAudioStreamDescription::GetMemSize()
{
    int ret = sizeof(int);
    for(size_t i=0; i<streamAttributes.size(); i++)
    {
        ret += streamAttributes[i].first.size() + streamAttributes[i].second.size() + 2;
    }
    return ret;
}

int CAudioStreamDescription::Serialize(char* thebuf, int bufSize)
{
    if (bufSize < sizeof(int))
        return -1;
    *(int*)thebuf = htonl(streamAttributes.size());

    char* last = thebuf + sizeof(int);
    for(size_t i=0; i<streamAttributes.size(); i++)
    {
        if (streamAttributes[i].first.size()+1 > (bufSize-(last-thebuf)))
            return -1;
        memcpy(last, streamAttributes[i].first.c_str(), streamAttributes[i].first.length() + 1 );
        last += streamAttributes[i].first.length()+1;

        if (streamAttributes[i].second.size()+1 > (bufSize-(last-thebuf)))
            return -1;
        memcpy(last, streamAttributes[i].second.c_str(), streamAttributes[i].second.length() + 1 );
        last += streamAttributes[i].second.length()+1;
    }

    return last - thebuf;
}

int CAudioStreamDescription::Deserialize(char* thebuf, int bufSize)
{
    if (bufSize < 4)
        return -1;
    int item_count = ntohl(*(int*)thebuf);

    char* last = thebuf + sizeof(int);
    for (int i=0; i<item_count; i++)
    {
        char* name = last;
        char* value = name + strlen(name) + 1;
        last = value + strlen(value) + 1;
        if (last > thebuf + bufSize)
        {
            streamAttributes.clear();
            return -1;
        }
        streamAttributes.push_back(make_pair(name, value));
    }

    return last - thebuf;
}

string CAudioStreamDescription::to_str()
{
    ostringstream oss;
    oss << "[";
    for (iterator it=streamAttributes.begin(); it != streamAttributes.end(); it++)
    {
        oss << it->first << "=" << it->second << ",";
    }
    oss << "]";
    string str = oss.str();
    if (str.length() > 2)
    {
        str.erase(str.length()-2, 1);
    }
    return str;
}

///Type_Client_AgentMakeCall
SIPCCMsg_Client_AgentMakeCall::SIPCCMsg_Client_AgentMakeCall()
{
	msgType = Type_Client_AgentMakeCall;
	callID = NULL;
	callIDLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";
	
	uuiData2 = "";
	
	outdialPrefixNo = "";
	originalData = "";

	sipBoardIP = 0;
	sipBoardRtpPort = 0;
	sipBoardRtcpPort = 0;
    sipTransIP = 0;   //中转IP
    sipTransRtpPort = 0;  //中转RtpPort
    sipTransRtcpPort = 0;  //中转rtcpPort

	sipAgentPhoneIP1 = 0;   	//主叫座席端话机IP
	sipAgentPhoneRtpPort1 = 0;  //主叫座席端话机RtpPort
	sipAgentPhoneRtcpPort1 = 0; //主叫座席端话机rtcpPort

	operatorsInfo = "";

	toAcdOrUserState = -1;
}

void SIPCCMsg_Client_AgentMakeCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentMakeCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, strMsg, "callIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, strMsg, "callID", ip, port, g_bIsACDServer)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//targetType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "targetType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

	//targetPositionLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "targetPositionLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetPositionLen, TARGETPOSITION_LEN, strMsg, "targetPositionLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//targetPosition
	if ( !(VerifyTotalLen(theBufContent+targetPositionLen, msgsize, strMsg, "targetPosition", ip, port, g_bIsACDServer, agentID)) ) {return;}
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;

	//uuiDataLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "uuiDataLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(uuiDataLen, UUIDATA_LEN, strMsg, "uuiDataLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//uuiData
	if ( !(VerifyTotalLen(theBufContent+uuiDataLen, msgsize, strMsg, "uuiData", ip, port, g_bIsACDServer, agentID)) ) {return;}
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;

	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "corporationNameLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, strMsg, "corporationNameLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, strMsg, "corporationName", ip, port, g_bIsACDServer, agentID)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	if(theBufContent == msgsize)
		return;

	callerNoForSend = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerNoForSend.length()+1, msgsize, strMsg, "callerNoForSend.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(callerNoForSend.length(), CALLERNOFORSEND_LEN, strMsg, "callerNoForSend", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += callerNoForSend.length()+1;

	if(theBufContent == msgsize)
		return;

	//curVersion
	curVersion = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+curVersion.length()+1, msgsize, strMsg, "curVersion.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(curVersion.length(), CURVERSION_LEN, strMsg, "curVersion", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += curVersion.length()+1;

	if(theBufContent == msgsize)
		return;

	userLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userLineNo.length()+1, msgsize, strMsg, "userLineNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(userLineNo.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += ( userLineNo.length() + 1 );

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "userLineIp", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "userLinePort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(theBufContent == msgsize)
		return;

	wpAgentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+wpAgentID.length()+1, msgsize, strMsg, "wpAgentID.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(wpAgentID.length(), AGENTID_LEN, strMsg, "wpAgentID", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += ( wpAgentID.length() + 1 );

	if(theBufContent == msgsize)
		return;

	uuiData2 = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+uuiData2.length()+1, msgsize, strMsg, "uuiData2.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(uuiData2.length(), UUIDATA_LEN, strMsg, "uuiData2", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += ( uuiData2.length() + 1 );

	if(theBufContent == msgsize)
		return;

	outdialPrefixNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+outdialPrefixNo.length()+1, msgsize, strMsg, "outdialPrefixNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(outdialPrefixNo.length(), OUTDIALPREFIXNO_LEN, strMsg, "outdialPrefixNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += ( outdialPrefixNo.length() + 1 );

	if(theBufContent == msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipBoardIP", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipBoardIP, thebuf+theBufContent, sizeof(sipBoardIP));
	theBufContent += sizeof(sipBoardIP);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipBoardRtpPort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipBoardRtpPort, thebuf+theBufContent, sizeof(sipBoardRtpPort));
	theBufContent += sizeof(sipBoardRtpPort);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipBoardRtcpPort", ip, port, g_bIsACDServer,agentID)) ) {return;}
	memmove(&sipBoardRtcpPort, thebuf+theBufContent, sizeof(sipBoardRtcpPort));
	theBufContent += sizeof(sipBoardRtcpPort);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipTransIP", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipTransIP, thebuf+theBufContent, sizeof(sipTransIP));
	theBufContent += sizeof(sipTransIP);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipTransRtpPort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipTransRtpPort, thebuf+theBufContent, sizeof(sipTransRtpPort));
	theBufContent += sizeof(sipTransRtpPort);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipTransRtcpPort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipTransRtcpPort, thebuf+theBufContent, sizeof(sipTransRtcpPort));
	theBufContent += sizeof(sipTransRtcpPort);

	//sipAgentPhoneIP1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipAgentPhoneIP1", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipAgentPhoneIP1,thebuf+theBufContent,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//sipAgentPhoneRtpPort1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipAgentPhoneRtpPort1", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipAgentPhoneRtpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipAgentPhoneRtcpPort1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipAgentPhoneRtcpPort1", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipAgentPhoneRtcpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// 开始 [2/23/2009 lixg]
	if(theBufContent == msgsize)
		return;

	// agentUUIData
	if ( !(VerifyTotalLen(theBufContent+sizeof(BYTE), msgsize, strMsg, "byAgentUUIDataLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	BYTE byAgentUUIDataLen = 0;
	memmove(&byAgentUUIDataLen,thebuf+theBufContent,sizeof(BYTE));
	theBufContent += sizeof(BYTE);
	if ( !(VerifyData(byAgentUUIDataLen, UUIDATA_LEN, strMsg, "byAgentUUIDataLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	char acAgentUUIData[sizeof(BYTE)] = {0};
	memmove(acAgentUUIData,thebuf+theBufContent, byAgentUUIDataLen);
	theBufContent += byAgentUUIDataLen;
	acAgentUUIData[sizeof(BYTE)-1] = 0;
	agentUUIData = acAgentUUIData;
	if ( !(VerifyTotalLen(theBufContent+byAgentUUIDataLen, msgsize, strMsg, "agentUUIData", ip, port, g_bIsACDServer, agentID)) ) {return;}
	// 结束 [2/23/2009 lixg]

	if(theBufContent == msgsize)
		return;

	//originalData
	originalData = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+originalData.length()+1, msgsize, strMsg, "originalData.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(originalData.length(), ORIGINALDATA_LEN, strMsg, "originalData", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += ( originalData.length() + 1 );

	if(theBufContent == msgsize)
		return;

	//comSymbol
	comSymbol = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+comSymbol.length()+1, msgsize, strMsg, "comSymbol.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(comSymbol.length(), COMSYMBOL_LEN, strMsg, "comSymbol", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += ( comSymbol.length() + 1 );

	// [scq/start/2010-06-02]
	// toAcdOrUserState
	if(theBufContent == msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-06-02]

	if(theBufContent == msgsize)
		return;

	//operatorsInfo
	operatorsInfo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+operatorsInfo.length()+1, msgsize, strMsg, "operatorsInfo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(operatorsInfo.length(), COMSYMBOL_LEN, strMsg, "operatorsInfo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += ( operatorsInfo.length() + 1 );

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_Client_AgentMakeCall::FillBuf(char*& thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length() + 1 );
	theBufContent += ( userLineNo.length() + 1 );
	
	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length() + 1 );
	theBufContent += ( wpAgentID.length() + 1 );
	
	memcpy(thebuf+theBufContent, uuiData2.c_str(), uuiData2.length() + 1 );
	theBufContent += ( uuiData2.length() + 1 );
	
	memcpy(thebuf+theBufContent, outdialPrefixNo.c_str(), outdialPrefixNo.length() + 1 );
	theBufContent += ( outdialPrefixNo.length() + 1 );
	
	memcpy(thebuf+theBufContent, &sipBoardIP, sizeof(sipBoardIP));
	theBufContent += sizeof(sipBoardIP);

	memcpy(thebuf+theBufContent, &sipBoardRtpPort, sizeof(sipBoardRtpPort));
	theBufContent += sizeof(sipBoardRtpPort);

	memcpy(thebuf+theBufContent, &sipBoardRtcpPort, sizeof(sipBoardRtcpPort));
	theBufContent += sizeof(sipBoardRtcpPort);

	memcpy(thebuf+theBufContent, &sipTransIP, sizeof(sipTransIP));
	theBufContent += sizeof(sipTransIP);

	memcpy(thebuf+theBufContent, &sipTransRtpPort, sizeof(sipTransRtpPort));
	theBufContent += sizeof(sipTransRtpPort);

	memcpy(thebuf+theBufContent, &sipTransRtcpPort, sizeof(sipTransRtcpPort));
	theBufContent += sizeof(sipTransRtcpPort);

	//sipAgentPhoneIP1
	memmove(thebuf+theBufContent,&sipAgentPhoneIP1,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//sipAgentPhoneRtpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//sipAgentPhoneRtcpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtcpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// 开始 [2/23/2009 lixg]
	// agentUUIDataLen
	BYTE agentUUIDataLen = agentUUIData.size();
	memmove(thebuf+theBufContent, &agentUUIDataLen, sizeof(BYTE));
	theBufContent += sizeof(BYTE);
	// agentUUIData
	memmove(thebuf+theBufContent, agentUUIData.c_str(), agentUUIData.size());
	theBufContent += agentUUIData.size();
	// 结束 [2/23/2009 lixg]

	//originalData
	memmove(thebuf+theBufContent, originalData.c_str(), originalData.length()+1);
	theBufContent += originalData.length()+1;

	//comSymbol
	memmove(thebuf+theBufContent, comSymbol.c_str(), comSymbol.length()+1);
	theBufContent += comSymbol.length()+1;

	// [scq/start/2010-06-02]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-06-02]

	//operatorsInfo
	memmove(thebuf+theBufContent, operatorsInfo.c_str(), operatorsInfo.length()+1);
	theBufContent += operatorsInfo.length()+1;

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

    theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_Client_AgentMakeCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//agentIDLen
	memSize += this->agentIDLen;			//agentID
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	
	memSize += userLineNo.length() + 1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	
	memSize += wpAgentID.length() + 1;
	
	memSize += uuiData2.length() + 1;
	memSize += outdialPrefixNo.length() + 1;

	memSize += sizeof(sipBoardIP);   //交换机ip板IP
	memSize += sizeof(sipBoardRtpPort);  //交换机ip板RtpPort
	memSize += sizeof(sipBoardRtcpPort);  //交换机ip板rtcpPort
	memSize += sizeof(sipTransIP);   //中转IP
	memSize += sizeof(sipTransRtpPort);  //中转RtpPort
	memSize += sizeof(sipTransRtcpPort);  //中转rtcpPort

	memSize += sizeof(unsigned long);	//sipAgentPhoneIP1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtpPort1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtcpPort1

	//  [2/23/2009 lixg]
	memSize += sizeof(BYTE);			// agentUUIDataLen
	memSize += agentUUIData.size();		// agentUUIData

	memSize += originalData.length() + 1;	//originalData

	memSize += comSymbol.length() + 1;	//originalData

	memSize += sizeof(int);					// [scq/2010-06-02] toAcdOrUserState

	memSize += operatorsInfo.length()+1;	//operatorsInfo

	memSize += managerId.length()+1;		//managerId

    memSize += audioStreamDescription.GetMemSize();

	return memSize;
}	



void SIPCCMsg_Client_AgentMakeCall::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_Client_AgentMakeCall::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentMakeCall::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_Client_AgentMakeCall::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_Client_AgentMakeCall::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_Client_AgentMakeCall2
SIPCCMsg_Client_AgentMakeCall2::SIPCCMsg_Client_AgentMakeCall2()
{
	msgType = Type_Client_AgentMakeCall2;
	callID = NULL;
	callIDLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";
	invokeID = "";
	usableTime = 0;
	
	lanIp = 0;
	
	calledOperType = WpAgentLineOperType_None;

	callTransID = "";

	extPhoneNo = "";
	recordFilePath = "";

	LowLevelPrefixNo = "";

	nickName = "";

	RecordMode = 0;

	the2nd_dial_valid = false;
	the2nd_dial_digit = "";
	the3rd_media_valid = false;//
	the3rd_media_address = "";
	the3rd_media_port = 0;

	token = "";
}

void SIPCCMsg_Client_AgentMakeCall2::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "MsgHead", ip, port)) ) {return;}

	int theBufContent = AnalyzeMsgHead(thebuf);

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "callIDLen", ip, port)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, "SIPCCMsg_Client_AgentMakeCall2", "callIDLen", ip, port)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "callID", ip, port)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "agentIDLen", ip, port)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, "SIPCCMsg_Client_AgentMakeCall2", "agentIDLen", ip, port)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "agentID", ip, port)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//targetType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "targetType", ip, port)) ) {return;}
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

	//targetPositionLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "targetPositionLen", ip, port)) ) {return;}
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetPositionLen, TARGETPOSITION_LEN, "SIPCCMsg_Client_AgentMakeCall2", "targetPositionLen", ip, port)) ) {return;}

	//targetPosition
	if ( !(VerifyTotalLen(theBufContent+targetPositionLen, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "targetPosition", ip, port)) ) {return;}
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;

	//uuiDataLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "uuiDataLen", ip, port)) ) {return;}
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(uuiDataLen, UUIDATA_LEN, "SIPCCMsg_Client_AgentMakeCall2", "uuiDataLen", ip, port)) ) {return;}

	//uuiData
	if ( !(VerifyTotalLen(theBufContent+uuiDataLen, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "uuiData", ip, port)) ) {return;}
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;

	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, "SIPCCMsg_Client_AgentMakeCall2", "corporationNameLen", ip, port)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	callerNoForSend = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerNoForSend.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "callerNoForSend.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerNoForSend.length(), CALLERNOFORSEND_LEN, "SIPCCMsg_Client_AgentMakeCall2", "callerNoForSend", ip, port)) ) {return;}
	theBufContent += callerNoForSend.length()+1;

	//curVersion
	curVersion = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+curVersion.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "curVersion.length()", ip, port)) ) {return;}
	if ( !(VerifyData(curVersion.length(), CURVERSION_LEN, "SIPCCMsg_Client_AgentMakeCall2", "curVersion", ip, port)) ) {return;}
	theBufContent += curVersion.length()+1;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "invokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, "SIPCCMsg_Client_AgentMakeCall2", "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length()+1;

	//usableTime
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "usableTime", ip, port)) ) {return;}
	memmove(&this->usableTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

	if(theBufContent >= msgsize)
		return;

	//lanIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "lanIp", ip, port)) ) {return;}
	memmove(&this->lanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);	

	if(theBufContent >= msgsize)
		return;

	//calledOperType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "calledOperType", ip, port)) ) {return;}
	memmove(&this->calledOperType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

	if ( theBufContent >= msgsize)
	{
		return;
	}

	wpAgentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+wpAgentID.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "wpAgentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(wpAgentID.length(), AGENTID_LEN, "SIPCCMsg_Client_AgentMakeCall2", "wpAgentID", ip, port)) ) {return;}
	theBufContent += wpAgentID.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	callTransID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callTransID.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "callTransID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callTransID.length(), CALLTRANSID_LEN, "SIPCCMsg_Client_AgentMakeCall2", "callTransID", ip, port)) ) {return;}
	theBufContent += callTransID.length()+1;

	if(theBufContent >= msgsize)
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "managerId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, "SIPCCMsg_Client_AgentMakeCall2", "managerId", ip, port)) ) {return;}
	theBufContent += managerId.length()+1;

	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "corpName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, "SIPCCMsg_Client_AgentMakeCall2", "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;

	if(theBufContent >= msgsize)
		return;

	extPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extPhoneNo.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "extPhoneNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(extPhoneNo.length(), EXTPHONENO_LEN, "SIPCCMsg_Client_AgentMakeCall2", "extPhoneNo", ip, port)) ) {return;}
	theBufContent += extPhoneNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	recordFilePath = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+recordFilePath.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "recordFilePath.length()", ip, port)) ) {return;}
	if ( !(VerifyData(recordFilePath.length(), FULLPATHFILENAME_LEN, "SIPCCMsg_Client_AgentMakeCall2", "recordFilePath", ip, port)) ) {return;}
	theBufContent += recordFilePath.length()+1;

	if(theBufContent >= msgsize)
		return;

	LowLevelPrefixNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+LowLevelPrefixNo.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "LowLevelPrefixNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(LowLevelPrefixNo.length(), HEAD_LEN, "SIPCCMsg_Client_AgentMakeCall2", "LowLevelPrefixNo", ip, port)) ) {return;}
	theBufContent += LowLevelPrefixNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	nickName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickName.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "nickName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(nickName.length(), NICKNAME_LEN, "SIPCCMsg_Client_AgentMakeCall2", "nickName", ip, port)) ) {return;}
	theBufContent += nickName.length()+1;

	if(theBufContent >= msgsize)
		return;

	//RecordMode
	memmove(&this->RecordMode, thebuf+theBufContent, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//20121228
	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(bool), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "the2nd_dial_valid", ip, port)) ) {return;}
	memmove(&this->the2nd_dial_valid, thebuf+theBufContent,sizeof(bool));
	theBufContent += sizeof(bool);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+the2nd_dial_digit.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "the2nd_dial_digit.length()", ip, port)) ) {return;}
	this->the2nd_dial_digit = thebuf+theBufContent;
	theBufContent += the2nd_dial_digit.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(bool), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "the3rd_media_valid", ip, port)) ) {return;}
	memmove(&(this->the3rd_media_valid), thebuf+theBufContent,sizeof(bool));
	theBufContent += sizeof(bool);

	if(theBufContent>=msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+the3rd_media_address.length()+1, msgsize, "SIPCCMsg_Client_AgentMakeCall2", "the3rd_media_address.length()", ip, port)) ) {return;}
	the3rd_media_address = thebuf+theBufContent;
	theBufContent += the3rd_media_address.length()+1;

	if(theBufContent>=msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_Client_AgentMakeCall2", "the3rd_media_port", ip, port)) ) {return;}
	memmove(&(this->the3rd_media_port),thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);

	if(theBufContent >= msgsize)
		return;

	//token
	token = thebuf + theBufContent;
	theBufContent += token.length()+1;
}

int SIPCCMsg_Client_AgentMakeCall2::FillBuf(char*& thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	//usableTime
	memmove(thebuf+theBufContent, &this->usableTime, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIp
	memmove(thebuf+theBufContent, &this->lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &calledOperType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;

	memmove(thebuf+theBufContent, callTransID.c_str(), callTransID.length()+1);
	theBufContent += callTransID.length()+1;

	memcpy( thebuf + theBufContent, managerId.c_str(), managerId.length() + 1 );
	theBufContent += managerId.length() + 1;

	memcpy( thebuf + theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += corpName.length() + 1;

	memcpy( thebuf + theBufContent, extPhoneNo.c_str(), extPhoneNo.length() + 1 );
	theBufContent += extPhoneNo.length() + 1;

	memcpy( thebuf + theBufContent, recordFilePath.c_str(), recordFilePath.length() + 1 );
	theBufContent += recordFilePath.length() + 1;

	memcpy( thebuf + theBufContent, LowLevelPrefixNo.c_str(), LowLevelPrefixNo.length() + 1 );
	theBufContent += LowLevelPrefixNo.length() + 1;
	
	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length()+1);
	theBufContent += nickName.length()+1;

	//RecordMode
	memmove(thebuf+theBufContent, &this->RecordMode, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//20121128
	memmove(thebuf+theBufContent, &this->the2nd_dial_valid, sizeof(bool));
	theBufContent += sizeof(bool);

	memcpy(thebuf+theBufContent, the2nd_dial_digit.c_str(),the2nd_dial_digit.length()+1);
	theBufContent += the2nd_dial_digit.length()+1;

	memmove(thebuf+theBufContent, &this->the3rd_media_valid, sizeof(bool));
	theBufContent += sizeof(bool);

	memcpy(thebuf+theBufContent, the3rd_media_address.c_str(),the3rd_media_address.length()+1);
	theBufContent += the3rd_media_address.length()+1;

	memmove(thebuf+theBufContent, &this->the3rd_media_port,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	//token
	memcpy(thebuf+theBufContent, token.c_str(), token.length()+1);
	theBufContent += token.length()+1;

    return theBufContent;
}

int SIPCCMsg_Client_AgentMakeCall2::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//agentIDLen
	memSize += this->agentIDLen;			//agentID
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	memSize += invokeID.length()+1;			//invokeID
	
	memSize += sizeof(int);					//usableTime
	
	memSize += sizeof(unsigned long);					//lanIp
	memSize += sizeof(int);
	
	memSize += wpAgentID.length()+1;
	memSize += callTransID.length()+1;		//callTransID
	memSize += managerId.length() + 1;
	memSize += corpName.length() + 1;
	memSize += extPhoneNo.length() + 1;
	memSize += recordFilePath.length() + 1;
	memSize += LowLevelPrefixNo.length() + 1;
	
	memSize += nickName.length()+1;		//nickName

	memSize += sizeof(RecordMode);		//RecordMode

	memSize += sizeof(bool);//20121128
	memSize += the2nd_dial_digit.length()+1;
	memSize += sizeof(bool);
	memSize += the3rd_media_address.length()+1;
	memSize += sizeof(unsigned short);

	memSize += audioStreamDescription.GetMemSize();

	memSize += token.length()+1;		//token

    return memSize;
}

void SIPCCMsg_Client_AgentMakeCall2::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_Client_AgentMakeCall2::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentMakeCall2::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_Client_AgentMakeCall2::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_Client_AgentMakeCall2::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_Client_UserMakeCallPSTN
SIPCCMsg_Client_UserMakeCallPSTN::SIPCCMsg_Client_UserMakeCallPSTN()
{
	msgType = Type_Client_UserMakeCallPSTN;
	callID = NULL;
	callIDLen = 0;
	userName = NULL;
	userNameLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";
}

void SIPCCMsg_Client_UserMakeCallPSTN::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "callIDLen", ip, port)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, "SIPCCMsg_Client_UserMakeCallPSTN", "callIDLen", ip, port)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "callID", ip, port)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "userNameLen", ip, port)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, "SIPCCMsg_Client_UserMakeCallPSTN", "userNameLen", ip, port)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "userName", ip, port)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//targetType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "targetType", ip, port)) ) {return;}
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

	//targetPositionLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "targetPositionLen", ip, port)) ) {return;}
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetPositionLen, TARGETPOSITION_LEN, "SIPCCMsg_Client_UserMakeCallPSTN", "targetPositionLen", ip, port)) ) {return;}

	//targetPosition
	if ( !(VerifyTotalLen(theBufContent+targetPositionLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "targetPosition", ip, port)) ) {return;}
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;

	//uuiDataLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "uuiDataLen", ip, port)) ) {return;}
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(uuiDataLen, UUIDATA_LEN, "SIPCCMsg_Client_UserMakeCallPSTN", "uuiDataLen", ip, port)) ) {return;}

	//uuiData
	if ( !(VerifyTotalLen(theBufContent+uuiDataLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "uuiData", ip, port)) ) {return;}
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;

	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, "SIPCCMsg_Client_UserMakeCallPSTN", "corporationNameLen", ip, port)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	if(theBufContent == msgsize)
		return;

	callerNoForSend = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerNoForSend.length()+1, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "callerNoForSend.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerNoForSend.length(), CALLERNOFORSEND_LEN, "SIPCCMsg_Client_UserMakeCallPSTN", "callerNoForSend", ip, port)) ) {return;}
	theBufContent += callerNoForSend.length()+1;

	if(theBufContent == msgsize)
		return;

	//curVersion
	curVersion = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+curVersion.length()+1, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN", "curVersion.length()", ip, port)) ) {return;}
	if ( !(VerifyData(curVersion.length(), CURVERSION_LEN, "SIPCCMsg_Client_UserMakeCallPSTN", "curVersion", ip, port)) ) {return;}
	theBufContent += curVersion.length()+1;
}

int SIPCCMsg_Client_UserMakeCallPSTN::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_UserMakeCallPSTN::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//userNameLen
	memSize += this->userNameLen;			//userName
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	
	return memSize;
}

void SIPCCMsg_Client_UserMakeCallPSTN::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_Client_UserMakeCallPSTN::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_UserMakeCallPSTN::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_Client_UserMakeCallPSTN::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_Client_UserMakeCallPSTN::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}


///Type_Client_UserMakeCallPSTN2
SIPCCMsg_Client_UserMakeCallPSTN2::SIPCCMsg_Client_UserMakeCallPSTN2()
{
	msgType = Type_Client_UserMakeCallPSTN2;
	callID = NULL;
	callIDLen = 0;
	userName = NULL;
	userNameLen = 0;
	targetType = -1;
	targetPosition = NULL;
	targetPositionLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	
	callerNoForSend = "";
	curVersion = "";
	invokeID = "";
}

void SIPCCMsg_Client_UserMakeCallPSTN2::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "callIDLen", ip, port)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "callIDLen", ip, port)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "callID", ip, port)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "userNameLen", ip, port)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "userNameLen", ip, port)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "userName", ip, port)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//targetType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "targetType", ip, port)) ) {return;}
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

	//targetPositionLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "targetPositionLen", ip, port)) ) {return;}
	memmove(&this->targetPositionLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetPositionLen, TARGETPOSITION_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "targetPositionLen", ip, port)) ) {return;}

	//targetPosition
	if ( !(VerifyTotalLen(theBufContent+targetPositionLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "targetPosition", ip, port)) ) {return;}
	targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memmove(targetPosition, thebuf+theBufContent, targetPositionLen);
	theBufContent += targetPositionLen;

	//uuiDataLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "uuiDataLen", ip, port)) ) {return;}
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(uuiDataLen, UUIDATA_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "uuiDataLen", ip, port)) ) {return;}

	//uuiData
	if ( !(VerifyTotalLen(theBufContent+uuiDataLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "uuiData", ip, port)) ) {return;}
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;

	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "corporationNameLen", ip, port)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	if(theBufContent == msgsize)
		return;

	callerNoForSend = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerNoForSend.length()+1, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "callerNoForSend.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerNoForSend.length(), CALLERNOFORSEND_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "callerNoForSend", ip, port)) ) {return;}
	theBufContent += callerNoForSend.length()+1;

	if(theBufContent == msgsize)
		return;

	//curVersion
	curVersion = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+curVersion.length()+1, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "curVersion.length()", ip, port)) ) {return;}
	if ( !(VerifyData(curVersion.length(), CURVERSION_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "curVersion", ip, port)) ) {return;}
	theBufContent += curVersion.length()+1;

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, "SIPCCMsg_Client_UserMakeCallPSTN2", "invokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, "SIPCCMsg_Client_UserMakeCallPSTN2", "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_UserMakeCallPSTN2::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	//targetPositionLen
	memmove(thebuf+theBufContent, &this->targetPositionLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetPosition
	memmove(thebuf+theBufContent, this->targetPosition, this->targetPositionLen);
	theBufContent += targetPositionLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	
	//curVersion
	memmove(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_UserMakeCallPSTN2::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//userNameLen
	memSize += this->userNameLen;			//userName
	memSize += sizeof(int);					//targetType
	memSize += sizeof(int);					//targetPositionLen
	memSize += this->targetPositionLen;		//targetPosition
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += curVersion.length()+1;		//curVersion
	
	memSize += invokeID.length()+1;			//invokeID
	
	return memSize;
}

void SIPCCMsg_Client_UserMakeCallPSTN2::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_Client_UserMakeCallPSTN2::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_UserMakeCallPSTN2::SetTargetPosition(string targetposition)
{
	int iTargetPosition = targetposition.length();
	this->targetPositionLen = iTargetPosition + 1;
	this->targetPosition = new char[targetPositionLen];
	memset(targetPosition, 0, targetPositionLen);
	memcpy(targetPosition, targetposition.c_str(), iTargetPosition);
}

void SIPCCMsg_Client_UserMakeCallPSTN2::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_Client_UserMakeCallPSTN2::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_Client_AgentAnswerCall
SIPCCMsg_Client_AgentAnswerCall::SIPCCMsg_Client_AgentAnswerCall()
{
	msgType = Type_Client_AgentAnswerCall;
	agentID = NULL;
	agentIDLen = 0;
	theOtherParty = NULL;
	theOtherPartyLen = 0;
	theotherPartyType = CallParty_UnKnown;
	toAcdOrUserState = -1; // [scq/2010-05-21]
	callId = "";
	managerId = "";
	corpName = "";
	extPhoneNo = "";
	recordFilePath = "";

	RecordMode = 0;

	the3rd_media_valid = false;
	the3rd_media_address = "";
	the3rd_media_port = 0;

	token = "";
}

void SIPCCMsg_Client_AgentAnswerCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentAnswerCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "mediaType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//theOtherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theOtherPartyLen, THEOTHERPARTY_LEN, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//theOtherParty
	if ( !(VerifyTotalLen(theBufContent+theOtherPartyLen, msgsize, strMsg, "theOtherParty", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//theotherPartyType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theotherPartyType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->theotherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	callId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callId.length() + 1, msgsize, strMsg, "callId.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(callId.length(), CALLID_LEN, strMsg, "callId", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += callId.length() + 1;

	if(theBufContent >= msgsize)
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length() + 1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += managerId.length()+1;

	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length() + 1, msgsize, strMsg, "corpName.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsg, "corpName", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += corpName.length()+1;

	// [scq/start/2010-05-21]
	// toAcdOrUserState
	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]

	if ( theBufContent >= msgsize )
	{
		return;
	}

	// extPhoneNo
	extPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extPhoneNo.length() + 1, msgsize, strMsg, "extPhoneNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(extPhoneNo.length(), EXTPHONENO_LEN, strMsg, "extPhoneNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += extPhoneNo.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	// recordFilePath
	recordFilePath = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+recordFilePath.length() + 1, msgsize, strMsg, "recordFilePath.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(recordFilePath.length(), FULLPATHFILENAME_LEN, strMsg, "recordFilePath", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += recordFilePath.length()+1;

	if(theBufContent >= msgsize)
		return;

	//RecordMode
	memmove(&this->RecordMode, thebuf+theBufContent, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//20121128
	if(theBufContent>=msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(bool), msgsize, "SIPCCMsg_UState_CallAnswered", "the3rd_media_valid", ip, port)) ) {return;}
	memmove(&this->the3rd_media_valid,thebuf+theBufContent,sizeof(bool));
	theBufContent += sizeof(bool);

	if(theBufContent>=msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+the3rd_media_address.length()+1, msgsize, "SIPCCMsg_UState_CallAnswered", "the3rd_media_address.length()", ip, port)) ) {return;}
	the3rd_media_address = thebuf+theBufContent;
	theBufContent += the3rd_media_address.length()+1;

	if(theBufContent>=msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_UState_CallAnswered", "the3rd_media_port", ip, port)) ) {return;}
	memmove(&this->the3rd_media_port,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//token
	token = thebuf + theBufContent;
	theBufContent += token.length()+1;
}

int SIPCCMsg_Client_AgentAnswerCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	
	//theotherPartyType
	memmove(thebuf+theBufContent, &this->theotherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove( thebuf + theBufContent, callId.c_str(), callId.length() + 1 );
	theBufContent += callId.length() + 1;

	memcpy( thebuf + theBufContent, managerId.c_str(), managerId.length() + 1 );
	theBufContent += managerId.length() + 1;

	memcpy( thebuf + theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += corpName.length() + 1;

	// [scq/start/2010-05-21]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]
	
	memmove( thebuf + theBufContent, extPhoneNo.c_str(), extPhoneNo.length() + 1 );
	theBufContent += extPhoneNo.length() + 1;

	memmove( thebuf + theBufContent, recordFilePath.c_str(), recordFilePath.length() + 1 );
	theBufContent += recordFilePath.length() + 1;

	//RecordMode
	memmove(thebuf+theBufContent, &this->RecordMode, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//20121128
	memmove(thebuf+theBufContent, &this->the3rd_media_valid,sizeof(bool));
	theBufContent += sizeof(bool);

	memcpy(thebuf+theBufContent, this->the3rd_media_address.c_str(),the3rd_media_address.length()+1);
	theBufContent += the3rd_media_address.length()+1;

	memmove(thebuf+theBufContent, &this->the3rd_media_port,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//token
	memmove( thebuf + theBufContent, token.c_str(), token.length() + 1 );
	theBufContent += token.length() + 1;

	return theBufContent;
}

int SIPCCMsg_Client_AgentAnswerCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	memSize += sizeof(int);				//theotherPartyType
	memSize += callId.length() + 1;
	memSize += managerId.length() + 1;
	memSize += corpName.length() + 1;
	memSize += sizeof(int);				// [scq/2010-05-21] toAcdOrUserState
	memSize += extPhoneNo.length() + 1;
	memSize += recordFilePath.length() + 1;

	memSize += sizeof(RecordMode);		//RecordMode

	memSize += sizeof(bool);//
	memSize += the3rd_media_address.length()+1;
	memSize += sizeof(unsigned short);

	memSize += token.length() + 1;		//token

	return memSize;
}

void SIPCCMsg_Client_AgentAnswerCall::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentAnswerCall::SetTheOtherParty(string theotherparty)
{
	int iTheOtherPartyLen = theotherparty.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, theotherparty.c_str(), iTheOtherPartyLen);
}

///Type_Client_AgentCallReceived
SIPCCMsg_Client_AgentCallReceived::SIPCCMsg_Client_AgentCallReceived()
{
	msgType = Type_Client_AgentCallReceived;
	agentID = NULL;
	agentIDLen = 0;
	theOtherParty = NULL;
	theOtherPartyLen = 0;

	sipAgentPhoneIP1 = 0;   	//主叫座席端话机IP
	sipAgentPhoneRtpPort1 = 0;  //主叫座席端话机RtpPort
	sipAgentPhoneRtcpPort1 = 0; //主叫座席端话机rtcpPort
	
	lanIp = 0;

	toAcdOrUserState = -1;		// [scq/2010-05-21]

	nickName = "";
}

void SIPCCMsg_Client_AgentCallReceived::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentCallReceived";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//theOtherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theOtherPartyLen, THEOTHERPARTY_LEN, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//theOtherParty
	if ( !(VerifyTotalLen(theBufContent+theOtherPartyLen, msgsize, strMsg, "theOtherParty", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	if(theBufContent >= msgsize)
		return;

	//lanIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "lanIp", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->lanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);	

	if(theBufContent >= msgsize)
		return;

	agentExtNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentExtNo.length()+1, msgsize, strMsg, "agentExtNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(agentExtNo.length(), AGENTEXTNO_LEN, strMsg, "agentExtNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += agentExtNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	//sipAgentPhoneIP1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipAgentPhoneIP1", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipAgentPhoneIP1,thebuf+theBufContent,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//sipAgentPhoneRtpPort1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipAgentPhoneRtpPort1", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipAgentPhoneRtpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//sipAgentPhoneRtcpPort1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipAgentPhoneRtcpPort1", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&sipAgentPhoneRtcpPort1,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// [scq/start/2010-05-21]
	// toAcdOrUserState
	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]

	if(theBufContent >= msgsize)
		return;

	nickName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickName.length()+1, msgsize, strMsg, "nickName.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(nickName.length(), NICKNAME_LEN, strMsg, "nickName", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += nickName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_Client_AgentCallReceived::FillBuf(char*&  thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	
	//lanIp
	memmove(thebuf+theBufContent, &this->lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(thebuf+theBufContent, agentExtNo.c_str(), agentExtNo.length()+1);
	theBufContent += agentExtNo.length()+1;

	//sipAgentPhoneIP1
	memmove(thebuf+theBufContent,&sipAgentPhoneIP1,sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//sipAgentPhoneRtpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//sipAgentPhoneRtcpPort1
	memmove(thebuf+theBufContent,&sipAgentPhoneRtcpPort1,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// [scq/start/2010-05-21]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]
	
	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length()+1);
	theBufContent += nickName.length()+1;

    theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_Client_AgentCallReceived::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	
	memSize += sizeof(unsigned long);					//lanIp
	
	memSize += agentExtNo.length()+1;

	memSize += sizeof(unsigned long);	//sipAgentPhoneIP1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtpPort1
	memSize += sizeof(unsigned short);	//sipAgentPhoneRtcpPort1

	memSize += sizeof(int);				// [scq/2010-05-21] toAcdOrUserState

	memSize += nickName.length()+1;		//nickName

    memSize += audioStreamDescription.GetMemSize();
	
	return memSize;
}

void SIPCCMsg_Client_AgentCallReceived::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentCallReceived::SetTheOtherParty(string oppname)
{
	int iTheOtherPartyLen = oppname.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, oppname.c_str(), iTheOtherPartyLen);
}

///Type_Client_AgentHangupCall
SIPCCMsg_Client_AgentHangupCall::SIPCCMsg_Client_AgentHangupCall()
{
	msgType = Type_Client_AgentHangupCall;
	theOtherParty = NULL;
	theOtherPartyLen = 0;
	agentID = NULL;
	agentIDLen = 0;
	callID = NULL;
	callIDLen = 0;
	agentJoinType = AgentJoin_UnKnown;
	bAgentAssigned = 0;
	toAcdOrUserState = -1;	// [scq/2010-05-21]
}

void SIPCCMsg_Client_AgentHangupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentHangupCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//theOtherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theOtherPartyLen, THEOTHERPARTY_LEN, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//theOtherParty
	if ( !(VerifyTotalLen(theBufContent+theOtherPartyLen, msgsize, strMsg, "theOtherParty", ip, port, g_bIsACDServer)) ) {return;}
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//agentJoinType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentJoinType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->agentJoinType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//bAgentAssigned
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bAgentAssigned", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->bAgentAssigned, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(msgsize == theBufContent)
		return;

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callIDLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, strMsg, "callIDLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, strMsg, "callID", ip, port, g_bIsACDServer, agentID)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	// [scq/start/2010-05-21] 
	// toAcdOrUserState
	if(msgsize == theBufContent)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]
}

int SIPCCMsg_Client_AgentHangupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//agentJoinType
	memmove(thebuf+theBufContent, &this->agentJoinType, sizeof(int));
	theBufContent += sizeof(int);
	//bAgentAssigned
	memmove(thebuf+theBufContent, &this->bAgentAssigned, sizeof(char));
	theBufContent += sizeof(char);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;

	// [scq/start/2010-05-21] 
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentHangupCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//agentJoinType
	memSize += sizeof(char);			//bAgentAssigned
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				// [scq/2010-05-21] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_AgentHangupCall::SetTheOtherParty(string oppname)
{
	int iTheOtherPartyLen = oppname.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, oppname.c_str(), iTheOtherPartyLen);
}

void SIPCCMsg_Client_AgentHangupCall::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Client_AgentHangupCall::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

///Type_Client_MediaRequest
SIPCCMsg_Client_MediaRequest::SIPCCMsg_Client_MediaRequest()
{
	msgType = Type_Client_MediaRequest;
	callID = NULL;
	callIDLen = 0;
	targetName = NULL;
	targetNameLen = 0;
	mediaType = -1;
	seq = 0;
	toAcdOrUserState = -1;	// [scq/2010-05-21]

	transmitServerIP = 0;
	transmitServerPort = 0;
	account = "";
	netPath = "";
}

void SIPCCMsg_Client_MediaRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_MediaRequest";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//mediaType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "mediaType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//seq
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "seq", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//保护
	if(theBufContent >= msgsize)
		return;

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, strMsg, "callIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, strMsg, "callID", ip, port, g_bIsACDServer)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//targetNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "targetNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->targetNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetNameLen, TARGETNAME_LEN, strMsg, "targetNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//targetName
	if ( !(VerifyTotalLen(theBufContent+targetNameLen, msgsize, strMsg, "targetName", ip, port, g_bIsACDServer)) ) {return;}
	targetName = new char[targetNameLen];
	memset(targetName, 0, targetNameLen);
	memmove(targetName, thebuf+theBufContent, targetNameLen);
	theBufContent += targetNameLen;

	// [scq/start/2010-05-21]
	// targetType
	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]

	if (theBufContent >= msgsize)
	{
		return;
	}

	this->account = thebuf + theBufContent;
	theBufContent += this->account.length() + 1;

	memmove(&this->transmitServerIP, thebuf + theBufContent, sizeof(transmitServerIP));
	theBufContent += sizeof(transmitServerIP);

	memmove(&this->transmitServerPort, thebuf + theBufContent, sizeof(transmitServerPort));
	theBufContent += sizeof(transmitServerPort);

	this->netPath = thebuf + theBufContent;
	theBufContent += this->netPath.length() + 1;
}

int SIPCCMsg_Client_MediaRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//mediaType
	memmove(thebuf+theBufContent, &this->mediaType, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//targetNameLen
	memmove(thebuf+theBufContent, &this->targetNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetName
	memmove(thebuf+theBufContent, this->targetName, this->targetNameLen);
	theBufContent += targetNameLen;

	// [scq/start/2010-05-21]
	// targetType
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]
	
	memmove(thebuf + theBufContent, this->account.c_str(), this->account.length() + 1);
	theBufContent += this->account.length() + 1;

	memmove(thebuf + theBufContent, &(this->transmitServerIP), sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf + theBufContent, &(this->transmitServerPort), sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf + theBufContent, this->netPath.c_str(), this->netPath.length() + 1);
	theBufContent += this->netPath.length() + 1;

	return theBufContent;
}

int SIPCCMsg_Client_MediaRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//mediaType
	memSize += sizeof(int);				//seq
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//targetNameLen
	memSize += this->targetNameLen;		//targetName
	memSize += sizeof(int);				// [scq/2010-05-21] targetType

	memSize += account.length()+1;		//account
	memSize += sizeof(unsigned long);	//transmitServerIP
	memSize += sizeof(unsigned short);	//transmitServerPort
	memSize += netPath.length() + 1;	//netPath
	
	return memSize;
}

void SIPCCMsg_Client_MediaRequest::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_Client_MediaRequest::SetTargetName(string targetname)
{
	int iTargetNameLen = targetname.length();
	this->targetNameLen = iTargetNameLen + 1;
	this->targetName = new char[targetNameLen];
	memset(targetName, 0, targetNameLen);
	memcpy(targetName, targetname.c_str(), iTargetNameLen);
}

///Type_Client_MediaRequestConf
SIPCCMsg_Client_MediaRequestConf::SIPCCMsg_Client_MediaRequestConf()
{
	msgType = Type_Client_MediaRequestConf;
	callID = NULL;
	callIDLen = 0;
	mediaType = -1;
}

void SIPCCMsg_Client_MediaRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_MediaRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(thebuf+theBufContent, &this->mediaType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Client_MediaRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//mediaType
	
	return memSize;
}

void SIPCCMsg_Client_MediaRequestConf::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

///Type_Client_TextChatWords
SIPCCMsg_Client_TextChatWords::SIPCCMsg_Client_TextChatWords()
{
	msgType = Type_Client_TextChatWords;
	chatWords = NULL;
	chatWordsLen = 0;
}

void SIPCCMsg_Client_TextChatWords::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//chatWordsLen
	memmove(&this->chatWordsLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//chatWords
	chatWords = new char[chatWordsLen];
	memset(chatWords, 0, chatWordsLen);
	memmove(chatWords, thebuf+theBufContent, chatWordsLen);
	theBufContent += chatWordsLen;
}

int SIPCCMsg_Client_TextChatWords::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//chatWordsLen
	memmove(thebuf+theBufContent, &this->chatWordsLen, sizeof(int));
	theBufContent += sizeof(int);
	//chatWords
	memmove(thebuf+theBufContent, this->chatWords, this->chatWordsLen);
	theBufContent += chatWordsLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_TextChatWords::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//chatWordsLen
	memSize += this->chatWordsLen;			//chatWords
	
	return memSize;
}

void SIPCCMsg_Client_TextChatWords::SetChatWords(string chatwords)
{
	int iChatWordsLen = chatwords.length();
	this->chatWordsLen = iChatWordsLen + 1;
	this->chatWords = new char[chatWordsLen];
	memset(chatWords, 0, chatWordsLen);
	memcpy(chatWords, chatwords.c_str(), iChatWordsLen);
}

///Type_Client_MediaReady
SIPCCMsg_Client_MediaReady::SIPCCMsg_Client_MediaReady()
{
	msgType = Type_Client_MediaReady;
	targetName = NULL;
	targetNameLen = 0;

	toAcdOrUserState = -1;	// [scq/2010-05-24]
}

void SIPCCMsg_Client_MediaReady::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_MediaReady", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent >= msgsize)
		return;

	//targetNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_MediaReady", "targetNameLen", ip, port)) ) {return;}
	memmove(&this->targetNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(targetNameLen, TARGETNAME_LEN, "SIPCCMsg_Client_MediaReady", "targetNameLen", ip, port)) ) {return;}

	//targetName
	if ( !(VerifyTotalLen(theBufContent+targetNameLen, msgsize, "SIPCCMsg_Client_MediaReady", "targetName", ip, port)) ) {return;}
	targetName = new char[targetNameLen];
	memset(targetName, 0, targetNameLen);
	memmove(targetName, thebuf+theBufContent, targetNameLen);
	theBufContent += targetNameLen;

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if(theBufContent >= msgsize)
		return;
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_MediaReady", "toAcdOrUserState", ip, port)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
}

int SIPCCMsg_Client_MediaReady::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//targetNameLen
	memmove(thebuf+theBufContent, &this->targetNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//targetName
	memmove(thebuf+theBufContent, this->targetName, this->targetNameLen);
	theBufContent += targetNameLen;

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	return theBufContent;
}

int SIPCCMsg_Client_MediaReady::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//targetNameLen
	memSize += this->targetNameLen;		//targetName

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_MediaReady::SetTargetName(string targetname)
{
	int iTargetNameLen = targetname.length();
	this->targetNameLen = iTargetNameLen + 1;
	this->targetName = new char[targetNameLen];
	memset(targetName, 0, targetNameLen);
	memcpy(targetName, targetname.c_str(), iTargetNameLen);
}

///Type_Client_GetCallingQueueInfo
SIPCCMsg_Client_GetCallingQueueInfo::SIPCCMsg_Client_GetCallingQueueInfo()
{
	msgType = Type_Client_GetCallingQueueInfo;
	theDepartment = NULL;
	theDepartmentLen = 0;
	userName = NULL;
	userNameLen = 0;
	invokeID = "";
}

void SIPCCMsg_Client_GetCallingQueueInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_GetCallingQueueInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	if (userNameLen < 0)
	{
		theDepartmentLen = 0;
		theDepartment = "";
		userNameLen = 0;
		userName = "";
/*#ifdef MAKEMSGLOG
		PushMsgLog("GetCallingQueueInfo", thebuf, msgsize);
		WriteMsgLog("GetCallingQueueInfo");
#endif*/
		return;
	}
	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_GetCallingQueueInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;

	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_GetCallingQueueInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += invokeID.length()+1;		//invokeID
	
	return memSize;
}

void SIPCCMsg_Client_GetCallingQueueInfo::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

void SIPCCMsg_Client_GetCallingQueueInfo::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_Client_AgentQueryState
SIPCCMsg_Client_AgentQueryState::SIPCCMsg_Client_AgentQueryState()
{
	msgType = Type_Client_AgentQueryState;
	agentID = NULL;
	agentIDLen = 0;
	agentState = Agent_NoLogin;
	parkReasonID = -1;
	parkReason = NULL;
	parkReasonLen = 0;
	comSymbol = "";
	newAgentPhoneNo = "";
	handleId="";		//操作唯一标识
}

void SIPCCMsg_Client_AgentQueryState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentQueryState";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( agentIDLen>=msgsize )
	{
		agentID = NULL;
		agentIDLen = 0;
		agentState = Agent_NoLogin;
		parkReasonID = -1;
		parkReason = NULL;
		parkReasonLen = 0;
		comSymbol = "";
		newAgentPhoneNo = "";
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;

	//agentState
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentState", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->agentState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//bPSTNCall
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bPSTNCall", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->bPSTNCall, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//bInnerCall
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bInnerCall", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->bInnerCall, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	if(theBufContent >= msgsize)
		return;	
	//parkReasonID
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "parkReasonID", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&parkReasonID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//parkReasonLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "parkReasonLen", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&parkReasonLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(parkReasonLen, PARKREASON_LEN, strMsg, "parkReasonLen", ip, port, g_bIsACDServer, agentID)) ) {return;}

	//parkReason
	if ( parkReasonLen>=msgsize )
	{
		parkReason = NULL;
		parkReasonLen = 0;
		comSymbol = "";
		newAgentPhoneNo = "";
		return;
	}
	if ( !(VerifyTotalLen(theBufContent+parkReasonLen, msgsize, strMsg, "parkReason", ip, port, g_bIsACDServer, agentID)) ) {return;}
	parkReason = new char[parkReasonLen];
	memset(parkReason, 0, parkReasonLen);
	memmove(parkReason, thebuf+theBufContent, parkReasonLen);
	theBufContent += parkReasonLen;

	if(theBufContent >= msgsize)
		return;

	// comSymbol
	comSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+comSymbol.length()+1, msgsize, strMsg, "comSymbol.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(comSymbol.length(), COMSYMBOL_LEN, strMsg, "comSymbol", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += comSymbol.length()+1;

	// newAgentPhoneNo
	newAgentPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+newAgentPhoneNo.length()+1, msgsize, strMsg, "newAgentPhoneNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(newAgentPhoneNo.length(), NEWAGENTPHONENO_LEN, strMsg, "newAgentPhoneNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += newAgentPhoneNo.length()+1;

	if(theBufContent >= msgsize)
		return;

   //handleId
	handleId = thebuf + theBufContent;	
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Client_AgentQueryState::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//agentState
	memmove(thebuf+theBufContent, &this->agentState, sizeof(int));
	theBufContent += sizeof(int);
	
	//bPSTNCall
	memmove(thebuf+theBufContent, &this->bPSTNCall, sizeof(char));
	theBufContent += sizeof(char);
	//bInnerCall
	memmove(thebuf+theBufContent, &this->bInnerCall, sizeof(char));
	theBufContent += sizeof(char);
	
	//parkReasonID
	memmove(thebuf+theBufContent, &parkReasonID, sizeof(int));
	theBufContent += sizeof(int);
	//parkReasonLen
	memmove(thebuf+theBufContent, &parkReasonLen, sizeof(int));
	theBufContent += sizeof(int);
	//parkReason
	memmove(thebuf+theBufContent, parkReason, parkReasonLen);
	theBufContent += parkReasonLen;

	// comSymbol
	memcpy(thebuf+theBufContent, comSymbol.c_str(), comSymbol.length()+1);
	theBufContent += comSymbol.length()+1;

	// newAgentPhoneNo
	memcpy(thebuf+theBufContent, newAgentPhoneNo.c_str(), newAgentPhoneNo.length()+1);
	theBufContent += newAgentPhoneNo.length()+1;


	// handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_AgentQueryState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//agentState
	memSize += sizeof(char);			//bPSTNCall
	memSize += sizeof(char);			//bInnerCall
	memSize += sizeof(int);				//parkReasonID
	memSize += sizeof(int);				//parkReasonLen
	memSize += parkReasonLen;			//parkReason
	memSize += comSymbol.length()+1;	
	memSize += newAgentPhoneNo.length()+1;	

	memSize += handleId.length()+1;	//handleId
	return memSize;
}

void SIPCCMsg_Client_AgentQueryState::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

///Type_Client_UserQueryState
SIPCCMsg_Client_UserQueryState::SIPCCMsg_Client_UserQueryState()
{
	msgType = Type_Client_UserQueryState;
	userName = NULL;
	userNameLen = 0;
	userState = -1;
}

void SIPCCMsg_Client_UserQueryState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_UserQueryState", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserQueryState", "userNameLen", ip, port)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, "SIPCCMsg_Client_UserQueryState", "userNameLen", ip, port)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, "SIPCCMsg_Client_UserQueryState", "userName", ip, port)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//userState
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserQueryState", "userState", ip, port)) ) {return;}
	memmove(&this->userState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_UserQueryState::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//userState
	memmove(thebuf+theBufContent, &this->userState, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Client_UserQueryState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//userState
	
	return memSize;
}

void SIPCCMsg_Client_UserQueryState::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_Client_UserReset
SIPCCMsg_Client_UserReset::SIPCCMsg_Client_UserReset()
{
	msgType = Type_Client_UserReset;
	userName = NULL;
	userNameLen = 0;
	toAcdOrUserState = -1;	// [scq/2010-05-21]
}

void SIPCCMsg_Client_UserReset::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_UserReset";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	// [scq/start/2010-05-21]
	// toAcdOrUserState
	if(msgsize == theBufContent)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]
}

int SIPCCMsg_Client_UserReset::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;

	// [scq/start/2010-05-21]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-21]
	
	return theBufContent;
}

int SIPCCMsg_Client_UserReset::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				// [scq/2010-05-21] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_UserReset::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_Client_AgentReset
SIPCCMsg_Client_AgentReset::SIPCCMsg_Client_AgentReset()
{
	msgType = Type_Client_AgentReset;
	agentID = NULL;
	agentIDLen = 0;
}

void SIPCCMsg_Client_AgentReset::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_AgentReset";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(agentIDLen, AGENTID_LEN, strMsg, "agentIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//agentID
	if ( !(VerifyTotalLen(theBufContent+agentIDLen, msgsize, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
}

int SIPCCMsg_Client_AgentReset::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentReset::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	
	return memSize;
}

void SIPCCMsg_Client_AgentReset::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

///Type_Client_UserLoginStateSvr
SIPCCMsg_Client_UserLoginStateSvr::SIPCCMsg_Client_UserLoginStateSvr()
{
	msgType = Type_Client_UserLoginStateSvr;
	userName = NULL;
	userNameLen = 0;
	
	natType = NatType_Unknown;
	
	this->localIP = 0;
	this->localPort = 0;

	GwName = "";
	ComputerSymbol = "";
	allUserName = "";
	indexNum = 0;
	wanIP=0;
	wanPort=0;
	handleId="";

	totalIndex=0;
}

void SIPCCMsg_Client_UserLoginStateSvr::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "userNameLen", ip, port)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, "SIPCCMsg_Client_UserLoginStateSvr", "userNameLen", ip, port)) ) {return;}
	
	//userName
	if ( userNameLen != 0 )
	{
		if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "userName", ip, port)) ) {return;}
		userName = new char[userNameLen];
		memset(userName, 0, userNameLen);
		memmove(userName, thebuf+theBufContent, userNameLen);
		theBufContent += userNameLen;
	}
	else
	{
		userName = NULL;
	}
	
	//natType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "natType", ip, port)) ) {return;}
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(msgsize == theBufContent)
		return;
	
	//localIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "localIP", ip, port)) ) {return;}
	memmove(&this->localIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "localPort", ip, port)) ) {return;}
	memmove(&this->localPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(msgsize == theBufContent)
		return;

	//GwName
	GwName = thebuf+theBufContent;
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf+theBufContent;
	theBufContent += ComputerSymbol.length()+1;

	//allUserName
	allUserName = thebuf+theBufContent;
	theBufContent += allUserName.length()+1;

	//indexNum
	memmove(&this->indexNum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);



		//wanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "wanIP", ip, port)) ) {return;}
	memmove(&this->wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//wanPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_Client_UserLoginStateSvr", "wanPort", ip, port)) ) {return;}
	memmove(&this->wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	if(msgsize == theBufContent)
		return;

	//handleId
	handleId = thebuf + theBufContent;
	theBufContent+= handleId.length()+1;

	memmove(&totalIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


}

int SIPCCMsg_Client_UserLoginStateSvr::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);
	//localIP
	memmove(thebuf+theBufContent, &this->localIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	memmove(thebuf+theBufContent, &this->localPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//GwName
	memmove(thebuf+theBufContent, this->GwName.c_str(),GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memmove(thebuf+theBufContent, this->ComputerSymbol.c_str(),ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//allUserName
	memmove(thebuf+theBufContent, this->allUserName.c_str(),allUserName.length()+1);
	theBufContent += allUserName.length()+1;

	//indexNum
	memmove(thebuf+theBufContent, &this->indexNum, sizeof(int));
	theBufContent += sizeof(int);



	//wanIP
	memmove(thebuf+theBufContent, &this->wanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//wanPort
	memmove(thebuf+theBufContent, &this->wanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//handleId 
	memcpy(thebuf+theBufContent, handleId .c_str(), handleId .length()+1);
	theBufContent += handleId .length()+1;


	//totalIndex
	memmove(thebuf+theBufContent, &totalIndex, sizeof(int));
	theBufContent += sizeof(int);


	return theBufContent;
}

int SIPCCMsg_Client_UserLoginStateSvr::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//natType
	memSize += sizeof(unsigned long);	//localIP
	memSize += sizeof(unsigned short);	//localPort

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += allUserName.length()+1;		//allUserName
	memSize += sizeof(int);					//indexNum
	

	memSize += sizeof(unsigned long);	//wanIP
	memSize += sizeof(unsigned short);	//wanPort

    memSize += handleId.length()+1;		//handleId
	memSize += sizeof(int);	//totalIndex


	return memSize;
}

void SIPCCMsg_Client_UserLoginStateSvr::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_Client_UserLogoutStateSvr
SIPCCMsg_Client_UserLogoutStateSvr::SIPCCMsg_Client_UserLogoutStateSvr()
{
	msgType = Type_Client_UserLogoutStateSvr;
	userName = NULL;
	userNameLen = 0;
}

void SIPCCMsg_Client_UserLogoutStateSvr::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_UserLogoutStateSvr", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_UserLogoutStateSvr", "userNameLen", ip, port)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, "SIPCCMsg_Client_UserLogoutStateSvr", "userNameLen", ip, port)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, "SIPCCMsg_Client_UserLogoutStateSvr", "userName", ip, port)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
}

int SIPCCMsg_Client_UserLogoutStateSvr::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_UserLogoutStateSvr::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	
	return memSize;
}

void SIPCCMsg_Client_UserLogoutStateSvr::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

//Type_Client_UserAnswerCall
SIPCCMsg_Client_UserAnswerCall::SIPCCMsg_Client_UserAnswerCall()
{
	msgType = Type_Client_UserAnswerCall;
	userName = NULL;
	userNameLen = 0;
	theOtherParty = NULL;
	theOtherPartyLen = 0;
	theotherPartyType = CallParty_UnKnown;
	
	outDialType = OutDialType_Normal;

	toAcdOrUserState = -1;	// [scq/2010-05-24]
	privateData="";
	lineType = 0;

	netPath = "";
}

void SIPCCMsg_Client_UserAnswerCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_UserAnswerCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//theOtherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theOtherPartyLen, THEOTHERPARTY_LEN, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//theOtherParty
	if ( !(VerifyTotalLen(theBufContent+theOtherPartyLen, msgsize, strMsg, "theOtherParty", ip, port, g_bIsACDServer)) ) {return;}
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//theotherPartyType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theotherPartyType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theotherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	userLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userLineNo.length()+1, msgsize, strMsg, "userLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(userLineNo.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( userLineNo.length() + 1 );

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "userLineIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "userLinePort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if(theBufContent == msgsize)
		return;
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;



	if (theBufContent >= msgsize)
	{
		return;
	}
	//privateData
	privateData = thebuf + theBufContent;	
	theBufContent += privateData.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//lineType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "lineType", ip, port, g_bIsACDServer)) ) {return;}
	memmove( &lineType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1;
}

int SIPCCMsg_Client_UserAnswerCall::FillBuf(char*& thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	
	//theotherPartyType
	memmove(thebuf+theBufContent, &this->theotherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length() + 1 );
	theBufContent += ( userLineNo.length() + 1 );
	
	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	// privateData
	memcpy(thebuf+theBufContent, privateData.c_str(), privateData.length()+1);
	theBufContent += privateData.length()+1;

	//lineType
	memmove(thebuf+theBufContent, &lineType, sizeof(int));
	theBufContent += sizeof(int);

	theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

    return theBufContent;
}

int SIPCCMsg_Client_UserAnswerCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	memSize += sizeof(int);				//theotherPartyType
	
	memSize += sizeof(int);
	
	memSize += userLineNo.length() + 1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId
	memSize += privateData.length()+1;		//privateData
	memSize += sizeof(int);				//lineType

	memSize += audioStreamDescription.GetMemSize();

	memSize += netPath.length()+1;			//netPath

    return memSize;
}

void SIPCCMsg_Client_UserAnswerCall::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_UserAnswerCall::SetTheOtherParty(string theotherparty)
{
	int iTheOtherPartyLen = theotherparty.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, theotherparty.c_str(), iTheOtherPartyLen);
}

//Type_Client_UserAnswerCall_Real
SIPCCMsg_Client_UserAnswerCall_Real::SIPCCMsg_Client_UserAnswerCall_Real()
{
	msgType = Type_Client_UserAnswerCall_Real;
	userName = NULL;
	userNameLen = 0;
	theOtherParty = NULL;
	theOtherPartyLen = 0;
	theotherPartyType = CallParty_UnKnown;

	outDialType = OutDialType_Normal;

	netPath = "";
}

void SIPCCMsg_Client_UserAnswerCall_Real::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_UserAnswerCall_Real";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//theOtherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theOtherPartyLen, THEOTHERPARTY_LEN, strMsg, "theOtherPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//theOtherParty
	if ( !(VerifyTotalLen(theBufContent+theOtherPartyLen, msgsize, strMsg, "theOtherParty", ip, port, g_bIsACDServer)) ) {return;}
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//theotherPartyType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theotherPartyType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theotherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	userLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userLineNo.length()+1, msgsize, strMsg, "userLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(userLineNo.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( userLineNo.length() + 1 );

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "userLineIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "userLinePort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1;
}

int SIPCCMsg_Client_UserAnswerCall_Real::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;

	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//theotherPartyType
	memmove(thebuf+theBufContent, &this->theotherPartyType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length() + 1 );
	theBufContent += ( userLineNo.length() + 1 );

	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_UserAnswerCall_Real::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	memSize += sizeof(int);				//theotherPartyType

	memSize += sizeof(int);

	memSize += userLineNo.length() + 1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	memSize += netPath.length()+1;			//netPath

	return memSize;
}

void SIPCCMsg_Client_UserAnswerCall_Real::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_UserAnswerCall_Real::SetTheOtherParty(string theotherparty)
{
	int iTheOtherPartyLen = theotherparty.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, theotherparty.c_str(), iTheOtherPartyLen);
}

//Type_ACD_CallEstablished_Real
SIPCCMsg_ACD_CallEstablished_Real::SIPCCMsg_ACD_CallEstablished_Real()
{
	msgType = Type_ACD_CallEstablished_Real;
	userName = NULL;
	userNameLen = 0;
	theOtherParty = NULL;
	theOtherPartyLen = 0;
	theotherPartyType = CallParty_UnKnown;

	outDialType = OutDialType_Normal;
}

void SIPCCMsg_ACD_CallEstablished_Real::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//theOtherPartyLen
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//theotherPartyType
	memmove(&this->theotherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	userLineNo = thebuf+theBufContent;
	theBufContent += ( userLineNo.length() + 1 );

	memmove(&userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_ACD_CallEstablished_Real::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;

	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;

	//theotherPartyType
	memmove(thebuf+theBufContent, &this->theotherPartyType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length() + 1 );
	theBufContent += ( userLineNo.length() + 1 );

	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_ACD_CallEstablished_Real::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	memSize += sizeof(int);				//theotherPartyType

	memSize += sizeof(int);

	memSize += userLineNo.length() + 1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	return memSize;
}

void SIPCCMsg_ACD_CallEstablished_Real::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_ACD_CallEstablished_Real::SetTheOtherParty(string theotherparty)
{
	int iTheOtherPartyLen = theotherparty.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, theotherparty.c_str(), iTheOtherPartyLen);
}

///Type_Client_CallUserConf
SIPCCMsg_Client_CallUserConf::SIPCCMsg_Client_CallUserConf()
{
	msgType = Type_Client_CallUserConf;
	userName = NULL;
	userNameLen = 0;
	callerParty = NULL;
	callerPartyLen = 0;
	bCallFailed = 1;
	audioIP = 0;
	audioPort = 0;
	lanIP = 0;
	failedCause = -1;
	calledNo = NULL;
	calledNoLen = 0;
	invokeID = "";
	
	outDialType = OutDialType_Normal;
	sipBoardIP = 0;   //交换机ip板IP
	sipBoardRtpPort = 0;  //交换机ip板RtpPort
	sipBoardRtcpPort = 0;  //交换机ip板rtcpPort
	sipTransIP = 0;   //中转IP
	sipTransRtpPort = 0;  //中转RtpPort
	sipTransRtcpPort = 0;  //中转rtcpPort

	trans = "";
	codec = "";
	unit = 0;

	toAcdOrUserState = -1;	// [scq/2010-05-24]

	conferencePort1 = 0;
	conferencePort2 = 0;
	calleeNo="";

	netPath = "";
}

void SIPCCMsg_Client_CallUserConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_CallUserConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//callerPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callerPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->callerPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callerPartyLen, CALLERPARTY_LEN, strMsg, "callerPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//callerParty
	if ( !(VerifyTotalLen(theBufContent+callerPartyLen, msgsize, strMsg, "callerParty", ip, port, g_bIsACDServer)) ) {return;}
	callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memmove(callerParty, thebuf+theBufContent, callerPartyLen);
	theBufContent += callerPartyLen;

	//bCallFailed
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bCallFailed", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->bCallFailed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//audioIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "audioIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->audioIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "audioPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->audioPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//failedCause
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "failedCause", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//lanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "lanIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent == msgsize)
		return;

	//calledNoLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "calledNoLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->calledNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(calledNoLen, CALLEDNO_LEN, strMsg, "calledNoLen", ip, port, g_bIsACDServer)) ) {return;}

	//calledNo
	if ( !(VerifyTotalLen(theBufContent+calledNoLen, msgsize, strMsg, "calledNo", ip, port, g_bIsACDServer)) ) {return;}
	calledNo = new char[calledNoLen];
	memset(calledNo, 0, calledNoLen);
	memmove(calledNo, thebuf+theBufContent, calledNoLen);
	theBufContent += calledNoLen;

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeID.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipBoardIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipBoardIP, thebuf+theBufContent, sizeof(sipBoardIP));
	theBufContent += sizeof(sipBoardIP);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipBoardRtpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipBoardRtpPort, thebuf+theBufContent, sizeof(sipBoardRtpPort));
	theBufContent += sizeof(sipBoardRtpPort);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipBoardRtcpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipBoardRtcpPort, thebuf+theBufContent, sizeof(sipBoardRtcpPort));
	theBufContent += sizeof(sipBoardRtcpPort);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "sipTransIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipTransIP, thebuf+theBufContent, sizeof(sipTransIP));
	theBufContent += sizeof(sipTransIP);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipTransRtpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipTransRtpPort, thebuf+theBufContent, sizeof(sipTransRtpPort));
	theBufContent += sizeof(sipTransRtpPort);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "sipTransRtcpPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->sipTransRtcpPort, thebuf+theBufContent, sizeof(sipTransRtcpPort));
	theBufContent += sizeof(sipTransRtcpPort);

	//20090806 haoy
	if ( theBufContent >= msgsize )
	{
		return;
	}
	trans = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+trans.length()+1, msgsize, strMsg, "trans.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(trans.length(), TRANS_LEN, strMsg, "trans", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += trans.length() + 1;

	codec = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+codec.length()+1, msgsize, strMsg, "codec.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(codec.length(), CODEC_LEN, strMsg, "codec", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += codec.length() + 1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(size_t), msgsize, strMsg, "unit", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&unit,thebuf+theBufContent,sizeof(size_t));
	theBufContent += sizeof(size_t);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if(theBufContent == msgsize)
		return;
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	if(theBufContent == msgsize)
		return;

	//conferencePort1
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "conferencePort1", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferencePort1, thebuf+theBufContent, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "conferencePort2", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferencePort2, thebuf+theBufContent, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);



	if ( theBufContent >= msgsize )
	{
		return;
	}

	calleeNo = thebuf + theBufContent;
	theBufContent += calleeNo.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1;

}

int SIPCCMsg_Client_CallUserConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//callerPartyLen
	memmove(thebuf+theBufContent, &this->callerPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//callerParty
	memmove(thebuf+theBufContent, this->callerParty, this->callerPartyLen);
	theBufContent += callerPartyLen;
	//bCallFailed
	memmove(thebuf+theBufContent, &this->bCallFailed, sizeof(char));
	theBufContent += sizeof(char);
	//audioIP
	memmove(thebuf+theBufContent, &this->audioIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(thebuf+theBufContent, &this->audioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//calledNoLen
	memmove(thebuf+theBufContent, &this->calledNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo, this->calledNoLen);
	theBufContent += calledNoLen;
	
	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), this->invokeID.length()+1);
	theBufContent += this->invokeID.length()+1;
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	//sipBoardIP
	memmove(thebuf+theBufContent, &sipBoardIP, sizeof(sipBoardIP));
	theBufContent += sizeof(sipBoardIP);

	//sipBoardRtpPort
	memmove(thebuf+theBufContent, &sipBoardRtpPort, sizeof(sipBoardRtpPort));
	theBufContent += sizeof(sipBoardRtpPort);

	//sipBoardRtcpPort
	memmove(thebuf+theBufContent, &sipBoardRtcpPort, sizeof(sipBoardRtcpPort));
	theBufContent += sizeof(sipBoardRtcpPort);

	//sipTransIP
	memmove(thebuf+theBufContent, &sipTransIP, sizeof(sipTransIP));
	theBufContent += sizeof(sipTransIP);

	//sipTransRtpPort
	memmove(thebuf+theBufContent, &sipTransRtpPort, sizeof(sipTransRtpPort));
	theBufContent += sizeof(sipTransRtpPort);

	//sipTransRtcpPort
	memmove(thebuf+theBufContent, &sipTransRtcpPort, sizeof(sipTransRtcpPort));
	theBufContent += sizeof(sipTransRtcpPort);

	//Media Info
	memcpy(thebuf+theBufContent,trans.c_str(),trans.length()+1);
	theBufContent += (trans.length() + 1);
	
	memcpy(thebuf+theBufContent,codec.c_str(),codec.length()+1);
	theBufContent += (codec.length() + 1);
	
	memcpy(thebuf+theBufContent,&unit,sizeof(size_t));
	theBufContent += (sizeof(size_t));

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//conferencePort1
	memmove(thebuf+theBufContent, &conferencePort1, sizeof(conferencePort1));
	theBufContent += sizeof(conferencePort1);

	//conferencePort2
	memmove(thebuf+theBufContent, &conferencePort2, sizeof(conferencePort2));
	theBufContent += sizeof(conferencePort2);


    //calleeNo
	memmove(thebuf+theBufContent, this->calleeNo.c_str(), this->calleeNo.length()+1);
	theBufContent += this->calleeNo.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;


	return theBufContent;
}

int SIPCCMsg_Client_CallUserConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//callerPartyLen
	memSize += this->callerPartyLen;	//callerParty
	memSize += sizeof(char);			//bCallFailed
	memSize += sizeof(unsigned long);	//audioIP
	memSize += sizeof(unsigned short);	//audioPort
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(int);				//failedCause
	memSize += sizeof(int);				//calledNoLen
	memSize += this->calledNoLen;		//calledNo
	memSize += invokeID.length()+1;		//invokeID
	
	memSize += sizeof(int);
	
	memSize += sizeof(sipBoardIP);		//sipBoardIP
	memSize += sizeof(sipBoardRtpPort);	//sipBoardRtpPort
	memSize += sizeof(sipBoardRtcpPort);//sipBoardRtcpPort
	memSize += sizeof(sipTransIP);		//sipTransIP
	memSize += sizeof(sipTransRtpPort);	//sipTransRtpPort
	memSize += sizeof(sipTransRtcpPort);//sipTransRtcpPort

	
	
	//20090806 haoy
	memSize += trans.length() + 1;
	memSize += codec.length() + 1;
	memSize += sizeof(size_t);

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState

	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;

	memSize += sizeof(conferencePort1);	//conferencePort1
	memSize += sizeof(conferencePort2);	//conferencePort2


	memSize += calleeNo.length() + 1;//calleeNo

	memSize += netPath.length()+1;			//netPath

	return memSize;
}

void SIPCCMsg_Client_CallUserConf::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_CallUserConf::SetCallerParty(string callerparty)
{
	int iCallerPartyLen = callerparty.length();
	this->callerPartyLen = iCallerPartyLen + 1;
	this->callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memcpy(callerParty, callerparty.c_str(), iCallerPartyLen);
}

void SIPCCMsg_Client_CallUserConf::SetCalledNo(string calledno)
{
	int iCalledNoLen = calledno.length();
	this->calledNoLen = iCalledNoLen + 1;
	this->calledNo = new char[calledNoLen];
	memset(calledNo, 0, calledNoLen);
	memcpy(calledNo, calledno.c_str(), iCalledNoLen);
}

///Type_Client_CallUserFailed
SIPCCMsg_Client_CallUserFailed::SIPCCMsg_Client_CallUserFailed()
{
	msgType = Type_Client_CallUserFailed;
	userName = NULL;
	userNameLen = 0;
	callerParty = NULL;
	callerPartyLen = 0;
	failedCause = -1;
	calledNo = NULL;
	calledNoLen = 0;
	
	outDialType = OutDialType_Normal;

	toAcdOrUserState = -1;	// [scq/2010-05-24]
}

void SIPCCMsg_Client_CallUserFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_CallUserFailed";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//callerPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callerPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->callerPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callerPartyLen, CALLERPARTY_LEN, strMsg, "callerPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//callerParty
	if ( !(VerifyTotalLen(theBufContent+callerPartyLen, msgsize, strMsg, "callerParty", ip, port, g_bIsACDServer)) ) {return;}
	callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memmove(callerParty, thebuf+theBufContent, callerPartyLen);
	theBufContent += callerPartyLen;

	//failedCause
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "failedCause", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//calledNoLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "calledNoLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->calledNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(calledNoLen, CALLEDNO_LEN, strMsg, "calledNoLen", ip, port, g_bIsACDServer)) ) {return;}

	//calledNo
	if ( !(VerifyTotalLen(theBufContent+calledNoLen, msgsize, strMsg, "calledNo", ip, port, g_bIsACDServer)) ) {return;}
	calledNo = new char[calledNoLen];
	memset(calledNo, 0, calledNoLen);
	memmove(calledNo, thebuf+theBufContent, calledNoLen);
	theBufContent += calledNoLen;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if(theBufContent == msgsize)
		return;
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;
}

int SIPCCMsg_Client_CallUserFailed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//callerPartyLen
	memmove(thebuf+theBufContent, &this->callerPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//callerParty
	memmove(thebuf+theBufContent, this->callerParty, this->callerPartyLen);
	theBufContent += callerPartyLen;
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	//calledNoLen
	memmove(thebuf+theBufContent, &this->calledNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo, this->calledNoLen);
	theBufContent += calledNoLen;
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_CallUserFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//callerPartyLen
	memSize += this->callerPartyLen;	//callerParty
	memSize += sizeof(int);				//failedCause
	memSize += sizeof(int);				//calledNoLen
	memSize += this->calledNoLen;		//calledNo
	
	memSize += sizeof(int);

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState

	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;
	
	return memSize;
}

void SIPCCMsg_Client_CallUserFailed::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_CallUserFailed::SetCallerParty(string callerparty)
{
	int iCallerPartyLen = callerparty.length();
	this->callerPartyLen = iCallerPartyLen + 1;
	this->callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memcpy(callerParty, callerparty.c_str(), iCallerPartyLen);
}

void SIPCCMsg_Client_CallUserFailed::SetCalledNo(string calledno)
{
	int iCalledNoLen = calledno.length();
	this->calledNoLen = iCalledNoLen + 1;
	this->calledNo = new char[calledNoLen];
	memset(calledNo, 0, calledNoLen);
	memcpy(calledNo, calledno.c_str(), iCalledNoLen);
}

///Type_Client_AgentHoldCall
SIPCCMsg_Client_AgentHoldCall::SIPCCMsg_Client_AgentHoldCall()
{
	msgType = Type_Client_AgentHoldCall;
	heldParty = NULL;
	heldPartyLen = 0;

	toAcdOrUserState = -1;
}

void SIPCCMsg_Client_AgentHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_AgentHoldCall", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//heldPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentHoldCall", "heldPartyLen", ip, port)) ) {return;}
	memmove(&this->heldPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(heldPartyLen, THEPARTY_LEN, "SIPCCMsg_Client_AgentHoldCall", "heldPartyLen", ip, port)) ) {return;}

	//heldParty
	if ( !(VerifyTotalLen(theBufContent+heldPartyLen, msgsize, "SIPCCMsg_Client_AgentHoldCall", "heldParty", ip, port)) ) {return;}
	heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memmove(heldParty, 	thebuf+theBufContent, heldPartyLen);
	theBufContent += heldPartyLen;

	if(theBufContent >= msgsize)
		return;

	ManagerID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ManagerID.length()+1, msgsize, "SIPCCMsg_Client_AgentHoldCall", "ManagerID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ManagerID.length(), MANAGERID_LEN, "SIPCCMsg_Client_AgentHoldCall", "ManagerID", ip, port)) ) {return;}
	theBufContent += ManagerID.length() + 1;

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentHoldCall", "toAcdOrUserState", ip, port)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
}

int SIPCCMsg_Client_AgentHoldCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//heldPartyLen
	memmove(thebuf+theBufContent, &this->heldPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	memmove(thebuf+theBufContent, this->heldParty, this->heldPartyLen);
	theBufContent += heldPartyLen;
	//ManagerID
	memcpy(thebuf+theBufContent, ManagerID.c_str(), ManagerID.length()+1);
	theBufContent += ManagerID.length()+1;

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	return theBufContent;
}

int SIPCCMsg_Client_AgentHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//heldPartyLen
	memSize += this->heldPartyLen;		//heldParty
	memSize += ManagerID.length()+1;	//ManagerID

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_AgentHoldCall::SetHeldParty(string heldparty)
{
	int iHeldPartyLen = heldparty.length();
	this->heldPartyLen = iHeldPartyLen + 1;
	this->heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memcpy(heldParty, heldparty.c_str(), iHeldPartyLen);
}

///Type_Client_AgentUnHoldCall
SIPCCMsg_Client_AgentUnHoldCall::SIPCCMsg_Client_AgentUnHoldCall()
{
	msgType = Type_Client_AgentUnHoldCall;
	heldParty = NULL;
	heldPartyLen = 0;

	toAcdOrUserState = -1;	// [scq/2010-05-24]
}

void SIPCCMsg_Client_AgentUnHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_AgentUnHoldCall", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//heldPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentUnHoldCall", "heldPartyLen", ip, port)) ) {return;}
	memmove(&this->heldPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(heldPartyLen, THEPARTY_LEN, "SIPCCMsg_Client_AgentUnHoldCall", "heldPartyLen", ip, port)) ) {return;}

	//heldParty
	if ( !(VerifyTotalLen(theBufContent+heldPartyLen, msgsize, "SIPCCMsg_Client_AgentUnHoldCall", "heldParty", ip, port)) ) {return;}
	heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memmove(heldParty, 	thebuf+theBufContent, heldPartyLen);
	theBufContent += heldPartyLen;

	// [scq/start/2010-05-24]
	if(theBufContent >= msgsize)
		return;

	// toAcdOrUserState
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_AgentUnHoldCall", "toAcdOrUserState", ip, port)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
}

int SIPCCMsg_Client_AgentUnHoldCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//heldPartyLen
	memmove(thebuf+theBufContent, &this->heldPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	memmove(thebuf+theBufContent, this->heldParty, this->heldPartyLen);
	theBufContent += heldPartyLen;
	
	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	return theBufContent;
}

int SIPCCMsg_Client_AgentUnHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//heldPartyLen
	memSize += this->heldPartyLen;		//heldParty

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_AgentUnHoldCall::SetHeldParty(string heldparty)
{
	int iHeldPartyLen = heldparty.length();
	this->heldPartyLen = iHeldPartyLen + 1;
	this->heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memcpy(heldParty, heldparty.c_str(), iHeldPartyLen);
}

///Type_Client_QueryRouteTactic
SIPCCMsg_Client_QueryRouteTactic::SIPCCMsg_Client_QueryRouteTactic()
{
	msgType = Type_Client_QueryRouteTactic;
	userName = NULL;
	userNameLen = 0;
	theCorporation = NULL;
	theCorporationLen = 0;
	routeDest = NULL;
	routeDestLen = 0;
}

void SIPCCMsg_Client_QueryRouteTactic::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	//theCorporationLen
	memmove(&this->theCorporationLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memmove(theCorporation, 	thebuf+theBufContent, theCorporationLen);
	theBufContent += theCorporationLen;
	
	//routeDestLen
	memmove(&this->routeDestLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memmove(routeDest, 	thebuf+theBufContent, routeDestLen);
	theBufContent += routeDestLen;
}

int SIPCCMsg_Client_QueryRouteTactic::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//theCorporationLen
	memmove(thebuf+theBufContent, &this->theCorporationLen, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	memmove(thebuf+theBufContent, this->theCorporation, this->theCorporationLen);
	theBufContent += theCorporationLen;
	
	//routeDestLen
	memmove(thebuf+theBufContent, &this->routeDestLen, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	memmove(thebuf+theBufContent, this->routeDest, this->routeDestLen);
	theBufContent += routeDestLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_QueryRouteTactic::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//theCorporationLen
	memSize += this->theCorporationLen;	//theCorporation
	memSize += sizeof(int);				//routeDestLen
	memSize += this->routeDestLen;		//routeDest
	
	return memSize;
}

void SIPCCMsg_Client_QueryRouteTactic::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_Client_QueryRouteTactic::SetTheCorporation(string thecorporation)
{
	int iTheCorporationLen = thecorporation.length();
	this->theCorporationLen = iTheCorporationLen + 1;
	this->theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memcpy(theCorporation, thecorporation.c_str(), iTheCorporationLen);
}

void SIPCCMsg_Client_QueryRouteTactic::SetRouteDest(string routedest)
{
	int iRouteLen = routedest.length();
	this->routeDestLen = iRouteLen + 1;
	this->routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memcpy(routeDest, routedest.c_str(), iRouteLen);
}

///Type_Client_PrepareTransfer
SIPCCMsg_Client_PrepareTransfer::SIPCCMsg_Client_PrepareTransfer()
{
	msgType = Type_Client_PrepareTransfer;
	callID = NULL;
	callIDLen = 0;
	theParty = NULL;
	thePartyLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	otherPartyType = CallParty_UnKnown;
	AudioIp = 0;
	AudioPort = 0;
	lanIP = 0;
	toAcdOrUserState = -1;
}

void SIPCCMsg_Client_PrepareTransfer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_PrepareTransfer";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//callIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callIDLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->callIDLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(callIDLen, CALLID_LEN, strMsg, "callIDLen", ip, port, g_bIsACDServer)) ) {return;}

	//callID
	if ( !(VerifyTotalLen(theBufContent+callIDLen, msgsize, strMsg, "callID", ip, port, g_bIsACDServer)) ) {return;}
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, 	thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;

	//thePartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "thePartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->thePartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(thePartyLen, THEPARTY_LEN, strMsg, "thePartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//theParty
	if ( !(VerifyTotalLen(theBufContent+thePartyLen, msgsize, strMsg, "theParty", ip, port, g_bIsACDServer)) ) {return;}
	theParty = new char[thePartyLen];
	memset(theParty, 0, thePartyLen);
	memmove(theParty, 	thebuf+theBufContent, thePartyLen);
	theBufContent += thePartyLen;

	//otherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "otherPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(otherPartyLen, OTHERPARTY_LEN, strMsg, "otherPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//otherParty
	if ( !(VerifyTotalLen(theBufContent+otherPartyLen, msgsize, strMsg, "otherParty", ip, port, g_bIsACDServer)) ) {return;}
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;

	//otherPartyType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "otherPartyType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->otherPartyType, thebuf + theBufContent, sizeof(int) );
	theBufContent += sizeof(int);

	//AudioIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "AudioIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->AudioIp, thebuf + theBufContent, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);

	//AudioPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "AudioPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->AudioPort, thebuf + theBufContent, sizeof(unsigned short) );
	theBufContent += sizeof(unsigned short);

	//lanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "lanIP", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->lanIP, thebuf + theBufContent, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);

	// [scq/start/2010-05-24]
	if(theBufContent >= msgsize)
		return;

	//toAcdOrUserState
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf + theBufContent, sizeof(int) );
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
}

int SIPCCMsg_Client_PrepareTransfer::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//thePartyLen
	memmove(thebuf+theBufContent, &this->thePartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	memmove(thebuf+theBufContent, this->theParty, this->thePartyLen);
	theBufContent += thePartyLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	//AudioIp
	memmove(thebuf+theBufContent, &this->AudioIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//AudioPort
	memmove(thebuf+theBufContent, &this->AudioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	return theBufContent;
}

int SIPCCMsg_Client_PrepareTransfer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//thePartyLen
	memSize += this->thePartyLen;		//theParty
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	
	memSize += sizeof(int);				//otherPartyType
	memSize += sizeof(unsigned long);	//AudioIp
	memSize += sizeof(unsigned short);	//AudioPort
	memSize += sizeof(unsigned long);	//lanIp

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_PrepareTransfer::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_Client_PrepareTransfer::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

void SIPCCMsg_Client_PrepareTransfer::SetTheParty(string theparty)
{
	int iThePartyLen = theparty.length();
	this->thePartyLen = iThePartyLen + 1;
	this->theParty = new char[thePartyLen];
	memset(this->theParty, 0, thePartyLen);
	memcpy(this->theParty, theparty.c_str(), iThePartyLen);
}

///Type_Client_TransReady
SIPCCMsg_Client_TransReady::SIPCCMsg_Client_TransReady()
{
	msgType = Type_Client_TransReady;
	presideAgent = NULL;
	presideAgentLen = 0;
	readyParty = NULL;
	readyPartyLen = 0;
	toAcdOrUserState = -1; // [scq/2010-05-24]
}

void SIPCCMsg_Client_TransReady::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_TransReady";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//presideAgentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "presideAgentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(presideAgentLen, PRESIDEAGENT_LEN, strMsg, "presideAgentLen", ip, port, g_bIsACDServer)) ) {return;}

	//presideAgent
	if ( !(VerifyTotalLen(theBufContent+presideAgentLen, msgsize, strMsg, "presideAgent", ip, port, g_bIsACDServer)) ) {return;}
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;

	//readyPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "readyPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->readyPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(readyPartyLen, READYPARTY_LEN, strMsg, "readyPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//readyParty
	if ( !(VerifyTotalLen(theBufContent+readyPartyLen, msgsize, strMsg, "readyParty", ip, port, g_bIsACDServer)) ) {return;}
	readyParty = new char[readyPartyLen];
	memset(readyParty, 0, readyPartyLen);
	memmove(readyParty, 	thebuf+theBufContent, readyPartyLen);
	theBufContent += readyPartyLen;

	// [scq/start/2010-05-24]
	if(theBufContent >= msgsize)
		return;

	// toAcdOrUserState
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf + theBufContent, sizeof(int) );
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
}

int SIPCCMsg_Client_TransReady::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//readyPartyLen
	memmove(thebuf+theBufContent, &this->readyPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//readyParty
	memmove(thebuf+theBufContent, this->readyParty, this->readyPartyLen);
	theBufContent += readyPartyLen;

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	return theBufContent;
}

int SIPCCMsg_Client_TransReady::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//readyPartyLen
	memSize += this->readyPartyLen;		//readyParty
	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_TransReady::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_Client_TransReady::SetReadyParty(string readyparty)
{
	int iReadyPartyLen = readyparty.length();
	this->readyPartyLen = iReadyPartyLen + 1;
	this->readyParty = new char[readyPartyLen];
	memset(this->readyParty, 0, readyPartyLen);
	memcpy(this->readyParty, readyparty.c_str(), iReadyPartyLen);
}

///Type_Client_TransferCall
SIPCCMsg_Client_TransferCall::SIPCCMsg_Client_TransferCall()
{
	msgType = Type_Client_TransferCall;
	presideAgent = NULL;
	presideAgentLen = 0;
	theParty = NULL;
	thePartyLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	
	otherPartyType = CallParty_UnKnown;
	
	userLineIp = 0;
	userLinePort = 0;

	thePartyType = CallParty_UnKnown;
	agentUUIData = "";

	needReturn = 0;
	IsWebPSTNAgent = 0;

	trans = "";
	codec = "";
	unit = 0;

	toAcdOrUserState = -1;	// [scq/2010-05-24]
}

void SIPCCMsg_Client_TransferCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_TransferCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//presideAgentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "presideAgentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(presideAgentLen, PRESIDEAGENT_LEN, strMsg, "presideAgentLen", ip, port, g_bIsACDServer)) ) {return;}

	//presideAgent
	if ( !(VerifyTotalLen(theBufContent+presideAgentLen, msgsize, strMsg, "presideAgent", ip, port, g_bIsACDServer)) ) {return;}
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;

	//thePartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "thePartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->thePartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(thePartyLen, THEPARTY_LEN, strMsg, "thePartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//theParty
	if ( !(VerifyTotalLen(theBufContent+thePartyLen, msgsize, strMsg, "theParty", ip, port, g_bIsACDServer)) ) {return;}
	theParty = new char[thePartyLen];
	memset(theParty, 0, thePartyLen);
	memmove(theParty, 	thebuf+theBufContent, thePartyLen);
	theBufContent += thePartyLen;

	//otherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "otherPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(otherPartyLen, OTHERPARTY_LEN, strMsg, "otherPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//otherParty
	if ( !(VerifyTotalLen(theBufContent+otherPartyLen, msgsize, strMsg, "otherParty", ip, port, g_bIsACDServer)) ) {return;}
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//otherPartyType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "otherPartyType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->otherPartyType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	userLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userLineNo.length()+1, msgsize, strMsg, "userLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(userLineNo.length(), USERLINENO_LEN, "SIPCCMsg_Client_TransferCall", "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += userLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "userLineIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "userLinePort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//thePartyType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "thePartyType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->thePartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//agentUUIData
	agentUUIData = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentUUIData.length()+1, msgsize, strMsg, "agentUUIData.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentUUIData.length(), UUIDATA_LEN, strMsg, "agentUUIData", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentUUIData.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//needReturn
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "needReturn", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->needReturn, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	trans = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+trans.length()+1, msgsize, strMsg, "trans.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(trans.length(), TRANS_LEN, strMsg, "trans", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += trans.length() + 1;

	codec = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+codec.length()+1, msgsize, strMsg, "codec.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(codec.length(), CODEC_LEN, strMsg, "codec", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += codec.length() + 1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(size_t), msgsize, strMsg, "unit", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&unit,thebuf+theBufContent,sizeof(size_t));
	theBufContent += sizeof(size_t);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if ( theBufContent >= msgsize)
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//IsWebPSTNAgent
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "IsWebPSTNAgent", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->IsWebPSTNAgent, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_Client_TransferCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//thePartyLen
	memmove(thebuf+theBufContent, &this->thePartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	memmove(thebuf+theBufContent, this->theParty, this->thePartyLen);
	theBufContent += thePartyLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length()+1);
	theBufContent += userLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//thePartyType
	memmove(thebuf+theBufContent, &this->thePartyType, sizeof(int));
	theBufContent += sizeof(int);

	//agentUUIData
	memcpy(thebuf+theBufContent, agentUUIData.c_str(), agentUUIData.length()+1);
	theBufContent += agentUUIData.length()+1;

	//needReturn
	memmove(thebuf+theBufContent, &this->needReturn, sizeof(char));
	theBufContent += sizeof(char);

//Media Info
	memcpy(thebuf+theBufContent,trans.c_str(),trans.length()+1);
	theBufContent += (trans.length() + 1);

	memcpy(thebuf+theBufContent,codec.c_str(),codec.length()+1);
	theBufContent += (codec.length() + 1);

	memcpy(thebuf+theBufContent,&unit,sizeof(size_t));
	theBufContent += (sizeof(size_t));

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	//IsWebPSTNAgent
	memmove(thebuf+theBufContent, &this->IsWebPSTNAgent, sizeof(char));
	theBufContent += sizeof(char);

	return theBufContent;
}

int SIPCCMsg_Client_TransferCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//thePartyLen
	memSize += this->thePartyLen;		//theParty
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	
	memSize += sizeof(int);				//otherPartyType
	
	memSize += userLineNo.length()+1;
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);	

	memSize += sizeof(int);				//thePartyType
	memSize += agentUUIData.length()+1;	//agentUUIData

	memSize += sizeof(char);			//needReturn

	memSize += trans.length() + 1;
	memSize += codec.length() + 1;
	memSize += sizeof(size_t);

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState

	memSize += sizeof(char);			//IsWebPSTNAgent 
	
	return memSize;
}

void SIPCCMsg_Client_TransferCall::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_Client_TransferCall::SetTheParty(string theparty)
{
	int iThePartyLen = theparty.length();
	this->thePartyLen = iThePartyLen + 1;
	this->theParty = new char[thePartyLen];
	memset(this->theParty, 0, thePartyLen);
	memcpy(this->theParty, theparty.c_str(), iThePartyLen);
}

void SIPCCMsg_Client_TransferCall::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

///Type_Client_BeforeTransfer
SIPCCMsg_Client_BeforeTransfer::SIPCCMsg_Client_BeforeTransfer()
{
	msgType = Type_Client_BeforeTransfer;
	presideAgent = NULL;
	presideAgentLen = 0;
	theParty = NULL;
	thePartyLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	
	otherPartyType = CallParty_UnKnown;

	toAcdOrUserState = -1;
}

void SIPCCMsg_Client_BeforeTransfer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_BeforeTransfer";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//presideAgentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "presideAgentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(presideAgentLen, PRESIDEAGENT_LEN, strMsg, "presideAgentLen", ip, port, g_bIsACDServer)) ) {return;}

	//presideAgent
	if ( !(VerifyTotalLen(theBufContent+presideAgentLen, msgsize, strMsg, "presideAgent", ip, port, g_bIsACDServer)) ) {return;}
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;

	//thePartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "thePartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->thePartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(thePartyLen, THEPARTY_LEN, strMsg, "thePartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//theParty
	if ( !(VerifyTotalLen(theBufContent+thePartyLen, msgsize, strMsg, "theParty", ip, port, g_bIsACDServer)) ) {return;}
	theParty = new char[thePartyLen];
	memset(theParty, 0, thePartyLen);
	memmove(theParty, 	thebuf+theBufContent, thePartyLen);
	theBufContent += thePartyLen;

	//otherPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "otherPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(otherPartyLen, OTHERPARTY_LEN, strMsg, "thePartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//otherParty
	if ( !(VerifyTotalLen(theBufContent+otherPartyLen, msgsize, strMsg, "otherParty", ip, port, g_bIsACDServer)) ) {return;}
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//otherPartyType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "otherPartyType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->otherPartyType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if ( theBufContent >= msgsize)
	{
		return;
	}
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
}

int SIPCCMsg_Client_BeforeTransfer::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//thePartyLen
	memmove(thebuf+theBufContent, &this->thePartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	memmove(thebuf+theBufContent, this->theParty, this->thePartyLen);
	theBufContent += thePartyLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	return theBufContent;
}

int SIPCCMsg_Client_BeforeTransfer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//thePartyLen
	memSize += this->thePartyLen;		//theParty
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	
	memSize += sizeof(int);				//otherPartyType

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_BeforeTransfer::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_Client_BeforeTransfer::SetTheParty(string theparty)
{
	int iThePartyLen = theparty.length();
	this->thePartyLen = iThePartyLen + 1;
	this->theParty = new char[thePartyLen];
	memset(this->theParty, 0, thePartyLen);
	memcpy(this->theParty, theparty.c_str(), iThePartyLen);
}

void SIPCCMsg_Client_BeforeTransfer::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

///Type_Client_ClearPreConnection
SIPCCMsg_Client_ClearPreConnection::SIPCCMsg_Client_ClearPreConnection()
{
	msgType = Type_Client_ClearPreConnection;
	notifiedParty = NULL;
	notifiedPartyLen = 0;
	notifier = NULL;
	notifierLen = 0;

	toAcdOrUserState = -1;	// [scq/2010-05-24]
}

void SIPCCMsg_Client_ClearPreConnection::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_ClearPreConnection";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//notifiedPartyLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "notifiedPartyLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->notifiedPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(notifiedPartyLen, NOTIFIEDPARTY_LEN, strMsg, "notifiedPartyLen", ip, port, g_bIsACDServer)) ) {return;}

	//notifiedParty
	if ( !(VerifyTotalLen(theBufContent+notifiedPartyLen, msgsize, strMsg, "notifiedParty", ip, port, g_bIsACDServer)) ) {return;}
	notifiedParty = new char[notifiedPartyLen];
	memset(notifiedParty, 0, notifiedPartyLen);
	memmove(notifiedParty, 	thebuf+theBufContent, notifiedPartyLen);
	theBufContent += notifiedPartyLen;

	//notifierLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "notifierLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->notifierLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(notifierLen, NOTIFIER_LEN, strMsg, "notifierLen", ip, port, g_bIsACDServer)) ) {return;}

	//notifier
	if ( !(VerifyTotalLen(theBufContent+notifierLen, msgsize, strMsg, "notifier", ip, port, g_bIsACDServer)) ) {return;}
	notifier = new char[notifierLen];
	memset(notifier, 0, notifierLen);
	memmove(notifier, 	thebuf+theBufContent, notifierLen);
	theBufContent += notifierLen;

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	if ( theBufContent >= msgsize)
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "toAcdOrUserState", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&(this->toAcdOrUserState), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
}

int SIPCCMsg_Client_ClearPreConnection::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//notifiedPartyLen
	memmove(thebuf+theBufContent, &this->notifiedPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//notifiedParty
	memmove(thebuf+theBufContent, this->notifiedParty, this->notifiedPartyLen);
	theBufContent += notifiedPartyLen;
	
	//notifierLen
	memmove(thebuf+theBufContent, &this->notifierLen, sizeof(int));
	theBufContent += sizeof(int);
	//notifier
	memmove(thebuf+theBufContent, this->notifier, this->notifierLen);
	theBufContent += notifierLen;

	// [scq/start/2010-05-24]
	// toAcdOrUserState
	memmove(thebuf+theBufContent, &(this->toAcdOrUserState), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-24]
	
	return theBufContent;
}

int SIPCCMsg_Client_ClearPreConnection::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//notifiedPartyLen
	memSize += this->notifiedPartyLen;	//notifiedParty
	
	memSize += sizeof(int);				//notifierLen
	memSize += this->notifierLen;		//notifier

	memSize += sizeof(int);				// [scq/2010-05-24] toAcdOrUserState
	
	return memSize;
}

void SIPCCMsg_Client_ClearPreConnection::SetNotifiedParty(string notifiedparty)
{
	int iNotifiedPartyLen = notifiedparty.length();
	this->notifiedPartyLen = iNotifiedPartyLen + 1;
	this->notifiedParty = new char[notifiedPartyLen];
	memset(this->notifiedParty, 0, notifiedPartyLen);
	memcpy(this->notifiedParty, notifiedparty.c_str(), iNotifiedPartyLen);
}

void SIPCCMsg_Client_ClearPreConnection::SetNotifier(string theNotifier)
{
	int iNotifier = theNotifier.length();
	this->notifierLen = iNotifier + 1;
	this->notifier = new char[notifierLen];
	memset(this->notifier, 0, notifierLen);
	memcpy(this->notifier, theNotifier.c_str(), iNotifier);
}

///Type_Client_AgentTestNet
SIPCCMsg_Client_AgentTestNet::SIPCCMsg_Client_AgentTestNet()
{
	msgType = Type_Client_AgentTestNet;
	oppName = NULL;
	oppNameLen = 0;
}

void SIPCCMsg_Client_AgentTestNet::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//oppNameLen
	memmove(&this->oppNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//oppName
	oppName = new char[oppNameLen];
	memset(oppName, 0, oppNameLen);
	memmove(oppName, 	thebuf+theBufContent, oppNameLen);
	theBufContent += oppNameLen;
}

int SIPCCMsg_Client_AgentTestNet::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//oppNameLen
	memmove(thebuf+theBufContent, &this->oppNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//oppName
	memmove(thebuf+theBufContent, this->oppName, this->oppNameLen);
	theBufContent += oppNameLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentTestNet::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//oppNameLen
	memSize += this->oppNameLen;		//oppName
	
	return memSize;
}

void SIPCCMsg_Client_AgentTestNet::SetOppName(string oppname)
{
	int iOppNameLen = oppname.length();
	this->oppNameLen = iOppNameLen + 1;
	this->oppName = new char[oppNameLen];
	memset(this->oppName, 0, oppNameLen);
	memcpy(this->oppName, oppname.c_str(), iOppNameLen);
}

///Type_Client_AgentTestNetConf
SIPCCMsg_Client_AgentTestNetConf::SIPCCMsg_Client_AgentTestNetConf()
{
	msgType = Type_Client_AgentTestNetConf;
	oppName = NULL;
	oppNameLen = 0;
}

void SIPCCMsg_Client_AgentTestNetConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//oppNameLen
	memmove(&this->oppNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//oppName
	oppName = new char[oppNameLen];
	memset(oppName, 0, oppNameLen);
	memmove(oppName, 	thebuf+theBufContent, oppNameLen);
	theBufContent += oppNameLen;
}

int SIPCCMsg_Client_AgentTestNetConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//oppNameLen
	memmove(thebuf+theBufContent, &this->oppNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//oppName
	memmove(thebuf+theBufContent, this->oppName, this->oppNameLen);
	theBufContent += oppNameLen;
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentTestNetConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//oppNameLen
	memSize += this->oppNameLen;		//oppName
	
	return memSize;
}

void SIPCCMsg_Client_AgentTestNetConf::SetOppName(string oppname)
{
	int iOppNameLen = oppname.length();
	this->oppNameLen = iOppNameLen + 1;
	this->oppName = new char[oppNameLen];
	memset(this->oppName, 0, oppNameLen);
	memcpy(this->oppName, oppname.c_str(), iOppNameLen);
}

///Type_Client_LanPortApprize
SIPCCMsg_Client_LanPortApprize::SIPCCMsg_Client_LanPortApprize()
{
	msgType = Type_Client_LanPortApprize;
	lanTextPort = 0;
	lanAudioPort = 0;
}

void SIPCCMsg_Client_LanPortApprize::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//lanTextPort
	memmove(&this->lanTextPort, 	thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//lanAudioPort
	memmove(&this->lanAudioPort, 	thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_Client_LanPortApprize::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//lanTextPort
	memmove(thebuf+theBufContent, &this->lanTextPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//lanAudioPort
	memmove(thebuf+theBufContent, &this->lanAudioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_Client_LanPortApprize::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned short);	//lanTextPort
	memSize += sizeof(unsigned short);	//lanAudioPort
	
	return memSize;
}

///Type_Client_QueryGW
SIPCCMsg_Client_QueryGW::SIPCCMsg_Client_QueryGW()
{
	msgType = Type_Client_QueryGW;
	corporationName = "";
	departName = "";
	calledNo = "";
	sPrefix = "";
	sPhoneNum = "";
	sAreaCode = "";
	iMatchResult = 0;  
	internationalCallUnallowed = -1;
	iUseBackupTG = 0;
	TGRouteType=0;
	operatorsInfo = "";
	agentID = "";

	calloutByIAD = 0;
	haveCallerNoQuestion=0;
	callerNoForSend="";
}

void SIPCCMsg_Client_QueryGW::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Client_QueryGW";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//corporationName
	corporationName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corporationName.length()+1, msgsize, strMsgName, "corporationName", ip, port)) ) {return;}
	if ( !(VerifyData(corporationName.length(), CORPNAME_LEN, strMsgName, "corporationName", ip, port)) ) {return;}
	theBufContent += (corporationName.length()+1);
	//departName
	departName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+departName.length()+1, msgsize, strMsgName, "departName", ip, port)) ) {return;}
	if ( !(VerifyData(departName.length(), CORPNDEPT_LEN, strMsgName, "departName", ip, port)) ) {return;}
	theBufContent += (departName.length()+1);
	//calledNo
	calledNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsgName, "calledNo", ip, port)) ) {return;}
	if ( !(VerifyData(calledNo.length(), CALLEDNO_LEN, strMsgName, "calledNo", ip, port)) ) {return;}
	theBufContent += (calledNo.length()+1);
	
	if ( theBufContent >= msgsize)
	{
		return;
	}

	//sPrefix
	sPrefix = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+sPrefix.length()+1, msgsize, strMsgName, "sPrefix", ip, port)) ) {return;}
	if ( !(VerifyData(sPrefix.length(), PREFIX_LEN, strMsgName, "sPrefix", ip, port)) ) {return;}
	theBufContent += (sPrefix.length()+1);
	//sPhoneNum
	sPhoneNum = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+sPhoneNum.length()+1, msgsize, strMsgName, "sPhoneNum", ip, port)) ) {return;}
	if ( !(VerifyData(sPhoneNum.length(), PHONENO_LEN, strMsgName, "sPhoneNum", ip, port)) ) {return;}
	theBufContent += (sPhoneNum.length()+1);
	//sAreaCode
	sAreaCode = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+sAreaCode.length()+1, msgsize, strMsgName, "sAreaCode", ip, port)) ) {return;}
	if ( !(VerifyData(sAreaCode.length(), AREACODE_LEN, strMsgName, "sAreaCode", ip, port)) ) {return;}
	theBufContent += (sAreaCode.length()+1);
	if ( theBufContent >= msgsize)
	{
		return;
	}
	//iMatchResult
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "iMatchResult", ip, port)) ) {return;}
	memmove(&this->iMatchResult, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//internationalCallUnallowed
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "internationalCallUnallowed", ip, port)) ) {return;}
	memmove(&this->internationalCallUnallowed, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//iUseBackupTG
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "iUseBackupTG", ip, port)) ) {return;}
	memmove(&this->iUseBackupTG, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if ( theBufContent >= msgsize)
	{
		return;
	}

	memmove(&this->TGRouteType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//operatorsInfo
	operatorsInfo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+operatorsInfo.length()+1, msgsize, strMsgName, "operatorsInfo", ip, port)) ) {return;}
	if ( !(VerifyData(operatorsInfo.length(), CALLEDNO_LEN, strMsgName, "operatorsInfo", ip, port)) ) {return;}
	theBufContent += (operatorsInfo.length()+1);

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsgName, "agentID", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), CALLEDNO_LEN, strMsgName, "agentID", ip, port)) ) {return;}
	theBufContent += (agentID.length()+1);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//calloutByIAD
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "calloutByIAD", ip, port)) ) {return;}
	memmove(&this->calloutByIAD, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if ( theBufContent >= msgsize)
	{
		return;
	}

	memmove(&this->haveCallerNoQuestion, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	callerNoForSend = thebuf+theBufContent;	
	theBufContent += (callerNoForSend.length()+1);

}

int SIPCCMsg_Client_QueryGW::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//corporationName
	memmove(thebuf+theBufContent, this->corporationName.c_str(), this->corporationName.length()+1);
	theBufContent += (this->corporationName.length()+1);
	//departName
	memmove(thebuf+theBufContent, this->departName.c_str(), this->departName.length()+1);
	theBufContent += (this->departName.length()+1);
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo.c_str(), this->calledNo.length()+1);
	theBufContent += (this->calledNo.length()+1);
	//sPrefix
	memmove(thebuf+theBufContent, this->sPrefix.c_str(), this->sPrefix.length()+1);
	theBufContent += (this->sPrefix.length()+1);
	//sPhoneNum
	memmove(thebuf+theBufContent, this->sPhoneNum.c_str(), this->sPhoneNum.length()+1);
	theBufContent += (this->sPhoneNum.length()+1);
	//sAreaCode
	memmove(thebuf+theBufContent, this->sAreaCode.c_str(), this->sAreaCode.length()+1);
	theBufContent += (this->sAreaCode.length()+1);
	//iMatchResult
	memmove(thebuf+theBufContent, &this->iMatchResult, sizeof(int));
	theBufContent += sizeof(int);
	//internationalCallUnallowed
	memmove(thebuf+theBufContent, &this->internationalCallUnallowed, sizeof(int));
	theBufContent += sizeof(int);

	//iUseBackupTG
	memmove(thebuf+theBufContent, &this->iUseBackupTG, sizeof(int));
	theBufContent += sizeof(int);

	//TGRouteType
	memmove(thebuf+theBufContent, &this->TGRouteType, sizeof(int));
	theBufContent += sizeof(int);

	//operatorsInfo
	memmove(thebuf+theBufContent, this->operatorsInfo.c_str(), this->operatorsInfo.length()+1);
	theBufContent += (this->operatorsInfo.length()+1);

	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += (this->agentID.length()+1);

	//calloutByIAD
	memmove(thebuf+theBufContent, &this->calloutByIAD, sizeof(int));
	theBufContent += sizeof(int);


   //haveCallerNoQuestion
	memmove(thebuf+theBufContent, &this->haveCallerNoQuestion, sizeof(int));
	theBufContent += sizeof(int);

	//callerNoForSend
	memmove(thebuf+theBufContent, this->callerNoForSend.c_str(), this->callerNoForSend.length()+1);
	theBufContent += (this->callerNoForSend.length()+1);

	return theBufContent;
}

int SIPCCMsg_Client_QueryGW::GetMyMemSize()
{
	int memSize = 2*sizeof(int);						//msgclass+msgtype

	memSize += (this->corporationName.length() + 1);	//corporationName
	memSize += (this->departName.length() + 1);			//departName
	memSize += (this->calledNo.length() + 1);			//calledNo
	memSize += (this->sPrefix.length() + 1);			//sPrefix
	memSize += (this->sPhoneNum.length() + 1);			//sPhoneNum
	memSize += (this->sAreaCode.length() + 1);			//sAreaCode
	memSize += sizeof(int);								//iMatchResult
	memSize += sizeof(int);								//internationalCallUnallowed
	memSize += sizeof(int);								//iUseBackupTG

	memSize += sizeof(int);								//TGRouteType
	memSize += (this->operatorsInfo.length() + 1);		//operatorsInfo
	memSize += (this->agentID.length() + 1);			//agentID

	memSize += sizeof(int);								//calloutByIAD
	memSize += sizeof(int);                             //haveCallerNoQuestion


	memSize += (this->callerNoForSend.length() + 1);		//callerNoForSend

	return memSize;
}

///Type_Client_QueryGWLanInfo
SIPCCMsg_Client_QueryGWLanInfo::SIPCCMsg_Client_QueryGWLanInfo()
{
	msgType = Type_Client_QueryGWLanInfo;
	string corpName = "";
	string deptName = "";
}

void SIPCCMsg_Client_QueryGWLanInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Client_QueryGWLanInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += (corpName.length()+1);
	//deptName
	deptName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptName.length()+1, msgsize, strMsgName, "deptName", ip, port)) ) {return;}
	if ( !(VerifyData(deptName.length(), CORPNDEPT_LEN, strMsgName, "deptName", ip, port)) ) {return;}
	theBufContent += (deptName.length()+1);
}

int SIPCCMsg_Client_QueryGWLanInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corpName
	memmove(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += (corpName.length()+1);
	//deptName
	memmove(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += (deptName.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_Client_QueryGWLanInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += (corpName.length()+1);	//corpName
	memSize += (deptName.length()+1);	//deptName
	return memSize;
}

///Type_Client_GetDepartNAgentInfo
SIPCCMsg_Client_GetDepartNAgentInfo::SIPCCMsg_Client_GetDepartNAgentInfo()
{
	msgType = Type_Client_GetDepartNAgentInfo;
	getMode = -1;
	corporationName = NULL;
	corporationNameLen = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
	invokeID = "";
}

void SIPCCMsg_Client_GetDepartNAgentInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_GetDepartNAgentInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "corporationNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(corporationNameLen, CORPNAME_LEN, strMsg, "corporationNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, strMsg, "corporationName", ip, port, g_bIsACDServer)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, 	thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	//getMode
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "getMode", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->getMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_GetDepartNAgentInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	
	//getMode
	memmove(thebuf+theBufContent, &this->getMode, sizeof(int));
	theBufContent += sizeof(int);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_GetDepartNAgentInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	memSize += sizeof(int);				//theDepartmentLen
	memSize += this->theDepartmentLen;	//theDepartment
	memSize += sizeof(int);				//getMode
	memSize += invokeID.length()+1;		//invokeID
	return memSize;
}

void SIPCCMsg_Client_GetDepartNAgentInfo::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

void SIPCCMsg_Client_GetDepartNAgentInfo::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

///Type_Client_GetGroupRequest
SIPCCMsg_Client_GetGroupRequest::SIPCCMsg_Client_GetGroupRequest()
{
	msgType = Type_Client_GetGroupRequest;
	invokeID = "";
}

void SIPCCMsg_Client_GetGroupRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_GetGroupRequest";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_GetGroupRequest::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_GetGroupRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeID.length()+1;		//invokeID
	return memSize;
}

///Type_Client_LoginToText
SIPCCMsg_Client_LoginToText::SIPCCMsg_Client_LoginToText()
{
	msgType = Type_Client_LoginToText;
	UserName = "";
}

void SIPCCMsg_Client_LoginToText::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	//UserName
	UserName = thebuf+theBufContent;
	theBufContent += ( UserName.length() + 1 );
}

int SIPCCMsg_Client_LoginToText::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//UserName
	memmove(thebuf+theBufContent, UserName.c_str(), UserName.length() + 1);
	theBufContent += ( UserName.length() + 1 );
	
	return theBufContent;
}

int SIPCCMsg_Client_LoginToText::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += ( UserName.length() + 1 );	//UserName
	return memSize;
}

///Type_Client_LogoutFromText
SIPCCMsg_Client_LogoutFromText::SIPCCMsg_Client_LogoutFromText()
{
	msgType = Type_Client_LogoutFromText;
	UserName = "";
}

void SIPCCMsg_Client_LogoutFromText::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	//UserName
	UserName = thebuf+theBufContent;
	theBufContent += ( UserName.length() + 1 );
}

int SIPCCMsg_Client_LogoutFromText::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//UserName
	memmove(thebuf+theBufContent, UserName.c_str(), UserName.length() + 1);
	theBufContent += ( UserName.length() + 1 );
	
	return theBufContent;
}

int SIPCCMsg_Client_LogoutFromText::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += ( UserName.length() + 1 );	//UserName
	return memSize;
}

///Type_Client_TextChat
SIPCCMsg_Client_TextChat::SIPCCMsg_Client_TextChat()
{
	msgType = Type_Client_TextChat;
	Sender = "";
	Receiver = "";
	ChatWords = "";
}

void SIPCCMsg_Client_TextChat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	Sender = thebuf;
	thebuf += ( Sender.length() + 1 );
	
	Receiver = thebuf;
	thebuf += ( Receiver.length() + 1 );
	
	ChatWords = thebuf;
	thebuf += ( ChatWords.length() + 1 );
}

int SIPCCMsg_Client_TextChat::FillBuf(char*& thebuf)
{
	int iLen = GetMyMemSize();
	thebuf = new char[iLen];
	char* pTemp = thebuf;
	
	int theBufContent = FillMsgHead(thebuf);
	pTemp += theBufContent;
	
	memcpy( pTemp, Sender.c_str(), Sender.length() + 1 );
	pTemp += ( Sender.length() + 1 );
	
	memcpy( pTemp, Receiver.c_str(), Receiver.length() + 1 );
	pTemp += ( Receiver.length() + 1 );
	
	memcpy( pTemp, ChatWords.c_str(), ChatWords.length() + 1 );
	pTemp += ( ChatWords.length() + 1 );
	
	return iLen;
}

int SIPCCMsg_Client_TextChat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += ( Sender.length() + 1 );
	memSize += ( Receiver.length() + 1 );
	memSize += ( ChatWords.length() + 1 );
	
	return memSize;
}


//Type_Client_QueryTransServer

void SIPCCMsg_Client_QueryTransServer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//clientIP
	memmove(&this->clientIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//gwServerIP
	memmove(&this->gwServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}


int SIPCCMsg_Client_QueryTransServer::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//clientIP
	memmove(thebuf+theBufContent, &this->clientIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//gwServerIP
	memmove(thebuf+theBufContent, &this->gwServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	return theBufContent;
}

int SIPCCMsg_Client_QueryTransServer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned long);
	
	return memSize;
}

//Type_Client_AgentLoadURL
void SIPCCMsg_Client_AgentLoadURL::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentName
	agentName = thebuf+theBufContent;
	theBufContent += ( agentName.length() + 1 );
	
	//corpName
	corpName = thebuf+theBufContent;
	theBufContent += ( corpName.length() + 1 );
}


int SIPCCMsg_Client_AgentLoadURL::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentName
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length() + 1 );
	theBufContent += ( agentName.length() + 1 );
	
	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += ( corpName.length() + 1 );
	
	return theBufContent;
}

int SIPCCMsg_Client_AgentLoadURL::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += agentName.length() + 1;
	memSize += corpName.length() + 1;
	
	return memSize;
}


//Type_Client_SuperDisconnect
void SIPCCMsg_Client_SuperDisconnect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_SuperDisconnect";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( agentID.length() + 1 );
}


int SIPCCMsg_Client_SuperDisconnect::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentID
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += ( agentID.length() + 1 );

	
	return theBufContent;
}

int SIPCCMsg_Client_SuperDisconnect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += agentID.length() + 1;

	return memSize;
}

//Type_Client_GetParkReasons
void SIPCCMsg_Client_GetParkReasons::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerid = thebuf+theBufContent;
	theBufContent += ( managerid.length() + 1 );

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
}


int SIPCCMsg_Client_GetParkReasons::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1 );
	theBufContent += ( managerid.length() + 1 );
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_GetParkReasons::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += managerid.length() + 1;
	memSize += invokeID.length()+1;		//invokeID
	
	return memSize;
}

///Type_Client_ReturnToAgent
SIPCCMsg_Client_ReturnToAgent::SIPCCMsg_Client_ReturnToAgent()
{
	msgType = Type_Client_ReturnToAgent;
	agentID = "";
	IVRUUIData = "";
	bIsSuccess = 0;
}

void SIPCCMsg_Client_ReturnToAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_ReturnToAgent";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	//IVRUUIData
	IVRUUIData = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+IVRUUIData.length()+1, msgsize, strMsg, "IVRUUIData.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(IVRUUIData.length(), UUIDATA_LEN, strMsg, "IVRUUIData", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += IVRUUIData.length()+1;

	//bIsSuccess
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bIsSuccess", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->bIsSuccess, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Client_ReturnToAgent::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//agentID
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += ( agentID.length() + 1 );

	//IVRUUIData
	memcpy(thebuf+theBufContent, IVRUUIData.c_str(), IVRUUIData.length() + 1 );
	theBufContent += ( IVRUUIData.length() + 1 );

	//bIsSuccess
	memmove(thebuf+theBufContent, &this->bIsSuccess, sizeof(char));
	theBufContent += sizeof(char);

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_ReturnToAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length() + 1;	//agentID
	memSize += IVRUUIData.length() + 1;	//IVRUUIData
	memSize += sizeof(char);			//bIsSuccess

	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

///Type_Client_GetUSnGWM
SIPCCMsg_Client_GetUSnGWM::SIPCCMsg_Client_GetUSnGWM()
{
	msgType = Type_Client_GetUSnGWM;

	InvokeId = "";
	UStateServerIp = 0;
	UStateServerPort = 0;
	GWManageServerIp = 0;
	GWManageServerPort = 0;
}

void SIPCCMsg_Client_GetUSnGWM::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Client_GetUSnGWM";
	int theBufContent = AnalyzeMsgHead(thebuf);

	//InvokeId
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	//UStateServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "UStateServerIp", ip, port)) ) {return;}
	memmove(&this->UStateServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//UStateServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "UStateServerPort", ip, port)) ) {return;}
	memmove(&this->UStateServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//GWManageServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "GWManageServerIp", ip, port)) ) {return;}
	memmove(&this->GWManageServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//GWManageServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "GWManageServerPort", ip, port)) ) {return;}
	memmove(&this->GWManageServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_Client_GetUSnGWM::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	//UStateServerIp
	memmove(thebuf+theBufContent, &this->UStateServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//UStateServerPort
	memmove(thebuf+theBufContent, &this->UStateServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//GWManageServerIp
	memmove(thebuf+theBufContent, &this->GWManageServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//GWManageServerPort
	memmove(thebuf+theBufContent, &this->GWManageServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_Client_GetUSnGWM::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += InvokeId.length()+1;		//InvokeId
	memSize += sizeof(unsigned long);	//UStateServerIp
	memSize += sizeof(unsigned short);	//UStateServerPort
	memSize += sizeof(unsigned long);	//GWManageServerIp
	memSize += sizeof(unsigned short);	//GWManageServerPort

	return memSize;
}

///Type_Client_UStateConfirm
SIPCCMsg_Client_UStateConfirm::SIPCCMsg_Client_UStateConfirm()
{
	msgType = Type_Client_UStateConfirm;
	invokeID = "";
}

void SIPCCMsg_Client_UStateConfirm::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_UStateConfirm::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_UStateConfirm::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;
	return memSize;
}

///Type_Client_GWManageConfirm
SIPCCMsg_Client_GWManageConfirm::SIPCCMsg_Client_GWManageConfirm()
{
	msgType = Type_Client_GWManageConfirm;
	invokeID = "";
}

void SIPCCMsg_Client_GWManageConfirm::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_GWManageConfirm::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_GWManageConfirm::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;
	return memSize;
}


///Type_Client_LoginOverrun
SIPCCMsg_Client_LoginOverrun::SIPCCMsg_Client_LoginOverrun()
{
	msgType = Type_Client_LoginOverrun;
	overrunAgent = "";
}

void SIPCCMsg_Client_LoginOverrun::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	overrunAgent = thebuf + theBufContent;
	theBufContent += overrunAgent.length()+1;
}

int SIPCCMsg_Client_LoginOverrun::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, overrunAgent.c_str(), overrunAgent.length()+1);
	theBufContent += overrunAgent.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_LoginOverrun::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += overrunAgent.length()+1;
	return memSize;
}


///Class_Client
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_Login
SIPCCMsg_Login::SIPCCMsg_Login()
{
	msgClass = Class_Login;
}

///Type_Login_UserLoginFailed
SIPCCMsg_Login_UserLoginFailed::SIPCCMsg_Login_UserLoginFailed()
{
	msgType = Type_Login_UserLoginFailed;
	failedCause = NULL;
	failedCauseLen = 0;
	handleId="";
}

void SIPCCMsg_Login_UserLoginFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//failedCauseLen
	memmove(&this->failedCauseLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//failedCause
	failedCause = new char[failedCauseLen];
	memset(failedCause, 0, failedCauseLen);
	memmove(failedCause, thebuf+theBufContent, failedCauseLen);
	theBufContent += failedCauseLen;

	if(theBufContent >= msgsize)
		return;

	//handleId
	handleId = thebuf+theBufContent;
	theBufContent += handleId.length()+1;



}

int SIPCCMsg_Login_UserLoginFailed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//failedCauseLen
	memmove(thebuf+theBufContent, &this->failedCauseLen, sizeof(int));
	theBufContent += sizeof(int);
	//failedCause
	memmove(thebuf+theBufContent, this->failedCause, this->failedCauseLen);
	theBufContent += failedCauseLen;


	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length() + 1 );
	theBufContent += ( handleId.length() + 1 );

	
	return theBufContent;
}

int SIPCCMsg_Login_UserLoginFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//failedCauseLen
	memSize += this->failedCauseLen;	//failedCause
	memSize += handleId.length()+1;		//handleId
	
	return memSize;
}

void SIPCCMsg_Login_UserLoginFailed::SetFailedCause(string failedcause)
{
	int iFailedCauseLen = failedcause.length();
	if(iFailedCauseLen == 0)
		return;
	this->failedCauseLen = iFailedCauseLen + 1;
	failedCause = new char[failedCauseLen];
	memset(failedCause, 0, failedCauseLen);
	memmove(failedCause, failedcause.c_str(), iFailedCauseLen);
}

///Type_Login_UserLoginSucc
SIPCCMsg_Login_UserLoginSucc::SIPCCMsg_Login_UserLoginSucc()
{
	msgType = Type_Login_UserLoginSucc;
	
	uStateServerIP = 0;
	guideServerIP = 0;
	acdServerIP = 0;
	relayServerIP = 0;
	markServerIP = 0;
	
	natServer1IP = 0;
	natServer2IP = 0;
	
	transmitServerIP = 0;
	routeServerIP = 0;
	gwMgrServerIP = 0;
	
	textChatServerIP = 0;
	dlyStrategyServerIP = 0;
	
	callerNoForSend = "";
	
	this->departmentInfo = NULL;
	this->departmentInfoLen = 0;
	
	tollQueryServerIP = 0;
	phoneBookServerIP = 0;
	agentID = "";
	
	agentPhoneNo = "";
	
	dataCenterServerIP = 0;
	
	managerID = "";
	spNumber = "";
	shortName = "";
	
	autoFinishProcess=-1;
	bIsSuper = false;
	
	outdialPrefixNo = "";
	bAutoTransfer = true; 
	bHasSMS = true;

	transSererIp = 0;
	transServerPort = 0;
	
	bPermitPlayAgentID = false;
	bIsMasterSuper = false;
	
	agentName_Return = "";

	remindTalkTime = -1;

	user_role = 2;
	agentType = 0;

	remindProcessTime = -1;
	managerFlag = 1;

	isOutDial = 0;
	
	managerPassKey = "";

	funcConfigure = 0;

	extNo = "";

	bClientNeedUpdate = false;
	bOutDialOpenURL = false;
	
	iSms_Type = 0;

	mainproxyip = 0;
	mainproxyport = 0;
	audioproxyip = 0;
	audioproxyport = 0;

	iLoginSuccMode = 0;
	bCallInOpenURL = false;

	isPhoneNoEditBoxDisabled = false;

	bHidePhone = 0;

	ACDServerIP = "";

	iReDailUseBackupTG = 0;

	RegisterServerA_Ip = 0;
	RegisterServerA_Port = 0;
	RegisterServerB_Ip = 0;
	RegisterServerB_Port = 0;

	MuiltACDServerID = -1;

	calloutByIAD = 0;

	SkillGroupID = "";
	handleId="";

	ACDServerPort = 0;
}

void SIPCCMsg_Login_UserLoginSucc::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Login_UserLoginSucc";
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//departmentInfoLen
	memmove(&this->departmentInfoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//departmentInfo
	departmentInfo = new char[departmentInfoLen];
	memset(departmentInfo, 0, departmentInfoLen);
	memmove(departmentInfo, thebuf+theBufContent, departmentInfoLen);
	theBufContent += departmentInfoLen;
	//guideServerIP
	memmove(&this->guideServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//acdServerIP
	memmove(&this->acdServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//relayServerIP
	memmove(&this->relayServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//markServerIP
	memmove(&this->markServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//NatServer1IP
	memmove(&this->natServer1IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//NatServer2IP
	memmove(&this->natServer2IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//uStateServerIP
	memmove(&this->uStateServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//transmitServerIP
	memmove(&this->transmitServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//routeServerIP
	memmove(&this->routeServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//gwMgrServerIP
	memmove(&this->gwMgrServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//textChatServerIP
	memmove(&this->textChatServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	if(theBufContent == msgsize)
		return;
	//dlyStrategyServerIP
	memmove(&this->dlyStrategyServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	if(theBufContent == msgsize)
		return;
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1;
	if(theBufContent == msgsize)
		return;
	//tollQueryServerIP
	memmove(&this->tollQueryServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	if(theBufContent == msgsize)
		return;
	//phoneBookServerIP
	memmove(&this->phoneBookServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	if(theBufContent == msgsize)
		return;
	//agentID
	agentID = thebuf+theBufContent;
	theBufContent += agentID.length()+1;
	if(theBufContent == msgsize)
		return;
	//agentPhoneNo
	agentPhoneNo = thebuf+theBufContent;
	theBufContent += agentPhoneNo.length()+1;
	if(theBufContent == msgsize)
		return;
	//dataCenterServerIP
	memmove(&this->dataCenterServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	if(theBufContent == msgsize)
		return;
	//dataRouteServerIP
	memmove(&this->dataRouteServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);	
	if(theBufContent == msgsize)
		return;
	//managerID
	managerID = thebuf+theBufContent;
	theBufContent += managerID.length()+1;
	//spNumber
	spNumber = thebuf+theBufContent;
	theBufContent += spNumber.length()+1;
	//shortName
	shortName = thebuf+theBufContent;
	theBufContent += shortName.length()+1;
	if(theBufContent == msgsize)
		return;
	//autoFinishProcess
	memmove(&this->autoFinishProcess, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	
	if(theBufContent == msgsize)
		return;
	memmove(&this->bIsSuper, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);	
	if(theBufContent == msgsize)
		return;
	//nickName
	nickName = thebuf+theBufContent;
	theBufContent += nickName.length()+1;
	if(theBufContent == msgsize)
		return;
	//outdialPrefixNo
	outdialPrefixNo = thebuf+theBufContent;
	theBufContent += outdialPrefixNo.length()+1;
	//bAutoTransfer
	if(theBufContent == msgsize)
		return;
	memmove(&this->bAutoTransfer, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//bHasSMS
	if(theBufContent == msgsize)
		return;
	memmove(&this->bHasSMS, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//transSererIp
	if(theBufContent == msgsize)
		return;
	memmove(&transSererIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//transServerPort
	if(theBufContent == msgsize)
		return;
	memmove(&transServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//bPermitPalyAgentID
	if(theBufContent >= msgsize)
		return;
	memmove(&bPermitPlayAgentID, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//bIsMasterSuper
	if(theBufContent >= msgsize)
		return;
	memmove(&bIsMasterSuper, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	if(theBufContent >= msgsize)
		return;
	
	//agentName_Return
	agentName_Return = thebuf+theBufContent;
	theBufContent += agentName_Return.length()+1;
	
	if(theBufContent >= msgsize)
		return;
	
	//remindTalkTime
	memmove(&this->remindTalkTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	//user_role
	memmove(&this->user_role, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	//agentType
	memmove(&this->agentType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	//remindProcessTime
	memmove(&this->remindProcessTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	//agentFlag
	memmove(&this->managerFlag, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	//isOutDial
	memmove(&this->isOutDial, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	managerPassKey = thebuf+theBufContent;
	theBufContent += managerPassKey.length()+1;
	
	if(theBufContent >= msgsize)
		return;

	memmove(&this->iNeedDisposal, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;
	
	memmove(&this->funcConfigure, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	extNo = thebuf+theBufContent;
	theBufContent += extNo.length()+1;

	if(theBufContent == msgsize)
		return;
	memmove(&this->bClientNeedUpdate, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);	

	memmove(&this->bOutDialOpenURL, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);	

	if(theBufContent >= msgsize)
		return;

	memmove(&this->iSms_Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if(theBufContent >= msgsize)
		return;

	memmove(&this->mainproxyip, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&this->mainproxyport, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	memmove(&this->audioproxyip, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(&this->audioproxyport, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(theBufContent == msgsize)
		return;

	memmove(&this->bSelectSkillGroup, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent == msgsize)
		return;

	memmove(&this->iLoginSuccMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;
	memmove(&this->bCallInOpenURL, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);	

	if(theBufContent >= msgsize)
		return;
	memmove(&this->isPhoneNoEditBoxDisabled, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);	

	if(theBufContent >= msgsize)
		return;
	memmove(&this->internationalCallUnallowed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;
	memmove(&this->bHidePhone, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;

	ACDServerIP = thebuf+theBufContent;
	theBufContent += ACDServerIP.length()+1;

	if(theBufContent >= msgsize)
		return;

	memmove(&this->samplerServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->iReDailUseBackupTG, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	//RegisterServerA_Ip
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "RegisterServerA_Ip", ip, port)) ) {return;}
	memmove(&this->RegisterServerA_Ip, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//RegisterServerA_Port
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "RegisterServerA_Port", ip, port)) ) {return;}
	memmove(&this->RegisterServerA_Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//RegisterServerB_Ip
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "RegisterServerB_Ip", ip, port)) ) {return;}
	memmove(&this->RegisterServerB_Ip, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//RegisterServerB_Port
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "RegisterServerB_Port", ip, port)) ) {return;}
	memmove(&this->RegisterServerB_Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(theBufContent >= msgsize)
		return;

	ACDServerID = thebuf+theBufContent;
	theBufContent += ACDServerID.length()+1;

	if(theBufContent >= msgsize)
		return;

	memmove(&this->MuiltACDServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->calloutByIAD, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += SkillGroupID.length()+1;

    
	if(theBufContent >= msgsize)
		return;

	//handleId
	handleId = thebuf+theBufContent;
	theBufContent += handleId.length()+1;

	if(theBufContent >= msgsize)
		return;

	//ACDServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "ACDServerPort", ip, port)) ) {return;}
	memmove(&this->ACDServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&this->LoginConfType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
        
    if(theBufContent >= msgsize)
		return;

    //agent_TollStatus
	memmove(&this->agent_TollStatus, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
        
	//loginTime
	loginTime = thebuf+theBufContent;
	theBufContent += loginTime.length()+1;

}

int SIPCCMsg_Login_UserLoginSucc::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//departmentInfoLen
	memmove(thebuf+theBufContent, &this->departmentInfoLen, sizeof(int));
	theBufContent += sizeof(int);
	//departmentInfo
	memmove(thebuf+theBufContent, this->departmentInfo, this->departmentInfoLen);
	theBufContent += departmentInfoLen;
	//guideServerIP
	memmove(thebuf+theBufContent, &this->guideServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//acdServerIP
	memmove(thebuf+theBufContent, &this->acdServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//relayServerIP
	memmove(thebuf+theBufContent, &this->relayServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//markServerIP
	memmove(thebuf+theBufContent, &this->markServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//NatServer1IP
	memmove(thebuf+theBufContent, &this->natServer1IP, sizeof(int));
	theBufContent += sizeof(int);
	//NatServer2IP
	memmove(thebuf+theBufContent, &this->natServer2IP, sizeof(int));
	theBufContent += sizeof(int);
	//uStateServerIP
	memmove(thebuf+theBufContent, &this->uStateServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//transmitServerIP
	memmove(thebuf+theBufContent, &this->transmitServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//routeServerIP
	memmove(thebuf+theBufContent, &this->routeServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//gwMgrServerIP
	memmove(thebuf+theBufContent, &this->gwMgrServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//textChatServerIP
	memmove(thebuf+theBufContent, &this->textChatServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//dlyStrategyServerIP
	memmove(thebuf+theBufContent, &this->dlyStrategyServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	//tollQueryServerIP
	memmove(thebuf+theBufContent, &this->tollQueryServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//phoneBookServerIP
	memmove(thebuf+theBufContent, &this->phoneBookServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += ( agentID.length() + 1 );
	//agentPhoneNo
	memcpy(thebuf+theBufContent, agentPhoneNo.c_str(), agentPhoneNo.length() + 1 );
	theBufContent += ( agentPhoneNo.length() + 1 );
	//dataCenterServerIP
	memmove(thebuf+theBufContent, &this->dataCenterServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//dataRouteServerIP
	memmove(thebuf+theBufContent, &this->dataRouteServerIP, sizeof(int));
	theBufContent += sizeof(int);
	//managerID
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1 );
	theBufContent += ( managerID.length() + 1 );
	//spNumber
	memcpy(thebuf+theBufContent, spNumber.c_str(), spNumber.length() + 1 );
	theBufContent += ( spNumber.length() + 1 );
	//shortName
	memcpy(thebuf+theBufContent, shortName.c_str(), shortName.length() + 1 );
	theBufContent += ( shortName.length() + 1 );
	//autoFinishProcess
	memmove(thebuf+theBufContent, &this->autoFinishProcess, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->bIsSuper, sizeof(char));
	theBufContent += sizeof(char);
	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length() + 1 );
	theBufContent += ( nickName.length() + 1 );
	//outdialPrefixNo
	memcpy(thebuf+theBufContent, outdialPrefixNo.c_str(), outdialPrefixNo.length() + 1 );
	theBufContent += ( outdialPrefixNo.length() + 1 );
	//bAutoTransfer
	memmove(thebuf+theBufContent, &this->bAutoTransfer, sizeof(char));
	theBufContent += sizeof(char);
	//bHasSMS
	memmove(thebuf+theBufContent, &this->bHasSMS, sizeof(char));
	theBufContent += sizeof(char);
	//transSererIp
	memmove(thebuf+theBufContent, &transSererIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//transServerPort
	memmove(thebuf+theBufContent, &transServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//bPermitPlayAgentID
	memmove(thebuf+theBufContent, &bPermitPlayAgentID, sizeof(char));
	theBufContent += sizeof(char);
	//bIsMasterSuper
	memmove(thebuf+theBufContent, &bIsMasterSuper, sizeof(char));
	theBufContent += sizeof(char);

	//
	memcpy(thebuf+theBufContent, agentName_Return.c_str(), agentName_Return.length() + 1 );
	theBufContent += ( agentName_Return.length() + 1 );

	//remindTalkTime
	memmove(thebuf+theBufContent, &this->remindTalkTime, sizeof(int));
	theBufContent += sizeof(int);

	//user_role
	memmove(thebuf+theBufContent, &this->user_role, sizeof(int));
	theBufContent += sizeof(int);

	//agentType
	memmove(thebuf+theBufContent, &this->agentType, sizeof(int));
	theBufContent += sizeof(int);

	//remindProcessTime
	memmove(thebuf+theBufContent, &this->remindProcessTime, sizeof(int));
	theBufContent += sizeof(int);

	//agentFlag
	memmove(thebuf+theBufContent, &this->managerFlag, sizeof(int));
	theBufContent += sizeof(int);

	//isOutDial
	memmove(thebuf+theBufContent, &this->isOutDial, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, managerPassKey.c_str(), managerPassKey.length() + 1 );
	theBufContent += ( managerPassKey.length() + 1 );

	//iNeedDisposal
	memmove(thebuf+theBufContent, &this->iNeedDisposal, sizeof(int));
	theBufContent += sizeof(int);

	//funcConfigure
	memmove(thebuf+theBufContent, &this->funcConfigure, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, extNo.c_str(), extNo.length() + 1 );
	theBufContent += ( extNo.length() + 1 );

	memmove(thebuf+theBufContent, &this->bClientNeedUpdate, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->bOutDialOpenURL, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->iSms_Type, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &mainproxyip, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &mainproxyport, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &audioproxyip, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &audioproxyport, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->bSelectSkillGroup, sizeof(char));
	theBufContent += sizeof(char);

	//iLoginSuccMode
	memmove(thebuf+theBufContent, &this->iLoginSuccMode, sizeof(int));
	theBufContent += sizeof(int);
	//bCallInOpenURL
	memmove(thebuf+theBufContent, &this->bCallInOpenURL, sizeof(char));
	theBufContent += sizeof(char);
	///isPhoneNoEditBoxDisabled
	memmove(thebuf+theBufContent, &this->isPhoneNoEditBoxDisabled, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->internationalCallUnallowed, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->bHidePhone, sizeof(char));
	theBufContent += sizeof(char);

	memcpy(thebuf+theBufContent, ACDServerIP.c_str(), ACDServerIP.length() + 1 );
	theBufContent += ( ACDServerIP.length() + 1 );

	memmove(thebuf+theBufContent, &this->samplerServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//iReDailUseBackupTG
	memmove(thebuf+theBufContent, &this->iReDailUseBackupTG, sizeof(int));
	theBufContent += sizeof(int);

	//RegisterServerA_Ip
	memmove(thebuf+theBufContent, &this->RegisterServerA_Ip, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//RegisterServerA_Port
	memmove(thebuf+theBufContent, &this->RegisterServerA_Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//RegisterServerB_Ip
	memmove(thebuf+theBufContent, &this->RegisterServerB_Ip, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//RegisterServerB_Port
	memmove(thebuf+theBufContent, &this->RegisterServerB_Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, ACDServerID.c_str(), ACDServerID.length() + 1 );
	theBufContent += ( ACDServerID.length() + 1 );

	//MuiltACDServerID
	memmove(thebuf+theBufContent, &this->MuiltACDServerID, sizeof(int));
	theBufContent += sizeof(int);

	//calloutByIAD
	memmove(thebuf+theBufContent, &this->calloutByIAD, sizeof(int));
	theBufContent += sizeof(int);

	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );



	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length() + 1 );
	theBufContent += ( handleId.length() + 1 );

	//ACDServerPort
	memmove(thebuf+theBufContent, &this->ACDServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

    //LoginConfType
	memmove(thebuf+theBufContent, &this->LoginConfType, sizeof(int));
	theBufContent += sizeof(int);
        
    //agent_TollStatus
	memmove(thebuf+theBufContent, &this->agent_TollStatus, sizeof(int));
	theBufContent += sizeof(int);
        
    //loginTime
	memcpy(thebuf+theBufContent, loginTime.c_str(), loginTime.length() + 1 );
	theBufContent += ( loginTime.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_Login_UserLoginSucc::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//departmentInfoLen
	memSize += this->departmentInfoLen;		//departmentInfo
	memSize += sizeof(unsigned long);		//acdServerIP
	memSize += sizeof(unsigned long);		//guideServerIP
	memSize += sizeof(unsigned long);		//replayServerIP
	memSize += sizeof(unsigned long);		//markServerIP
	memSize += sizeof(unsigned long);		//natServer1IP
	memSize += sizeof(unsigned long);		//natServer2IP
	memSize += sizeof(unsigned long);		//uStateServerIP
	memSize += sizeof(unsigned long);		//transmitServerIP
	memSize += sizeof(unsigned long);		//routeServerIP
	memSize += sizeof(unsigned long);		//gwMgrServerIP
	memSize += sizeof(unsigned long);		//textChatServerIP
	memSize += sizeof(unsigned long);		//dlyStrategyServerIP
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += sizeof(unsigned long);		//tollQueryServerIP
	memSize += sizeof(unsigned long);		//phoneBookServerIP
	memSize += agentID.length()+1;			//agentID
	memSize += agentPhoneNo.length()+1;		//agentPhoneNo
	memSize += sizeof(unsigned long);		//dataCenterServerIP
	memSize += sizeof(unsigned long);		//dataRouteServerIP
	memSize += managerID.length()+1;		//managerID
	memSize += spNumber.length()+1;			//spNumber
	memSize += shortName.length()+1;		//shortName
	memSize += sizeof(int);					//autoFinishProcess
	memSize += sizeof(char);	
	memSize += nickName.length()+1;			//shortName
	memSize += outdialPrefixNo.length()+1;	//outdialPrefixNo
	memSize += sizeof(char);				//bAutoTransfer
	memSize += sizeof(char);				//bHasSMS
	memSize += sizeof(unsigned long);		//transServerIp
	memSize += sizeof(unsigned short);		//transServerPort
	memSize += sizeof(char);				//bPermitPlayAgentID
	memSize += sizeof(char);				//bIsMasterSuper
	memSize += agentName_Return.length()+1;	//agentName_Return
	memSize += sizeof(int);					//remindTalkTime
	memSize += sizeof(int);					//user_role
	memSize += sizeof(int);					//agentType
	memSize += sizeof(int);					//remindProcessTime
	memSize += sizeof(int);					//agentFlag
	memSize += sizeof(int);					//isOutDial
	memSize += managerPassKey.length()+1;			//passKey
	memSize += sizeof(int);					//iNeedDisposal
	memSize += sizeof(int);					//funcConfigure
	memSize += extNo.length()+1;			//extNo

	memSize += sizeof(char);				//bClientNeedUpdate
	memSize += sizeof(char);				//bOutDialOpenURL
	memSize += sizeof(int);	

	memSize += sizeof(unsigned long);		//
	memSize += sizeof(unsigned short);		//
	memSize += sizeof(unsigned long);		//
	memSize += sizeof(unsigned short);		//

	memSize += sizeof(char);

	memSize += sizeof(int);					//iLoginSuccMode
	memSize += sizeof(char);				//bCallInOpenURL
	memSize += sizeof(char);
	memSize += sizeof(char);

	memSize += sizeof(char);				//bHidePhone

	memSize += ACDServerIP.length()+1;		//ACDServerIP

	memSize += sizeof(unsigned long);

	memSize += sizeof(int);					//iReDailUseBackupTG

	memSize += sizeof(unsigned long);	//RegisterServerA_Ip
	memSize += sizeof(unsigned short);	//RegisterServerA_Port
	memSize += sizeof(unsigned long);	//RegisterServerB_Ip
	memSize += sizeof(unsigned short);	//RegisterServerB_Port
	memSize += ACDServerID.length() + 1;	//ACDServerID

	memSize += sizeof(int);					//MuiltACDServerID

	memSize += sizeof(int);					//calloutByIAD	

	memSize += SkillGroupID.length()+1;		//SkillGroupID
	memSize += handleId.length()+1;		//handleId

	memSize += sizeof(unsigned short);	//ACDServerPort

    memSize += sizeof(int);         //LoginConfType
    memSize += sizeof(int);         //agent_TollStatus
    memSize += loginTime.length()+1;		//loginTime
	return memSize;
}

void SIPCCMsg_Login_UserLoginSucc::SetDepartmentInfo(string departmentinfo)
{
	int iDepartmentinfoLen = departmentinfo.length();
	if(iDepartmentinfoLen == 0)
	{
		this->departmentInfoLen = 0;
		return;
	}
	this->departmentInfoLen = iDepartmentinfoLen + 1;
	this->departmentInfo = new char[departmentInfoLen];
	memset(departmentInfo, 0, departmentInfoLen);
	memcpy(departmentInfo, departmentinfo.c_str(), iDepartmentinfoLen);
}

///Type_Login_ServerRegister
SIPCCMsg_Login_ServerRegister::SIPCCMsg_Login_ServerRegister()
{
	msgType = Type_Login_ServerRegister;
	ServerType = -1;
}

void SIPCCMsg_Login_ServerRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//ServerType
	memmove(&this->ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Login_ServerRegister::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ServerType
	memmove(thebuf+theBufContent, &this->ServerType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Login_ServerRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//ServerType
	
	return memSize;
}

///Type_Login_ServerRegisterConf
SIPCCMsg_Login_ServerRegisterConf::SIPCCMsg_Login_ServerRegisterConf()
{
	msgType = Type_Login_ServerRegisterConf;
	ScanKeyWordIP = 0;
}

void SIPCCMsg_Login_ServerRegisterConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//ServerType
	memmove(&this->ScanKeyWordIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_Login_ServerRegisterConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ScanKeyWordIP
	memmove(thebuf+theBufContent, &this->ScanKeyWordIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	return theBufContent;
}

int SIPCCMsg_Login_ServerRegisterConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned long);	//ScanKeyWordIP
	
	return memSize;
}


///Type_Login_AgentLoadURLConf
void SIPCCMsg_Login_AgentLoadURLConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentURL
	agentURL = thebuf+theBufContent;
	theBufContent += agentURL.length()+1;
	
	//loginName
	loginName = thebuf+theBufContent;
	theBufContent += loginName.length()+1;
	
	//loginPwd
	loginPwd = thebuf+theBufContent;
	theBufContent += loginPwd.length()+1;
	
	//haveVerifyCode
	memmove(&this->haveVerifyCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//remark1
	remark1 = thebuf+theBufContent;
	theBufContent += remark1.length()+1;
	
	//remark2
	remark2 = thebuf+theBufContent;
	theBufContent += remark2.length()+1;
	
	//remark3
	remark3 = thebuf+theBufContent;
	theBufContent += remark3.length()+1;
	
	//urlSign
	urlSign = thebuf+theBufContent;
	theBufContent += urlSign.length()+1;
	
}

int SIPCCMsg_Login_AgentLoadURLConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentURL
	memcpy(thebuf+theBufContent, agentURL.c_str(), agentURL.length() + 1 );
	theBufContent += ( agentURL.length() + 1 );
	
	//loginName
	memcpy(thebuf+theBufContent, loginName.c_str(), loginName.length() + 1 );
	theBufContent += ( loginName.length() + 1 );
	
	//loginPwd
	memcpy(thebuf+theBufContent, loginPwd.c_str(), loginPwd.length() + 1 );
	theBufContent += ( loginPwd.length() + 1 );
	
	//haveVerifyCode
	memmove(thebuf+theBufContent, &this->haveVerifyCode, sizeof(int));
	theBufContent += sizeof(int);
	
	//remark1
	memcpy(thebuf+theBufContent, remark1.c_str(), remark1.length() + 1 );
	theBufContent += ( remark1.length() + 1 );
	
	//remark2
	memcpy(thebuf+theBufContent, remark2.c_str(), remark2.length() + 1 );
	theBufContent += ( remark2.length() + 1 );
	
	//remark3
	memcpy(thebuf+theBufContent, remark3.c_str(), remark3.length() + 1 );
	theBufContent += ( remark3.length() + 1 );
	
	//urlSign
	memcpy(thebuf+theBufContent, urlSign.c_str(), urlSign.length() + 1 );
	theBufContent += ( urlSign.length() + 1 );
	
	return theBufContent;
}

int SIPCCMsg_Login_AgentLoadURLConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentURL.length()+1;
	memSize += loginName.length()+1;	
	memSize += loginPwd.length()+1;	
	memSize += sizeof(int);	
	memSize += remark1.length()+1;	
	memSize += remark2.length()+1;	
	memSize += remark3.length()+1;	
	memSize += urlSign.length()+1;	
	
	return memSize;
}


///Type_Login_GetParkReasonsConf
void SIPCCMsg_Login_GetParkReasonsConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	parkReasons = thebuf+theBufContent;
	theBufContent += parkReasons.length()+1;
}

int SIPCCMsg_Login_GetParkReasonsConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, parkReasons.c_str(), parkReasons.length() + 1 );
	theBufContent += ( parkReasons.length() + 1 );
	
	return theBufContent;
}

int SIPCCMsg_Login_GetParkReasonsConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += parkReasons.length()+1;
	
	return memSize;
}


///Type_Login_ChangePasswordConf
void SIPCCMsg_Login_ChangePasswordConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//result
	memmove(&this->result, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_Login_ChangePasswordConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//result
	memmove(thebuf+theBufContent, &this->result, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Login_ChangePasswordConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	return memSize;
}

///Type_Login_QueryIncrementFuncConf
void SIPCCMsg_Login_QueryIncrementFuncConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//funcID
	memmove(&this->funcID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//funcName
	funcName = thebuf+theBufContent;
	theBufContent += funcName.length()+1;

	//defaultLangTypeID
	memmove(&this->defaultLangTypeID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//defaultOperTypeID
	memmove(&this->defaultOperTypeID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//ivrLangType
	ivrLangType = thebuf+theBufContent;
	theBufContent += ivrLangType.length()+1;

	//operationType
	operationType = thebuf+theBufContent;
	theBufContent += operationType.length()+1;
	
}

int SIPCCMsg_Login_QueryIncrementFuncConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//funcID
	memmove(thebuf+theBufContent, &this->funcID, sizeof(int));
	theBufContent += sizeof(int);

	//funcName
	memcpy(thebuf+theBufContent, funcName.c_str(), funcName.length() + 1 );
	theBufContent += ( funcName.length() + 1 );

	//defaultLangTypeID
	memmove(thebuf+theBufContent, &this->defaultLangTypeID, sizeof(int));
	theBufContent += sizeof(int);

	//defaultOperTypeID
	memmove(thebuf+theBufContent, &this->defaultOperTypeID, sizeof(int));
	theBufContent += sizeof(int);

	//ivrLangType
	memcpy(thebuf+theBufContent, ivrLangType.c_str(), ivrLangType.length() + 1 );
	theBufContent += ( ivrLangType.length() + 1 );

	//operationType
	memcpy(thebuf+theBufContent, operationType.c_str(), operationType.length() + 1 );
	theBufContent += ( operationType.length() + 1 );

	
	return theBufContent;
}

int SIPCCMsg_Login_QueryIncrementFuncConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//funcID
	memSize += funcName.length() + 1;	//funcName
	memSize += sizeof(int);				//defaultLangTypeID
	memSize += sizeof(int);				//defaultOperTypeID
	memSize += ivrLangType.length() + 1;	//ivrLangType
	memSize += operationType.length() + 1;	//operationType

	return memSize;
}


///Type_Login_SendStrMsg
void SIPCCMsg_Login_SendStrMsg::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->nStrMsgId, thebuf+theBufContent, sizeof(this->nStrMsgId));
	theBufContent += sizeof(this->nStrMsgId);
	//theSender
	theSender = thebuf+theBufContent;
	theBufContent += theSender.length()+1;

	//msgContent
	msgContent = thebuf+theBufContent;
	theBufContent += msgContent.length()+1;

}

int SIPCCMsg_Login_SendStrMsg::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//nStrMsgId;
	memmove(thebuf+theBufContent, &this->nStrMsgId, sizeof(this->nStrMsgId));
	theBufContent += sizeof(this->nStrMsgId);

	//theSender
	memcpy(thebuf+theBufContent, theSender.c_str(), theSender.length() + 1 );
	theBufContent += ( theSender.length() + 1 );

	//msgContent
	memcpy(thebuf+theBufContent, msgContent.c_str(), msgContent.length() + 1 );
	theBufContent += ( msgContent.length() + 1 );


	return theBufContent;
}

int SIPCCMsg_Login_SendStrMsg::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(nStrMsgId);
	memSize += theSender.length() + 1;	//ivrLangType
	memSize += msgContent.length() + 1;	//operationType

	return memSize;
}


///Type_Client_QueryIncrementFunc
void SIPCCMsg_Client_QueryIncrementFunc::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentName
	agentName = thebuf+theBufContent;
	theBufContent += agentName.length()+1;
	
	//departName
	departName = thebuf+theBufContent;
	theBufContent += departName.length()+1;
	
	//corpName
	corpName = thebuf+theBufContent;
	theBufContent += corpName.length()+1;
	
}

int SIPCCMsg_Client_QueryIncrementFunc::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentName
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length() + 1 );
	theBufContent += ( agentName.length() + 1 );

	//departName
	memcpy(thebuf+theBufContent, departName.c_str(), departName.length() + 1 );
	theBufContent += ( departName.length() + 1 );
	
	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += ( corpName.length() + 1 );
	
	
	return theBufContent;
}

int SIPCCMsg_Client_QueryIncrementFunc::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentName.length() + 1;	//agentName
	memSize += departName.length() + 1;	//departName
	memSize += corpName.length() + 1;	//corpName
	
	return memSize;
}

void SIPCCMsg_Login_NotifyAgentLoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//departName
	departName = thebuf+theBufContent;
	theBufContent += departName.length()+1;

	//popScript
	popScript = thebuf+theBufContent;
	theBufContent += popScript.length()+1;

	//smsServer
	smsServer = thebuf+theBufContent;
	theBufContent += smsServer.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	memmove(&this->cIsAgentRecord, thebuf+theBufContent, sizeof(cIsAgentRecord));
	theBufContent += sizeof(cIsAgentRecord);

	strAgentRecServerIP = thebuf+theBufContent;
	theBufContent += strAgentRecServerIP.length()+1;

	strRecServerSymbol = thebuf+theBufContent;
	theBufContent += strRecServerSymbol.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	transserverList = thebuf+theBufContent;
	theBufContent += transserverList.length()+1;
	
	memmove(&this->threshold_packetlossrate, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->threshold_delay, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof( int);
	
	memmove(&this->threshold_jitter, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof(int);
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	memmove(&this->agentRecServerPort, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	managerTransIP = thebuf+theBufContent;
	theBufContent += managerTransIP.length()+1;

	memmove(&this->managerTransPort, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	memmove(&this->CaptureNetInfoDataCollectIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof( unsigned long);

	memmove(&this->CaptureNetInfoDataCollectPort, thebuf+theBufContent, sizeof( unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&this->needCollectNetInfo, thebuf+theBufContent, sizeof( unsigned short));
	theBufContent += sizeof(int);
	
    memmove(&this->CanConference, thebuf+theBufContent, sizeof( unsigned short));
	theBufContent += sizeof(int);
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	primary_username = thebuf+theBufContent;
	theBufContent += primary_username.length()+1;
     //
	if ( theBufContent >= msgsize )
	{
		return;
	}

	 memmove(&this->TGRouteType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//iHaveBlackList_Callout
	memmove(&this->iHaveBlackList_Callout, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}
	memmove(&this->canredundancy, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->bProcedure_CallIn, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);

	memmove(&this->bProcedure_CallOut, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->tcpProxyServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&this->tcpProxyServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	defaultTG_DialUnderHold = thebuf+theBufContent;
	theBufContent += defaultTG_DialUnderHold.length()+1;
    //add lh.wang
	memmove(&this->haveCallerNoQuestion,thebuf+theBufContent,sizeof(int));
    theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//HaveHBtoACD
	memmove(&this->HaveHBtoACD, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//HaveHBtoHBServer
	memmove(&this->HaveHBtoHBServer, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//RegisterServerAdd
	RegisterServerAdd = thebuf+theBufContent;
	theBufContent += RegisterServerAdd.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//generalConfiguration
	generalConfiguration = thebuf+theBufContent;
	theBufContent += generalConfiguration.length() + 1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}

	//RouteSelect
	memmove(&this->RouteSelectIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&this->RouteSelectPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	int count;
	memmove(&count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	for (int i = 0; i < count; i++)
	{
		S_RouteSelect_Node node;
		
		memmove(&node.Id, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(&node.Ip, thebuf+theBufContent, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);
		
		memmove(&node.MainPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
		
		memmove(&node.TestPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
		
		OtherServerList.push_back(node);
	}
	// 2015-8-26
	memmove(&this->VoiceRouteDetect, thebuf+theBufContent, sizeof(short));
	theBufContent += sizeof(short);
    
     if (theBufContent >= msgsize) {
        return;
    }
    memmove(&NeedTCPProxy, thebuf + theBufContent, sizeof(unsigned long));
    theBufContent += sizeof(unsigned long);
    
    if (theBufContent >= msgsize) {
        return;
    }

    //the2ndDomainName
    the2ndDomainName = thebuf + theBufContent;
    theBufContent += the2ndDomainName.length() + 1;
}

int SIPCCMsg_Login_NotifyAgentLoginConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//departName
	memcpy(thebuf+theBufContent, departName.c_str(), departName.length() + 1 );
	theBufContent += ( departName.length() + 1 );

	//popScript
	memcpy(thebuf+theBufContent, popScript.c_str(), popScript.length() + 1 );
	theBufContent += ( popScript.length() + 1 );

	//smsServer
	memcpy(thebuf+theBufContent, smsServer.c_str(), smsServer.length() + 1 );
	theBufContent += ( smsServer.length() + 1 );


	memmove(thebuf+theBufContent, &this->cIsAgentRecord, sizeof(cIsAgentRecord));
	theBufContent += sizeof(cIsAgentRecord);

	memcpy(thebuf+theBufContent, strAgentRecServerIP.c_str(), strAgentRecServerIP.length() + 1 );
	theBufContent += ( strAgentRecServerIP.length() + 1 );
	memcpy(thebuf+theBufContent, strRecServerSymbol.c_str(), strRecServerSymbol.length() + 1 );
	theBufContent += ( strRecServerSymbol.length() + 1 );

	memcpy(thebuf+theBufContent, transserverList.c_str(), transserverList.length() + 1 );
	theBufContent += ( transserverList.length() + 1 );

	memmove(thebuf+theBufContent, &this->threshold_packetlossrate, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->threshold_delay, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->threshold_jitter, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->agentRecServerPort, sizeof(int));
	theBufContent += sizeof(int);


	memcpy(thebuf+theBufContent, managerTransIP.c_str(), managerTransIP.length() + 1 );
	theBufContent += ( managerTransIP.length() + 1 );

	memmove(thebuf+theBufContent, &this->managerTransPort, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CaptureNetInfoDataCollectIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->CaptureNetInfoDataCollectPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->needCollectNetInfo, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CanConference, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, primary_username.c_str(), primary_username.length() + 1 );
	theBufContent += ( primary_username.length() + 1 );

	memmove(thebuf+theBufContent, &this->TGRouteType, sizeof(int));
	theBufContent += sizeof(int);

	//iHaveBlackList_Callout
	memmove(thebuf+theBufContent, &this->iHaveBlackList_Callout, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->canredundancy, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->bProcedure_CallIn, sizeof(bool));
	theBufContent += sizeof(bool);

	memmove(thebuf+theBufContent, &this->bProcedure_CallOut, sizeof(bool));
	theBufContent += sizeof(bool);

	memmove(thebuf+theBufContent, &this->tcpProxyServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->tcpProxyServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, defaultTG_DialUnderHold.c_str(), defaultTG_DialUnderHold.length() + 1 );
	theBufContent += ( defaultTG_DialUnderHold.length() + 1 );

	//add lh.wang
	memmove(thebuf+theBufContent,&this->haveCallerNoQuestion,sizeof(int));
    theBufContent += sizeof(int);

	//HaveHBtoACD
	memmove(thebuf+theBufContent,&this->HaveHBtoACD,sizeof(int));
	theBufContent += sizeof(int);

	//HaveHBtoHBServer
	memmove(thebuf+theBufContent,&this->HaveHBtoHBServer,sizeof(int));
	theBufContent += sizeof(int);

	//RegisterServerAdd
	memcpy(thebuf+theBufContent, RegisterServerAdd.c_str(), RegisterServerAdd.length() + 1 );
	theBufContent += RegisterServerAdd.length() + 1;

	// generalConfiguration
	memcpy(thebuf+theBufContent, generalConfiguration.c_str(), generalConfiguration.length() + 1 );
	theBufContent += generalConfiguration.length() + 1;

	//RouteSelect
	memmove(thebuf+theBufContent, &this->RouteSelectIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->RouteSelectPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	int iSize = OtherServerList.size();
	memmove(thebuf+theBufContent, &iSize, sizeof(int));
	theBufContent += sizeof(int);
	
	for (list<S_RouteSelect_Node>::iterator it = OtherServerList.begin()
		; it != OtherServerList.end(); ++it)
	{
		S_RouteSelect_Node& node = *it;
		
		memmove(thebuf+theBufContent, &node.Id, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(thebuf+theBufContent, &node.Ip, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);
		
		memmove(thebuf+theBufContent, &node.MainPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
		
		memmove(thebuf+theBufContent, &node.TestPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
	}

	// 2015-8-26
	memmove(thebuf+theBufContent, &this->VoiceRouteDetect, sizeof(short));
	theBufContent += sizeof(short);
    
    memmove(thebuf + theBufContent, &this->NeedTCPProxy, sizeof(unsigned long));
    theBufContent += sizeof(unsigned long);
    
    memcpy(thebuf + theBufContent, the2ndDomainName.c_str(), the2ndDomainName.length() + 1);
    theBufContent += (the2ndDomainName.length() + 1);
    
	return theBufContent;
}

int SIPCCMsg_Login_NotifyAgentLoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += departName.length() + 1;	//departName
	memSize += popScript.length() + 1;	//popScript
	memSize += smsServer.length() + 1;	//smsServer

	memSize += sizeof(cIsAgentRecord);  //cIsAgentRecord
	memSize += strAgentRecServerIP.length() + 1; ///strAgentRecServerIP
	memSize += strRecServerSymbol.length() + 1;// strRecServerSymbol

	memSize += transserverList.length() + 1; /// transserverList


	memSize += sizeof(int);		//threshold_packetlossrate
	memSize += sizeof(int);		//threshold_delay
	memSize += sizeof(int);		//threshold_jitter

	memSize += sizeof(int);		//agentRecServerPort

	memSize += managerTransIP.length() + 1;  ///managerTransIP

	memSize += sizeof(int);		//managerTransPort


	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);	
	memSize += sizeof(int);	
	memSize += sizeof(int);	//CanConference

	memSize += primary_username.length() + 1;  ///primary_username

    memSize += sizeof(int);	//TGRouteType

	memSize += sizeof(int);	//iHaveBlackList_Callout
	memSize += sizeof(int);	//canredundancy

	memSize += sizeof(bool);	
	memSize += sizeof(bool);

	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);

	memSize += defaultTG_DialUnderHold.length() + 1;
    
	memSize += sizeof(int); //haveCallerNoQuestion

	memSize += sizeof(int);								//HaveHBtoACD
	memSize += sizeof(int);								//HaveHBtoHBServer
	memSize += RegisterServerAdd.length() + 1;			//RegisterServerAdd

	memSize += generalConfiguration.length() + 1;    	// generalConfiguration

	//RouteSelect
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);
	memSize += sizeof(int) * OtherServerList.size();
	memSize += sizeof(int) * OtherServerList.size();
	memSize += sizeof(unsigned long) * OtherServerList.size();
	memSize += sizeof(unsigned short) * OtherServerList.size();
	memSize += sizeof(unsigned short) * OtherServerList.size();
	// 2015-8-26
	memSize += sizeof(short);
    memSize += sizeof(unsigned long);  //NeedTCPProxy
    memSize += the2ndDomainName.length()+1;  //the2ndDomainName
	return memSize;
}

///Class_Login
/////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_Guide
SIPCCMsg_Guide::SIPCCMsg_Guide()
{
	msgClass = Class_Guide;
}

//Type_Guide_ACDInfo
SIPCCMsg_Guide_ACDInfo::SIPCCMsg_Guide_ACDInfo()
{
	msgType = Type_Guide_ACDInfo;
	acdServerIP = 0;
	acdServerPort = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
	invokeID = 0;

	UserLevel = 3;
	CallTargetType = 0;
}

void SIPCCMsg_Guide_ACDInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;
	//acdServerIP
	memmove(&this->acdServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//acdServerPort
	memmove(&this->acdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//invokeID
	memmove(&this->invokeID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//UserLevel
	memmove(&this->UserLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//CallTargetType
	memmove(&this->CallTargetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Guide_ACDInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	//acdServerIP
	memmove(thebuf+theBufContent, &this->acdServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//acdServerPort
	memmove(thebuf+theBufContent, &this->acdServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//invokeID
	memmove(thebuf+theBufContent, &this->invokeID, sizeof(int));
	theBufContent += sizeof(int);

	//UserLevel
	memmove(thebuf+theBufContent, &this->UserLevel, sizeof(int));
	theBufContent += sizeof(int);

	//CallTargetType
	memmove(thebuf+theBufContent, &this->CallTargetType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Guide_ACDInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//departmentLen
	memSize += this->theDepartmentLen;	//department
	memSize += sizeof(unsigned long);	//acdServerIP
	memSize += sizeof(unsigned short);	//acdServerPort
	memSize += sizeof(int);				//invokeID

	memSize += sizeof(int);				//UserLevel
	memSize += sizeof(int);				//CallTargetType
	
	return memSize;
}

void SIPCCMsg_Guide_ACDInfo::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	if(iTheDepartmentLen == 0)
		return;
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

///Type_Guide_AddKeyConf
SIPCCMsg_Guide_AddKeyConf::SIPCCMsg_Guide_AddKeyConf()
{
	msgType = Type_Guide_AddKeyConf;
	keyWord = NULL;
	keyWordLen = 0;
}

void SIPCCMsg_Guide_AddKeyConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//keyWordLen
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;
}

int SIPCCMsg_Guide_AddKeyConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	
	return theBufContent;
}

int SIPCCMsg_Guide_AddKeyConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//keyWordLen
	memSize += this->keyWordLen;		//keyWord
	
	return memSize;
}

void SIPCCMsg_Guide_AddKeyConf::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

///Type_Guide_DelKeyConf
SIPCCMsg_Guide_DelKeyConf::SIPCCMsg_Guide_DelKeyConf()
{
	msgType = Type_Guide_DelKeyConf;
	keyWord = NULL;
	keyWordLen = 0;
}

void SIPCCMsg_Guide_DelKeyConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//keyWordLen
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;
}

int SIPCCMsg_Guide_DelKeyConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	
	return theBufContent;
}

int SIPCCMsg_Guide_DelKeyConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//keyWordLen
	memSize += this->keyWordLen;		//keyWord
	
	return memSize;
}

void SIPCCMsg_Guide_DelKeyConf::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

///Type_Guide_LoadKeyWords
SIPCCMsg_Guide_LoadKeyWords::SIPCCMsg_Guide_LoadKeyWords()
{
	msgType = Type_Guide_LoadKeyWords;

	invokeId = "";
}

void SIPCCMsg_Guide_LoadKeyWords::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent == msgsize)
		return;

	//invokeId
	invokeId = thebuf+theBufContent;
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_Guide_LoadKeyWords::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//invokeId
	memmove(thebuf+theBufContent, this->invokeId.c_str(), invokeId.length()+1);
	theBufContent += (invokeId.length()+1);

	return theBufContent;
}

int SIPCCMsg_Guide_LoadKeyWords::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize +=  invokeId.length() + 1;	//invokeId

	return memSize;
}
///Class_Guide
///////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_SysManage
SIPCCMsg_SysManage::SIPCCMsg_SysManage()
{
	msgClass = Class_SysManage;
}

///Type_SysManage_AddDepartment
SIPCCMsg_SysManage_AddDepartment::SIPCCMsg_SysManage_AddDepartment()
{
	msgType = Type_SysManage_AddDepartment;
	theDepartment = NULL;
	theDepartmentLen = 0;
	
	timeoutValue = 20;
	overFlowDest = "";
	overFlowDestType = 0;
	maxRingTime = -1;

	deptType = DeptType_Skill;
	isOutDial = 0;
	outdialGroupID = 0;

	managerid = "";
	deptid = "";

	nickname = "";
	generalConfiguration="";
}

void SIPCCMsg_SysManage_AddDepartment::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SysManage_AddDepartment";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;

	if(theBufContent >= msgsize)
	{
		return;
	}

	//timeoutValue
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "timeoutValue", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->timeoutValue, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//overFlowDest
	overFlowDest = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+overFlowDest.length()+1, msgsize, strMsg, "overFlowDest.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(overFlowDest.length(), OVERFLOWDEST_LEN, strMsg, "overFlowDest", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (overFlowDest.length()+1);

	//overFlowDestType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "overFlowDestType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->overFlowDestType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	//maxRingTime
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "maxRingTime", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->maxRingTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	//deptType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "deptType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->deptType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "isOutDial", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->isOutDial, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outdialGroupID", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->outdialGroupID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	invokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeID.length()+1;

	if(theBufContent == msgsize)
		return;

	managerid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerid.length()+1, msgsize, strMsg, "managerid.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerid.length(), MANAGERID_LEN, strMsg, "managerid", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerid.length()+1;

	deptid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptid.length()+1, msgsize, strMsg, "deptid.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(deptid.length(), DEPTID_LEN, strMsg, "deptid", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += deptid.length()+1;

	if(theBufContent == msgsize)
		return;

	nickname = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickname.length()+1, msgsize, strMsg, "nickname.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(nickname.length(), NICKNAME_LEN, strMsg, "nickname", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += nickname.length()+1;


	if(theBufContent == msgsize)
		return;

	generalConfiguration = thebuf + theBufContent;	
	theBufContent += generalConfiguration.length()+1;
}

int SIPCCMsg_SysManage_AddDepartment::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;

	//timeoutValue
	memmove(thebuf+theBufContent, &this->timeoutValue, sizeof(int));
	theBufContent += sizeof(int);
	
	//overFlowDest
	memmove(thebuf+theBufContent, this->overFlowDest.c_str(), overFlowDest.length()+1);
	theBufContent += (overFlowDest.length()+1);

	//overFlowDestType
	memmove(thebuf+theBufContent, &this->overFlowDestType, sizeof(int));
	theBufContent += sizeof(int);

	//overFlowDestType
	memmove(thebuf+theBufContent, &this->maxRingTime, sizeof(int));
	theBufContent += sizeof(int);

	//deptType
	memmove(thebuf+theBufContent, &this->deptType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->isOutDial, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->outdialGroupID, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length() + 1);
	theBufContent += invokeID.length() + 1;

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;

	memcpy(thebuf+theBufContent, deptid.c_str(), deptid.length() + 1);
	theBufContent += deptid.length() + 1;

	memcpy(thebuf+theBufContent, nickname.c_str(), nickname.length() + 1);
	theBufContent += nickname.length() + 1;

    ///
	memcpy(thebuf+theBufContent, generalConfiguration.c_str(), generalConfiguration.length() + 1);
	theBufContent += generalConfiguration.length() + 1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddDepartment::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//departmentLen
	memSize += this->theDepartmentLen;	//department
	memSize += sizeof(int);				//timeoutValue
	memSize += (this->overFlowDest.length() + 1);		//overFlowDest
	memSize += sizeof(int);				//overFlowDestType
	memSize += sizeof(int);				//maxRingTime
	memSize += sizeof(int);				//deptType
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize +=  invokeID.length() + 1;
	memSize +=  managerid.length() + 1;
	memSize +=  deptid.length() + 1;

	memSize +=  nickname.length() + 1;

	memSize +=  generalConfiguration.length() + 1;

	return memSize;
}

void SIPCCMsg_SysManage_AddDepartment::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	if(iTheDepartmentLen == 0)
		return;
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

///Type_SysManage_DelDepartment
SIPCCMsg_SysManage_DelDepartment::SIPCCMsg_SysManage_DelDepartment()
{
	msgType = Type_SysManage_DelDepartment;
	theDepartment = NULL;
	theDepartmentLen = 0;
}

void SIPCCMsg_SysManage_DelDepartment::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SysManage_DelDepartment";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//theDepartmentLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theDepartmentLen, CORPNDEPT_LEN, strMsg, "theDepartmentLen", ip, port, g_bIsACDServer)) ) {return;}

	//theDepartment
	if ( !(VerifyTotalLen(theBufContent+theDepartmentLen, msgsize, strMsg, "theDepartment", ip, port, g_bIsACDServer)) ) {return;}
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;
}

int SIPCCMsg_SysManage_DelDepartment::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	
	return theBufContent;
}

int SIPCCMsg_SysManage_DelDepartment::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//departmentLen
	memSize += this->theDepartmentLen;	//department
	
	return memSize;
}

void SIPCCMsg_SysManage_DelDepartment::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	if(iTheDepartmentLen == 0)
		return;
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

// [scq/start/2010-07-06]
// Type_SysManage_ModifyKeyword
SIPCCMsg_SysManage_ModifyKeyword::SIPCCMsg_SysManage_ModifyKeyword()
{
	msgType = Type_SysManage_ModifyKeyword;
	originKeyword = NULL;
	originKeywordLen = 0;
	newKeyword = NULL;
	newKeywordLen = 0;
}

void SIPCCMsg_SysManage_ModifyKeyword::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//originKeywordLen
	memmove(&this->originKeywordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//originKeyword
	originKeyword = new char[originKeywordLen];
	memset(originKeyword, 0, originKeywordLen);
	memmove(originKeyword, thebuf+theBufContent, originKeywordLen);
	theBufContent += originKeywordLen;

	if(theBufContent >= msgsize)
		return;

	//newKeywordLen
	memmove(&this->newKeywordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//newKeyword
	newKeyword = new char[newKeywordLen];
	memset(newKeyword, 0, newKeywordLen);
	memmove(newKeyword, thebuf+theBufContent, newKeywordLen);
	theBufContent += newKeywordLen;
}

int SIPCCMsg_SysManage_ModifyKeyword::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//originKeywordLen
	memmove(thebuf+theBufContent, &this->originKeywordLen, sizeof(int));
	theBufContent += sizeof(int);
	//originKeyword
	memmove(thebuf+theBufContent, this->originKeyword, this->originKeywordLen);
	theBufContent += originKeywordLen;

	//newKeywordLen
	memmove(thebuf+theBufContent, &this->newKeywordLen, sizeof(int));
	theBufContent += sizeof(int);
	//newKeyword
	memmove(thebuf+theBufContent, this->newKeyword, this->newKeywordLen);
	theBufContent += newKeywordLen;

	return theBufContent;
}

int SIPCCMsg_SysManage_ModifyKeyword::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//originKeywordLen
	memSize += this->originKeywordLen;	//originKeyword
	memSize += sizeof(int);				//newKeywordLen
	memSize += this->newKeywordLen;		//newKeyword

	return memSize;
}

void SIPCCMsg_SysManage_ModifyKeyword::SetOriginKeyword(string originkeyword)
{
	int iTheOriginkeywordLen = originkeyword.length();
	if(iTheOriginkeywordLen == 0)
		return;
	this->originKeywordLen = iTheOriginkeywordLen + 1;
	this->originKeyword = new char[this->originKeywordLen];
	memset(this->originKeyword, 0, this->originKeywordLen);
	memcpy(this->originKeyword, originkeyword.c_str(), iTheOriginkeywordLen);
}

void SIPCCMsg_SysManage_ModifyKeyword::SetNewKeyword(string newkeyword)
{
	int iTheNewKeywordLen = newkeyword.length();
	if(iTheNewKeywordLen == 0)
		return;
	this->newKeywordLen = iTheNewKeywordLen + 1;
	this->newKeyword = new char[this->newKeywordLen];
	memset(this->newKeyword, 0, this->newKeywordLen);
	memcpy(this->newKeyword, newkeyword.c_str(), iTheNewKeywordLen);
}

// Type_SysManage_ModifyKeyDepart
SIPCCMsg_SysManage_ModifyKeyDepart::SIPCCMsg_SysManage_ModifyKeyDepart()
{
	msgType = Type_SysManage_ModifyKeyDepart;
	theKeyword = NULL;
	theKeywordLen = 0;
	theDepart = NULL;
	theDepartLen = 0;
}

void SIPCCMsg_SysManage_ModifyKeyDepart::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//theKeywordLen
	memmove(&this->theKeywordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theKeyword
	theKeyword = new char[theKeywordLen];
	memset(theKeyword, 0, theKeywordLen);
	memmove(theKeyword, thebuf+theBufContent, theKeywordLen);
	theBufContent += theKeywordLen;

	if(theBufContent >= msgsize)
		return;

	//theDepartLen
	memmove(&this->theDepartLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theDepart
	theDepart = new char[theDepartLen];
	memset(theDepart, 0, theDepartLen);
	memmove(theDepart, thebuf+theBufContent, theDepartLen);
	theBufContent += theDepartLen;
}

int SIPCCMsg_SysManage_ModifyKeyDepart::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//theKeywordLen
	memmove(thebuf+theBufContent, &this->theKeywordLen, sizeof(int));
	theBufContent += sizeof(int);
	//theKeyword
	memmove(thebuf+theBufContent, this->theKeyword, this->theKeywordLen);
	theBufContent += theKeywordLen;

	//theDepartLen
	memmove(thebuf+theBufContent, &this->theDepartLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepart
	memmove(thebuf+theBufContent, this->theDepart, this->theDepartLen);
	theBufContent += theDepartLen;

	return theBufContent;
}

int SIPCCMsg_SysManage_ModifyKeyDepart::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theKeywordLen
	memSize += this->theKeywordLen;		//theKeyword
	memSize += sizeof(int);				//theDepartLen
	memSize += this->theDepartLen;		//theDepart

	return memSize;
}

void SIPCCMsg_SysManage_ModifyKeyDepart::SetTheKeyword(string thekeyword)
{
	int iTheKeywordLen = thekeyword.length();
	if(iTheKeywordLen == 0)
		return;
	this->theKeywordLen = iTheKeywordLen + 1;
	this->theKeyword = new char[this->theKeywordLen];
	memset(this->theKeyword, 0, this->theKeywordLen);
	memcpy(this->theKeyword, thekeyword.c_str(), iTheKeywordLen);
}

void SIPCCMsg_SysManage_ModifyKeyDepart::SetTheDepart(string thedepart)
{
	int iTheDepartLen = thedepart.length();
	if(iTheDepartLen == 0)
		return;
	this->theDepartLen = iTheDepartLen + 1;
	this->theDepart = new char[this->theDepartLen];
	memset(this->theDepart, 0, this->theDepartLen);
	memcpy(this->theDepart, thedepart.c_str(), iTheDepartLen);
}

// Type_SysManage_ModifyDepart
SIPCCMsg_SysManage_ModifyDepart::SIPCCMsg_SysManage_ModifyDepart()
{
	msgType = Type_SysManage_ModifyDepart;
	theKeyword = NULL;
	theKeywordLen = 0;
	theDepart = NULL;
	theDepartLen = 0;
}

void SIPCCMsg_SysManage_ModifyDepart::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//theKeywordLen
	memmove(&this->theKeywordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theKeyword
	theKeyword = new char[theKeywordLen];
	memset(theKeyword, 0, theKeywordLen);
	memmove(theKeyword, thebuf+theBufContent, theKeywordLen);
	theBufContent += theKeywordLen;

	if(theBufContent >= msgsize)
		return;

	//theDepartLen
	memmove(&this->theDepartLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theDepart
	theDepart = new char[theDepartLen];
	memset(theDepart, 0, theDepartLen);
	memmove(theDepart, thebuf+theBufContent, theDepartLen);
	theBufContent += theDepartLen;
}

int SIPCCMsg_SysManage_ModifyDepart::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//theKeywordLen
	memmove(thebuf+theBufContent, &this->theKeywordLen, sizeof(int));
	theBufContent += sizeof(int);
	//theKeyword
	memmove(thebuf+theBufContent, this->theKeyword, this->theKeywordLen);
	theBufContent += theKeywordLen;

	//theDepartLen
	memmove(thebuf+theBufContent, &this->theDepartLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepart
	memmove(thebuf+theBufContent, this->theDepart, this->theDepartLen);
	theBufContent += theDepartLen;

	return theBufContent;
}

int SIPCCMsg_SysManage_ModifyDepart::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theKeywordLen
	memSize += this->theKeywordLen;		//theKeyword
	memSize += sizeof(int);				//theDepartLen
	memSize += this->theDepartLen;		//theDepart

	return memSize;
}

void SIPCCMsg_SysManage_ModifyDepart::SetTheKeyword(string thekeyword)
{
	int iTheKeywordLen = thekeyword.length();
	if(iTheKeywordLen == 0)
		return;
	this->theKeywordLen = iTheKeywordLen + 1;
	this->theKeyword = new char[this->theKeywordLen];
	memset(this->theKeyword, 0, this->theKeywordLen);
	memcpy(this->theKeyword, thekeyword.c_str(), iTheKeywordLen);
}

void SIPCCMsg_SysManage_ModifyDepart::SetTheDepart(string thedepart)
{
	int iTheDepartLen = thedepart.length();
	if(iTheDepartLen == 0)
		return;
	this->theDepartLen = iTheDepartLen + 1;
	this->theDepart = new char[this->theDepartLen];
	memset(this->theDepart, 0, this->theDepartLen);
	memcpy(this->theDepart, thedepart.c_str(), iTheDepartLen);
}

// Type_Client_Conference
SIPCCMsg_Client_Conference::SIPCCMsg_Client_Conference()
{
	msgType = Type_Client_Conference;
	presideParty = "";
	presidePartyType = 0;
	otherJoinParty = "";
	otherJoinPartyType = 0;
}

void SIPCCMsg_Client_Conference::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//presideParty
	presideParty = thebuf+theBufContent;
	theBufContent += (presideParty.length()+1);
	//presidePartyType
	memmove(&presidePartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	//otherJoinParty
	otherJoinParty = thebuf+theBufContent;
	theBufContent += (otherJoinParty.length()+1);
	//otherJoinPartyType
	memmove(&otherJoinPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_Conference::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//presideParty
	memmove(thebuf+theBufContent, this->presideParty.c_str(), presideParty.length()+1);
	theBufContent += (presideParty.length()+1);
	//presidePartyType
	memmove(thebuf+theBufContent, &presidePartyType, sizeof(int));
	theBufContent += sizeof(int);
	//otherJoinParty
	memmove(thebuf+theBufContent, this->otherJoinParty.c_str(), otherJoinParty.length()+1);
	theBufContent += (otherJoinParty.length()+1);
	//otherJoinPartyType
	memmove(thebuf+theBufContent, &otherJoinPartyType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Client_Conference::GetMyMemSize()
{
	int memSize = 2*sizeof(int);				//msgclass+msgtype
	memSize += (presideParty.length()+1);		//presideParty
	memSize += sizeof(int);						//presidePartyType
	memSize += (otherJoinParty.length()+1);		//otherJoinParty
	memSize += sizeof(int);						//otherJoinPartyType

	return memSize;
}

// Type_ACD_Conference
SIPCCMsg_ACD_Conference::SIPCCMsg_ACD_Conference()
{
	msgType = Type_ACD_Conference;
	presideParty = "";
	presidePartyType = 0;
	otherJoinParty = "";
	otherJoinPartyType = 0;
}

void SIPCCMsg_ACD_Conference::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//presideParty
	presideParty = thebuf+theBufContent;
	theBufContent += (presideParty.length()+1);
	//presidePartyType
	memmove(&presidePartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	//otherJoinParty
	otherJoinParty = thebuf+theBufContent;
	theBufContent += (otherJoinParty.length()+1);
	//otherJoinPartyType
	memmove(&otherJoinPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_Conference::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//presideParty
	memmove(thebuf+theBufContent, this->presideParty.c_str(), presideParty.length()+1);
	theBufContent += (presideParty.length()+1);
	//presidePartyType
	memmove(thebuf+theBufContent, &presidePartyType, sizeof(int));
	theBufContent += sizeof(int);
	//otherJoinParty
	memmove(thebuf+theBufContent, this->otherJoinParty.c_str(), otherJoinParty.length()+1);
	theBufContent += (otherJoinParty.length()+1);
	//otherJoinPartyType
	memmove(thebuf+theBufContent, &otherJoinPartyType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_ACD_Conference::GetMyMemSize()
{
	int memSize = 2*sizeof(int);				//msgclass+msgtype
	memSize += (presideParty.length()+1);		//presideParty
	memSize += sizeof(int);						//presidePartyType
	memSize += (otherJoinParty.length()+1);		//otherJoinParty
	memSize += sizeof(int);						//otherJoinPartyType

	return memSize;
}
// [scq/end/2010-07-06]

///Type_SysManage_AddKey
SIPCCMsg_SysManage_AddKey::SIPCCMsg_SysManage_AddKey()
{
	msgType = Type_SysManage_AddKey;
	keyWord = NULL;
	keyWordLen = 0;
	theDepartment = NULL;
	theDepartmentLen = 0;
	acdServerIP = 0;
	acdServerPort = 0;

	SkillGroupID = "";
	UserLevel = 3;
}

void SIPCCMsg_SysManage_AddKey::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//keyWordLen
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;
	//theDepartmentLen
	memmove(&this->theDepartmentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memmove(theDepartment, thebuf+theBufContent, theDepartmentLen);
	theBufContent += theDepartmentLen;
	//acdServerIP
	memmove(&this->acdServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);	
	//acdServerPort
	memmove(&this->acdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);	

	if(theBufContent == msgsize)
		return;

	//SkillGroupID
	SkillGroupID = thebuf+theBufContent;
	theBufContent += SkillGroupID.length()+1;

	//UserLevel
	memmove(&this->UserLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_SysManage_AddKey::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	//theDepartmentLen
	memmove(thebuf+theBufContent, &this->theDepartmentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theDepartment
	memmove(thebuf+theBufContent, this->theDepartment, this->theDepartmentLen);
	theBufContent += theDepartmentLen;
	//acdServerIP
	memmove(thebuf+theBufContent, &this->acdServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);	
	//acdServerPort
	memmove(thebuf+theBufContent, &this->acdServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//SkillGroupID
	memcpy(thebuf+theBufContent, SkillGroupID.c_str(), SkillGroupID.length() + 1 );
	theBufContent += ( SkillGroupID.length() + 1 );

	//UserLevel
	memmove(thebuf+theBufContent, &this->UserLevel, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_SysManage_AddKey::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//keyWordLen
	memSize += this->keyWordLen;		//keyWord
	memSize += sizeof(int);				//departmentLen
	memSize += this->theDepartmentLen;	//department
	memSize += sizeof(unsigned long);	//serverIP
	memSize += sizeof(unsigned short);	//serverPort

	memSize += SkillGroupID.length()+1;	//SkillGroupID
	memSize += sizeof(int);				//UserLevel
	
	return memSize;
}

void SIPCCMsg_SysManage_AddKey::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

void SIPCCMsg_SysManage_AddKey::SetTheDepartment(string thedepartment)
{
	int iTheDepartmentLen = thedepartment.length();
	if(iTheDepartmentLen == 0)
		return;
	this->theDepartmentLen = iTheDepartmentLen + 1;
	this->theDepartment = new char[theDepartmentLen];
	memset(theDepartment, 0, theDepartmentLen);
	memcpy(theDepartment, thedepartment.c_str(), iTheDepartmentLen);
}

///Type_SysManage_DelKey
SIPCCMsg_SysManage_DelKey::SIPCCMsg_SysManage_DelKey()
{
	msgType = Type_SysManage_DelKey;
	keyWord = NULL;
	keyWordLen = 0;
}

void SIPCCMsg_SysManage_DelKey::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//keyWordLen
	memmove(&this->keyWordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memmove(keyWord, thebuf+theBufContent, keyWordLen);
	theBufContent += keyWordLen;	
}

int SIPCCMsg_SysManage_DelKey::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//keyWordLen
	memmove(thebuf+theBufContent, &this->keyWordLen, sizeof(int));
	theBufContent += sizeof(int);
	//keyWord
	memmove(thebuf+theBufContent, this->keyWord, this->keyWordLen);
	theBufContent += keyWordLen;
	
	return theBufContent;
}

int SIPCCMsg_SysManage_DelKey::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//keyWordLen
	memSize += this->keyWordLen;		//keyWord
	
	return memSize;
}

void SIPCCMsg_SysManage_DelKey::SetKeyWord(string keyword)
{
	int iKeyWordLen = keyword.length();
	this->keyWordLen = iKeyWordLen + 1;
	this->keyWord = new char[keyWordLen];
	memset(keyWord, 0, keyWordLen);
	memcpy(keyWord, keyword.c_str(), iKeyWordLen);
}

///Type_SysManage_AddGatewayInfo
SIPCCMsg_SysManage_AddGatewayInfo::SIPCCMsg_SysManage_AddGatewayInfo()
{
	msgType = Type_SysManage_AddGatewayInfo;
	this->gwName = "";
	this->theAccount = "";
	this->thePassword = "";
	this->dtmfEN = 1000;
	this->gwAreaCode = "";
}

void SIPCCMsg_SysManage_AddGatewayInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddGatewayInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gwName
	gwName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwName.length()+1, msgsize, strMsgName, "gwName", ip, port)) ) {return;}
	if ( !(VerifyData(gwName.length(), GWNAME_LEN, strMsgName, "gwName", ip, port)) ) {return;}
	theBufContent += (gwName.length()+1);
	//theAccount
	theAccount = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+theAccount.length()+1, msgsize, strMsgName, "theAccount", ip, port)) ) {return;}
	if ( !(VerifyData(theAccount.length(), ACCOUNT_LEN, strMsgName, "theAccount", ip, port)) ) {return;}
	theBufContent += (theAccount.length()+1);
	//thePassword
	thePassword = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+thePassword.length()+1, msgsize, strMsgName, "thePassword", ip, port)) ) {return;}
	if ( !(VerifyData(thePassword.length(), PASSWORD_LEN, strMsgName, "thePassword", ip, port)) ) {return;}
	theBufContent += (thePassword.length()+1);
	
	if(theBufContent == msgsize)
		return;
	
	//dtmfEN
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "dtmfEN", ip, port)) ) {return;}
	memmove(&this->dtmfEN, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if(theBufContent >= msgsize)
		return;
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length() + 1;

	if(theBufContent >= msgsize)
		return;

	//gwAreaCode
	gwAreaCode = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAreaCode.length()+1, msgsize, strMsgName, "gwAreaCode", ip, port)) ) {return;}
	if ( !(VerifyData(gwAreaCode.length(), AREACODE_LEN, strMsgName, "gwAreaCode", ip, port)) ) {return;}
	theBufContent += (gwAreaCode.length()+1);
}

int SIPCCMsg_SysManage_AddGatewayInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gwName
	memmove(thebuf+theBufContent, this->gwName.c_str(), gwName.length()+1);
	theBufContent += (gwName.length()+1);
	//theAccount
	memmove(thebuf+theBufContent, this->theAccount.c_str(), theAccount.length()+1);
	theBufContent += (theAccount.length()+1);
	//thePassword
	memmove(thebuf+theBufContent, this->thePassword.c_str(), thePassword.length()+1);
	theBufContent += (thePassword.length()+1);
	
	//dtmfEN
	memmove(thebuf+theBufContent, &this->dtmfEN, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);

	//gwAreaCode
	memmove(thebuf+theBufContent, this->gwAreaCode.c_str(), gwAreaCode.length()+1);
	theBufContent += (gwAreaCode.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_SysManage_AddGatewayInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (gwName.length()+1);			//gwName
	memSize += (theAccount.length()+1);		//theAccount
	memSize += (thePassword.length()+1);	//thePassword
	memSize += sizeof(int);					//dtmfEN
	memSize += (invokeID.length()+1);		//thePassword
	memSize += (gwAreaCode.length()+1);		//gwAreaCode
	return memSize;
}

///Type_SysManage_DelGatewayInfo
SIPCCMsg_SysManage_DelGatewayInfo::SIPCCMsg_SysManage_DelGatewayInfo()
{
	msgType = Type_SysManage_DelGatewayInfo;
	this->gwName = "";
}

void SIPCCMsg_SysManage_DelGatewayInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_DelGatewayInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gwName
	gwName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwName.length()+1, msgsize, strMsgName, "gwName", ip, port)) ) {return;}
	if ( !(VerifyData(gwName.length(), GWNAME_LEN, strMsgName, "gwName", ip, port)) ) {return;}
	theBufContent += (gwName.length()+1);

	if(theBufContent >= msgsize)
		return;
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_DelGatewayInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gwName
	memmove(thebuf+theBufContent, this->gwName.c_str(), gwName.length()+1);
	theBufContent += (gwName.length()+1);

	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_SysManage_DelGatewayInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (gwName.length()+1);			//gwName
	memSize += invokeID.length()+1;

	return memSize;
}

///Type_SysManage_AddGWCorp
SIPCCMsg_SysManage_AddGWCorp::SIPCCMsg_SysManage_AddGWCorp()
{
	msgType = Type_SysManage_AddGWCorp;
	this->corpName = "";
	this->defaultTG = "";
	this->enableDialNoRule = false;
}

void SIPCCMsg_SysManage_AddGWCorp::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddGWCorp";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += (corpName.length()+1);
	//defaultTG
	defaultTG = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+defaultTG.length()+1, msgsize, strMsgName, "defaultTG", ip, port)) ) {return;}
	if ( !(VerifyData(defaultTG.length(), TRUNKNO_LEN, strMsgName, "defaultTG", ip, port)) ) {return;}
	theBufContent += (defaultTG.length()+1);

	if(theBufContent == msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsgName, "enableDialNoRule", ip, port)) ) {return;}
	memcpy(&enableDialNoRule, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_AddGWCorp::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), corpName.length()+1);
	theBufContent += (corpName.length()+1);
	//defaultTG
	memmove(thebuf+theBufContent, this->defaultTG.c_str(), defaultTG.length()+1);
	theBufContent += (defaultTG.length()+1);

	memcpy(thebuf+theBufContent, &enableDialNoRule, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_SysManage_AddGWCorp::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (corpName.length()+1);		//corpName
	memSize += (defaultTG.length()+1);		//defaultTG
	memSize += sizeof(char);
	memSize += invokeID.length()+1;
	return memSize;
}

///Type_SysManage_DelGWCorp
SIPCCMsg_SysManage_DelGWCorp::SIPCCMsg_SysManage_DelGWCorp()
{
	msgType = Type_SysManage_DelGWCorp;
	this->corpName = "";
}

void SIPCCMsg_SysManage_DelGWCorp::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_DelGWCorp";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += (corpName.length()+1);

	if(theBufContent >= msgsize)
		return;
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_DelGWCorp::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), corpName.length()+1);
	theBufContent += (corpName.length()+1);

	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_SysManage_DelGWCorp::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (corpName.length()+1);		//corpName
	memSize += invokeID.length()+1;
	return memSize;
}

///Type_SysManage_DelACDCorp
SIPCCMsg_SysManage_DelACDCorp::SIPCCMsg_SysManage_DelACDCorp()
{
	msgType = Type_SysManage_DelACDCorp;
	this->corpName = "";
}

void SIPCCMsg_SysManage_DelACDCorp::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SysManage_DelACDCorp";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsg, "corpName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsg, "corpName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (corpName.length()+1);
}

int SIPCCMsg_SysManage_DelACDCorp::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), corpName.length()+1);
	theBufContent += (corpName.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_SysManage_DelACDCorp::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (corpName.length()+1);		//corpName
	
	return memSize;
}

///Type_SysManage_AddGWTG
SIPCCMsg_SysManage_AddGWTG::SIPCCMsg_SysManage_AddGWTG()
{
	msgType = Type_SysManage_AddGWTG;
	
	this->tgName = "";
	this->gwName = "";
	this->corpName = "";
	this->calledNo = "";
	this->callinLicence = 0;
	this->calloutLicence = 0;
	this->mappingName = "";
	this->tgPrefix = "";

	computerSymbol="";
	areaCode="";
	operatorsInfo="";
	allowCallType=0;			//默认为0
	trunkCount=0;				//默认为0
	lowerLimitNum = 0;
}

void SIPCCMsg_SysManage_AddGWTG::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddGWTG";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	

	
	//tgName
	tgName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+tgName.length()+1, msgsize, strMsgName, "tgName", ip, port)) ) {return;}
	if ( !(VerifyData(tgName.length(), TRUNKGROUP_LEN, strMsgName, "tgName", ip, port)) ) {return;}
	theBufContent += (tgName.length()+1);
	//gwName
	gwName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+tgName.length()+1, msgsize, strMsgName, "gwName", ip, port)) ) {return;}
	if ( !(VerifyData(gwName.length(), GWNAME_LEN, strMsgName, "gwName", ip, port)) ) {return;}
	theBufContent += (gwName.length()+1);
	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += (corpName.length()+1);
	//calledNo
	calledNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsgName, "calledNo", ip, port)) ) {return;}
	if ( !(VerifyData(calledNo.length(), CALLEDNO_LEN, strMsgName, "calledNo", ip, port)) ) {return;}
	theBufContent += (calledNo.length()+1);

	//callinLicence
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "callinLicence", ip, port)) ) {return;}
	memmove(&callinLicence, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//calloutLicence
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "calloutLicence", ip, port)) ) {return;}
	memmove(&calloutLicence, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent == msgsize)
		return;

	mappingName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+mappingName.length()+1, msgsize, strMsgName, "mappingName", ip, port)) ) {return;}
	if ( !(VerifyData(mappingName.length(), MAPPINGNAME_LEN, strMsgName, "mappingName", ip, port)) ) {return;}
	theBufContent += (mappingName.length()+1);

	if(theBufContent >= msgsize)
		return;
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length() + 1;

	if(theBufContent == msgsize)
		return;

	tgPrefix = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+tgPrefix.length()+1, msgsize, strMsgName, "tgPrefix", ip, port)) ) {return;}
	if ( !(VerifyData(tgPrefix.length(), MAPPINGNAME_LEN, strMsgName, "tgPrefix", ip, port)) ) {return;}
	theBufContent += (tgPrefix.length()+1);



	if(theBufContent == msgsize)
		return;
	//computerSymbol
	computerSymbol = thebuf+theBufContent;	
	theBufContent += (computerSymbol.length()+1);

	
	//areaCode
	areaCode = thebuf+theBufContent;	
	theBufContent += (areaCode.length()+1);

	//operatorsInfo
	operatorsInfo = thebuf+theBufContent;	
	theBufContent += (operatorsInfo.length()+1);

	memmove(&allowCallType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&trunkCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//lowerLimitNum
	memmove(&lowerLimitNum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_SysManage_AddGWTG::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//tgName
	memmove(thebuf+theBufContent, this->tgName.c_str(), tgName.length()+1);
	theBufContent += (tgName.length()+1);
	//gwName
	memmove(thebuf+theBufContent, this->gwName.c_str(), gwName.length()+1);
	theBufContent += (gwName.length()+1);
	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), corpName.length()+1);
	theBufContent += (corpName.length()+1);
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo.c_str(), calledNo.length()+1);
	theBufContent += (calledNo.length()+1);
	//callinLicence
	memmove(thebuf+theBufContent, &callinLicence, sizeof(int));
	theBufContent += sizeof(int);
	//calloutLicence
	memmove(thebuf+theBufContent, &calloutLicence, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, mappingName.c_str(), mappingName.length() + 1 );
	theBufContent += ( mappingName.length() + 1 );

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length() + 1 );
	theBufContent += ( invokeID.length() + 1 );

	memcpy(thebuf+theBufContent, tgPrefix.c_str(), tgPrefix.length() + 1 );
	theBufContent += ( tgPrefix.length() + 1 );
	
	//
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length() + 1 );
	theBufContent += ( computerSymbol.length() + 1 );

	//
	memcpy(thebuf+theBufContent, areaCode.c_str(), areaCode.length() + 1 );
	theBufContent += ( areaCode.length() + 1 );

	//
	memcpy(thebuf+theBufContent, operatorsInfo.c_str(), operatorsInfo.length() + 1 );
	theBufContent += ( operatorsInfo.length() + 1 );

    //
    memmove(thebuf+theBufContent, &allowCallType, sizeof(int));
	theBufContent += sizeof(int);

	 //
    memmove(thebuf+theBufContent, &trunkCount, sizeof(int));
	theBufContent += sizeof(int);

	//lowerLimitNum
	memmove(thebuf+theBufContent, &lowerLimitNum, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_SysManage_AddGWTG::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += (tgName.length()+1);		//tgName
	memSize += (gwName.length()+1);		//gwName
	memSize += (corpName.length()+1);	//corpName
	memSize += (calledNo.length()+1);	//corpName
	memSize += sizeof(int);				//callinLicence
	memSize += sizeof(int);				//calloutLicence
	
	memSize += (mappingName.length()+1);	//mappingName

	memSize += (invokeID.length()+1);
	memSize += (tgPrefix.length()+1);

	memSize += (computerSymbol.length()+1);		//computerSymbol
	memSize += (areaCode.length()+1);		//areaCode
	memSize += (operatorsInfo.length()+1);		//operatorsInfo

	memSize += sizeof(int);				//allowCallType
	memSize += sizeof(int);				//trunkCount
	memSize += sizeof(int);				//lowerLimitNum

	return memSize;
}

///Type_SysManage_AddDeptTG
SIPCCMsg_SysManage_AddDeptTG::SIPCCMsg_SysManage_AddDeptTG()
{
	msgType = Type_SysManage_AddDeptTG;
	this->corpName = "";
	this->deptName = "";
	this->specialTGName = "";
	this->innerTGName = "";
	this->backupTGName = "";	// + [1/11/2008 lixg]

	enableDialNoRule = false;

	invokeID = "";
	defaultIADGName = "";
}

void SIPCCMsg_SysManage_AddDeptTG::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddDeptTG";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length() + 1;
	//deptName
	deptName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptName.length()+1, msgsize, strMsgName, "deptName", ip, port)) ) {return;}
	if ( !(VerifyData(deptName.length(), CORPNDEPT_LEN, strMsgName, "deptName", ip, port)) ) {return;}
	theBufContent += deptName.length() + 1;
	//specialTGName
	specialTGName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+specialTGName.length()+1, msgsize, strMsgName, "specialTGName", ip, port)) ) {return;}
	if ( !(VerifyData(specialTGName.length(), TRUNKGROUP_LEN, strMsgName, "specialTGName", ip, port)) ) {return;}
	theBufContent += specialTGName.length() + 1;
	//innerTGName
	innerTGName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+innerTGName.length()+1, msgsize, strMsgName, "innerTGName", ip, port)) ) {return;}
	if ( !(VerifyData(innerTGName.length(), TRUNKGROUP_LEN, strMsgName, "innerTGName", ip, port)) ) {return;}
	theBufContent += innerTGName.length() + 1;
	
	// backupTGName [1/11/2008 lixg]
	if(theBufContent >= msgsize)
		return;
	backupTGName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+backupTGName.length()+1, msgsize, strMsgName, "backupTGName", ip, port)) ) {return;}
	if ( !(VerifyData(backupTGName.length(), TRUNKGROUP_LEN, strMsgName, "backupTGName", ip, port)) ) {return;}
	theBufContent += backupTGName.length() + 1;

	if(theBufContent >= msgsize)
		return;
	longDisTGName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+longDisTGName.length()+1, msgsize, strMsgName, "longDisTGName", ip, port)) ) {return;}
	if ( !(VerifyData(longDisTGName.length(), TRUNKGROUP_LEN, strMsgName, "longDisTGName", ip, port)) ) {return;}
	theBufContent += longDisTGName.length() + 1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsgName, "enableDialNoRule", ip, port)) ) {return;}
	memcpy(&enableDialNoRule, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length() + 1;

	if(theBufContent >= msgsize)
		return;

	defaultIADGName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+defaultIADGName.length()+1, msgsize, strMsgName, "defaultIADGName", ip, port)) ) {return;}
	if ( !(VerifyData(defaultIADGName.length(), TRUNKGROUP_LEN, strMsgName, "defaultIADGName", ip, port)) ) {return;}
	theBufContent += defaultIADGName.length() + 1;
}

int SIPCCMsg_SysManage_AddDeptTG::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), corpName.length()+1);
	theBufContent += (corpName.length()+1);
	//deptName
	memmove(thebuf+theBufContent, this->deptName.c_str(), deptName.length()+1);
	theBufContent += (deptName.length()+1);
	//specialTGName
	memmove(thebuf+theBufContent, this->specialTGName.c_str(), specialTGName.length()+1);
	theBufContent += (specialTGName.length()+1);
	//innerTGName
	memmove(thebuf+theBufContent, this->innerTGName.c_str(), innerTGName.length()+1);
	theBufContent += (innerTGName.length()+1);
	
	// backupTGName  [1/11/2008 lixg]
	memmove(thebuf+theBufContent, this->backupTGName.c_str(), backupTGName.length()+1);
	theBufContent += (backupTGName.length()+1);

	memmove(thebuf+theBufContent, this->longDisTGName.c_str(), longDisTGName.length()+1);
	theBufContent += (longDisTGName.length()+1);

	memcpy(thebuf+theBufContent, &enableDialNoRule, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);
	
	memmove(thebuf+theBufContent, this->defaultIADGName.c_str(), defaultIADGName.length()+1);
	theBufContent += (defaultIADGName.length()+1);

	return theBufContent;
}

int SIPCCMsg_SysManage_AddDeptTG::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (corpName.length()+1);		//corpName
	memSize += (deptName.length()+1);		//deptName
	memSize += (specialTGName.length()+1);	//specialTGName
	memSize += (innerTGName.length()+1);	//innerTGName
	
	memSize += (backupTGName.length()+1);	// backupTGName [1/11/2008 lixg]

	memSize += (longDisTGName.length()+1);
	
	memSize += sizeof(char);
	memSize += (invokeID.length()+1);

	memSize += (defaultIADGName.length()+1);
	return memSize;
}

///Type_SysManage_AddDialRule
SIPCCMsg_SysManage_AddDialRule::SIPCCMsg_SysManage_AddDialRule()
{
	msgType = Type_SysManage_AddDialRule;
	this->corpName = "";
	this->tgName = "";
	this->checkedPrefix = "";
	this->delPrefixLen = 0;
	this->addPrefix = "";
}

void SIPCCMsg_SysManage_AddDialRule::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddDialRule";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corpName
	corpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length() + 1;
	//tgName
	tgName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+tgName.length()+1, msgsize, strMsgName, "tgName", ip, port)) ) {return;}
	if ( !(VerifyData(tgName.length(), TRUNKGROUP_LEN, strMsgName, "tgName", ip, port)) ) {return;}
	theBufContent += tgName.length() + 1;
	//checkedPrefix
	checkedPrefix = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+checkedPrefix.length()+1, msgsize, strMsgName, "checkedPrefix", ip, port)) ) {return;}
	if ( !(VerifyData(checkedPrefix.length(), CHECKEDPREFIX_LEN, strMsgName, "checkedPrefix", ip, port)) ) {return;}
	theBufContent += checkedPrefix.length() + 1;
	//delPrefixLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "delPrefixLen", ip, port)) ) {return;}
	memmove(&delPrefixLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//addPrefix
	addPrefix = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+addPrefix.length()+1, msgsize, strMsgName, "addPrefix", ip, port)) ) {return;}
	if ( !(VerifyData(addPrefix.length(), CHECKEDPREFIX_LEN, strMsgName, "addPrefix", ip, port)) ) {return;}
	theBufContent += addPrefix.length() + 1;

	if(theBufContent >= msgsize)
		return;
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_AddDialRule::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corpName
	memmove(thebuf+theBufContent, this->corpName.c_str(), corpName.length()+1);
	theBufContent += (corpName.length()+1);
	//tgName
	memmove(thebuf+theBufContent, this->tgName.c_str(), tgName.length()+1);
	theBufContent += (tgName.length()+1);
	//checkedPrefix
	memmove(thebuf+theBufContent, this->checkedPrefix.c_str(), checkedPrefix.length()+1);
	theBufContent += (checkedPrefix.length()+1);
	//delPrefixLen
	memmove(thebuf+theBufContent, &this->delPrefixLen, sizeof(int));
	theBufContent += sizeof(int);
	//addPrefix
	memmove(thebuf+theBufContent, this->addPrefix.c_str(), addPrefix.length()+1);
	theBufContent += (addPrefix.length()+1);

	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);
	
	return theBufContent;
}

int SIPCCMsg_SysManage_AddDialRule::GetMyMemSize()
{
	int memSize = 2*sizeof(int);				//msgclass+msgtype
	memSize += (corpName.length()+1);			//corpName
	memSize += (tgName.length()+1);				//tgName
	memSize += (checkedPrefix.length()+1);		//checkedPrefix
	memSize += sizeof(int);						//delPrefixLen
	memSize += (addPrefix.length()+1);			//addPrefix
	memSize += (invokeID.length()+1);

	return memSize;
}


SIPCCMsg_SysManage_NotifyACDLicence::SIPCCMsg_SysManage_NotifyACDLicence()
{
	msgType = Type_SysManage_NotifyACDLicence;
	licence = "";
	invokeID = "";
}

void SIPCCMsg_SysManage_NotifyACDLicence::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SysManage_NotifyACDLicence";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//licence
	licence = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+licence.length()+1, msgsize, strMsg, "licence.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(licence.length(), LICENCE_LEN, strMsg, "licence", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += licence.length() + 1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_NotifyACDLicence::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//licence
	memmove(thebuf+theBufContent, this->licence.c_str(), licence.length()+1);
	theBufContent += (licence.length()+1);

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += (invokeID.length()+1);

	return theBufContent;
}

int SIPCCMsg_SysManage_NotifyACDLicence::GetMyMemSize()
{
	int memSize = 2*sizeof(int);				//msgclass+msgtype

	memSize += (licence.length()+1);			//licence
	memSize += (invokeID.length()+1);			//invokeID

	return memSize;
}

///Type_SysManage_LoadServerInfoConf
SIPCCMsg_SysManage_LoadServerInfoConf::SIPCCMsg_SysManage_LoadServerInfoConf()
{
	msgType = Type_SysManage_LoadServerInfoConf;
	ManagerID = "";
	CorpName = "";
	ACDServerIP = "";
	PhoneNo = "";

	DataCollectServerIP = "";
	DataCollectServerPort = "";

	bLoad = 1;
	InvokeId = "";
	indexnum = 0;
	bSwitchACD = 0;
}

void SIPCCMsg_SysManage_LoadServerInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SysManage_LoadServerInfoConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ManagerID
	ManagerID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ManagerID.length()+1, msgsize, strMsg, "ManagerID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ManagerID.length(), MANAGERID_LEN, strMsg, "ManagerID", ip, port)) ) {return;}
	theBufContent += ManagerID.length() + 1;

	//CorpName
	CorpName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CorpName.length()+1, msgsize, strMsg, "CorpName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(CorpName.length(), CORPNAME_LEN, strMsg, "CorpName", ip, port)) ) {return;}
	theBufContent += CorpName.length() + 1;


	//ACDServerIP
	ACDServerIP = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ACDServerIP.length()+1, msgsize, strMsg, "ACDServerIP.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ACDServerIP.length(), IPADDRESS_LEN, strMsg, "ACDServerIP", ip, port)) ) {return;}
	theBufContent += ACDServerIP.length() + 1;

	//PhoneNo
	PhoneNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+PhoneNo.length()+1, msgsize, strMsg, "PhoneNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(PhoneNo.length(), GENERAL_LARGE_FIELD_LEN, strMsg, "PhoneNo", ip, port)) ) {return;}
	theBufContent += PhoneNo.length() + 1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//DataCollectServerIP
	DataCollectServerIP = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+DataCollectServerIP.length()+1, msgsize, strMsg, "DataCollectServerIP.length()", ip, port)) ) {return;}
	if ( !(VerifyData(DataCollectServerIP.length(), MSGCONTENT_LEN, strMsg, "DataCollectServerIP", ip, port)) ) {return;}
	theBufContent += DataCollectServerIP.length() + 1;

	//DataCollectServerPort
	DataCollectServerPort = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+DataCollectServerPort.length()+1, msgsize, strMsg, "DataCollectServerPort.length()", ip, port)) ) {return;}
	if ( !(VerifyData(DataCollectServerPort.length(), MSGCONTENT_LEN, strMsg, "DataCollectServerPort", ip, port)) ) {return;}
	theBufContent += DataCollectServerPort.length() + 1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	memmove(&bLoad, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//InvokeId
	InvokeId = thebuf+theBufContent;
	theBufContent += InvokeId.length() + 1;

    //indexnum
	memmove(&indexnum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//bSwitchACD
	memmove(&bSwitchACD, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_SysManage_LoadServerInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//ManagerID
	memmove(thebuf+theBufContent, this->ManagerID.c_str(), ManagerID.length()+1);
	theBufContent += (ManagerID.length()+1);

	//CorpName
	memmove(thebuf+theBufContent, this->CorpName.c_str(), CorpName.length()+1);
	theBufContent += (CorpName.length()+1);

	//ACDServerIP
	memmove(thebuf+theBufContent, this->ACDServerIP.c_str(), ACDServerIP.length()+1);
	theBufContent += (ACDServerIP.length()+1);

	//PhoneNo
	memmove(thebuf+theBufContent, this->PhoneNo.c_str(), PhoneNo.length()+1);
	theBufContent += (PhoneNo.length()+1);

	//DataCollectServerIP
	memmove(thebuf+theBufContent, this->DataCollectServerIP.c_str(), DataCollectServerIP.length()+1);
	theBufContent += (DataCollectServerIP.length()+1);

	//DataCollectServerPort
	memmove(thebuf+theBufContent, this->DataCollectServerPort.c_str(), DataCollectServerPort.length()+1);
	theBufContent += (DataCollectServerPort.length()+1);

	//bLoad
	memmove(thebuf+theBufContent, &bLoad, sizeof(int));
	theBufContent += sizeof(int);


	//InvokeId
	memmove(thebuf+theBufContent, this->InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += (InvokeId.length()+1);

    //indexnum
	memmove(thebuf+theBufContent, &indexnum, sizeof(int));
	theBufContent += sizeof(int);

	//bSwitchACD
	memmove(thebuf+theBufContent, &bSwitchACD, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_SysManage_LoadServerInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);				//msgclass+msgtype
	memSize += (ManagerID.length()+1);			//
	memSize += (CorpName.length()+1);			//corpName
	memSize += (ACDServerIP.length()+1);		//ACDServerIP
	memSize += (PhoneNo.length()+1);		//PhoneNo

	memSize += (DataCollectServerIP.length()+1);		//DataCollectServerIP
	memSize += (DataCollectServerPort.length()+1);		//DataCollectServerPort

	memSize += sizeof(int);						//bLoad

	memSize += (InvokeId.length()+1);			//InvokeId
	memSize += sizeof(int);						//indexnum

	memSize += sizeof(int);						//bSwitchACD

	return memSize;
}



///Class_SysManage
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_EndEgn
SIPCCMsg_EndEgn::SIPCCMsg_EndEgn()
{
	this->msgClass = Class_EndEgn;
	this->msgType = Type_EndEgn;
}

void SIPCCMsg_EndEgn::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_EndEgn::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_EndEgn::GetMyMemSize()
{
	return 2*sizeof(int);	//msgClass+msgType
}
///Class_EndEgn
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_HeartBeat
///Type_HeartBeat
SIPCCMsg_HeartBeat::SIPCCMsg_HeartBeat()
{
	this->msgClass = Class_HeartBeat;
	this->msgType = Type_HeartBeat;
	
	theSender = NULL;
	theSenderLen = 0;
	sipPhoneIP = 0;
	sipPhoneRtpPort = 0;
	sipPhoneRtcpPort = 0;
	clientType = ClientType_Agent;	// [scq/2010-05-18]
	redundancyRate = 1;
}

void SIPCCMsg_HeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_HeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//theSenderLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "theSenderLen", ip, port)) ) {return;}
	memmove(&this->theSenderLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theSenderLen, SENDER_LEN, strMsgName, "userNameLen", ip, port)) ) {return;}

	//theSender
	if ( !(VerifyTotalLen(theBufContent+theSenderLen, msgsize, strMsgName, "theSender", ip, port)) ) {return;}
	theSender = new char[theSenderLen];
	memset(theSender, 0, theSenderLen);
	memmove(theSender, thebuf+theBufContent, theSenderLen);
	theBufContent += theSenderLen;

	if ( theBufContent >= msgsize )
	{
		return;
	}
	//haoy add //////////////////////////////
	if ( !(VerifyTotalLen(theBufContent+sizeof(this->sipPhoneIP), msgsize, strMsgName, "sipPhoneIP", ip, port)) ) {return;}
	memmove(&(this->sipPhoneIP),thebuf+theBufContent,sizeof(this->sipPhoneIP));
	theBufContent += sizeof(this->sipPhoneIP);

	if ( !(VerifyTotalLen(theBufContent+sizeof(this->sipPhoneRtpPort), msgsize, strMsgName, "sipPhoneRtpPort", ip, port)) ) {return;}
	memmove(&(this->sipPhoneRtpPort),thebuf+theBufContent,sizeof(this->sipPhoneRtpPort));
	theBufContent += sizeof(this->sipPhoneRtpPort);

	if ( !(VerifyTotalLen(theBufContent+sizeof(this->sipPhoneRtcpPort), msgsize, strMsgName, "sipPhoneRtcpPort", ip, port)) ) {return;}
	memmove(&(this->sipPhoneRtcpPort),thebuf+theBufContent,sizeof(this->sipPhoneRtcpPort));
	theBufContent += sizeof(this->sipPhoneRtcpPort);	
	////////////////////////////////////////

	// [scq/start/2010-05-18]
	if ( theBufContent>=msgsize )
	{
		return;
	}
	// clientType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "clientType", ip, port)) ) {return;}
	memmove(&(this->clientType), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-18]

	if ( theBufContent>=msgsize )
	{
		return;
	}
	// clientType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "redundancyRate", ip, port)) ) {return;}
	memmove(&(this->redundancyRate), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_HeartBeat::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theSenderLen
	memmove(thebuf+theBufContent, &this->theSenderLen, sizeof(int));
	theBufContent += sizeof(int);
	//theSender
	memmove(thebuf+theBufContent, this->theSender, this->theSenderLen);
	theBufContent += theSenderLen;
	//haoy add //////////////////////////////
	memmove(thebuf+theBufContent, &(this->sipPhoneIP), sizeof(this->sipPhoneIP));
	theBufContent += sizeof(this->sipPhoneIP);

	memmove(thebuf+theBufContent, &(this->sipPhoneRtpPort), sizeof(this->sipPhoneRtpPort));
	theBufContent += sizeof(this->sipPhoneRtpPort);

	memmove(thebuf+theBufContent, &(this->sipPhoneRtcpPort), sizeof(this->sipPhoneRtcpPort));
	theBufContent += sizeof(this->sipPhoneRtcpPort);
	////////////////////////////////////////
	
	// [scq/start/2010-05-18]
	// clientType
	memmove(thebuf+theBufContent, &(this->clientType), sizeof(int));
	theBufContent += sizeof(int);
	// [scq/end/2010-05-18]

	memmove(thebuf+theBufContent, &(this->redundancyRate), sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_HeartBeat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);	//msgClass+msgType
	memSize += sizeof(int);			//theSenderLen
	memSize += this->theSenderLen;	//theSender
	memSize += sizeof(sipPhoneIP);
	memSize += sizeof(sipPhoneRtpPort);
	memSize += sizeof(sipPhoneRtcpPort);
	memSize += sizeof(int);	// [scq/2010-05-12] clientType
	memSize += sizeof(int);// redundancyRate
	
	return memSize;
}

///Type_HeartBeatResponse
SIPCCMsg_HeartBeatResponse::SIPCCMsg_HeartBeatResponse()
{
	this->msgClass = Class_HeartBeat;
	this->msgType = Type_HeartBeatResponse;
	ServiceCode = -1;
}

void SIPCCMsg_HeartBeatResponse::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//ServiceCode
	memmove(&this->ServiceCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	
}

int SIPCCMsg_HeartBeatResponse::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ServiceCode
	memmove(thebuf+theBufContent, &this->ServiceCode, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_HeartBeatResponse::GetMyMemSize()
{
	int memSize = 2*sizeof(int);	//msgClass+msgType
	memSize += sizeof(int);
	return memSize;
}

///Class_HeartBeat
/////////////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_P2P
SIPCCMsg_P2P::SIPCCMsg_P2P()
{
	msgClass = Class_P2P;
}

///Type_P2P_ConnRequest
SIPCCMsg_P2P_ConnRequest::SIPCCMsg_P2P_ConnRequest()
{
	msgType = Type_P2P_ConnRequest;
	callID = NULL;
	callIDLen = 0;
	//clientType = 0;
	mediaType = -1;
	localIP = 0;
	localPort = 0;
	natType = -1;
	seq = 0;
	lastReqIsTest = 0;
}

void SIPCCMsg_P2P_ConnRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//clienType
	//memmove(&this->clientType, thebuf+theBufContent, sizeof(int));
	//theBufContent += sizeof(int);
	//mediaType
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//localIP
	memmove(&this->localIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	memmove(&this->localPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//natType
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//lastReqIsTest
	memmove(&this->lastReqIsTest, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_P2P_ConnRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	////clientType
	//memmove(thebuf+theBufContent, &this->clientType, sizeof(int));
	//theBufContent += sizeof(int);
	//mediaType
	memmove(thebuf+theBufContent, &this->mediaType, sizeof(int));
	theBufContent += sizeof(int);
	//localIP
	memmove(thebuf+theBufContent, &this->localIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	memmove(thebuf+theBufContent, &this->localPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);
	//lastReqIsTest
	memmove(thebuf+theBufContent, &this->lastReqIsTest, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_ConnRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	//memSize += sizeof(int);				//clientType
	memSize += sizeof(int);				//mediaType
	memSize += sizeof(unsigned long);	//localIP
	memSize += sizeof(unsigned short);	//localPort
	memSize += sizeof(int);				//natType
	memSize += sizeof(int);				//seq
	memSize += sizeof(char);			//lastReqIsTest
	
	return memSize;
}

void SIPCCMsg_P2P_ConnRequest::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

///Type_P2P_ConnRequestConf
SIPCCMsg_P2P_ConnRequestConf::SIPCCMsg_P2P_ConnRequestConf()
{
	msgType = Type_P2P_ConnRequestConf;
	//agentIP = 0;
	//agentPort = 0;
	targetIP = 0;
	targetPort = 0;
	bNeedGuess = 0;
}

void SIPCCMsg_P2P_ConnRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	////agentIP
	//memmove(&this->agentIP, thebuf+theBufContent, sizeof(unsigned long));
	//theBufContent += sizeof(unsigned long);
	////agentPort
	//memmove(&this->agentPort, thebuf+theBufContent, sizeof(unsigned short));
	//theBufContent += sizeof(unsigned short);
	
	//targetIP
	memmove(&this->targetIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//targetPort
	memmove(&this->targetPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//bNeedGuess
	memmove(&this->bNeedGuess, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
}

int SIPCCMsg_P2P_ConnRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	////agentIP
	//memmove(thebuf+theBufContent, &this->agentIP, sizeof(unsigned long));
	//theBufContent += sizeof(unsigned long);
	////agentPort
	//memmove(thebuf+theBufContent, &this->agentPort, sizeof(unsigned short));
	//theBufContent += sizeof(unsigned short);
	
	//targetIP
	memmove(thebuf+theBufContent, &this->targetIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//targetPort
	memmove(thebuf+theBufContent, &this->targetPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//bNeedGuess
	memmove(thebuf+theBufContent, &this->bNeedGuess, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_ConnRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	//memSize += sizeof(unsigned long);	//agentIP
	//memSize += sizeof(unsigned short);	//agentPort
	
	memSize += sizeof(unsigned long);	//targetIP
	memSize += sizeof(unsigned short);	//targetPort
	memSize += sizeof(char);	//bNeedGuess
	
	return memSize;
}

///Type_P2P_MakeHoleCmd
SIPCCMsg_P2P_MakeHoleCmd::SIPCCMsg_P2P_MakeHoleCmd()
{
	msgType = Type_P2P_MakeHoleCmd;
	//userIP = 0;
	//userPort = 0;
	targetIP = 0;
	targetPort = 0;
	callID = NULL;
	callIDLen = 0;
	bNeedGuess = 0;
}

void SIPCCMsg_P2P_MakeHoleCmd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	////userIP
	//memmove(&this->userIP, thebuf+theBufContent, sizeof(unsigned long));
	//theBufContent += sizeof(unsigned long);
	////userPort
	//memmove(&this->userPort, thebuf+theBufContent, sizeof(unsigned short));
	//theBufContent += sizeof(unsigned short);
	
	//targetIP
	memmove(&this->targetIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//targetPort
	memmove(&this->targetPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//bNeedGuess
	memmove(&this->bNeedGuess, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_P2P_MakeHoleCmd::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	////userIP
	//memmove(thebuf+theBufContent, &this->userIP, sizeof(unsigned long));
	//theBufContent += sizeof(unsigned long);
	////userPort
	//memmove(thebuf+theBufContent, &this->userPort, sizeof(unsigned short));
	//theBufContent += sizeof(unsigned short);
	
	//targetIP
	memmove(thebuf+theBufContent, &this->targetIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//targetPort
	memmove(thebuf+theBufContent, &this->targetPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//bNeedGuess
	memmove(thebuf+theBufContent, &this->bNeedGuess, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_MakeHoleCmd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(char);				//bNeedGuess	
	memSize += sizeof(unsigned long);		//targetIP
	memSize += sizeof(unsigned short);		//targetPort
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(char);				//bNeedGuess
	
	return memSize;
}

///Type_P2P_MakeHoleCmdConf
SIPCCMsg_P2P_MakeHoleCmdConf::SIPCCMsg_P2P_MakeHoleCmdConf()
{
	msgType = Type_P2P_MakeHoleCmdConf;
	//userIP = 0;
	//userPort = 0;
	callID = NULL;
	callIDLen = 0;
}

void SIPCCMsg_P2P_MakeHoleCmdConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	////userIP
	//memmove(&this->userIP, thebuf+theBufContent, sizeof(unsigned long));
	//theBufContent += sizeof(unsigned long);
	////userPort
	//memmove(&this->userPort, thebuf+theBufContent, sizeof(unsigned short));
	//theBufContent += sizeof(unsigned short);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
}

int SIPCCMsg_P2P_MakeHoleCmdConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	////userIP
	//memmove(thebuf+theBufContent, &this->userIP, sizeof(unsigned long));
	//theBufContent += sizeof(unsigned long);
	////userPort
	//memmove(thebuf+theBufContent, &this->userPort, sizeof(unsigned short));
	//theBufContent += sizeof(unsigned short);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	return theBufContent;
}

int SIPCCMsg_P2P_MakeHoleCmdConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	//memSize += sizeof(unsigned long);	//userIP
	//memSize += sizeof(unsigned short);	//userPort
	
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	
	return memSize;
}

///Type_P2P_MakeHoleMsg
SIPCCMsg_P2P_MakeHoleMsg::SIPCCMsg_P2P_MakeHoleMsg()
{
	msgType = Type_P2P_MakeHoleMsg;
}

void SIPCCMsg_P2P_MakeHoleMsg::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_P2P_MakeHoleMsg::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_P2P_MakeHoleMsg::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_P2P_TestMsg
SIPCCMsg_P2P_TestMsg::SIPCCMsg_P2P_TestMsg()
{
	msgType = Type_P2P_TestMsg;
	seq = 0;
}

void SIPCCMsg_P2P_TestMsg::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//seq
	memmove(&this->seq, thebuf+theBufContent, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
}

int SIPCCMsg_P2P_TestMsg::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//seq
	memmove(thebuf+theBufContent, &this->seq, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_TestMsg::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(unsigned char);	//seq
	
	return memSize;
}

///Type_P2P_TestMsgConf
SIPCCMsg_P2P_TestMsgConf::SIPCCMsg_P2P_TestMsgConf()
{
	msgType = Type_P2P_TestMsgConf;
	
	mediaHeadData = NULL;
	mediaHeadDataLen = 0;
	
	seq = 0;
}

void SIPCCMsg_P2P_TestMsgConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//mediaHeadDataLen
	memmove(&this->mediaHeadDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//mediaHeadData
	mediaHeadData = new char[mediaHeadDataLen];
	memset(mediaHeadData, 0, mediaHeadDataLen);
	memmove(this->mediaHeadData, thebuf+theBufContent, mediaHeadDataLen);
	theBufContent += mediaHeadDataLen;
	
	//seq
	memmove(&this->seq, thebuf+theBufContent, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
}

int SIPCCMsg_P2P_TestMsgConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//mediaHeadDataLen
	memmove(thebuf+theBufContent, &this->mediaHeadDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//mediaHeadData
	memmove(thebuf+theBufContent, this->mediaHeadData, mediaHeadDataLen);
	theBufContent += mediaHeadDataLen;
	
	//seq
	memmove(thebuf+theBufContent, &this->seq, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	
	return theBufContent;
}

void SIPCCMsg_P2P_TestMsgConf::SetMediaHeadData(char* mediaheaddata, int len)
{
	if(len > 0)
	{
		mediaHeadData = new char[len];
		this->mediaHeadDataLen = len;
		memmove(mediaHeadData, mediaheaddata, len);
	}
}

int SIPCCMsg_P2P_TestMsgConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//mediaHeadDataLen
	memSize += this->mediaHeadDataLen;	//mediaHeadData
	
	memSize += sizeof(unsigned char);	//seq
	
	return memSize;
}

///Type_P2P_DirectConn
SIPCCMsg_P2P_DirectConn::SIPCCMsg_P2P_DirectConn()
{
	msgType = Type_P2P_DirectConn;
	oppIP = 0;
	oppPort = 0;
}

void SIPCCMsg_P2P_DirectConn::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//oppIP
	memmove(&this->oppIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//oppPort
	memmove(&this->oppPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_P2P_DirectConn::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//oppIP
	memmove(thebuf+theBufContent, &this->oppIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//oppPort
	memmove(thebuf+theBufContent, &this->oppPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_P2P_DirectConn::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned long);	//oppIP
	memSize += sizeof(unsigned short);	//oppPort
	
	return memSize;
}

///SIPCCMsg_P2P_ConnDifficultMsg
SIPCCMsg_P2P_ConnDifficultMsg::SIPCCMsg_P2P_ConnDifficultMsg()
{
	msgType = Type_P2P_ConnDifficultMsg;
	natType = -1;
}

void SIPCCMsg_P2P_ConnDifficultMsg::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//natType
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_P2P_ConnDifficultMsg::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_P2P_ConnDifficultMsg::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//natType
	
	return memSize;
}

///SIPCCMsg_P2P_CheckNatRequest
SIPCCMsg_P2P_CheckNatRequest::SIPCCMsg_P2P_CheckNatRequest()
{
	msgType = Type_P2P_ChechNatRequest;
	RequestID = 0;
	RequestSeq = 0;
	ConfSeq = 0;
}

void SIPCCMsg_P2P_CheckNatRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//RequestID
	memmove(&this->RequestID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//RequestSeq
	memmove(&this->RequestSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//ConfSeq
	memmove(&this->ConfSeq, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_P2P_CheckNatRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//RequestID
	memmove(thebuf+theBufContent, &this->RequestID, sizeof(int));
	theBufContent += sizeof(int);
	//RequestSeq
	memmove(thebuf+theBufContent, &this->RequestSeq, sizeof(int));
	theBufContent += sizeof(int);
	//ConfSeq
	memmove(thebuf+theBufContent, &this->ConfSeq, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_CheckNatRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//RequestID
	memSize += sizeof(int);				//RequestSeq
	memSize += sizeof(char);			//ConfSeq
	
	return memSize;
}

///SIPCCMsg_P2P_CheckNatConf
SIPCCMsg_P2P_CheckNatConf::SIPCCMsg_P2P_CheckNatConf()
{
	msgType = Type_P2P_ChechNatConf;
	RequestID = 0;
	RequestSeq = 0;
	WanIP = 0;
	WanPort = 0;
}

void SIPCCMsg_P2P_CheckNatConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//RequestID
	memmove(&this->RequestID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//RequestSeq
	memmove(&this->RequestSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//WanIP
	memmove(&this->WanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//WanPort
	memmove(&this->WanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_P2P_CheckNatConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//RequestID
	memmove(thebuf+theBufContent, &this->RequestID, sizeof(int));
	theBufContent += sizeof(int);
	//RequestSeq
	memmove(thebuf+theBufContent, &this->RequestSeq, sizeof(int));
	theBufContent += sizeof(int);
	//WanIP
	memmove(thebuf+theBufContent, &this->WanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//WanPort
	memmove(thebuf+theBufContent, &this->WanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_P2P_CheckNatConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//RequestID
	memSize += sizeof(int);				//RequestSeq
	memSize += sizeof(unsigned long);	//WanIP
	memSize += sizeof(unsigned short);	//WanPort
	
	return memSize;
}

///SIPCCMsg_P2P_ReInitSockCmd
SIPCCMsg_P2P_ReInitSockCmd::SIPCCMsg_P2P_ReInitSockCmd()
{
	msgType = Type_P2P_ReInitSockCmd;
	Port = 0;
}

void SIPCCMsg_P2P_ReInitSockCmd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//Port
	memmove(&this->Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_P2P_ReInitSockCmd::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//Port
	memmove(thebuf+theBufContent, &this->Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_P2P_ReInitSockCmd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned short);	//Port
	
	return memSize;
}

///SIPCCMsg_P2P_MediaNegotiate
SIPCCMsg_P2P_MediaNegotiate::SIPCCMsg_P2P_MediaNegotiate()
{
	msgType = Type_P2P_MediaNegotiate;
	MediaCapability = MediaType_None;
}

void SIPCCMsg_P2P_MediaNegotiate::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//MediaCapability
	memmove(&this->MediaCapability, thebuf+theBufContent, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
}

int SIPCCMsg_P2P_MediaNegotiate::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//MediaCapability
	memmove(thebuf+theBufContent, &this->MediaCapability, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_MediaNegotiate::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned char);	//MediaCapability
	
	return memSize;
}

///SIPCCMsg_P2P_MediaNegotiateConf
SIPCCMsg_P2P_MediaNegotiateConf::SIPCCMsg_P2P_MediaNegotiateConf()
{
	msgType = Type_P2P_MediaNegotiateConf;
	MediaCapability = MediaType_None;
}

void SIPCCMsg_P2P_MediaNegotiateConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//MediaCapability
	memmove(&this->MediaCapability, thebuf+theBufContent, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
}

int SIPCCMsg_P2P_MediaNegotiateConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//MediaCapability
	memmove(thebuf+theBufContent, &this->MediaCapability, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_MediaNegotiateConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned char);	//MediaCapability
	
	return memSize;
}

///Type_P2P_ReInitSockFailed
SIPCCMsg_P2P_ReInitSockFailed::SIPCCMsg_P2P_ReInitSockFailed()
{
	msgType = Type_P2P_ReInitSockFailed;
	callID = NULL;
	callIDLen = 0;
	mediaType = -1;
	seq = 0;
}

void SIPCCMsg_P2P_ReInitSockFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
}

int SIPCCMsg_P2P_ReInitSockFailed::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(thebuf+theBufContent, &this->mediaType, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(thebuf+theBufContent, &this->seq, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	
	return theBufContent;
}

int SIPCCMsg_P2P_ReInitSockFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//mediaType
	memSize += sizeof(unsigned char);	//seq
	
	return memSize;
}

void SIPCCMsg_P2P_ReInitSockFailed::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}
///Class_P2P
///////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_Transmit
SIPCCMsg_Transmit::SIPCCMsg_Transmit()
{
	msgClass = Class_Transmit;
}
///Type_Trans_TransmitRequest
SIPCCMsg_Trans_TransmitRequest::SIPCCMsg_Trans_TransmitRequest()
{
	msgType = Type_Trans_TransmitRequest;
	
	callID = NULL;
	callIDLen = 0;
	mediaHeadData = NULL;
	mediaHeadDataLen = 0;

	nSeq  = 0;				// 同一个invokeID的计数标记
	cIsAgentRecord = 0;	// 1录音，其他值不录音； 此字段被动通话方座席置0即可
	ulRecServerIP = 0;	// 录音IP网络字节序，由用户端通知到中转Server
	nRecServerPort = 0;		// 录音端口网络字节序，由用户端通知到中转Server
	bOldFormat=true;
	m_nPackedSize = 0;
}

void SIPCCMsg_Trans_TransmitRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Trans_TransmitRequest";
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//mediaHeadDataLen
	memmove(&this->mediaHeadDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//mediaHeadData
	mediaHeadData = new char[mediaHeadDataLen];
	memset(mediaHeadData, 0, mediaHeadDataLen);
	memmove(this->mediaHeadData, thebuf+theBufContent, mediaHeadDataLen);
	theBufContent += mediaHeadDataLen;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	memmove(&this->nSeq, thebuf+theBufContent, sizeof(nSeq));
	theBufContent += sizeof(nSeq);
	memmove(&this->cIsAgentRecord, thebuf+theBufContent, sizeof(cIsAgentRecord));
	theBufContent += sizeof(cIsAgentRecord);
	memmove(&this->ulRecServerIP, thebuf+theBufContent, sizeof(ulRecServerIP));
	theBufContent += sizeof(ulRecServerIP);
	memmove(&this->nRecServerPort, thebuf+theBufContent, sizeof(nRecServerPort));
	theBufContent += sizeof(nRecServerPort);
	strPresideAgentAccount = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strPresideAgentAccount.length()+1, msgsize, strMsg, "strPresideAgentAccount.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strPresideAgentAccount.length(), AGENTID_LEN, strMsg, "strPresideAgentAccount", ip, port)) ) {return;}
	theBufContent += strPresideAgentAccount.length()+1;

	strCodec = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strCodec.length()+1, msgsize, strMsg, "strCodec.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strCodec.length(), CODEC_LEN, strMsg, "strCodec", ip, port)) ) {return;}
	theBufContent += strCodec.length()+1;
	memmove(&this->bOldFormat, thebuf+theBufContent, sizeof(bOldFormat));
	theBufContent += sizeof(bOldFormat);

	if ( !(VerifyTotalLen(theBufContent+sizeof(m_nPackedSize), msgsize, strMsg, "m_nPackedSize", ip, port)) ) 
	{
		return;
	}
	if ( !(VerifyData(*((int*)(thebuf+theBufContent)), PACKED_SIZE, strMsg, "m_nPackedSize", ip, port)) ) 
	{
		return;
	}
	memmove(&this->m_nPackedSize, thebuf+theBufContent, sizeof(m_nPackedSize));
	theBufContent += sizeof(m_nPackedSize);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_Trans_TransmitRequest::FillBuf(char*&  thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//mediaHeadDataLen
	memmove(thebuf+theBufContent, &this->mediaHeadDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//mediaHeadData
	memmove(thebuf+theBufContent, this->mediaHeadData, mediaHeadDataLen);
	theBufContent += mediaHeadDataLen;
	

	memmove(thebuf+theBufContent, &this->nSeq, sizeof(nSeq));
	theBufContent += sizeof(nSeq);
	memmove(thebuf+theBufContent, &this->cIsAgentRecord, sizeof(cIsAgentRecord));
	theBufContent += sizeof(cIsAgentRecord);
	memmove(thebuf+theBufContent, &this->ulRecServerIP, sizeof(ulRecServerIP));
	theBufContent += sizeof(ulRecServerIP);
	memmove(thebuf+theBufContent, &this->nRecServerPort, sizeof(nRecServerPort));
	theBufContent += sizeof(nRecServerPort);
	memcpy(thebuf+theBufContent, strPresideAgentAccount.c_str(), strPresideAgentAccount.length()+1);
	theBufContent += strPresideAgentAccount.length()+1;

	memcpy(thebuf+theBufContent, strCodec.c_str(), strCodec.length()+1);
	theBufContent += strCodec.length()+1;
	memmove(thebuf+theBufContent, &this->bOldFormat, sizeof(bOldFormat));
	theBufContent += sizeof(bOldFormat);
	memmove(thebuf+theBufContent, &this->m_nPackedSize, sizeof(m_nPackedSize));
	theBufContent += sizeof(m_nPackedSize);
	
	//audioStreamDescription
	theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);
	
	return theBufContent;
}

int SIPCCMsg_Trans_TransmitRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//mediaHeadDataLen
	memSize += this->mediaHeadDataLen;	//mediaHeadData

	memSize += sizeof(nSeq);
	memSize += sizeof(cIsAgentRecord);
	memSize += sizeof(ulRecServerIP);
	memSize += sizeof(nRecServerPort);
	memSize += strPresideAgentAccount.length()+1;

	memSize += strCodec.length()+1;
	memSize += sizeof(bOldFormat);
	memSize += sizeof(m_nPackedSize);

	memSize += audioStreamDescription.GetMemSize();

	return memSize;
}

void SIPCCMsg_Trans_TransmitRequest::SetMediaHeadData(char* mediaheaddata, int len)
{
	if(len > 0)
	{
		mediaHeadData = new char[len];
		this->mediaHeadDataLen = len;
		memmove(mediaHeadData, mediaheaddata, len);
	}
}

///Type_Trans_TransmitRequestConf
SIPCCMsg_Trans_TransmitRequestConf::SIPCCMsg_Trans_TransmitRequestConf()
{
	msgType = Type_Trans_TransmitRequestConf;
	
	mediaHeadData = NULL;
	mediaHeadDataLen = 0;
	textPort = 0;
	audioPort = 0;
}

void SIPCCMsg_Trans_TransmitRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//mediaHeadDataLen
	memmove(&this->mediaHeadDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//mediaHeadData
	mediaHeadData = new char[mediaHeadDataLen];
	memset(mediaHeadData, 0, mediaHeadDataLen);
	memmove(this->mediaHeadData, thebuf+theBufContent, mediaHeadDataLen);
	theBufContent += mediaHeadDataLen;
	//textPort
	memmove(&this->textPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//audioPort
	memmove(&this->audioPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_Trans_TransmitRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//mediaHeadDataLen
	memmove(thebuf+theBufContent, &this->mediaHeadDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//mediaHeadData
	memmove(thebuf+theBufContent, this->mediaHeadData, mediaHeadDataLen);
	theBufContent += mediaHeadDataLen;
	//textPort
	memmove(thebuf+theBufContent, &this->textPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//audioPort
	memmove(thebuf+theBufContent, &this->audioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_Trans_TransmitRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//mediaHeadDataLen
	memSize += this->mediaHeadDataLen;	//mediaHeadData
	memSize += sizeof(unsigned short);	//textPort
	memSize += sizeof(unsigned short);	//audioPort
	return memSize;
}

void SIPCCMsg_Trans_TransmitRequestConf::SetMediaHeadData(char* mediaheaddata, int len)
{
	if(len > 0)
	{
		mediaHeadData = new char[len];
		this->mediaHeadDataLen = len;
		memmove(mediaHeadData, mediaheaddata, len);
	}
}

///Type_Trans_TransmitStopRequest
SIPCCMsg_Trans_TransmitStopRequest::SIPCCMsg_Trans_TransmitStopRequest()
{
	msgType = Type_Trans_TransmitStopRequest;
	
	callID = NULL;
	callIDLen = 0;
}

void SIPCCMsg_Trans_TransmitStopRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
}

int SIPCCMsg_Trans_TransmitStopRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	return theBufContent;
}

int SIPCCMsg_Trans_TransmitStopRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	
	return memSize;
}

///Type_Trans_TransmitRejected
SIPCCMsg_Trans_TransmitRejected::SIPCCMsg_Trans_TransmitRejected()
{
	msgType = Type_Trans_TransmitRejected;
}

void SIPCCMsg_Trans_TransmitRejected::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Trans_TransmitRejected::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Trans_TransmitRejected::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Class_Transmit
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_UState
SIPCCMsg_UState::SIPCCMsg_UState()
{
	msgClass = Class_UState;
}

///Type_UState_CallArriveToAgent
SIPCCMsg_UState_CallArriveToAgent::SIPCCMsg_UState_CallArriveToAgent()
{
	msgType = Type_UState_CallArriveToAgent;
	
	agentID = NULL;
	agentIDLen = 0;
	userName = NULL;
	userNameLen = 0;
	
	lanIp = 0;
	wanIp = 0;

	nickName = "";
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_CallArriveToAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	//lanIp
	memmove(&this->lanIp, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//wanIp
	memmove(&this->wanIp, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent >= msgsize)
		return;

	nickName = thebuf + theBufContent;
	theBufContent += nickName.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_UState_CallArriveToAgent::FillBuf(char*&  thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	//lanIp
	memmove(thebuf+theBufContent, &this->lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//wanIp
	memmove(thebuf+theBufContent, &this->wanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length()+1);
	theBufContent += nickName.length()+1;

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_UState_CallArriveToAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	
	memSize += sizeof(unsigned long);	//lanIp
	memSize += sizeof(unsigned long);	//wanIp

	memSize += nickName.length()+1;		//nickName

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol
	
	memSize += audioStreamDescription.GetMemSize();

    return memSize;
}

void SIPCCMsg_UState_CallArriveToAgent::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_UState_CallArriveToAgent::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_UState_CallReceived
SIPCCMsg_UState_CallReceived::SIPCCMsg_UState_CallReceived()
{
	msgType = Type_UState_CallReceived;
	callerParty = NULL;
	callerPartyLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	callID = NULL;
	callIDLen = 0;
	corporationName = NULL;
	corporationNameLen = 0;
	callerNoForSend = "";
	callerPartyType = CallParty_Agent;
	
	outdialPrefixNo = "";
	uuiData2 = "";

	operatorsInfo = "";


	gatewayName="";
	computerSymbol="";

	netPath = "";
}

void SIPCCMsg_UState_CallReceived::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_CallReceived";
	
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callerPartyLen
	memmove(&this->callerPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callerParty
	callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memmove(callerParty, thebuf+theBufContent, callerPartyLen);
	theBufContent += callerPartyLen;
	
	//uuiDataLen
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	
	if(theBufContent == msgsize)
		return;
	
	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	//callerPartyType
	memmove(&callerPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent == msgsize)
		return;
	
	//callerNoForSend
	wpAgentID = thebuf+theBufContent;
	theBufContent += wpAgentID.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	//outdialPrefixNo
	outdialPrefixNo = thebuf+theBufContent;
	theBufContent += outdialPrefixNo.length()+1;

	if(theBufContent == msgsize)
		return;

	//uuiData2
	uuiData2 = thebuf+theBufContent;
	theBufContent += uuiData2.length()+1;

	if(theBufContent == msgsize)
		return;

	//operatorsInfo
	operatorsInfo = thebuf+theBufContent;
	theBufContent += operatorsInfo.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;



	if ( theBufContent >= msgsize)
	{
		return;
	}
	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent += computerSymbol.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1;

}

int SIPCCMsg_UState_CallReceived::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callerPartyLen
	memmove(thebuf+theBufContent, &this->callerPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//callerParty
	memmove(thebuf+theBufContent, this->callerParty, this->callerPartyLen);
	theBufContent += callerPartyLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	//callerPartyType
	memmove(thebuf+theBufContent, &this->callerPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;
	
	memmove(thebuf+theBufContent, outdialPrefixNo.c_str(), outdialPrefixNo.length()+1);
	theBufContent += outdialPrefixNo.length()+1;

	memmove(thebuf+theBufContent, uuiData2.c_str(), uuiData2.length()+1);
	theBufContent += uuiData2.length()+1;
	
	memmove(thebuf+theBufContent, operatorsInfo.c_str(), operatorsInfo.length()+1);
	theBufContent += operatorsInfo.length()+1;

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_CallReceived::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callerPartyL
	memSize += this->callerPartyLen;		//callerParty
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += sizeof(int);					//callerPartyType
	
	memSize += wpAgentID.length()+1;
	memSize += outdialPrefixNo.length()+1;
	memSize += uuiData2.length()+1;			//uuiData2

	memSize += operatorsInfo.length()+1;	//operatorsInfo

	memSize += managerId.length()+1;		//managerId

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	memSize += netPath.length()+1;			//netPath

	return memSize;
}

void SIPCCMsg_UState_CallReceived::SetCallerParty(string callerparty)
{
	int iCallerPartyLen = callerparty.length();
	this->callerPartyLen = iCallerPartyLen + 1;
	this->callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memcpy(callerParty, callerparty.c_str(), iCallerPartyLen);
}

void SIPCCMsg_UState_CallReceived::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_UState_CallReceived::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_UState_CallReceived::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_UState_CallReceived2
SIPCCMsg_UState_CallReceived2::SIPCCMsg_UState_CallReceived2()
{
	msgType = Type_UState_CallReceived2;
	callerParty = NULL;
	callerPartyLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	callID = NULL;
	callIDLen = 0;
	corporationName = NULL;
	corporationNameLen = 0;
	callerNoForSend = "";
	callerPartyType = CallParty_Agent;
	invokeID = "";
	usableTime = 0;
	userName = "";
	
	lanIp = 0;
	wanIp = 0;
	
	outDialType = OutDialType_Normal;
	
	calledOperType = WpAgentLineOperType_None;

	callTransID = "";
	extPhoneNo = "";
	recordFilePath = "";

	LowLevelPrefixNo = "";

	nickName = "";

	RecordMode = 0;

	the2nd_dial_valid = false;
	the2nd_dial_digit = "";
	the3rd_media_valid = false;//
	the3rd_media_address = "";
	the3rd_media_port = 0;

	gatewayName="";
	computerSymbol="";

	token = "";
}

void SIPCCMsg_UState_CallReceived2::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callerPartyLen
	memmove(&this->callerPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callerParty
	callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memmove(callerParty, thebuf+theBufContent, callerPartyLen);
	theBufContent += callerPartyLen;
	
	//uuiDataLen
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1;
	
	//callerPartyType
	memmove(&callerPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
	
	//usableTime
	memmove(&this->usableTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//userName
	userName = thebuf+theBufContent;
	theBufContent += userName.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	//lanIp
	memmove(&this->lanIp, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//wanIp
	memmove(&this->wanIp, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;
	
	//calledOperType
	memmove(&this->calledOperType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if ( theBufContent >= msgsize)
	{
		return;
	}
	
	wpAgentID = thebuf+theBufContent;
	theBufContent += wpAgentID.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	callTransID = thebuf+theBufContent;
	theBufContent += callTransID.length()+1;

	if(theBufContent >= msgsize)
		return;

	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;

	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	if(theBufContent >= msgsize)
		return;

	extPhoneNo = thebuf + theBufContent;
	theBufContent += extPhoneNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	recordFilePath = thebuf + theBufContent;
	theBufContent += recordFilePath.length()+1;

	if(theBufContent >= msgsize)
		return;

	LowLevelPrefixNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+LowLevelPrefixNo.length()+1, msgsize, "SIPCCMsg_UState_CallReceived2", "LowLevelPrefixNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(LowLevelPrefixNo.length(), HEAD_LEN, "SIPCCMsg_UState_CallReceived2", "LowLevelPrefixNo", ip, port)) ) {return;}
	theBufContent += LowLevelPrefixNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	nickName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickName.length()+1, msgsize, "SIPCCMsg_UState_CallReceived2", "nickName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(nickName.length(), NICKNAME_LEN, "SIPCCMsg_UState_CallReceived2", "nickName", ip, port)) ) {return;}
	theBufContent += nickName.length()+1;

	if(theBufContent >= msgsize)
		return;

	//RecordMode
	memmove(&this->RecordMode, thebuf+theBufContent, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//
	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(bool), msgsize, "SIPCCMsg_UState_CallReceived2", "the2nd_dial_valid", ip, port)) ) {return;}
	memmove(&this->the2nd_dial_valid, thebuf+theBufContent,sizeof(bool));
	theBufContent += sizeof(bool);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+the2nd_dial_digit.length()+1, msgsize, "SIPCCMsg_UState_CallReceived2", "the2nd_dial_digit.length()", ip, port)) ) {return;}
	this->the2nd_dial_digit = thebuf+theBufContent;
	theBufContent += the2nd_dial_digit.length()+1;

	if(theBufContent >= msgsize)
		return;
	
	if ( !(VerifyTotalLen(theBufContent+sizeof(bool), msgsize, "SIPCCMsg_UState_CallReceived2", "the3rd_media_valid", ip, port)) ) {return;}
	memmove(&(this->the3rd_media_valid), thebuf+theBufContent,sizeof(bool));
	theBufContent += sizeof(bool);

	if(theBufContent>=msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+the3rd_media_address.length()+1, msgsize, "SIPCCMsg_UState_CallReceived2", "the3rd_media_address.length()", ip, port)) ) {return;}
	the3rd_media_address = thebuf+theBufContent;
	theBufContent += the3rd_media_address.length()+1;

	if(theBufContent>=msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_UState_CallReceived2", "the3rd_media_port", ip, port)) ) {return;}
	memmove(&(this->the3rd_media_port),thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

    if ( theBufContent >= msgsize )
	{
		return;
	}
    theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//token
	token = thebuf+theBufContent;
	theBufContent += token.length()+1;
}

int SIPCCMsg_UState_CallReceived2::FillBuf(char*& thebuf)
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);
	
	//callerPartyLen
	memmove(thebuf+theBufContent, &this->callerPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//callerParty
	memmove(thebuf+theBufContent, this->callerParty, this->callerPartyLen);
	theBufContent += callerPartyLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	//callerPartyType
	memmove(thebuf+theBufContent, &this->callerPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(),invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	//usableTime
	memmove(thebuf+theBufContent, &this->usableTime, sizeof(int));
	theBufContent += sizeof(int);
	
	//userName
	memmove(thebuf+theBufContent, this->userName.c_str(),userName.length()+1);
	theBufContent += userName.length()+1;
	
	//lanIp
	memmove(thebuf+theBufContent, &this->lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//wanIp
	memmove(thebuf+theBufContent, &this->wanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &calledOperType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;

	memmove(thebuf+theBufContent, callTransID.c_str(), callTransID.length()+1);
	theBufContent += callTransID.length()+1;

	memcpy( thebuf + theBufContent, managerId.c_str(), managerId.length() + 1 );
	theBufContent += managerId.length() + 1;

	memcpy( thebuf + theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += corpName.length() + 1;

	memcpy( thebuf + theBufContent, extPhoneNo.c_str(), extPhoneNo.length() + 1 );
	theBufContent += extPhoneNo.length() + 1;
	
	memcpy( thebuf + theBufContent, recordFilePath.c_str(), recordFilePath.length() + 1 );
	theBufContent += recordFilePath.length() + 1;

	memcpy( thebuf + theBufContent, LowLevelPrefixNo.c_str(), LowLevelPrefixNo.length() + 1 );
	theBufContent += LowLevelPrefixNo.length() + 1;
	
	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length()+1);
	theBufContent += nickName.length()+1;

	//RecordMode
	memmove(thebuf+theBufContent, &this->RecordMode, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//
	memmove(thebuf+theBufContent, &this->the2nd_dial_valid, sizeof(bool));
	theBufContent += sizeof(bool);

	memcpy(thebuf+theBufContent, the2nd_dial_digit.c_str(),the2nd_dial_digit.length()+1);
	theBufContent += the2nd_dial_digit.length()+1;

	memmove(thebuf+theBufContent, &this->the3rd_media_valid, sizeof(bool));
	theBufContent += sizeof(bool);

	memcpy(thebuf+theBufContent, the3rd_media_address.c_str(),the3rd_media_address.length()+1);
	theBufContent += the3rd_media_address.length()+1;

	memmove(thebuf+theBufContent, &this->the3rd_media_port,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	//token
	memcpy(thebuf+theBufContent, token.c_str(), token.length()+1);
	theBufContent += token.length()+1;

    return theBufContent;
}

int SIPCCMsg_UState_CallReceived2::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//callerPartyLen
	memSize += this->callerPartyLen;		//callerParty
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += sizeof(int);					//callerPartyType
	memSize += invokeID.length()+1;			//invokeID
	memSize += sizeof(int);					//usableTime
	memSize += userName.length()+1;			//userName
	
	memSize += sizeof(unsigned long);		//lanIp
	memSize += sizeof(unsigned long);		//wanIp
	
	memSize += sizeof(int);					//callerPartyType
	memSize += sizeof(int);					//calledOperType
	
	memSize += wpAgentID.length()+1;
	memSize += callTransID.length()+1;		//callTransID
	memSize += managerId.length() + 1;
	memSize += corpName.length() + 1;
	memSize += extPhoneNo.length() + 1;
	memSize += recordFilePath.length() + 1;

	memSize += LowLevelPrefixNo.length() + 1;

	memSize += nickName.length()+1;		//nickName

	memSize += sizeof(RecordMode);			//RecordMode
	
	memSize += sizeof(bool);
	memSize += the2nd_dial_digit.length()+1;
	memSize += sizeof(bool);
	memSize += the3rd_media_address.length()+1;
	memSize += sizeof(unsigned short);


	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	memSize += audioStreamDescription.GetMemSize();

	memSize += token.length()+1;		//token

	return memSize;
}

void SIPCCMsg_UState_CallReceived2::SetCallerParty(string callerparty)
{
	int iCallerPartyLen = callerparty.length();
	this->callerPartyLen = iCallerPartyLen + 1;
	this->callerParty = new char[callerPartyLen];
	memset(callerParty, 0, callerPartyLen);
	memcpy(callerParty, callerparty.c_str(), iCallerPartyLen);
}

void SIPCCMsg_UState_CallReceived2::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_UState_CallReceived2::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_UState_CallReceived2::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_UState_UserQueryStateConf
SIPCCMsg_UState_UserQueryStateConf::SIPCCMsg_UState_UserQueryStateConf()
{
	msgType = Type_UState_UserQueryStateConf;
	userState = -1;
	bQuerySucess = 0;
	
	additionalInfo = NULL;
	additionalInfoLen = 0;
}

void SIPCCMsg_UState_UserQueryStateConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userState
	memmove(&this->userState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//bQuerySucess
	memmove(&this->bQuerySucess, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//additionalInfoLen
	memmove(&this->additionalInfoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//additionalInfo
	additionalInfo = new char[additionalInfoLen];
	memset(additionalInfo, 0, additionalInfoLen);
	memmove(additionalInfo, thebuf+theBufContent, additionalInfoLen);
	theBufContent += additionalInfoLen;
}

int SIPCCMsg_UState_UserQueryStateConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userState
	memmove(thebuf+theBufContent, &this->userState, sizeof(int));
	theBufContent += sizeof(int);
	//bQuerySucess
	memmove(thebuf+theBufContent, &this->bQuerySucess, sizeof(char));
	theBufContent += sizeof(char);
	//additionalInfoLen
	memmove(thebuf+theBufContent, &this->additionalInfoLen, sizeof(int));
	theBufContent += sizeof(int);
	//additionalInfo
	memmove(thebuf+theBufContent, this->additionalInfo, this->additionalInfoLen);
	theBufContent += additionalInfoLen;
	
	return theBufContent;
}

int SIPCCMsg_UState_UserQueryStateConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userState
	memSize += sizeof(char);			//bQuerySucess
	memSize += sizeof(int);				//additionalInfoLen
	memSize += this->additionalInfoLen;	//additionalInfo
	
	return memSize;
}

void SIPCCMsg_UState_UserQueryStateConf::SetAdditionalInfo(string additionalinfo)
{
	int iAdditionalInfoLen = additionalinfo.length();
	this->additionalInfoLen = iAdditionalInfoLen + 1;
	this->additionalInfo = new char[additionalInfoLen];
	memset(additionalInfo, 0, additionalInfoLen);
	memcpy(additionalInfo, additionalinfo.c_str(), iAdditionalInfoLen);
}

///Type_UState_UserLoginConf
SIPCCMsg_UState_UserLoginConf::SIPCCMsg_UState_UserLoginConf()
{
	msgType = Type_UState_UserLoginConf;
}

void SIPCCMsg_UState_UserLoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_UState_UserLoginConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_UState_UserLoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_UState_UserLogoutConf
SIPCCMsg_UState_UserLogoutConf::SIPCCMsg_UState_UserLogoutConf()
{
	msgType = Type_UState_UserLogoutConf;
}

void SIPCCMsg_UState_UserLogoutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_UState_UserLogoutConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_UState_UserLogoutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_UState_AgentMakeCallConf
SIPCCMsg_UState_AgentMakeCallConf::SIPCCMsg_UState_AgentMakeCallConf()
{
	msgType = Type_UState_AgentMakeCallConf;
	callingState = -1;
}

void SIPCCMsg_UState_AgentMakeCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callingState
	memmove(&this->callingState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_UState_AgentMakeCallConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callingState
	memmove(thebuf+theBufContent, &this->callingState, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_UState_AgentMakeCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callingState
	
	return memSize;
}

///Type_UState_UserMakeCallConf
SIPCCMsg_UState_UserMakeCallConf::SIPCCMsg_UState_UserMakeCallConf()
{
	msgType = Type_UState_UserMakeCallConf;
	callingState = -1;
}

void SIPCCMsg_UState_UserMakeCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callingState
	memmove(&this->callingState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_UState_UserMakeCallConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callingState
	memmove(thebuf+theBufContent, &this->callingState, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_UState_UserMakeCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callingState
	
	return memSize;
}

///Type_UState_CallHanguped
SIPCCMsg_UState_CallHanguped::SIPCCMsg_UState_CallHanguped()
{
	msgType = Type_UState_CallHanguped;
	
	userName = NULL;
	userNameLen = 0;
	callID = NULL;
	callIDLen = 0;
	releasedParty = NULL;
	releasedPartyLen = 0;

	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_CallHanguped::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_CallHanguped";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	if(msgsize == theBufContent)
		return;
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	if(msgsize == theBufContent)
		return;
	
	//releasedPartyLen
	memmove(&this->releasedPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//releasedParty
	releasedParty = new char[releasedPartyLen];
	memset(releasedParty, 0, releasedPartyLen);
	memmove(releasedParty, thebuf+theBufContent, releasedPartyLen);
	theBufContent += releasedPartyLen;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;


}

int SIPCCMsg_UState_CallHanguped::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//releasedPartyLen
	memmove(thebuf+theBufContent, &this->releasedPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//releasedParty
	memmove(thebuf+theBufContent, this->releasedParty, this->releasedPartyLen);
	theBufContent += releasedPartyLen;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_CallHanguped::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//releasedPartyLen
	memSize += this->releasedPartyLen;	//releasedParty

	memSize += handleId.length()+1;			//handleId


	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	return memSize;
}

void SIPCCMsg_UState_CallHanguped::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_UState_CallHanguped::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_UState_CallHanguped::SetReleasedParty(string releasedparty)
{
	int iReleasedParty = releasedparty.length();
	this->releasedPartyLen = iReleasedParty + 1;
	this->releasedParty = new char[releasedPartyLen];
	memset(releasedParty, 0, releasedPartyLen);
	memcpy(releasedParty, releasedparty.c_str(), iReleasedParty);
}
///Type_UState_MediaRequest
SIPCCMsg_UState_MediaRequest::SIPCCMsg_UState_MediaRequest()
{
	msgType = Type_UState_MediaRequest;
	callID = NULL;
	callIDLen = 0;
	mediaType = -1;
	seq = 0;
}

void SIPCCMsg_UState_MediaRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(&this->mediaType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_UState_MediaRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	//mediaType
	memmove(thebuf+theBufContent, &this->mediaType, sizeof(int));
	theBufContent += sizeof(int);
	//seq
	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_UState_MediaRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//mediaType
	memSize += sizeof(int);				//seq
	
	return memSize;
}

void SIPCCMsg_UState_MediaRequest::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

//Type_UState_CallAnswered
SIPCCMsg_UState_CallAnswered::SIPCCMsg_UState_CallAnswered()
{
	msgType = Type_UState_CallAnswered;
	
	remoteNatType = NatType_Unknown;
	userName = NULL;
	userNameLen = 0;
	callId = "";
	managerId = "";
	corpName = "";
	agentId = "";      // 座席名
	extPhoneNo = "";   // 分机号码
	recordFilePath = "";

	RecordMode = 0;

	the3rd_media_valid = false;
	the3rd_media_address = "";
	the3rd_media_port = 0;

	gatewayName="";
	computerSymbol="";

	token = "";
}

void SIPCCMsg_UState_CallAnswered::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//remoteNatType
	memmove(&this->remoteNatType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userNameLen
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	callId = thebuf + theBufContent;
	theBufContent += callId.length() + 1;

	if(theBufContent >= msgsize)
		return;

	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;

	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;

	extPhoneNo = thebuf + theBufContent;
	theBufContent += extPhoneNo.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	recordFilePath = thebuf + theBufContent;
	theBufContent += recordFilePath.length()+1;

	if(theBufContent >= msgsize)
		return;

	//RecordMode
	memmove(&this->RecordMode, thebuf+theBufContent, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//20121128
	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(bool), msgsize, "SIPCCMsg_UState_CallAnswered", "the3rd_media_valid", ip, port)) ) {return;}
	memmove(&this->the3rd_media_valid,thebuf+theBufContent,sizeof(bool));
	theBufContent += sizeof(bool);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+the3rd_media_address.length()+1, msgsize, "SIPCCMsg_UState_CallAnswered", "the3rd_media_address.length()", ip, port)) ) {return;}
	the3rd_media_address = thebuf+theBufContent;
	theBufContent += the3rd_media_address.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_UState_CallAnswered", "the3rd_media_port", ip, port)) ) {return;}
	memmove(&this->the3rd_media_port,thebuf+theBufContent,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//token
	token = thebuf + theBufContent;
	theBufContent += token.length()+1;

}

int SIPCCMsg_UState_CallAnswered::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//remoteNatType
	memmove(thebuf+theBufContent, &this->remoteNatType, sizeof(int));
	theBufContent += sizeof(int);
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	memmove( thebuf + theBufContent, callId.c_str(), callId.length() + 1 );
	theBufContent += callId.length() + 1;

	memcpy( thebuf + theBufContent, managerId.c_str(), managerId.length() + 1 );
	theBufContent += managerId.length() + 1;

	memcpy( thebuf + theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += corpName.length() + 1;

	memcpy( thebuf + theBufContent, agentId.c_str(), agentId.length() + 1 );
	theBufContent += agentId.length() + 1;

	memcpy( thebuf + theBufContent, extPhoneNo.c_str(), extPhoneNo.length() + 1 );
	theBufContent += extPhoneNo.length() + 1;

	memcpy( thebuf + theBufContent, recordFilePath.c_str(), recordFilePath.length() + 1 );
	theBufContent += recordFilePath.length() + 1;
	
	//RecordMode
	memmove(thebuf+theBufContent, &this->RecordMode, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	//20121128
	memmove(thebuf+theBufContent, &this->the3rd_media_valid,sizeof(bool));
	theBufContent += sizeof(bool);

	memcpy(thebuf+theBufContent, this->the3rd_media_address.c_str(),the3rd_media_address.length()+1);
	theBufContent += the3rd_media_address.length()+1;

	memmove(thebuf+theBufContent, &this->the3rd_media_port,sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	//token
	memcpy(thebuf+theBufContent, token.c_str(), token.length()+1);
	theBufContent += token.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_CallAnswered::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//remoteNatType
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += callId.length() + 1;
	memSize += managerId.length() + 1;
	memSize += corpName.length() + 1;
	memSize += agentId.length() + 1;
	memSize += extPhoneNo.length() + 1;
	memSize += recordFilePath.length() + 1;

	memSize += sizeof(RecordMode);		//RecordMode
	
	memSize += sizeof(bool);//
	memSize += the3rd_media_address.length()+1;
	memSize += sizeof(unsigned short);


	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	memSize += token.length()+1;		//token

	return memSize;
}

void SIPCCMsg_UState_CallAnswered::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_UState_CallReleased
SIPCCMsg_UState_CallReleased::SIPCCMsg_UState_CallReleased()
{
	msgType = Type_UState_CallReleased;
	theOtherPartyLen = 0;
	theOtherParty = NULL;
}

void SIPCCMsg_UState_CallReleased::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theOtherPartyLen
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;
}

int SIPCCMsg_UState_CallReleased::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherPartyLen
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	
	return theBufContent;
}

int SIPCCMsg_UState_CallReleased::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	
	return memSize;
}

void SIPCCMsg_UState_CallReleased::SetTheOtherParty(string theotherparty)
{
	int iTheOtherPartyLen = theotherparty.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, theotherparty.c_str(), iTheOtherPartyLen);
}

///Type_UState_CallEstablished
SIPCCMsg_UState_CallEstablished::SIPCCMsg_UState_CallEstablished()
{
	msgType = Type_UState_CallEstablished;
	theOtherPartyLen = 0;
	theOtherParty = NULL;
}

void SIPCCMsg_UState_CallEstablished::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theOtherPartyLen
	memmove(&this->theOtherPartyLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherParty
	theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memmove(theOtherParty, thebuf+theBufContent, theOtherPartyLen);
	theBufContent += theOtherPartyLen;
}

int SIPCCMsg_UState_CallEstablished::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theOtherPartyLen
	memmove(thebuf+theBufContent, &this->theOtherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theOtherPartyLen
	memmove(thebuf+theBufContent, this->theOtherParty, this->theOtherPartyLen);
	theBufContent += theOtherPartyLen;
	
	return theBufContent;
}

int SIPCCMsg_UState_CallEstablished::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theOtherPartyLen
	memSize += this->theOtherPartyLen;	//theOtherParty
	
	return memSize;
}

void SIPCCMsg_UState_CallEstablished::SetTheOtherParty(string theotherparty)
{
	int iTheOtherPartyLen = theotherparty.length();
	this->theOtherPartyLen = iTheOtherPartyLen + 1;
	this->theOtherParty = new char[theOtherPartyLen];
	memset(theOtherParty, 0, theOtherPartyLen);
	memcpy(theOtherParty, theotherparty.c_str(), iTheOtherPartyLen);
}

///Type_UState_UserNoResponse
SIPCCMsg_UState_UserNoResponse::SIPCCMsg_UState_UserNoResponse()
{
	msgType = Type_UState_UserNoResponse;
	
	userName = NULL;
	userNameLen = 0;
}

void SIPCCMsg_UState_UserNoResponse::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_UserNoResponse";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->userNameLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port, g_bIsACDServer)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, 	thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;
}

int SIPCCMsg_UState_UserNoResponse::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	
	return theBufContent;
}

int SIPCCMsg_UState_UserNoResponse::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	
	return memSize;
}

void SIPCCMsg_UState_UserNoResponse::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

///Type_UState_AgentHoldCall
SIPCCMsg_UState_AgentHoldCall::SIPCCMsg_UState_AgentHoldCall()
{
	msgType = Type_UState_AgentHoldCall;
	heldParty = NULL;
	heldPartyLen = 0;
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_AgentHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//heldPartyLen
	memmove(&this->heldPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memmove(heldParty, 	thebuf+theBufContent, heldPartyLen);
	theBufContent += heldPartyLen;

	if(theBufContent >= msgsize)
		return;

	ManagerID = thebuf + theBufContent;
	theBufContent += ManagerID.length() + 1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

}

int SIPCCMsg_UState_AgentHoldCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//heldPartyLen
	memmove(thebuf+theBufContent, &this->heldPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	memmove(thebuf+theBufContent, this->heldParty, this->heldPartyLen);
	theBufContent += heldPartyLen;
	//ManagerID
	memcpy(thebuf+theBufContent, ManagerID.c_str(), ManagerID.length()+1);
	theBufContent += ManagerID.length()+1;
	

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_AgentHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//heldPartyLen
	memSize += this->heldPartyLen;		//heldParty
	memSize += ManagerID.length()+1;	//ManagerID

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol
	
	return memSize;
}

void SIPCCMsg_UState_AgentHoldCall::SetHeldParty(string heldparty)
{
	int iHeldPartyLen = heldparty.length();
	this->heldPartyLen = iHeldPartyLen + 1;
	this->heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memcpy(heldParty, heldparty.c_str(), iHeldPartyLen);
}

///Type_UState_AgentUnHoldCall
SIPCCMsg_UState_AgentUnHoldCall::SIPCCMsg_UState_AgentUnHoldCall()
{
	msgType = Type_UState_AgentUnHoldCall;
	heldParty = NULL;
	heldPartyLen = 0;

	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_AgentUnHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//heldPartyLen
	memmove(&this->heldPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memmove(heldParty, 	thebuf+theBufContent, heldPartyLen);
	theBufContent += heldPartyLen;

	if ( theBufContent >= msgsize)
	{
		return;
	}
	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

}

int SIPCCMsg_UState_AgentUnHoldCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//heldPartyLen
	memmove(thebuf+theBufContent, &this->heldPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//heldParty
	memmove(thebuf+theBufContent, this->heldParty, this->heldPartyLen);
	theBufContent += heldPartyLen;
	
	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_AgentUnHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//heldPartyLen
	memSize += this->heldPartyLen;		//heldParty
	
	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	return memSize;
}

void SIPCCMsg_UState_AgentUnHoldCall::SetHeldParty(string heldparty)
{
	int iHeldPartyLen = heldparty.length();
	this->heldPartyLen = iHeldPartyLen + 1;
	this->heldParty = new char[heldPartyLen];
	memset(heldParty, 0, heldPartyLen);
	memcpy(heldParty, heldparty.c_str(), iHeldPartyLen);
}

///Type_UState_AgentHoldCallConf
SIPCCMsg_UState_AgentHoldCallConf::SIPCCMsg_UState_AgentHoldCallConf()
{
	msgType = Type_UState_AgentHoldCallConf;
	bHoldSucc = 0;
}

void SIPCCMsg_UState_AgentHoldCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//bHoldSucc
	memmove(&this->bHoldSucc, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_UState_AgentHoldCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//bHoldSucc
	memmove(thebuf+theBufContent, &this->bHoldSucc, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_UState_AgentHoldCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);			//bHoldSucc
	
	return memSize;
}

///Type_UState_PrepareTransfer
SIPCCMsg_UState_PrepareTransfer::SIPCCMsg_UState_PrepareTransfer()
{
	msgType = Type_UState_PrepareTransfer;
	callID = NULL;
	callIDLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	otherPartyType = CallParty_UnKnown;
	AudioIp = 0;
	AudioPort = 0;
	lanIP = 0;
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_PrepareTransfer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//callIDLen
	memmove(&this->callIDLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, 	thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//otherPartyLen
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(&this->otherPartyType, thebuf + theBufContent, sizeof(int) );
	theBufContent += sizeof(int);
	
	//AudioIp
	memmove(&this->AudioIp, thebuf + theBufContent, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);
	//AudioPort
	memmove(&this->AudioPort, thebuf + theBufContent, sizeof(unsigned short) );
	theBufContent += sizeof(unsigned short);
	//lanIP
	memmove(&this->lanIP, thebuf + theBufContent, sizeof(unsigned long) );
	theBufContent += sizeof(unsigned long);

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;
}

int SIPCCMsg_UState_PrepareTransfer::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	//AudioIp
	memmove(thebuf+theBufContent, &this->AudioIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//AudioPort
	memmove(thebuf+theBufContent, &this->AudioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_PrepareTransfer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//callIDLen
	memSize += this->callIDLen;			//callID
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	
	memSize += sizeof(int);				//otherPartyType
	memSize += sizeof(unsigned long);	//AudioIp
	memSize += sizeof(unsigned short);	//AudioPort
	memSize += sizeof(unsigned long);	//lanIP

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol
	
	return memSize;
}

void SIPCCMsg_UState_PrepareTransfer::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_UState_PrepareTransfer::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

///Type_UState_TransReady
SIPCCMsg_UState_TransReady::SIPCCMsg_UState_TransReady()
{
	msgType = Type_UState_TransReady;
	readyParty = NULL;
	readyPartyLen = 0;
}

void SIPCCMsg_UState_TransReady::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//readyPartyLen
	memmove(&this->readyPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//readyParty
	readyParty = new char[readyPartyLen];
	memset(readyParty, 0, readyPartyLen);
	memmove(readyParty, 	thebuf+theBufContent, readyPartyLen);
	theBufContent += readyPartyLen;
}

int SIPCCMsg_UState_TransReady::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//readyPartyLen
	memmove(thebuf+theBufContent, &this->readyPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//readyParty
	memmove(thebuf+theBufContent, this->readyParty, this->readyPartyLen);
	theBufContent += readyPartyLen;
	
	return theBufContent;
}

int SIPCCMsg_UState_TransReady::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//readyPartyLen
	memSize += this->readyPartyLen;		//readyParty
	
	return memSize;
}

void SIPCCMsg_UState_TransReady::SetReadyParty(string readyparty)
{
	int iReadyPartyLen = readyparty.length();
	this->readyPartyLen = iReadyPartyLen + 1;
	this->readyParty = new char[readyPartyLen];
	memset(this->readyParty, 0, readyPartyLen);
	memcpy(this->readyParty, readyparty.c_str(), iReadyPartyLen);
}

///Type_UState_TransferCall
SIPCCMsg_UState_TransferCall::SIPCCMsg_UState_TransferCall()
{
	msgType = Type_UState_TransferCall;
	presideAgent = NULL;
	presideAgentLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	theParty = NULL;
	thePartyLen = 0;
	
	otherPartyType = CallParty_UnKnown;

	thePartyType = CallParty_UnKnown;
	agentUUIData = "";

	needReturn = 0;

	IsWebPSTNAgent = 0;
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_TransferCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//presideAgentLen
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;
	
	if(msgsize == theBufContent)
		return;
	
	//thePartyLen
	memmove(&this->thePartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	theParty = new char[thePartyLen];
	memset(theParty, 0, thePartyLen);
	memmove(theParty, 	thebuf+theBufContent, thePartyLen);
	theBufContent += thePartyLen;
	
	if ( theBufContent >= msgsize)
	{
		return;
	}
	
	//otherPartyType
	memmove(&this->otherPartyType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//thePartyType
	memmove(&this->thePartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//agentUUIData
	agentUUIData = thebuf + theBufContent;
	theBufContent += agentUUIData.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//needReturn
	memmove(&this->needReturn, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//IsWebPSTNAgent
	memmove(&this->IsWebPSTNAgent, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

}

int SIPCCMsg_UState_TransferCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//thePartyLen
	memmove(thebuf+theBufContent, &this->thePartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	memmove(thebuf+theBufContent, this->theParty, this->thePartyLen);
	theBufContent += thePartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	//thePartyType
	memmove(thebuf+theBufContent, &this->thePartyType, sizeof(int));
	theBufContent += sizeof(int);

	//agentUUIData
	memcpy(thebuf+theBufContent, agentUUIData.c_str(), agentUUIData.length()+1);
	theBufContent += agentUUIData.length()+1;

	//needReturn
	memmove(thebuf+theBufContent, &this->needReturn, sizeof(char));
	theBufContent += sizeof(char);

	//IsWebPSTNAgent
	memmove(thebuf+theBufContent, &this->IsWebPSTNAgent, sizeof(char));
	theBufContent += sizeof(char);


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;


	return theBufContent;
}

int SIPCCMsg_UState_TransferCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	memSize += sizeof(int);				//thePartyLen
	memSize += this->thePartyLen;		//theParty
	
	memSize += sizeof(int);				//otherPartyType

	memSize += sizeof(int);				//thePartyType
	memSize += agentUUIData.length()+1;	//agentUUIData

	memSize += sizeof(char);			//needReturn
	memSize += sizeof(char);			//IsWebPSTNAgent

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	
	return memSize;
}

void SIPCCMsg_UState_TransferCall::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_UState_TransferCall::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

void SIPCCMsg_UState_TransferCall::SetTheParty(string theparty)
{
	int iThePartyLen = theparty.length();
	this->thePartyLen = iThePartyLen + 1;
	this->theParty = new char[thePartyLen];
	memset(this->theParty, 0, thePartyLen);
	memcpy(this->theParty, theparty.c_str(), iThePartyLen);
}

///Type_UState_BeforeTransfer
SIPCCMsg_UState_BeforeTransfer::SIPCCMsg_UState_BeforeTransfer()
{
	msgType = Type_UState_BeforeTransfer;
	presideAgent = NULL;
	presideAgentLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	theParty = NULL;
	thePartyLen = 0;
	
	otherPartyType = CallParty_UnKnown;


	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_BeforeTransfer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//presideAgentLen
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;
	
	if(msgsize == theBufContent)
		return;
	
	//thePartyLen
	memmove(&this->thePartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	theParty = new char[thePartyLen];
	memset(theParty, 0, thePartyLen);
	memmove(theParty, 	thebuf+theBufContent, thePartyLen);
	theBufContent += thePartyLen;
	
	if ( theBufContent >= msgsize)
	{
		return;
	}
	
	//otherPartyType
	memmove(&this->otherPartyType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;
}

int SIPCCMsg_UState_BeforeTransfer::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//thePartyLen
	memmove(thebuf+theBufContent, &this->thePartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//theParty
	memmove(thebuf+theBufContent, this->theParty, this->thePartyLen);
	theBufContent += thePartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_BeforeTransfer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	memSize += sizeof(int);				//thePartyLen
	memSize += this->thePartyLen;		//theParty
	
	memSize += sizeof(int);				//otherPartyType


	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	
	return memSize;
}

void SIPCCMsg_UState_BeforeTransfer::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_UState_BeforeTransfer::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

void SIPCCMsg_UState_BeforeTransfer::SetTheParty(string theparty)
{
	int iThePartyLen = theparty.length();
	this->thePartyLen = iThePartyLen + 1;
	this->theParty = new char[thePartyLen];
	memset(this->theParty, 0, thePartyLen);
	memcpy(this->theParty, theparty.c_str(), iThePartyLen);
}

///Type_UState_ClearPreConnection
SIPCCMsg_UState_ClearPreConnection::SIPCCMsg_UState_ClearPreConnection()
{
	msgType = Type_UState_ClearPreConnection;
	notifier = NULL;
	notifierLen = 0;
}

void SIPCCMsg_UState_ClearPreConnection::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//notifierLen
	memmove(&this->notifierLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//notifier
	notifier = new char[notifierLen];
	memset(notifier, 0, notifierLen);
	memmove(notifier, 	thebuf+theBufContent, notifierLen);
	theBufContent += notifierLen;
}

int SIPCCMsg_UState_ClearPreConnection::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//notifierLen
	memmove(thebuf+theBufContent, &this->notifierLen, sizeof(int));
	theBufContent += sizeof(int);
	//notifier
	memmove(thebuf+theBufContent, this->notifier, this->notifierLen);
	theBufContent += notifierLen;
	
	return theBufContent;
}

int SIPCCMsg_UState_ClearPreConnection::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);				//notifierLen
	memSize += this->notifierLen;		//notifier
	
	return memSize;
}

void SIPCCMsg_UState_ClearPreConnection::SetNotifier(string theNotifier)
{
	int iNotifier = theNotifier.length();
	this->notifierLen = iNotifier + 1;
	this->notifier = new char[notifierLen];
	memset(this->notifier, 0, notifierLen);
	memcpy(this->notifier, theNotifier.c_str(), iNotifier);
}

///Type_UState_MediaReady
SIPCCMsg_UState_MediaReady::SIPCCMsg_UState_MediaReady()
{
	msgType = Type_UState_MediaReady;
}

void SIPCCMsg_UState_MediaReady::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_UState_MediaReady::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_UState_MediaReady::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

//Type_UState_CallUserConf
SIPCCMsg_UState_CallUserConf::SIPCCMsg_UState_CallUserConf()
{
	msgType = Type_UState_CallUserConf;
	userName = "";
	bCallFailed = 1;
	audioIP = 0;
	audioPort = 0;
	lanIP = 0;
	failedCause = -1;
	
	invokeID = "";
}

void SIPCCMsg_UState_CallUserConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userName
	userName = thebuf+theBufContent;
	theBufContent += userName.length()+1;
	
	//bCallFailed
	memmove(&this->bCallFailed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//audioIP
	memmove(&this->audioIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(&this->audioPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//failedCause
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	if(msgsize == theBufContent)
		return;
	
	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_UState_CallUserConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userName
	memmove(thebuf+theBufContent, this->userName.c_str(), userName.length()+1);
	theBufContent += userName.length()+1;
	
	//bCallFailed
	memmove(thebuf+theBufContent, &this->bCallFailed, sizeof(char));
	theBufContent += sizeof(char);
	//audioIP
	memmove(thebuf+theBufContent, &this->audioIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//audioPort
	memmove(thebuf+theBufContent, &this->audioPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_UState_CallUserConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += userName.length()+1;		//userName
	memSize += sizeof(char);			//bCallFailed
	memSize += sizeof(unsigned long);	//audioIP
	memSize += sizeof(unsigned short);	//audioPort
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(int);				//failedCause
	memSize += invokeID.length()+1;		//invokeID
	
	return memSize;
}

//Type_UState_CallUserFailed
SIPCCMsg_UState_CallUserFailed::SIPCCMsg_UState_CallUserFailed()
{
	msgType = Type_UState_CallUserFailed;
	userName = "";
	failedCause = -1;
}

void SIPCCMsg_UState_CallUserFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userName
	userName = thebuf+theBufContent;
	theBufContent += userName.length()+1;
	
	//failedCause
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_UState_CallUserFailed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userName
	memmove(thebuf+theBufContent, this->userName.c_str(), userName.length()+1);
	theBufContent += userName.length()+1;
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_UState_CallUserFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += userName.length()+1;		//userName
	memSize += sizeof(int);				//failedCause
	
	return memSize;
}

//Type_UState_GWLogoutConf
SIPCCMsg_UState_GWLogoutConf::SIPCCMsg_UState_GWLogoutConf()
{
	msgType = Type_UState_GWLogoutConf;

	GwName = "";
	ComputerSymbol = "";
}

void SIPCCMsg_UState_GWLogoutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_GWLogoutConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

}

int SIPCCMsg_UState_GWLogoutConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_GWLogoutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol

	return memSize;
}

///Type_UState_USRegister
SIPCCMsg_UState_USRegister::SIPCCMsg_UState_USRegister()
{
	msgType = Type_UState_USRegister;
	ServerName = "";
	ServerIp = 0;
	ServerPort = 0;
}

void SIPCCMsg_UState_USRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_UState_GWMRegister";
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ServerName
	ServerName = thebuf + theBufContent;
	theBufContent += ServerName.length()+1;

	//ServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "ServerIp", ip, port)) ) {return;}
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "ServerPort", ip, port)) ) {return;}
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_UState_USRegister::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	//ServerIp
	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_UState_USRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;	//ServerName
	memSize += sizeof(unsigned long);	//ServerIp
	memSize += sizeof(unsigned short);	//ServerPort

	return memSize;
}

///Type_UState_ConfirmConf
SIPCCMsg_UState_ConfirmConf::SIPCCMsg_UState_ConfirmConf()
{
	msgType = Type_UState_ConfirmConf;
	invokeID = "";
}

void SIPCCMsg_UState_ConfirmConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_UState_ConfirmConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_ConfirmConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;
	return memSize;
}

///Class_UState
///////////////////////////////////////////////////////////////////////////

void CIPCCMsgExchanger::SerializeUStateMsg(SIPCCMessage &msg, char *&thebuf, int &thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_UState_CallArriveToAgent:
		thebufcontent = ((SIPCCMsg_UState_CallArriveToAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_UserQueryStateConf:
		thebufcontent = ((SIPCCMsg_UState_UserQueryStateConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallReceived:
		thebufcontent = ((SIPCCMsg_UState_CallReceived*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallReceived2:
		thebufcontent = ((SIPCCMsg_UState_CallReceived2*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_UserLoginConf:
		thebufcontent = ((SIPCCMsg_UState_UserLoginConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_UserLogoutConf:
		thebufcontent = ((SIPCCMsg_UState_UserLogoutConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallHanguped:
		thebufcontent = ((SIPCCMsg_UState_CallHanguped*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallAnswered:
		thebufcontent = ((SIPCCMsg_UState_CallAnswered*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_MediaRequest:
		thebufcontent = ((SIPCCMsg_UState_MediaRequest*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallReleased:
		thebufcontent = ((SIPCCMsg_UState_CallReleased*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_AgentMakeCallConf:
		thebufcontent = ((SIPCCMsg_UState_AgentMakeCallConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_UserMakeCallConf:
		thebufcontent = ((SIPCCMsg_UState_UserMakeCallConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallEstablished:
		thebufcontent = ((SIPCCMsg_UState_CallEstablished*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_UserNoResponse:
		thebufcontent = ((SIPCCMsg_UState_UserNoResponse*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_AgentHoldCall:
		thebufcontent = ((SIPCCMsg_UState_AgentHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_AgentUnHoldCall:
		thebufcontent = ((SIPCCMsg_UState_AgentUnHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_AgentHoldCallConf:
		thebufcontent = ((SIPCCMsg_UState_AgentHoldCallConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_PrepareTransfer:
		thebufcontent = ((SIPCCMsg_UState_PrepareTransfer*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_TransReady:
		thebufcontent = ((SIPCCMsg_UState_TransReady*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_TransferCall:
		thebufcontent = ((SIPCCMsg_UState_TransferCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_ClearPreConnection:
		thebufcontent = ((SIPCCMsg_UState_ClearPreConnection*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_MediaReady:
		thebufcontent = ((SIPCCMsg_UState_MediaReady*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_BeforeTransfer:
		thebufcontent = ((SIPCCMsg_UState_BeforeTransfer*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallUserConf:
		thebufcontent = ((SIPCCMsg_UState_CallUserConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_CallUserFailed:
		thebufcontent = ((SIPCCMsg_UState_CallUserFailed*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_RingAgentExt:
		thebufcontent = ((SIPCCMsg_UState_RingAgentExt*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_RingAgentExt2:
		thebufcontent = ((SIPCCMsg_UState_RingAgentExt2*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_WebPSTNAgentHoldCall:
		thebufcontent = ((SIPCCMsg_UState_WebPSTNAgentHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_WebPSTNAgentHoldCallConf:
		thebufcontent = ((SIPCCMsg_UState_WebPSTNAgentHoldCallConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_WebPSTNAgentUnHoldCall:
		thebufcontent = ((SIPCCMsg_UState_WebPSTNAgentUnHoldCall*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_WpAgentTrans2VoipAgent:
		thebufcontent = ((SIPCCMsg_UState_WpAgentTrans2VoipAgent*)&msg)->FillBuf(thebuf);
		break;
	case Type_UState_EchoRemoveCtrl:
		thebufcontent = ((SIPCCMsg_UState_EchoRemoveCtrl*)&msg)->FillBuf(thebuf);
		break;
	default:
		thebufcontent = msg.FillBuf(thebuf);
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeUStateMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_UState_CallArriveToAgent:
		((SIPCCMsg_UState_CallArriveToAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_UserQueryStateConf:
		((SIPCCMsg_UState_UserQueryStateConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_CallReceived:
		((SIPCCMsg_UState_CallReceived*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_CallReceived2:
		((SIPCCMsg_UState_CallReceived2*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_UserLoginConf:
		((SIPCCMsg_UState_UserLoginConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_UserLogoutConf:
		((SIPCCMsg_UState_UserLogoutConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_CallHanguped:
		((SIPCCMsg_UState_CallHanguped*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_CallAnswered:
		((SIPCCMsg_UState_CallAnswered*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_MediaRequest:
		((SIPCCMsg_UState_MediaRequest*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_CallReleased:
		((SIPCCMsg_UState_CallReleased*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_AgentMakeCallConf:
		((SIPCCMsg_UState_AgentMakeCallConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_UserMakeCallConf:
		((SIPCCMsg_UState_UserMakeCallConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);		
		break;
	case Type_UState_CallEstablished:
		((SIPCCMsg_UState_CallEstablished*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_UserNoResponse:
		((SIPCCMsg_UState_UserNoResponse*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_AgentHoldCall:
		((SIPCCMsg_UState_AgentHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_AgentUnHoldCall:
		((SIPCCMsg_UState_AgentUnHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_AgentHoldCallConf:
		((SIPCCMsg_UState_AgentHoldCallConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_PrepareTransfer:
		((SIPCCMsg_UState_PrepareTransfer*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_TransReady:
		((SIPCCMsg_UState_TransReady*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_TransferCall:
		((SIPCCMsg_UState_TransferCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_ClearPreConnection:
		((SIPCCMsg_UState_ClearPreConnection*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_MediaReady:
		((SIPCCMsg_UState_MediaReady*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_BeforeTransfer:
		((SIPCCMsg_UState_BeforeTransfer*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_CallUserConf:
		((SIPCCMsg_UState_CallUserConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_CallUserFailed:
		((SIPCCMsg_UState_CallUserFailed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_RingAgentExt:
		((SIPCCMsg_UState_RingAgentExt*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_RingAgentExt2:
		((SIPCCMsg_UState_RingAgentExt2*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_WebPSTNAgentHoldCall:
		((SIPCCMsg_UState_WebPSTNAgentHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_WebPSTNAgentUnHoldCall:
		((SIPCCMsg_UState_WebPSTNAgentUnHoldCall*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_WebPSTNAgentHoldCallConf:
		((SIPCCMsg_UState_WebPSTNAgentHoldCallConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_WpAgentTrans2VoipAgent:
		((SIPCCMsg_UState_WpAgentTrans2VoipAgent*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_UState_EchoRemoveCtrl:
		((SIPCCMsg_UState_EchoRemoveCtrl*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		msg.AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	}
}

/////////////////////////////////////////////////////////////////////////////////
///Class_File
SIPCCMsg_File::SIPCCMsg_File()
{
	msgClass = Class_File;
}

///Type_File_TransRequest
SIPCCMsg_File_TransRequest::SIPCCMsg_File_TransRequest()
{
	msgType = Type_File_TransRequest;
	
	//	FileName = NULL;
	//	FileNameLen = 0;
	Seq = 0;
}

void SIPCCMsg_File_TransRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//	//FileNameLen
	//	memmove(&this->FileNameLen, thebuf+theBufContent, sizeof(int));
	//	theBufContent += sizeof(int);
	//	//FileName
	//	FileName = new char[FileNameLen];
	//	memset(FileName, 0, FileNameLen);
	//	memmove(FileName, thebuf+theBufContent, FileNameLen);
	//	theBufContent += FileNameLen;
	//Seq
	memmove(&this->Seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_File_TransRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//	//FileNameLen
	//	memmove(thebuf+theBufContent, &this->FileNameLen, sizeof(int));
	//	theBufContent += sizeof(int);
	//	//FileName
	//	memmove(thebuf+theBufContent, this->FileName, this->FileNameLen);
	//	theBufContent += FileNameLen;
	//Seq
	memmove(thebuf+theBufContent, &this->Seq, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_File_TransRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	//	memSize += sizeof(int);				//FileNameLen
	//	memSize += this->FileNameLen;		//FileName
	memSize += sizeof(int);				//Seq
	return memSize;
}

///Type_File_TransRequestConf
SIPCCMsg_File_TransRequestConf::SIPCCMsg_File_TransRequestConf()
{
	msgType = Type_File_TransRequestConf;
	
	Result = 0;
}

void SIPCCMsg_File_TransRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//Result
	memmove(&this->Result, thebuf+theBufContent, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
}

int SIPCCMsg_File_TransRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//Result
	memmove(thebuf+theBufContent, &this->Result, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	
	return theBufContent;
}

int SIPCCMsg_File_TransRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned char);	//Result
	return memSize;
}

///Type_File_TransReady
SIPCCMsg_File_TransReady::SIPCCMsg_File_TransReady()
{
	msgType = Type_File_TransReady;
}

void SIPCCMsg_File_TransReady::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_File_TransReady::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_File_TransReady::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_File_UnConnect
SIPCCMsg_File_UnConnect::SIPCCMsg_File_UnConnect()
{
	msgType = Type_File_UnConnect;
}

void SIPCCMsg_File_UnConnect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_File_UnConnect::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_File_UnConnect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_File_FileRequest
SIPCCMsg_File_FileRequest::SIPCCMsg_File_FileRequest()
{
	msgType = Type_File_FileRequest;
	
	FileName = NULL;
	FileNameLen = 0;
	FileSizeHigh = 0;
	FileSizeLow = 0;
}

void SIPCCMsg_File_FileRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//FileNameLen
	memmove(&this->FileNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//FileName
	FileName = new char[FileNameLen];
	memset(FileName, 0, FileNameLen);
	memmove(FileName, thebuf+theBufContent, FileNameLen);
	theBufContent += FileNameLen;
	//FileSizeHigh
	memmove(&this->FileSizeHigh, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//FileSizeLow
	memmove(&this->FileSizeLow, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_File_FileRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//FileNameLen
	memmove(thebuf+theBufContent, &this->FileNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//FileName
	memmove(thebuf+theBufContent, this->FileName, this->FileNameLen);
	theBufContent += FileNameLen;
	//FileSizeHigh
	memmove(thebuf+theBufContent, &this->FileSizeHigh, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//FileSizeLow
	memmove(thebuf+theBufContent, &this->FileSizeLow, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	return theBufContent;
}

int SIPCCMsg_File_FileRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//FileNameLen
	memSize += this->FileNameLen;		//FileName
	memSize += sizeof(unsigned long);	//FileSizeHigh
	memSize += sizeof(unsigned long);	//FileSizeLow
	return memSize;
}

///Type_File_FileRequestConf
SIPCCMsg_File_FileRequestConf::SIPCCMsg_File_FileRequestConf()
{
	msgType = Type_File_FileRequestConf;
	
	Result = 0;
}

void SIPCCMsg_File_FileRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//Result
	memmove(&this->Result, thebuf+theBufContent, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
}

int SIPCCMsg_File_FileRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//Result
	memmove(thebuf+theBufContent, &this->Result, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	
	return theBufContent;
}

int SIPCCMsg_File_FileRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned char);	//Result
	return memSize;
}

///Type_File_FileReceived
SIPCCMsg_File_FileReceived::SIPCCMsg_File_FileReceived()
{
	msgType = Type_File_FileReceived;
}

void SIPCCMsg_File_FileReceived::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_File_FileReceived::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_File_FileReceived::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_File_FileStopped
SIPCCMsg_File_FileStopped::SIPCCMsg_File_FileStopped()
{
	msgType = Type_File_FileStopped;
}

void SIPCCMsg_File_FileStopped::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_File_FileStopped::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_File_FileStopped::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_File_FileReceiveInfo
SIPCCMsg_File_FileReceiveInfo::SIPCCMsg_File_FileReceiveInfo()
{
	msgType = Type_File_FileReceiveInfo;
	
	PackCount = 0;
	ReceivedSize = 0;
}

void SIPCCMsg_File_FileReceiveInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//PackCount
	memmove(&this->PackCount, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//ReceivedSize
	memmove(&this->ReceivedSize, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_File_FileReceiveInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//PackCount
	memmove(thebuf+theBufContent, &this->PackCount, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//ReceivedSize
	memmove(thebuf+theBufContent, &this->ReceivedSize, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	return theBufContent;
}

int SIPCCMsg_File_FileReceiveInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned long);	//PackCount
	memSize += sizeof(unsigned long);	//ReceivedSize
	return memSize;
}
///Class_File
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_Record
SIPCCMsg_Record::SIPCCMsg_Record()
{
	msgClass = Class_Record;
}

///Type_Record_Login
SIPCCMsg_Record_Login::SIPCCMsg_Record_Login()
{
	msgType = Type_Record_Login;
	agentID = NULL;
	agentIDLen = 0;
}

void SIPCCMsg_Record_Login::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Record_Login";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "agentIDLen", ip, port)) ) {return;}
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//agentID
	if ( !(VerifyTotalLen(theBufContent+this->agentIDLen, msgsize, strMsg, "agentID", ip, port)) ) {return;}
	if ( !(VerifyData(this->agentIDLen, AGENTID_LEN, strMsg, "agentID", ip, port)) ) {return;}
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
}

int SIPCCMsg_Record_Login::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	return theBufContent;
}

int SIPCCMsg_Record_Login::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	
	return memSize;
}

void SIPCCMsg_Record_Login::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

///Type_Record_LoginConf
SIPCCMsg_Record_LoginConf::SIPCCMsg_Record_LoginConf()
{
	msgType = Type_Record_LoginConf;
	
	recIP = 0;
	recPort = 0;
}

void SIPCCMsg_Record_LoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//recIP
	memmove(&this->recIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//recPort
	memmove(&this->recPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_Record_LoginConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//recIP
	memmove(thebuf+theBufContent, &this->recIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//recPort
	memmove(thebuf+theBufContent, &this->recPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_Record_LoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned long);	//recIP
	memSize += sizeof(unsigned short);	//recPort
	
	return memSize;
}

///Type_Record_StartRecord
SIPCCMsg_Record_StartRecord::SIPCCMsg_Record_StartRecord()
{
	msgType = Type_Record_StartRecord;
	
	agentID = NULL;
	agentIDLen = 0;
	CTID = NULL;
	CTIDLen = 0;
	callerID = NULL;
	callerIDLen = 0;
	calleeID = NULL;
	calleeIDLen = 0;
	theComment = NULL;
	theCommentLen = 0;
}

void SIPCCMsg_Record_StartRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	//CTIDLen
	memmove(&this->CTIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//CTID
	CTID = new char[CTIDLen];
	memset(CTID, 0, CTIDLen);
	memmove(CTID, thebuf+theBufContent, CTIDLen);
	theBufContent += CTIDLen;
	//callerIDLen
	memmove(&this->callerIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callerID
	callerID = new char[callerIDLen];
	memset(callerID, 0, callerIDLen);
	memmove(callerID, thebuf+theBufContent, callerIDLen);
	theBufContent += callerIDLen;
	//calleeIDLen
	memmove(&this->calleeIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//calleeID
	calleeID = new char[calleeIDLen];
	memset(calleeID, 0, calleeIDLen);
	memmove(calleeID, thebuf+theBufContent, calleeIDLen);
	theBufContent += calleeIDLen;
	//theCommentLen
	memmove(&this->theCommentLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theComment
	theComment = new char[theCommentLen];
	memset(theComment, 0, theCommentLen);
	memmove(theComment, thebuf+theBufContent, theCommentLen);
	theBufContent += theCommentLen;
}

int SIPCCMsg_Record_StartRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	//CTIDLen
	memmove(thebuf+theBufContent, &this->CTIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//CTID
	memmove(thebuf+theBufContent, this->CTID, this->CTIDLen);
	theBufContent += CTIDLen;
	//callerIDLen
	memmove(thebuf+theBufContent, &this->callerIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callerID
	memmove(thebuf+theBufContent, this->callerID, this->callerIDLen);
	theBufContent += callerIDLen;
	//calleeIDLen
	memmove(thebuf+theBufContent, &this->calleeIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//calleeID
	memmove(thebuf+theBufContent, this->calleeID, this->calleeIDLen);
	theBufContent += calleeIDLen;
	//theCommentLen
	memmove(thebuf+theBufContent, &this->theCommentLen, sizeof(int));
	theBufContent += sizeof(int);
	//theComment
	memmove(thebuf+theBufContent, this->theComment, this->theCommentLen);
	theBufContent += theCommentLen;
	
	return theBufContent;
}

int SIPCCMsg_Record_StartRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	memSize += sizeof(int);				//CTIDLen
	memSize += this->CTIDLen;			//CTID
	memSize += sizeof(int);				//callerIDLen
	memSize += this->callerIDLen;		//callerID
	memSize += sizeof(int);				//calleeIDLen
	memSize += this->calleeIDLen;		//calleeID
	memSize += sizeof(int);				//theCommentLen
	memSize += this->theCommentLen;		//theComment
	
	return memSize;
}

void SIPCCMsg_Record_StartRecord::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_Record_StartRecord::SetCTID(string ctid)
{
	int iCTIDLen = ctid.length();
	this->CTIDLen = iCTIDLen + 1;
	this->CTID = new char[CTIDLen];
	memset(CTID, 0, CTIDLen);
	memcpy(CTID, ctid.c_str(), iCTIDLen);
}

void SIPCCMsg_Record_StartRecord::SetCallerID(string callerid)
{
	int iCallerIDLen = callerid.length();
	this->callerIDLen = iCallerIDLen + 1;
	this->callerID = new char[callerIDLen];
	memset(callerID, 0, callerIDLen);
	memcpy(callerID, callerid.c_str(), iCallerIDLen);
}

void SIPCCMsg_Record_StartRecord::SetCalleeID(string calleeid)
{
	int iCalleeIDLen = calleeid.length();
	this->calleeIDLen = iCalleeIDLen + 1;
	this->calleeID = new char[calleeIDLen];
	memset(calleeID, 0, calleeIDLen);
	memcpy(calleeID, calleeid.c_str(), iCalleeIDLen);
}

void SIPCCMsg_Record_StartRecord::SetTheComment(string thecomment)
{
	int iTheCommentLen = thecomment.length();
	this->theCommentLen = iTheCommentLen + 1;
	this->theComment = new char[theCommentLen];
	memset(theComment, 0, theCommentLen);
	memcpy(theComment, thecomment.c_str(), iTheCommentLen);
}

///Type_Record_StopRecord
SIPCCMsg_Record_StopRecord::SIPCCMsg_Record_StopRecord()
{
	msgType = Type_Record_StopRecord;
	agentID = NULL;
	agentIDLen = 0;
}

void SIPCCMsg_Record_StopRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
}

int SIPCCMsg_Record_StopRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	return theBufContent;
}

int SIPCCMsg_Record_StopRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//agentIDLen
	memSize += this->agentIDLen;		//agentID
	
	return memSize;
}

void SIPCCMsg_Record_StopRecord::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

///Type_Record_StartRecordConf
SIPCCMsg_Record_StartRecordConf::SIPCCMsg_Record_StartRecordConf()
{
	msgType = Type_Record_StartRecordConf;
}

void SIPCCMsg_Record_StartRecordConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Record_StartRecordConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Record_StartRecordConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_Record_StartTrunkP2ARecord
SIPCCMsg_Record_StartTrunkP2ARecord::SIPCCMsg_Record_StartTrunkP2ARecord()
{
	msgType = Type_Record_StartTrunkP2ARecord;
	agentID = "";
	CTID = "";
	callerID = "";
	calleeID = "";
	theComment = "";
	trunkDn = "";
	managerId = "";
	corpName = "";
	extPhoneNo = "";
	recordFilePath = "";

	callDirection = -1;
	nickName = "";
	beginTime = "";

	managerId2 = "";
}

void SIPCCMsg_Record_StartTrunkP2ARecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Record_StartTrunkP2ARecord";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port)) ) {return;}
	theBufContent += agentID.length()+1;
	
	CTID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CTID.length()+1, msgsize, strMsg, "CTID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(CTID.length(), INVOKEID_LEN, strMsg, "CTID", ip, port)) ) {return;}
	theBufContent += CTID.length()+1;
	
	callerID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerID.length()+1, msgsize, strMsg, "callerID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerID.length(), CALLID_LEN, strMsg, "callerID", ip, port)) ) {return;}
	theBufContent += callerID.length()+1;
	
	calleeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calleeID.length()+1, msgsize, strMsg, "calleeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(calleeID.length(), CALLEDNO_LEN, strMsg, "calleeID", ip, port)) ) {return;}
	theBufContent += calleeID.length()+1;
	
	theComment = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+theComment.length()+1, msgsize, strMsg, "theComment.length()", ip, port)) ) {return;}
	if ( !(VerifyData(theComment.length(), COMMENT_LEN, strMsg, "theComment", ip, port)) ) {return;}
	theBufContent += theComment.length()+1;
	
	trunkDn = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+trunkDn.length()+1, msgsize, strMsg, "trunkDn.length()", ip, port)) ) {return;}
	if ( !(VerifyData(trunkDn.length(), TRUNKNO_LEN, strMsg, "trunkDn", ip, port)) ) {return;}
	theBufContent += trunkDn.length()+1;

	if(theBufContent >= msgsize)
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port)) ) {return;}
	theBufContent += managerId.length()+1;

	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsg, "corpName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsg, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;

	if(theBufContent >= msgsize)
		return;

	extPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extPhoneNo.length()+1, msgsize, strMsg, "extPhoneNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(extPhoneNo.length(), PHONENO_LEN, strMsg, "extPhoneNo", ip, port)) ) {return;}
	theBufContent += extPhoneNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	recordFilePath = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+recordFilePath.length()+1, msgsize, strMsg, "recordFilePath.length()", ip, port)) ) {return;}
	if ( !(VerifyData(recordFilePath.length(), RECORDFILEPATH_LEN, strMsg, "recordFilePath", ip, port)) ) {return;}
	theBufContent += recordFilePath.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "callDirection", ip, port)) ) {return;}
	memmove(&(this->callDirection), thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	nickName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+nickName.length()+1, msgsize, strMsg, "nickName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(nickName.length(), NICKNAME_LEN, strMsg, "nickName", ip, port)) ) {return;}
	theBufContent += nickName.length()+1;

	beginTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+beginTime.length()+1, msgsize, strMsg, "beginTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(beginTime.length(), CURTIME_LEN, strMsg, "beginTime", ip, port)) ) {return;}
	theBufContent += beginTime.length()+1;

	if(theBufContent >= msgsize)
		return;

	strSequence = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strSequence.length()+1, msgsize, strMsg, "strSequence.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strSequence.length(), SEQUENCE_LEN, strMsg, "strSequence", ip, port)) ) {return;}
	theBufContent += strSequence.length()+1;

	if(theBufContent >= msgsize)
		return;

	managerId2 = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId2.length()+1, msgsize, strMsg, "managerId2.length()", ip, port)) ) {return;}
	if ( !(VerifyData(managerId2.length(), MANAGERID_LEN, strMsg, "managerId2", ip, port)) ) {return;}
	theBufContent += managerId2.length()+1;
}

int SIPCCMsg_Record_StartTrunkP2ARecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += agentID.length() + 1;
	
	memcpy( thebuf + theBufContent, CTID.c_str(), CTID.length() + 1 );
	theBufContent += CTID.length() + 1;
	
	memcpy( thebuf + theBufContent, callerID.c_str(), callerID.length() + 1 );
	theBufContent += callerID.length() + 1;
	
	memcpy( thebuf + theBufContent, calleeID.c_str(), calleeID.length() + 1 );
	theBufContent += calleeID.length() + 1;
	
	memcpy( thebuf + theBufContent, theComment.c_str(), theComment.length() + 1 );
	theBufContent += theComment.length() + 1;
	
	memcpy( thebuf + theBufContent, trunkDn.c_str(), trunkDn.length() + 1 );
	theBufContent += trunkDn.length() + 1;

	memcpy( thebuf + theBufContent, managerId.c_str(), managerId.length() + 1 );
	theBufContent += managerId.length() + 1;

	memcpy( thebuf + theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += corpName.length() + 1;

	memcpy( thebuf + theBufContent, extPhoneNo.c_str(), extPhoneNo.length() + 1 );
	theBufContent += extPhoneNo.length() + 1;

	memcpy( thebuf + theBufContent, recordFilePath.c_str(), recordFilePath.length() + 1 );
	theBufContent += recordFilePath.length() + 1;
	
	// callDirection
	memmove(thebuf+theBufContent, &(this->callDirection), sizeof(int));
	theBufContent += sizeof(int);

	//nickName
	memcpy(thebuf+theBufContent, nickName.c_str(), nickName.length()+1);
	theBufContent += nickName.length()+1;

	//beginTime
	memcpy(thebuf+theBufContent, beginTime.c_str(), beginTime.length()+1);
	theBufContent += beginTime.length()+1;

	//strSequence
	memcpy(thebuf+theBufContent, strSequence.c_str(), strSequence.length()+1);
	theBufContent += strSequence.length()+1;

	//managerId2
	memcpy(thebuf+theBufContent, managerId2.c_str(), managerId2.length()+1);
	theBufContent += managerId2.length()+1;

	return theBufContent;
}

int SIPCCMsg_Record_StartTrunkP2ARecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length() + 1;
	memSize += CTID.length() + 1;
	memSize += callerID.length() + 1;
	memSize += calleeID.length() + 1;
	memSize += theComment.length() + 1;
	memSize += trunkDn.length() + 1;
	memSize += managerId.length() + 1;
	memSize += corpName.length() + 1;
	memSize += extPhoneNo.length() + 1;
	memSize += recordFilePath.length() + 1;
	
	memSize += sizeof(int);				//callDirection
	memSize += nickName.length()+1;		//nickName
	memSize += beginTime.length()+1;	//beginTime

	memSize += strSequence.length()+1;	//strSequence

	memSize += managerId2.length()+1;	//managerId2

	return memSize;
}

///Type_Record_StopTrunkP2ARecord
SIPCCMsg_Record_StopTrunkP2ARecord::SIPCCMsg_Record_StopTrunkP2ARecord()
{
	msgType = Type_Record_StopTrunkP2ARecord;

	trunkDn = "";

	beginTime = "";
}

void SIPCCMsg_Record_StopTrunkP2ARecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Record_StopTrunkP2ARecord";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	trunkDn = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+trunkDn.length()+1, msgsize, strMsg, "trunkDn.length()", ip, port)) ) {return;}
	if ( !(VerifyData(trunkDn.length(), TRUNKNO_LEN, strMsg, "trunkDn", ip, port)) ) {return;}
	theBufContent += trunkDn.length()+1;

	if(theBufContent >= msgsize)
		return;

	beginTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+beginTime.length()+1, msgsize, strMsg, "beginTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(beginTime.length(), CURTIME_LEN, strMsg, "beginTime", ip, port)) ) {return;}
	theBufContent += beginTime.length()+1;

	if(theBufContent >= msgsize)
		return;

	strSequence = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strSequence.length()+1, msgsize, strMsg, "strSequence.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strSequence.length(), SEQUENCE_LEN, strMsg, "strSequence", ip, port)) ) {return;}
	theBufContent += strSequence.length()+1;
}

int SIPCCMsg_Record_StopTrunkP2ARecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, trunkDn.c_str(), trunkDn.length() + 1 );
	theBufContent += trunkDn.length() + 1;

	//beginTime
	memcpy(thebuf+theBufContent, beginTime.c_str(), beginTime.length()+1);
	theBufContent += beginTime.length()+1;

	//strSequence
	memcpy(thebuf+theBufContent, strSequence.c_str(), strSequence.length()+1);
	theBufContent += strSequence.length()+1;

	return theBufContent;
}

int SIPCCMsg_Record_StopTrunkP2ARecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += trunkDn.length() + 1;

	memSize += beginTime.length()+1;	//beginTime
	
	memSize += strSequence.length()+1;	//strSequence
	return memSize;
}

///Type_Record_StartTrunkP2PRecord
SIPCCMsg_Record_StartTrunkP2PRecord::SIPCCMsg_Record_StartTrunkP2PRecord()
{
	msgType = Type_Record_StartTrunkP2PRecord;
}

void SIPCCMsg_Record_StartTrunkP2PRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
	
	CTID = thebuf + theBufContent;
	theBufContent += CTID.length()+1;
	
	callerID = thebuf + theBufContent;
	theBufContent += callerID.length()+1;
	
	calleeID = thebuf + theBufContent;
	theBufContent += calleeID.length()+1;
	
	theComment = thebuf + theBufContent;
	theBufContent += theComment.length()+1;
	
	trunkDn = thebuf + theBufContent;
	theBufContent += trunkDn.length()+1;
}

int SIPCCMsg_Record_StartTrunkP2PRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += agentID.length() + 1;
	
	memcpy( thebuf + theBufContent, CTID.c_str(), CTID.length() + 1 );
	theBufContent += CTID.length() + 1;
	
	memcpy( thebuf + theBufContent, callerID.c_str(), callerID.length() + 1 );
	theBufContent += callerID.length() + 1;
	
	memcpy( thebuf + theBufContent, calleeID.c_str(), calleeID.length() + 1 );
	theBufContent += calleeID.length() + 1;
	
	memcpy( thebuf + theBufContent, theComment.c_str(), theComment.length() + 1 );
	theBufContent += theComment.length() + 1;
	
	memcpy( thebuf + theBufContent, trunkDn.c_str(), trunkDn.length() + 1 );
	theBufContent += trunkDn.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Record_StartTrunkP2PRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length() + 1;
	memSize += CTID.length() + 1;
	memSize += callerID.length() + 1;
	memSize += calleeID.length() + 1;
	memSize += theComment.length() + 1;
	memSize += trunkDn.length() + 1;
	
	return memSize;
}

///Type_Record_StopTrunkP2PRecord
SIPCCMsg_Record_StopTrunkP2PRecord::SIPCCMsg_Record_StopTrunkP2PRecord()
{
	msgType = Type_Record_StopTrunkP2PRecord;
}

void SIPCCMsg_Record_StopTrunkP2PRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	trunkDn = thebuf + theBufContent;
	theBufContent += trunkDn.length()+1;
}

int SIPCCMsg_Record_StopTrunkP2PRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, trunkDn.c_str(), trunkDn.length() + 1 );
	theBufContent += trunkDn.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Record_StopTrunkP2PRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += trunkDn.length() + 1;
	
	return memSize;
}

///Type_Record_LoadManageInfo
SIPCCMsg_Record_LoadManageInfo::SIPCCMsg_Record_LoadManageInfo()
{
	msgType = Type_Record_LoadManageInfo;
}

void SIPCCMsg_Record_LoadManageInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Record_LoadManageInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Record_LoadManageInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_Record_LoadManageInfoConf
SIPCCMsg_Record_LoadManageInfoConf::SIPCCMsg_Record_LoadManageInfoConf()
{
	msgType = Type_Record_LoadManageInfoConf;
}

void SIPCCMsg_Record_LoadManageInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	info = thebuf + theBufContent;
	theBufContent += info.length()+1;
}

int SIPCCMsg_Record_LoadManageInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, info.c_str(), info.length() + 1 );
	theBufContent += info.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Record_LoadManageInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += info.length() + 1;
	
	return memSize;
}

///Type_Record_AddRecCorp
SIPCCMsg_Record_AddRecCorp::SIPCCMsg_Record_AddRecCorp()
{
	msgType = Type_Record_AddRecCorp;
}

void SIPCCMsg_Record_AddRecCorp::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;
	
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;
	
	realCalledNo = thebuf + theBufContent;
	theBufContent += realCalledNo.length()+1;
}

int SIPCCMsg_Record_AddRecCorp::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, managerId.c_str(), managerId.length() + 1 );
	theBufContent += managerId.length() + 1;
	
	memcpy( thebuf + theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += corpName.length() + 1;
	
	memcpy( thebuf + theBufContent, realCalledNo.c_str(), realCalledNo.length() + 1 );
	theBufContent += realCalledNo.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Record_AddRecCorp::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += managerId.length() + 1;
	memSize += corpName.length() + 1;
	memSize += realCalledNo.length() + 1;
	
	return memSize;
}

///Type_Record_DelRecCorp
SIPCCMsg_Record_DelRecCorp::SIPCCMsg_Record_DelRecCorp()
{
	msgType = Type_Record_DelRecCorp;
}

void SIPCCMsg_Record_DelRecCorp::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;
}

int SIPCCMsg_Record_DelRecCorp::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, managerId.c_str(), managerId.length() + 1 );
	theBufContent += managerId.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Record_DelRecCorp::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += managerId.length() + 1;
	
	return memSize;
}

///Type_Record_RecInfo2ACD
SIPCCMsg_Record_RecInfo2ACD::SIPCCMsg_Record_RecInfo2ACD()
{
	msgType = Type_Record_RecInfo2ACD;
	agentID = "";
	invokeID = "";
	fullPathFileName = "";
	
	managerId = "";
	connectPhoneNo = "";
}

void SIPCCMsg_Record_RecInfo2ACD::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Record_RecInfo2ACD";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	invokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += invokeID.length()+1;

	fullPathFileName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+fullPathFileName.length()+1, msgsize, strMsg, "fullPathFileName.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(fullPathFileName.length(), FULLPATHFILENAME_LEN, strMsg, "fullPathFileName", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += fullPathFileName.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;
}

int SIPCCMsg_Record_RecInfo2ACD::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy( thebuf + theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += agentID.length() + 1;
	
	memcpy( thebuf + theBufContent, invokeID.c_str(), invokeID.length() + 1 );
	theBufContent += invokeID.length() + 1;
	
	memcpy( thebuf + theBufContent, fullPathFileName.c_str(), fullPathFileName.length() + 1 );
	theBufContent += fullPathFileName.length() + 1;

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Record_RecInfo2ACD::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length() + 1;
	memSize += invokeID.length() + 1;
	memSize += fullPathFileName.length() + 1;

	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	
	return memSize;
}
///Class_Record
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_SmartRoute
SIPCCMsg_SmartRoute::SIPCCMsg_SmartRoute()
{
	msgClass = Class_SmartRoute;
}

///Type_SmartRoute_QueryUserStatus
SIPCCMsg_SmartRoute_QueryUserStatus::SIPCCMsg_SmartRoute_QueryUserStatus()
{
	msgType = Type_SmartRoute_QueryUserStatus;
	
	userName = NULL;
	userNameLen = 0;
	theCorporation = NULL;
	theCorporationLen = 0;
	routeDest = NULL;
	routeDestLen = 0;
	userIP = 0;
	userPort = 0;
}

void SIPCCMsg_SmartRoute_QueryUserStatus::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SmartRoute_QueryUserStatus";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//userNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "userNameLen", ip, port)) ) {return;}
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(userNameLen, USERNAME_LEN, strMsg, "userNameLen", ip, port)) ) {return;}

	//userName
	if ( !(VerifyTotalLen(theBufContent+userNameLen, msgsize, strMsg, "userName", ip, port)) ) {return;}
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//theCorporationLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "theCorporationLen", ip, port)) ) {return;}
	memmove(&this->theCorporationLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(theCorporationLen, CORPNAME_LEN, strMsg, "theCorporationLen", ip, port)) ) {return;}

	//theCorporation
	if ( !(VerifyTotalLen(theBufContent+theCorporationLen, msgsize, strMsg, "theCorporation", ip, port)) ) {return;}
	theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memmove(theCorporation, thebuf+theBufContent, theCorporationLen);
	theBufContent += theCorporationLen;
	
	//routeDestLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "routeDestLen", ip, port)) ) {return;}
	memmove(&this->routeDestLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(routeDestLen, ROUTEDEST_LEN, strMsg, "routeDestLen", ip, port)) ) {return;}

	//routeDest
	if ( !(VerifyTotalLen(theBufContent+routeDestLen, msgsize, strMsg, "routeDest", ip, port)) ) {return;}
	routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memmove(routeDest, thebuf+theBufContent, routeDestLen);
	theBufContent += routeDestLen;
	
	//userIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "userIP", ip, port)) ) {return;}
	memmove(&this->userIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//userPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "userPort", ip, port)) ) {return;}
	memmove(&this->userPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_SmartRoute_QueryUserStatus::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;
	//theCorporationLen
	memmove(thebuf+theBufContent, &this->theCorporationLen, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	memmove(thebuf+theBufContent, this->theCorporation, this->theCorporationLen);
	theBufContent += theCorporationLen;
	
	//routeDestLen
	memmove(thebuf+theBufContent, &this->routeDestLen, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	memmove(thebuf+theBufContent, this->routeDest, this->routeDestLen);
	theBufContent += routeDestLen;
	
	//userIP
	memmove(thebuf+theBufContent, &this->userIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//userPort
	memmove(thebuf+theBufContent, &this->userPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_SmartRoute_QueryUserStatus::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//theCorporationLen
	memSize += this->theCorporationLen;	//theCorporation
	memSize += sizeof(int);				//routeDestLen
	memSize += this->routeDestLen;		//routeDest
	memSize += sizeof(unsigned long);	//userIP
	memSize += sizeof(unsigned short);	//userPort
	
	return memSize;
}

void SIPCCMsg_SmartRoute_QueryUserStatus::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

void SIPCCMsg_SmartRoute_QueryUserStatus::SetTheCorporation(string thecorporation)
{
	int iTheCorporation = thecorporation.length();
	this->theCorporationLen = iTheCorporation + 1;
	this->theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memcpy(theCorporation, thecorporation.c_str(), iTheCorporation);
}

void SIPCCMsg_SmartRoute_QueryUserStatus::SetRouteDest(string routedest)
{
	int iRouteLen = routedest.length();
	this->routeDestLen = iRouteLen + 1;
	this->routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memcpy(routeDest, routedest.c_str(), iRouteLen);
}

///Type_SmartRoute_QueryUserStatusConf
SIPCCMsg_SmartRoute_QueryUserStatusConf::SIPCCMsg_SmartRoute_QueryUserStatusConf()
{
	msgType = Type_SmartRoute_QueryUserStatusConf;
	theCorporation = NULL;
	theCorporationLen = 0;
	routeDest = NULL;
	routeDestLen = 0;
	userIP = 0;
	userPort = 0;
}

void SIPCCMsg_SmartRoute_QueryUserStatusConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//theCorporationLen
	memmove(&this->theCorporationLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memmove(theCorporation, thebuf+theBufContent, theCorporationLen);
	theBufContent += theCorporationLen;
	
	//routeDestLen
	memmove(&this->routeDestLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memmove(routeDest, thebuf+theBufContent, routeDestLen);
	theBufContent += routeDestLen;
	
	//userStatus
	memmove(&this->userStatus, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//userIP
	memmove(&this->userIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//userPort
	memmove(&this->userPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_SmartRoute_QueryUserStatusConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//theCorporationLen
	memmove(thebuf+theBufContent, &this->theCorporationLen, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	memmove(thebuf+theBufContent, this->theCorporation, this->theCorporationLen);
	theBufContent += theCorporationLen;
	
	//routeDestLen
	memmove(thebuf+theBufContent, &this->routeDestLen, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	memmove(thebuf+theBufContent, this->routeDest, this->routeDestLen);
	theBufContent += routeDestLen;
	
	//userStatus
	memmove(thebuf+theBufContent, &this->userStatus, sizeof(int));
	theBufContent += sizeof(int);
	
	//userIP
	memmove(thebuf+theBufContent, &this->userIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//userPort
	memmove(thebuf+theBufContent, &this->userPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_SmartRoute_QueryUserStatusConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theCorporationLen
	memSize += this->theCorporationLen;	//theCorporation
	memSize += sizeof(int);				//routeDestLen
	memSize += this->routeDestLen;		//routeDest
	memSize += sizeof(int);				//userStatus
	memSize += sizeof(unsigned long);	//userIP
	memSize += sizeof(unsigned short);	//userPort
	
	return memSize;
}

void SIPCCMsg_SmartRoute_QueryUserStatusConf::SetTheCorporation(string thecorporation)
{
	int iTheCorporation = thecorporation.length();
	this->theCorporationLen = iTheCorporation + 1;
	this->theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memcpy(theCorporation, thecorporation.c_str(), iTheCorporation);
}

void SIPCCMsg_SmartRoute_QueryUserStatusConf::SetRouteDest(string routedest)
{
	int iRouteLen = routedest.length();
	this->routeDestLen = iRouteLen + 1;
	this->routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memcpy(routeDest, routedest.c_str(), iRouteLen);
}

///Type_SmartRoute_LoadSmartRouteTactic
SIPCCMsg_SmartRoute_LoadSmartRouteTactic::SIPCCMsg_SmartRoute_LoadSmartRouteTactic()
{
	msgType = Type_SmartRoute_LoadSmartRouteTactic;
}


void SIPCCMsg_SmartRoute_LoadSmartRouteTactic::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_SmartRoute_LoadSmartRouteTactic::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_SmartRoute_LoadSmartRouteTactic::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_SmartRoute_BlackListTactic
SIPCCMsg_SmartRoute_BlackListTactic::SIPCCMsg_SmartRoute_BlackListTactic()
{
	msgType = Type_SmartRoute_BlackListTactic;
	routeDest = NULL;
	routeDestLen = 0;
	theCorporation = NULL;
	theCorporationLen = 0;
	theTactic = -1;
}

void SIPCCMsg_SmartRoute_BlackListTactic::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//routeDestLen
	memmove(&this->routeDestLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memmove(routeDest, thebuf+theBufContent, routeDestLen);
	theBufContent += routeDestLen;
	//theCorporationLen
	memmove(&this->theCorporationLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memmove(theCorporation, thebuf+theBufContent, theCorporationLen);
	theBufContent += theCorporationLen;
	//theTactic
	memmove(&this->theTactic, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_SmartRoute_BlackListTactic::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//routeDestLen
	memmove(thebuf+theBufContent, &this->routeDestLen, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	memmove(thebuf+theBufContent, this->routeDest, this->routeDestLen);
	theBufContent += routeDestLen;
	//theCorporationLen
	memmove(thebuf+theBufContent, &this->theCorporationLen, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	memmove(thebuf+theBufContent, this->theCorporation, this->theCorporationLen);
	theBufContent += theCorporationLen;
	//theTactic
	memmove(thebuf+theBufContent, &this->theTactic, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_SmartRoute_BlackListTactic::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//routeDestLen
	memSize += this->routeDestLen;		//routeDest
	memSize += sizeof(int);				//theCorporationLen
	memSize += this->theCorporationLen;	//theCorporation
	memSize += sizeof(int);				//theTactic
	
	return memSize;
}

void SIPCCMsg_SmartRoute_BlackListTactic::SetTheCorporation(string thecorporation)
{
	int iTheCorporation = thecorporation.length();
	this->theCorporationLen = iTheCorporation + 1;
	this->theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memcpy(theCorporation, thecorporation.c_str(), iTheCorporation);
}


void SIPCCMsg_SmartRoute_BlackListTactic::SetRouteDest(string routedest)
{
	int iRouteLen = routedest.length();
	this->routeDestLen = iRouteLen + 1;
	this->routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memcpy(routeDest, routedest.c_str(), iRouteLen);
}

///Type_SmartRoute_NewUserTactic
SIPCCMsg_SmartRoute_NewUserTactic::SIPCCMsg_SmartRoute_NewUserTactic()
{
	msgType = Type_SmartRoute_NewUserTactic;
	routeDest = NULL;
	routeDestLen = 0;
	theCorporation = NULL;
	theCorporationLen = 0;
	theTactic = -1;
}


void SIPCCMsg_SmartRoute_NewUserTactic::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//routeDestLen
	memmove(&this->routeDestLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memmove(routeDest, thebuf+theBufContent, routeDestLen);
	theBufContent += routeDestLen;
	//theCorporationLen
	memmove(&this->theCorporationLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memmove(theCorporation, thebuf+theBufContent, theCorporationLen);
	theBufContent += theCorporationLen;
	//theTactic
	memmove(&this->theTactic, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_SmartRoute_NewUserTactic::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//routeDestLen
	memmove(thebuf+theBufContent, &this->routeDestLen, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	memmove(thebuf+theBufContent, this->routeDest, this->routeDestLen);
	theBufContent += routeDestLen;
	//theCorporationLen
	memmove(thebuf+theBufContent, &this->theCorporationLen, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	memmove(thebuf+theBufContent, this->theCorporation, this->theCorporationLen);
	theBufContent += theCorporationLen;
	//theTactic
	memmove(thebuf+theBufContent, &this->theTactic, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_SmartRoute_NewUserTactic::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//routeDestLen
	memSize += this->routeDestLen;		//routeDest
	memSize += sizeof(int);				//theCorporationLen
	memSize += this->theCorporationLen;	//theCorporation
	memSize += sizeof(int);				//theTactic
	
	return memSize;
}

void SIPCCMsg_SmartRoute_NewUserTactic::SetTheCorporation(string thecorporation)
{
	int iTheCorporation = thecorporation.length();
	this->theCorporationLen = iTheCorporation + 1;
	this->theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memcpy(theCorporation, thecorporation.c_str(), iTheCorporation);
}

void SIPCCMsg_SmartRoute_NewUserTactic::SetRouteDest(string routedest)
{
	int iRouteLen = routedest.length();
	this->routeDestLen = iRouteLen + 1;
	this->routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memcpy(routeDest, routedest.c_str(), iRouteLen);
}

///Type_SmartRoute_OldUserTactic
SIPCCMsg_SmartRoute_OldUserTactic::SIPCCMsg_SmartRoute_OldUserTactic()
{
	msgType = Type_SmartRoute_OldUserTactic;
	routeDest = NULL;
	routeDestLen = 0;
	theCorporation = NULL;
	theCorporationLen = 0;
	theTactic = -1;
}

void SIPCCMsg_SmartRoute_OldUserTactic::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//routeDestLen
	memmove(&this->routeDestLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memmove(routeDest, thebuf+theBufContent, routeDestLen);
	theBufContent += routeDestLen;
	//theCorporationLen
	memmove(&this->theCorporationLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memmove(theCorporation, thebuf+theBufContent, theCorporationLen);
	theBufContent += theCorporationLen;
	//theTactic
	memmove(&this->theTactic, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_SmartRoute_OldUserTactic::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//routeDestLen
	memmove(thebuf+theBufContent, &this->routeDestLen, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	memmove(thebuf+theBufContent, this->routeDest, this->routeDestLen);
	theBufContent += routeDestLen;
	//theCorporationLen
	memmove(thebuf+theBufContent, &this->theCorporationLen, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	memmove(thebuf+theBufContent, this->theCorporation, this->theCorporationLen);
	theBufContent += theCorporationLen;
	//theTactic
	memmove(thebuf+theBufContent, &this->theTactic, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_SmartRoute_OldUserTactic::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//routeDestLen
	memSize += this->routeDestLen;		//routeDest
	memSize += sizeof(int);				//theCorporationLen
	memSize += this->theCorporationLen;	//theCorporation
	memSize += sizeof(int);				//theTactic
	
	return memSize;
}

void SIPCCMsg_SmartRoute_OldUserTactic::SetTheCorporation(string thecorporation)
{
	int iTheCorporation = thecorporation.length();
	this->theCorporationLen = iTheCorporation + 1;
	this->theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memcpy(theCorporation, thecorporation.c_str(), iTheCorporation);
}

void SIPCCMsg_SmartRoute_OldUserTactic::SetRouteDest(string routedest)
{
	int iRouteLen = routedest.length();
	this->routeDestLen = iRouteLen + 1;
	this->routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memcpy(routeDest, routedest.c_str(), iRouteLen);
}

///Type_SmartRoute_RouteTactic
SIPCCMsg_SmartRoute_RouteTactic::SIPCCMsg_SmartRoute_RouteTactic()
{
	msgType = Type_SmartRoute_RouteTactic;
	theCorporation = NULL;
	theCorporationLen = 0;
	routeDest = NULL;
	routeDestLen = 0;
	acdServerIP = 0;
	acdServerPort = 0;
	theTactic = -1;
}

void SIPCCMsg_SmartRoute_RouteTactic::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	//theCorporationLen
	memmove(&this->theCorporationLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memmove(theCorporation, thebuf+theBufContent, theCorporationLen);
	theBufContent += theCorporationLen;
	//routeDestLen
	memmove(&this->routeDestLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memmove(routeDest, thebuf+theBufContent, routeDestLen);
	theBufContent += routeDestLen;
	//acdServerIP
	memmove(&this->acdServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//acdServerPort
	memmove(&this->acdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//theTactic
	memmove(&this->theTactic, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_SmartRoute_RouteTactic::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//theCorporationLen
	memmove(thebuf+theBufContent, &this->theCorporationLen, sizeof(int));
	theBufContent += sizeof(int);
	//theCorporation
	memmove(thebuf+theBufContent, this->theCorporation, this->theCorporationLen);
	theBufContent += theCorporationLen;
	//routeDestLen
	memmove(thebuf+theBufContent, &this->routeDestLen, sizeof(int));
	theBufContent += sizeof(int);
	//routeDest
	memmove(thebuf+theBufContent, this->routeDest, this->routeDestLen);
	theBufContent += routeDestLen;
	//acdServerIP
	memmove(thebuf+theBufContent, &this->acdServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//acdServerPort
	memmove(thebuf+theBufContent, &this->acdServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//theTactic
	memmove(thebuf+theBufContent, &this->theTactic, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_SmartRoute_RouteTactic::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theCorporationLen
	memSize += this->theCorporationLen;	//theCorporation
	memSize += sizeof(int);				//routeDestLen
	memSize += this->routeDestLen;		//routeDest
	memSize += sizeof(unsigned long);	//acdServerIP
	memSize += sizeof(unsigned short);	//acdServerPort
	memSize += sizeof(int);				//theTactic
	
	return memSize;
}

void SIPCCMsg_SmartRoute_RouteTactic::SetTheCorporation(string thecorporation)
{
	int iTheCorporation = thecorporation.length();
	this->theCorporationLen = iTheCorporation + 1;
	this->theCorporation = new char[theCorporationLen];
	memset(theCorporation, 0, theCorporationLen);
	memcpy(theCorporation, thecorporation.c_str(), iTheCorporation);
}

void SIPCCMsg_SmartRoute_RouteTactic::SetRouteDest(string routedest)
{
	int iRouteLen = routedest.length();
	this->routeDestLen = iRouteLen + 1;
	this->routeDest = new char[routeDestLen];
	memset(routeDest, 0, routeDestLen);
	memcpy(routeDest, routedest.c_str(), iRouteLen);
}

///Class_SmartRoute
///////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_DataCollection
SIPCCMsg_DataCollection::SIPCCMsg_DataCollection()
{
	msgClass = Class_DataCollection;
}

///Type_Collect_RegisteConf
SIPCCMsg_Collect_RegisteConf::SIPCCMsg_Collect_RegisteConf()
{
	msgType = Type_Collect_RegisteConf;

	Version = "1.0";
	MsgSeq = 0;
	SplitCount = 1;
}

void SIPCCMsg_Collect_RegisteConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Collect_RegisteConf";
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent == msgsize)
		return;


	//Version
	Version = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+Version.length()+1, msgsize, strMsg, "Version.length()", ip, port)) ) {return;}
	if ( !(VerifyData(Version.length(), INVOKEID_LEN, strMsg, "Version", ip, port)) ) {return;}
	theBufContent += ( Version.length() + 1 );
	
	//MsgSeq
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "MsgSeq", ip, port)) ) {return;}
	memmove(&this->MsgSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//SplitCount
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "SplitCount", ip, port)) ) {return;}
	memmove(&this->SplitCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//TableName
	TableName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+TableName.length()+1, msgsize, strMsg, "TableName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(TableName.length(), INVOKEID_LEN, strMsg, "TableName", ip, port)) ) {return;}
	theBufContent += ( TableName.length() + 1 );

	//FieldName
	FieldName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+FieldName.length()+1, msgsize, strMsg, "FieldName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(FieldName.length(), FIELD_LEN, strMsg, "FieldName", ip, port)) ) {return;}
	theBufContent += ( FieldName.length() + 1 );

	//InvokeID
	InvokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeID.length()+1, msgsize, strMsg, "InvokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeID.length(), INVOKEID_LEN, strMsg, "InvokeID", ip, port)) ) {return;}
	theBufContent += ( InvokeID.length() + 1 );


}

int SIPCCMsg_Collect_RegisteConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//Version
	memcpy(thebuf+theBufContent, Version.c_str(), Version.length() + 1 );
	theBufContent += ( Version.length() + 1 );

	memmove(thebuf+theBufContent, &this->MsgSeq, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->SplitCount, sizeof(int));
	theBufContent += sizeof(int);

	//TableName
	memcpy(thebuf+theBufContent, TableName.c_str(), TableName.length() + 1 );
	theBufContent += ( TableName.length() + 1 );

	//FieldName
	memcpy(thebuf+theBufContent, FieldName.c_str(), FieldName.length() + 1 );
	theBufContent += ( FieldName.length() + 1 );

	//InvokeID
	memcpy(thebuf+theBufContent, InvokeID.c_str(), InvokeID.length() + 1 );
	theBufContent += ( InvokeID.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_Collect_RegisteConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += Version.length() + 1;	//Version
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	memSize += TableName.length() + 1;
	memSize += FieldName.length() + 1;
	memSize += InvokeID.length() + 1;

	return memSize;
}


///Type_Collect_StatProcess
SIPCCMsg_Collect_StatProcess::SIPCCMsg_Collect_StatProcess()
{
	msgType = Type_Collect_StatProcess;
	statSQL = NULL;
	statSQLLen = 0;
	
	iMsgSeq = 0;
	iSplitCount = 0;
	iMsgIvokeID = "";
	iMsgLevel = 0;
	Version = "1.0";
	bResend = 0;
	strManagerId = "";
}

void SIPCCMsg_Collect_StatProcess::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Collect_StatProcess";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//statSQLLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "statSQLLen", ip, port)) ) {return;}
	memmove(&this->statSQLLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( !(VerifyData(statSQLLen, STATSQL_LEN, strMsg, "statSQLLen", ip, port)) ) {return;}

	if(statSQLLen > 0)
	{
		//statSQL
		if ( !(VerifyTotalLen(theBufContent+statSQLLen, msgsize, strMsg, "statSQL", ip, port)) ) {return;}
		statSQL = new char[statSQLLen];
		memset(statSQL, 0, statSQLLen);
		memmove(statSQL, thebuf+theBufContent, statSQLLen);
		theBufContent += statSQLLen;
	}
	if(theBufContent == msgsize)
		return;
	
	//iMsgSeq
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "iMsgSeq", ip, port)) ) {return;}
	memmove(&this->iMsgSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//iSplitCount
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "iSplitCount", ip, port)) ) {return;}
	memmove(&this->iSplitCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//iMsgIvokeID
	iMsgIvokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+iMsgIvokeID.length()+1, msgsize, strMsg, "iMsgIvokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(iMsgIvokeID.length(), INVOKEID_LEN, strMsg, "iMsgIvokeID", ip, port)) ) {return;}
	theBufContent += ( iMsgIvokeID.length() + 1 );

	if(theBufContent == msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "iMsgLevel", ip, port)) ) {return;}
	memmove(&this->iMsgLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "iType", ip, port)) ) {return;}
	memmove(&this->iType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//Version
	Version = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+Version.length()+1, msgsize, strMsg, "Version.length()", ip, port)) ) {return;}
	if ( !(VerifyData(Version.length(), INVOKEID_LEN, strMsg, "Version", ip, port)) ) {return;}
	theBufContent += ( Version.length() + 1 );

	//TableName
	TableName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+TableName.length()+1, msgsize, strMsg, "TableName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(TableName.length(), INVOKEID_LEN, strMsg, "TableName", ip, port)) ) {return;}
	theBufContent += ( TableName.length() + 1 );

	if(theBufContent == msgsize)
		return;

	//bResend
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "bResend", ip, port)) ) {return;}
	memmove(&this->bResend, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//strStatSQL
	strStatSQL = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strStatSQL.length()+1, msgsize, strMsg, "strStatSQL.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strStatSQL.length(), INVOKEID_LEN, strMsg, "strStatSQL", ip, port)) ) {return;}
	theBufContent += ( strStatSQL.length() + 1 );

	//strManagerId
	strManagerId = thebuf+theBufContent;
	if(!(VerifyTotalLen(theBufContent+strManagerId.length()+1,msgsize,strMsg,"strManagerId.length()",ip,port))){return;}
	if(!(VerifyData(strManagerId.length(),INVOKEID_LEN,strMsg,"strManagerId",ip,port))){return;}
	theBufContent += (strManagerId.length()+1);
}

int SIPCCMsg_Collect_StatProcess::FillBuf(char*& thebuf)
{
	if(thebuf == NULL)
		thebuf = new char[GetMyMemSize()];

	int theBufContent = FillMsgHead(thebuf);
	
	//statSQLLen
	memmove(thebuf+theBufContent, &this->statSQLLen, sizeof(int));
	theBufContent += sizeof(int);
	//statSQL
	memmove(thebuf+theBufContent, this->statSQL, this->statSQLLen);
	theBufContent += statSQLLen;
	
	//iMsgSeq
	memmove(thebuf+theBufContent, &this->iMsgSeq, sizeof(int));
	theBufContent += sizeof(int);
	
	//iSplitCount
	memmove(thebuf+theBufContent, &this->iSplitCount, sizeof(int));
	theBufContent += sizeof(int);
	
	//iMsgIvokeID
	memcpy(thebuf+theBufContent, iMsgIvokeID.c_str(), iMsgIvokeID.length() + 1 );
	theBufContent += ( iMsgIvokeID.length() + 1 );

	memmove(thebuf+theBufContent, &this->iMsgLevel, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->iType, sizeof(int));
	theBufContent += sizeof(int);

	//Version
	memcpy(thebuf+theBufContent, Version.c_str(), Version.length() + 1 );
	theBufContent += ( Version.length() + 1 );

	//TableName
	memcpy(thebuf+theBufContent, TableName.c_str(), TableName.length() + 1 );
	theBufContent += ( TableName.length() + 1 );

	memmove(thebuf+theBufContent, &this->bResend, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, strStatSQL.c_str(), strStatSQL.length() + 1 );
	theBufContent += ( strStatSQL.length() + 1 );

	memcpy(thebuf+theBufContent, strManagerId.c_str(), strManagerId.length() + 1);
	theBufContent += (strManagerId.length()+1);

	return theBufContent;
}

int SIPCCMsg_Collect_StatProcess::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//statSQLLen
	memSize += this->statSQLLen;		//statSQL
	
	memSize += sizeof(int);				//iMsgSeq
	memSize += sizeof(int);				//iSplitCount
	memSize += iMsgIvokeID.length() + 1;	//iMsgIvokeID
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += Version.length() + 1;
	memSize += TableName.length() + 1;
	memSize += sizeof(int);

	memSize += strStatSQL.length() + 1;
	memSize += strManagerId.length()+1;
	return memSize;
}

void SIPCCMsg_Collect_StatProcess::SetStatSQL(string statsql)
{
	int iStatSQLLen = statsql.length();
	this->statSQLLen = iStatSQLLen + 1;
	this->statSQL = new char[statSQLLen];
	memset(statSQL, 0, statSQLLen);
	memcpy(statSQL, statsql.c_str(), iStatSQLLen);
}

///Type_Collect_StatProcessConf
void SIPCCMsg_Collect_StatProcessConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Collect_StatProcessConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);	
	
	iMsgIvokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+iMsgIvokeID.length()+1, msgsize, strMsg, "iMsgIvokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(iMsgIvokeID.length(), INVOKEID_LEN, strMsg, "iMsgIvokeID", ip, port)) ) {return;}
	theBufContent += iMsgIvokeID.length()+1;
	
	if(theBufContent == msgsize)
		return;

	//iSQLState
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "iSQLState", ip, port)) ) {return;}
	memmove(&this->iSQLState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "lSec", ip, port)) ) {return;}
	memmove(&this->lSec, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);


}

int SIPCCMsg_Collect_StatProcessConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, iMsgIvokeID.c_str(), iMsgIvokeID.length()+1);
	theBufContent += iMsgIvokeID.length()+1;

	//iSQLState
	memmove(thebuf+theBufContent, &this->iSQLState, sizeof(int));
	theBufContent += sizeof(int);

	//lSec
	memmove(thebuf+theBufContent, &this->lSec, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	return theBufContent;
}

int SIPCCMsg_Collect_StatProcessConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += this->iMsgIvokeID.length()+1;		//iMsgIvokeID
	memSize += sizeof(int);					//iSQLState
	memSize += sizeof(unsigned long);					//iSQLState


	return memSize;
}

///Type_Storage_Registe
SIPCCMsg_Storage_Registe::SIPCCMsg_Storage_Registe()
{
	msgType = Type_Storage_Registe;
	Version = "1.0";
}

void SIPCCMsg_Storage_Registe::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Storage_Registe";
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent == msgsize)
		return;

	//Version
	Version = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+Version.length()+1, msgsize, strMsg, "Version.length()", ip, port)) ) {return;}
	if ( !(VerifyData(Version.length(), INVOKEID_LEN, strMsg, "Version", ip, port)) ) {return;}
	theBufContent += ( Version.length() + 1 );
}

int SIPCCMsg_Storage_Registe::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, Version.c_str(), Version.length()+1);
	theBufContent += Version.length()+1;

	return theBufContent;
}

int SIPCCMsg_Storage_Registe::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += this->Version.length()+1;		//Version
	
	return memSize;
}

///Type_Storage_UnRegsite
SIPCCMsg_Storage_UnRegiste::SIPCCMsg_Storage_UnRegiste()
{
	msgType = Type_Storage_UnRegiste;
}

void SIPCCMsg_Storage_UnRegiste::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Storage_UnRegiste::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	return theBufContent;
}

int SIPCCMsg_Storage_UnRegiste::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Class_DataCollection
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_Gateway
SIPCCMsg_Gateway::SIPCCMsg_Gateway()
{
	msgClass = Class_Gateway;
}

///Type_Gateway_Login
SIPCCMsg_Gateway_Login::SIPCCMsg_Gateway_Login()
{
	msgType = Type_Gateway_Login;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->computerSymbol = NULL;
	this->computerSymbolLen = 0;
	this->theAccount = NULL;
	this->theAccountLen = 0;
	this->thePassword = NULL;
	this->thePasswordLen = 0;
	trunkCount = 0;
	lanIP = 0;
	lanPort = 0;
	
	
	gwPartNo = "";
	natType = 0;
	wanIP=0;
	wanPort=0;
	ConferenceAgentCount=0;
	isProxyRegister=0;
}

void SIPCCMsg_Gateway_Login::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{	
	string strMsgName = "SIPCCMsg_Gateway_Login";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	
	//computerSymbolLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "computerSymbolLen", ip, port)) ) {return;}
	memmove(&this->computerSymbolLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	if ( !(VerifyTotalLen(theBufContent+computerSymbolLen, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memmove(computerSymbol, thebuf+theBufContent, computerSymbolLen);
	theBufContent += computerSymbolLen;

	//theAccountLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "theAccountLen", ip, port)) ) {return;}
	memmove(&this->theAccountLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theAccount
	if ( !(VerifyTotalLen(theBufContent+theAccountLen, msgsize, strMsgName, "theAccount", ip, port)) ) {return;}
	theAccount = new char[theAccountLen];
	memset(theAccount, 0, theAccountLen);
	memmove(theAccount, thebuf+theBufContent, theAccountLen);
	theBufContent += theAccountLen;

	//thePasswordLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "thePasswordLen", ip, port)) ) {return;}
	memmove(&this->thePasswordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	if ( !(VerifyTotalLen(theBufContent+thePasswordLen, msgsize, strMsgName, "thePassword", ip, port)) ) {return;}
	thePassword = new char[thePasswordLen];
	memset(thePassword, 0, thePasswordLen);
	memmove(thePassword, thebuf+theBufContent, thePasswordLen);
	theBufContent += thePasswordLen;
	
	//trunkCount
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "trunkCount", ip, port)) ) {return;}
	memmove(&this->trunkCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "lanIP", ip, port)) ) {return;}
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "lanPort", ip, port)) ) {return;}
	memmove(&this->lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	if(theBufContent == msgsize)
		return;
	
	//gwPartNo
	gwPartNo = thebuf+theBufContent;
	theBufContent += ( gwPartNo.length() + 1 );
	VerifyData(gwPartNo.length(), GWPARTNO_LEN, strMsgName, "gwPartNo", ip, port);

	if(theBufContent == msgsize)
		return;

	//natType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "natType", ip, port)) ) {return;}
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//wanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "wanIP", ip, port)) ) {return;}
	memmove(&this->wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//wanPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "wanPort", ip, port)) ) {return;}
	memmove(&this->wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(theBufContent == msgsize)
		return;

	memmove(&this->ConferenceAgentCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;
    //isProxyRegister
	memmove(&this->isProxyRegister, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Gateway_Login::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	memmove(thebuf+theBufContent, &this->computerSymbolLen, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	memmove(thebuf+theBufContent, this->computerSymbol, this->computerSymbolLen);
	theBufContent += computerSymbolLen;
	//theAccountLen
	memmove(thebuf+theBufContent, &this->theAccountLen, sizeof(int));
	theBufContent += sizeof(int);
	//theAccount
	memmove(thebuf+theBufContent, this->theAccount, this->theAccountLen);
	theBufContent += theAccountLen;
	//thePasswordLen
	memmove(thebuf+theBufContent, &this->thePasswordLen, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	memmove(thebuf+theBufContent, this->thePassword, this->thePasswordLen);
	theBufContent += thePasswordLen;
	
	//trunkCount
	memmove(thebuf+theBufContent, &this->trunkCount, sizeof(int));
	theBufContent += sizeof(int);
	
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanPort
	memmove(thebuf+theBufContent, &this->lanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//gwPartNo
	memcpy(thebuf+theBufContent, gwPartNo.c_str(), gwPartNo.length() + 1 );
	theBufContent += ( gwPartNo.length() + 1 );

	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);


	//wanIP
	memmove(thebuf+theBufContent, &this->wanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanPort
	memmove(thebuf+theBufContent, &this->wanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->ConferenceAgentCount, sizeof(int));
	theBufContent += sizeof(int);


	//isProxyRegister
	memmove(thebuf+theBufContent, &this->isProxyRegister, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_Login::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//computerSymbolLen
	memSize += this->computerSymbolLen;	//computerSymbol
	memSize += sizeof(int);				//theAccountLen
	memSize += this->theAccountLen;		//theAccount
	memSize += sizeof(int);				//thePasswordLen
	memSize += this->thePasswordLen;	//thePassword
	memSize += sizeof(int);				//trunkCount
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(unsigned short);	//lanPort
	memSize += gwPartNo.length() + 1;	//gwPartNo
	memSize += sizeof(int);				//natType
	memSize += sizeof(unsigned long);	//wanIP
	memSize += sizeof(unsigned short);	//wanPort
	memSize += sizeof(int);	//ConferenceAgentCount
	memSize += sizeof(int);	//isProxyRegister
	
	return memSize;
}

void SIPCCMsg_Gateway_Login::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_Login::SetComputerSymbol(string computersymbol)
{
	int iComputerSymbolLen = computersymbol.length();
	this->computerSymbolLen = iComputerSymbolLen + 1;
	this->computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memcpy(computerSymbol, computersymbol.c_str(), iComputerSymbolLen);
}

void SIPCCMsg_Gateway_Login::SetTheAccount(string theaccount)
{
	int iTheAccountLen = theaccount.length();
	this->theAccountLen = iTheAccountLen + 1;
	this->theAccount = new char[theAccountLen];
	memset(theAccount, 0, theAccountLen);
	memcpy(theAccount, theaccount.c_str(), iTheAccountLen);
}

void SIPCCMsg_Gateway_Login::SetThePassword(string thepassword)
{
	int iThePasswordLen = thepassword.length();
	this->thePasswordLen = iThePasswordLen + 1;
	this->thePassword = new char[thePasswordLen];
	memset(thePassword, 0, thePasswordLen);
	memcpy(thePassword, thepassword.c_str(), iThePasswordLen);
}
//////////////////////////////////////////////////////////////////////////
// 开始 [12/25/2007 lixg]
///Type_Gateway_Valid
SIPCCMsg_Gateway_Valid::SIPCCMsg_Gateway_Valid()
{
	msgType = Type_Gateway_Valid;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->computerSymbol = NULL;
	this->computerSymbolLen = 0;
	this->bValid = 0;
}

void SIPCCMsg_Gateway_Valid::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_Valid";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;

	//computerSymbolLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "computerSymbolLen", ip, port)) ) {return;}
	memmove(&this->computerSymbolLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	if ( !(VerifyTotalLen(theBufContent+computerSymbolLen, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memmove(computerSymbol, thebuf+theBufContent, computerSymbolLen);
	theBufContent += computerSymbolLen;
	
	// bValid
	if ( !(VerifyTotalLen(theBufContent+sizeof(BYTE), msgsize, strMsgName, "bValid", ip, port)) ) {return;}
	memmove(&this->bValid, thebuf+theBufContent, sizeof(BYTE));
	theBufContent += sizeof(BYTE);
	
	if(theBufContent == msgsize)
		return;
}

int SIPCCMsg_Gateway_Valid::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	memmove(thebuf+theBufContent, &this->computerSymbolLen, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	memmove(thebuf+theBufContent, this->computerSymbol, this->computerSymbolLen);
	theBufContent += computerSymbolLen;
	
	// bValid
	memmove(thebuf+theBufContent, &this->bValid, sizeof(BYTE));
	theBufContent += sizeof(BYTE);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_Valid::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//computerSymbolLen
	memSize += this->computerSymbolLen;	//computerSymbol
	memSize += sizeof(BYTE);			//bValid
	
	return memSize;
}

void SIPCCMsg_Gateway_Valid::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_Valid::SetComputerSymbol(string computersymbol)
{
	int iComputerSymbolLen = computersymbol.length();
	this->computerSymbolLen = iComputerSymbolLen + 1;
	this->computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memcpy(computerSymbol, computersymbol.c_str(), iComputerSymbolLen);
}
// 结束 [12/25/2007 lixg]
//////////////////////////////////////////////////////////////////////////
///Type_Gateway_Logout
SIPCCMsg_Gateway_Logout::SIPCCMsg_Gateway_Logout()
{
	msgType = Type_Gateway_Logout;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->computerSymbol = NULL;
	this->computerSymbolLen = 0;
	this->theAccount = NULL;
	this->theAccountLen = 0;
	this->thePassword = NULL;
	this->thePasswordLen = 0;
}

void SIPCCMsg_Gateway_Logout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_Logout";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "computerSymbolLen", ip, port)) ) {return;}
	memmove(&this->computerSymbolLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	if ( !(VerifyTotalLen(theBufContent+computerSymbolLen, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memmove(computerSymbol, thebuf+theBufContent, computerSymbolLen);
	theBufContent += computerSymbolLen;
	//theAccountLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "theAccountLen", ip, port)) ) {return;}
	memmove(&this->theAccountLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theAccount
	if ( !(VerifyTotalLen(theBufContent+theAccountLen, msgsize, strMsgName, "theAccount", ip, port)) ) {return;}
	theAccount = new char[theAccountLen];
	memset(theAccount, 0, theAccountLen);
	memmove(theAccount, thebuf+theBufContent, theAccountLen);
	theBufContent += theAccountLen;
	//thePasswordLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "thePasswordLen", ip, port)) ) {return;}
	memmove(&this->thePasswordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	if ( !(VerifyTotalLen(theBufContent+thePasswordLen, msgsize, strMsgName, "thePassword", ip, port)) ) {return;}
	thePassword = new char[thePasswordLen];
	memset(thePassword, 0, thePasswordLen);
	memmove(thePassword, thebuf+theBufContent, thePasswordLen);
	theBufContent += thePasswordLen;
}

int SIPCCMsg_Gateway_Logout::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	memmove(thebuf+theBufContent, &this->computerSymbolLen, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	memmove(thebuf+theBufContent, this->computerSymbol, this->computerSymbolLen);
	theBufContent += computerSymbolLen;
	//theAccountLen
	memmove(thebuf+theBufContent, &this->theAccountLen, sizeof(int));
	theBufContent += sizeof(int);
	//theAccount
	memmove(thebuf+theBufContent, this->theAccount, this->theAccountLen);
	theBufContent += theAccountLen;
	//thePasswordLen
	memmove(thebuf+theBufContent, &this->thePasswordLen, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	memmove(thebuf+theBufContent, this->thePassword, this->thePasswordLen);
	theBufContent += thePasswordLen;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_Logout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//computerSymbolLen
	memSize += this->computerSymbolLen;	//computerSymbol
	memSize += sizeof(int);				//theAccountLen
	memSize += this->theAccountLen;		//theAccount
	memSize += sizeof(int);				//thePasswordLen
	memSize += this->thePasswordLen;	//thePassword
	
	return memSize;
}

void SIPCCMsg_Gateway_Logout::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_Logout::SetComputerSymbol(string computersymbol)
{
	int iComputerSymbolLen = computersymbol.length();
	this->computerSymbolLen = iComputerSymbolLen + 1;
	this->computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memcpy(computerSymbol, computersymbol.c_str(), iComputerSymbolLen);
}

void SIPCCMsg_Gateway_Logout::SetTheAccount(string theaccount)
{
	int iTheAccountLen = theaccount.length();
	this->theAccountLen = iTheAccountLen + 1;
	this->theAccount = new char[theAccountLen];
	memset(theAccount, 0, theAccountLen);
	memcpy(theAccount, theaccount.c_str(), iTheAccountLen);
}

void SIPCCMsg_Gateway_Logout::SetThePassword(string thepassword)
{
	int iThePasswordLen = thepassword.length();
	this->thePasswordLen = iThePasswordLen + 1;
	this->thePassword = new char[thePasswordLen];
	memset(thePassword, 0, thePasswordLen);
	memcpy(thePassword, thepassword.c_str(), iThePasswordLen);
}

///Type_Gateway_LoginConf
SIPCCMsg_Gateway_LoginConf::SIPCCMsg_Gateway_LoginConf()
{
	msgType = Type_Gateway_LoginConf;
	bSucc = 0;

	HeartBeatServerIP = 0;
	HeartBeatServerPort = 0;
	HeartBeatServerBackupIP = 0;
	HeartBeatServerBackupPort = 0;
	TrunkDataDistributeServerIp=0;
    TrunkDataDistributeServerPort=0;
	ServiceID=0;
	HeartBeatServerID=0;
	HeartBeatServerBackupID=0;

	recServerID = 0;
	recSymbol = "";
	recServerIP = "";
	recFilePath = "";
	recPathMode = 0;

	recServerID_Backup = 0;
	recSymbol_Backup = "";
	recServerIP_Backup = "";
	recFilePath_Backup = "";
	recPathMode_Backup = 0;
	operationMode=2;			//默认为2，表示须有两个心跳服务；为0表示无心跳服务；

	needProxyRegister=0;		//默认为0，表示网关可直接注册；为1表示网关需要代理注册；
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_Gateway_LoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_LoginConf";
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//bSucc
	memmove(&this->bSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//HeartBeatServerIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//HeartBeatServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//HeartBeatServerBackupIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerBackupIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//HeartBeatServerBackupPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerBackupPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


   //TrunkDataDistributeServerIp
	memmove(&this->TrunkDataDistributeServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
  
   //TrunkDataDistributeServerPort
	memmove(&this->TrunkDataDistributeServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	memmove(&this->HeartBeatServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->HeartBeatServerBackupID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//recServerID
	memmove(&this->recServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol
	recSymbol = thebuf + theBufContent;
	theBufContent += recSymbol.length()+1;

	//recServerIP
	recServerIP = thebuf + theBufContent;
	theBufContent += recServerIP.length()+1;

	//recFilePath
	recFilePath = thebuf + theBufContent;
	theBufContent += recFilePath.length()+1;

	//recPathMode
	memmove(&this->recPathMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//recServerID_Backup
	memmove(&this->recServerID_Backup, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol_Backup
	recSymbol_Backup = thebuf + theBufContent;
	theBufContent += recSymbol_Backup.length()+1;

	//recServerIP_Backup
	recServerIP_Backup = thebuf + theBufContent;
	theBufContent += recServerIP_Backup.length()+1;

	//recFilePath_Backup
	recFilePath_Backup = thebuf + theBufContent;
	theBufContent += recFilePath_Backup.length()+1;

	//recPathMode_Backup
	memmove(&this->recPathMode_Backup, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if ( theBufContent >= msgsize)
	{
		return;
	}
	//operationMode
	memmove(&this->operationMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if ( theBufContent >= msgsize)
	{
		return;
	}

	//needProxyRegister
	memmove(&this->needProxyRegister, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent += computerSymbol.length()+1;

}



int SIPCCMsg_Gateway_LoginConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//bSucc
	memmove(thebuf+theBufContent, &this->bSucc, sizeof(char));
	theBufContent += sizeof(char);
	
	//HeartBeatServerIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//HeartBeatServerBackupIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerBackupPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->TrunkDataDistributeServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//TrunkDataDistributeServerPort
	memmove(thebuf+theBufContent, &this->TrunkDataDistributeServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->HeartBeatServerID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupID, sizeof(int));
	theBufContent += sizeof(int);

	//recServerID
	memmove(thebuf+theBufContent, &this->recServerID, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol
	memcpy(thebuf+theBufContent, recSymbol.c_str(), recSymbol.length()+1);
	theBufContent += recSymbol.length()+1;

	//recServerIP
	memcpy(thebuf+theBufContent, recServerIP.c_str(), recServerIP.length()+1);
	theBufContent += recServerIP.length()+1;

	//recFilePath
	memcpy(thebuf+theBufContent, recFilePath.c_str(), recFilePath.length()+1);
	theBufContent += recFilePath.length()+1;

	//recPathMode
	memmove(thebuf+theBufContent, &this->recPathMode, sizeof(int));
	theBufContent += sizeof(int);

	//recServerID_Backup
	memmove(thebuf+theBufContent, &this->recServerID_Backup, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol_Backup
	memcpy(thebuf+theBufContent, recSymbol_Backup.c_str(), recSymbol_Backup.length()+1);
	theBufContent += recSymbol_Backup.length()+1;

	//recServerIP_Backup
	memcpy(thebuf+theBufContent, recServerIP_Backup.c_str(), recServerIP_Backup.length()+1);
	theBufContent += recServerIP_Backup.length()+1;

	//recFilePath_Backup
	memcpy(thebuf+theBufContent, recFilePath_Backup.c_str(), recFilePath_Backup.length()+1);
	theBufContent += recFilePath_Backup.length()+1;

	//recPathMode_Backup
	memmove(thebuf+theBufContent, &this->recPathMode_Backup, sizeof(int));
	theBufContent += sizeof(int);

	//
	//operationMode
	memmove(thebuf+theBufContent, &this->operationMode, sizeof(int));
	theBufContent += sizeof(int);



	//needProxyRegister
	memmove(thebuf+theBufContent, &this->needProxyRegister, sizeof(int));
	theBufContent += sizeof(int);

   //gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_LoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);			//bSucc

	memSize += sizeof(unsigned long);	//HeartBeatServerIP
	memSize += sizeof(unsigned short);	//HeartBeatServerPort
	memSize += sizeof(unsigned long);	//HeartBeatServerBackupIP
	memSize += sizeof(unsigned short);	//HeartBeatServerBackupPort

	memSize += sizeof(unsigned long);	//TrunkDataDistributeServerIp
	memSize += sizeof(unsigned short);	//TrunkDataDistributeServerPort

	memSize += sizeof(int);	//ServiceID
	memSize += sizeof(int);	//HeartBeatServerID
	memSize += sizeof(int);	//HeartBeatServerBackupID

	memSize += sizeof(int);						//recServerID
	memSize += recSymbol.length()+1;			//recSymbol
	memSize += recServerIP.length()+1;			//recServerIP
	memSize += recFilePath.length()+1;			//recFilePath
	memSize += sizeof(int);						//recPathMode

	memSize += sizeof(int);						//recServerID_Backup
	memSize += recSymbol_Backup.length()+1;		//recSymbol_Backup
	memSize += recServerIP_Backup.length()+1;	//recServerIP_Backup
	memSize += recFilePath_Backup.length()+1;	//recFilePath_Backup
	memSize += sizeof(int);						//recPathMode_Backup
	memSize += sizeof(int);						//operationMode



	memSize += sizeof(int);						//needProxyRegister
	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol


	return memSize;
}

///Type_Gateway_LoadInfo
SIPCCMsg_Gateway_LoadInfo::SIPCCMsg_Gateway_LoadInfo()
{
	msgType = Type_Gateway_LoadInfo;
}

void SIPCCMsg_Gateway_LoadInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Gateway_LoadInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_LoadInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_Gateway_SetBaseInfo
SIPCCMsg_Gateway_SetBaseInfo::SIPCCMsg_Gateway_SetBaseInfo()
{
	msgType = Type_Gateway_SetBaseInfo;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->theAccount = NULL;
	this->theAccountLen = 0;
	this->thePassword = NULL;
	this->thePasswordLen = 0;
}

void SIPCCMsg_Gateway_SetBaseInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_SetBaseInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	//theAccountLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "theAccountLen", ip, port)) ) {return;}
	memmove(&this->theAccountLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//theAccount
	if ( !(VerifyTotalLen(theBufContent+theAccountLen, msgsize, strMsgName, "theAccount", ip, port)) ) {return;}
	theAccount = new char[theAccountLen];
	memset(theAccount, 0, theAccountLen);
	memmove(theAccount, thebuf+theBufContent, theAccountLen);
	theBufContent += theAccountLen;
	//thePasswordLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "thePasswordLen", ip, port)) ) {return;}
	memmove(&this->thePasswordLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	if ( !(VerifyTotalLen(theBufContent+thePasswordLen, msgsize, strMsgName, "thePassword", ip, port)) ) {return;}
	thePassword = new char[thePasswordLen];
	memset(thePassword, 0, thePasswordLen);
	memmove(thePassword, thebuf+theBufContent, thePasswordLen);
	theBufContent += thePasswordLen;
}

int SIPCCMsg_Gateway_SetBaseInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//theAccountLen
	memmove(thebuf+theBufContent, &this->theAccountLen, sizeof(int));
	theBufContent += sizeof(int);
	//theAccount
	memmove(thebuf+theBufContent, this->theAccount, this->theAccountLen);
	theBufContent += theAccountLen;
	//thePasswordLen
	memmove(thebuf+theBufContent, &this->thePasswordLen, sizeof(int));
	theBufContent += sizeof(int);
	//thePassword
	memmove(thebuf+theBufContent, this->thePassword, this->thePasswordLen);
	theBufContent += thePasswordLen;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_SetBaseInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//theAccountLen
	memSize += this->theAccountLen;		//theAccount
	memSize += sizeof(int);				//thePasswordLen
	memSize += this->thePasswordLen;	//thePassword
	
	return memSize;
}

void SIPCCMsg_Gateway_SetBaseInfo::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_SetBaseInfo::SetTheAccount(string theaccount)
{
	int iTheAccountLen = theaccount.length();
	this->theAccountLen = iTheAccountLen + 1;
	this->theAccount = new char[theAccountLen];
	memset(theAccount, 0, theAccountLen);
	memcpy(theAccount, theaccount.c_str(), iTheAccountLen);
}

void SIPCCMsg_Gateway_SetBaseInfo::SetThePassword(string thepassword)
{
	int iThePasswordLen = thepassword.length();
	this->thePasswordLen = iThePasswordLen + 1;
	this->thePassword = new char[thePasswordLen];
	memset(thePassword, 0, thePasswordLen);
	memcpy(thePassword, thepassword.c_str(), iThePasswordLen);
}

///Type_Gateway_AddPrefixNoInfo
SIPCCMsg_Gateway_AddPrefixNoInfo::SIPCCMsg_Gateway_AddPrefixNoInfo()
{
	msgType = Type_Gateway_AddPrefixNoInfo;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->prefixList = NULL;
	this->prefixListLen = 0;

	invokeID = "";
}

void SIPCCMsg_Gateway_AddPrefixNoInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_AddPrefixNoInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	//prefixListLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "prefixListLen", ip, port)) ) {return;}
	memmove(&this->prefixListLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//prefixList
	if ( !(VerifyTotalLen(theBufContent+prefixListLen, msgsize, strMsgName, "prefixList", ip, port)) ) {return;}
	prefixList = new char[prefixListLen];
	memset(prefixList, 0, prefixListLen);
	memmove(prefixList, thebuf+theBufContent, prefixListLen);
	theBufContent += prefixListLen;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_Gateway_AddPrefixNoInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//prefixListLen
	memmove(thebuf+theBufContent, &this->prefixListLen, sizeof(int));
	theBufContent += sizeof(int);
	//prefixList
	memmove(thebuf+theBufContent, this->prefixList, this->prefixListLen);
	theBufContent += prefixListLen;
	
	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_AddPrefixNoInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//prefixListLen
	memSize += this->prefixListLen;		//prefixList

	memSize += invokeID.length()+1;		//invokeID
	
	return memSize;
}

void SIPCCMsg_Gateway_AddPrefixNoInfo::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_AddPrefixNoInfo::SetPrefixList(string prefixlist)
{
	int iPrefixListLen = prefixlist.length();
	this->prefixListLen = iPrefixListLen + 1;
	this->prefixList = new char[prefixListLen];
	memset(prefixList, 0, prefixListLen);
	memcpy(prefixList, prefixlist.c_str(), iPrefixListLen);
}

///Type_Gateway_SetCorporationInfo
SIPCCMsg_Gateway_SetCorporationInfo::SIPCCMsg_Gateway_SetCorporationInfo()
{
	msgType = Type_Gateway_SetCorporationInfo;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	this->phoneNo = NULL;
	this->phoneNoLen = 0;
	this->callInLicence = 0;
	this->callOutLicence = 0;
}

void SIPCCMsg_Gateway_SetCorporationInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	//phoneNoLen
	memmove(&this->phoneNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//phoneNo
	phoneNo = new char[phoneNoLen];
	memset(phoneNo, 0, phoneNoLen);
	memmove(phoneNo, thebuf+theBufContent, phoneNoLen);
	theBufContent += phoneNoLen;
	//callInLicence
	memmove(&this->callInLicence, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callOutLicence
	memmove(&this->callOutLicence, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Gateway_SetCorporationInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//phoneNoLen
	memmove(thebuf+theBufContent, &this->phoneNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//phoneNo
	memmove(thebuf+theBufContent, this->phoneNo, this->phoneNoLen);
	theBufContent += phoneNoLen;
	//callInLicence
	memmove(thebuf+theBufContent, &this->callInLicence, sizeof(int));
	theBufContent += sizeof(int);
	//callOutLicence
	memmove(thebuf+theBufContent, &this->callOutLicence, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_SetCorporationInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	memSize += sizeof(int);				//phoneNoLen
	memSize += this->phoneNoLen;		//phoneNo
	memSize += sizeof(int);				//callInLicence
	memSize += sizeof(int);				//callOutLicence
	
	return memSize;
}

void SIPCCMsg_Gateway_SetCorporationInfo::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_SetCorporationInfo::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

void SIPCCMsg_Gateway_SetCorporationInfo::SetPhoneNo(string phoneno)
{
	int iPhoneNoLen = phoneno.length();
	this->phoneNoLen = iPhoneNoLen + 1;
	this->phoneNo = new char[phoneNoLen];
	memset(phoneNo, 0, phoneNoLen);
	memcpy(phoneNo, phoneno.c_str(), iPhoneNoLen);
}

///Type_Gateway_DelCorporationInfo
SIPCCMsg_Gateway_DelCorporationInfo::SIPCCMsg_Gateway_DelCorporationInfo()
{
	msgType = Type_Gateway_DelCorporationInfo;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
}

void SIPCCMsg_Gateway_DelCorporationInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_DelCorporationInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, strMsgName, "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
}

int SIPCCMsg_Gateway_DelCorporationInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_DelCorporationInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	
	return memSize;
}

void SIPCCMsg_Gateway_DelCorporationInfo::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_Gateway_QueryGWConf
SIPCCMsg_Gateway_QueryGWConf::SIPCCMsg_Gateway_QueryGWConf()
{
	msgType = Type_Gateway_QueryGWConf;
	comSymbol = "";
	gwName = "";
	newPhoneNo = "";
	gwPartNo = "";
	dtmfEN = 1000;
	agentID = "";
	gwAreaCode = "";
	failedCause = "";
	usedBackupTG = 0;

	calloutByIAD = 0;
	routeContent = "";
	callerNoResult=0;
	ManagerTel="";
}

void SIPCCMsg_Gateway_QueryGWConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_QueryGWConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//comSymbol
	comSymbol = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+comSymbol.length()+1, msgsize, strMsg, "comSymbol.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(comSymbol.length(), COMSYMBOL_LEN, strMsg, "comSymbol", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (comSymbol.length()+1);

	//gwName
	gwName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwName.length()+1, msgsize, strMsg, "gwName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwName.length(), GWNAME_LEN, strMsg, "gwName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (gwName.length()+1);

	//newPhoneNo
	newPhoneNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+newPhoneNo.length()+1, msgsize, strMsg, "newPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(newPhoneNo.length(), NEWPHONENO_LEN, strMsg, "newPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (newPhoneNo.length()+1);

	if(theBufContent == msgsize)
		return;

	//gwPartNo
	gwPartNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwPartNo.length()+1, msgsize, strMsg, "gwPartNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwPartNo.length(), GWPARTNO_LEN, strMsg, "gwPartNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( gwPartNo.length() + 1 );

	if(theBufContent == msgsize)
		return;	

	//dtmfEN
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "dtmfEN", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->dtmfEN, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if(theBufContent >= msgsize)
		return;	
	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( agentID.length() + 1 );

	if(theBufContent == msgsize)
		return;

	//gwAreaCode
	gwAreaCode = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAreaCode.length()+1, msgsize, strMsg, "gwAreaCode.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwAreaCode.length(), GWAREACODE_LEN, strMsg, "gwAreaCode", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (gwAreaCode.length()+1);

	if(theBufContent == msgsize)
		return;

	//failedCause
	failedCause = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+failedCause.length()+1, msgsize, strMsg, "failedCause.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(failedCause.length(), UUIDATA_LEN, strMsg, "failedCause", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (failedCause.length()+1);

	if(theBufContent == msgsize)
		return;	

	//usedBackupTG
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "usedBackupTG", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->usedBackupTG, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;	

	//calloutByIAD
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "calloutByIAD", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->calloutByIAD, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//routeContent
	routeContent = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+routeContent.length()+1, msgsize, strMsg, "routeContent.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(routeContent.length(), GWPARTNO_LEN, strMsg, "routeContent", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += (routeContent.length()+1);

	if(theBufContent == msgsize)
		return;
	//callerNoResult
	memmove(&this->callerNoResult, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//ManagerTel
	ManagerTel = thebuf+theBufContent;	
	theBufContent += (ManagerTel.length()+1);
}


int SIPCCMsg_Gateway_QueryGWConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//comSymbol
	memmove(thebuf+theBufContent, comSymbol.c_str(), comSymbol.length()+1);
	theBufContent += (comSymbol.length()+1);
	//gwName
	memmove(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += (gwName.length()+1);
	//newPhoneNo
	memmove(thebuf+theBufContent, newPhoneNo.c_str(), newPhoneNo.length()+1);
	theBufContent += (newPhoneNo.length()+1);
	//gwPartNo
	memcpy(thebuf+theBufContent, gwPartNo.c_str(), gwPartNo.length() + 1 );
	theBufContent += ( gwPartNo.length() + 1 );
	
	//dtmfEN
	memmove(thebuf+theBufContent, &this->dtmfEN, sizeof(int));
	theBufContent += sizeof(int);
	
	//agentID
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += ( agentID.length() + 1 );

	//gwAreaCode
	memmove(thebuf+theBufContent, gwAreaCode.c_str(), gwAreaCode.length()+1);
	theBufContent += (gwAreaCode.length()+1);

	//failedCause
	memmove(thebuf+theBufContent, failedCause.c_str(), failedCause.length()+1);
	theBufContent += (failedCause.length()+1);

	//usedBackupTG
	memmove(thebuf+theBufContent, &this->usedBackupTG, sizeof(int));
	theBufContent += sizeof(int);

	//calloutByIAD
	memmove(thebuf+theBufContent, &this->calloutByIAD, sizeof(int));
	theBufContent += sizeof(int);
	
	//routeContent
	memmove(thebuf+theBufContent, routeContent.c_str(), routeContent.length()+1);
	theBufContent += (routeContent.length()+1);


	//callerNoResult
	memmove(thebuf+theBufContent, &this->callerNoResult, sizeof(int));
	theBufContent += sizeof(int);


	//ManagerTel
	memcpy(thebuf+theBufContent, ManagerTel.c_str(), ManagerTel.length() + 1 );
	theBufContent += ( ManagerTel.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_Gateway_QueryGWConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += (comSymbol.length()+1);	//comSymbol
	memSize += (gwName.length()+1);		//gwName
	memSize += (newPhoneNo.length()+1);	//newPhoneNo
	memSize += gwPartNo.length() + 1;	//gwPartNo
	memSize += sizeof(int);				//dtmfEN
	memSize += agentID.length() + 1;	//agentID
	memSize += gwAreaCode.length() + 1;	//gwAreaCode
	memSize += failedCause.length() + 1;//failedCause
	memSize += sizeof(int);				//usedBackupTG

	memSize += sizeof(int);				//calloutByIAD
	memSize += routeContent.length() + 1;	//routeContent

	memSize += sizeof(int);				//callerNoResult

	memSize += ManagerTel.length() + 1;	//ManagerTel

	return memSize;
}

///Type_Gateway_CallInQuery
SIPCCMsg_Gateway_CallInQuery::SIPCCMsg_Gateway_CallInQuery()
{
	msgType = Type_Gateway_CallInQuery;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->computerSymbol = NULL;
	this->computerSymbolLen = 0;
	this->phoneNo = NULL;
	this->phoneNoLen = 0;
	this->trunkNo = NULL;
	this->trunkNoLen = 0;
}

void SIPCCMsg_Gateway_CallInQuery::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_CallInQuery";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "computerSymbolLen", ip, port)) ) {return;}
	memmove(&this->computerSymbolLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	if ( !(VerifyTotalLen(theBufContent+computerSymbolLen, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memmove(computerSymbol, thebuf+theBufContent, computerSymbolLen);
	theBufContent += computerSymbolLen;
	//phoneNoLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "phoneNoLen", ip, port)) ) {return;}
	memmove(&this->phoneNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//phoneNo
	if ( !(VerifyTotalLen(theBufContent+phoneNoLen, msgsize, strMsgName, "phoneNo", ip, port)) ) {return;}
	phoneNo = new char[phoneNoLen];
	memset(phoneNo, 0, phoneNoLen);
	memmove(phoneNo, thebuf+theBufContent, phoneNoLen);
	theBufContent += phoneNoLen;
	//trunkNoLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "trunkNoLen", ip, port)) ) {return;}
	memmove(&this->trunkNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//trunkNo
	if ( !(VerifyTotalLen(theBufContent+trunkNoLen, msgsize, strMsgName, "trunkNo", ip, port)) ) {return;}
	trunkNo = new char[trunkNoLen];
	memset(trunkNo, 0, trunkNoLen);
	memmove(trunkNo, thebuf+theBufContent, trunkNoLen);
	theBufContent += trunkNoLen;
}

int SIPCCMsg_Gateway_CallInQuery::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	memmove(thebuf+theBufContent, &this->computerSymbolLen, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	memmove(thebuf+theBufContent, this->computerSymbol, this->computerSymbolLen);
	theBufContent += computerSymbolLen;
	//phoneNoLen
	memmove(thebuf+theBufContent, &this->phoneNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//phoneNo
	memmove(thebuf+theBufContent, this->phoneNo, this->phoneNoLen);
	theBufContent += phoneNoLen;
	//trunkNoLen
	memmove(thebuf+theBufContent, &this->trunkNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//trunkNo
	memmove(thebuf+theBufContent, this->trunkNo, this->trunkNoLen);
	theBufContent += trunkNoLen;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_CallInQuery::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//computerSymbolLen
	memSize += this->computerSymbolLen;	//computerSymbol
	memSize += sizeof(int);				//phoneNoLen
	memSize += this->phoneNoLen;		//phoneNo
	memSize += sizeof(int);				//trunkNoLen
	memSize += this->trunkNoLen;		//trunkNo
	
	return memSize;
}

void SIPCCMsg_Gateway_CallInQuery::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_CallInQuery::SetComputerSymbol(string computersymbol)
{
	int iComputerSymbolLen = computersymbol.length();
	this->computerSymbolLen = iComputerSymbolLen + 1;
	this->computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memcpy(computerSymbol, computersymbol.c_str(), iComputerSymbolLen);
}

void SIPCCMsg_Gateway_CallInQuery::SetPhoneNo(string phoneno)
{
	int iPhoneNoLen = phoneno.length();
	this->phoneNoLen = iPhoneNoLen + 1;
	this->phoneNo = new char[phoneNoLen];
	memset(phoneNo, 0, phoneNoLen);
	memcpy(phoneNo, phoneno.c_str(), iPhoneNoLen);
}

void SIPCCMsg_Gateway_CallInQuery::SetTrunkNo(string trunkno)
{
	int iTrunkNoLen = trunkno.length();
	this->trunkNoLen = iTrunkNoLen + 1;
	this->trunkNo = new char[trunkNoLen];
	memset(trunkNo, 0, trunkNoLen);
	memcpy(trunkNo, trunkno.c_str(), iTrunkNoLen);
}

///Type_Gateway_CallInQueryConf
SIPCCMsg_Gateway_CallInQueryConf::SIPCCMsg_Gateway_CallInQueryConf()
{
	msgType = Type_Gateway_CallInQueryConf;
	bLicenceOK = 1;
	trunkNo = NULL;
	trunkNoLen = 0;
	corporationName = NULL;
	corporationNameLen = 0;	
}

void SIPCCMsg_Gateway_CallInQueryConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//bLicenceOK
	memmove(&this->bLicenceOK, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//trunkNoLen
	memmove(&this->trunkNoLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//trunkNo
	trunkNo = new char[trunkNoLen];
	memset(trunkNo, 0, trunkNoLen);
	memmove(trunkNo, thebuf+theBufContent, trunkNoLen);
	theBufContent += trunkNoLen;
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
}

int SIPCCMsg_Gateway_CallInQueryConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//bLicenceOK
	memmove(thebuf+theBufContent, &this->bLicenceOK, sizeof(char));
	theBufContent += sizeof(char);
	//trunkNoLen
	memmove(thebuf+theBufContent, &this->trunkNoLen, sizeof(int));
	theBufContent += sizeof(int);
	//trunkNo
	memmove(thebuf+theBufContent, this->trunkNo, this->trunkNoLen);
	theBufContent += trunkNoLen;
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_CallInQueryConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);			//bLicenceOK
	memSize += sizeof(int);				//trunkNoLen
	memSize += this->trunkNoLen;		//trunkNo
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	
	return memSize;
}

void SIPCCMsg_Gateway_CallInQueryConf::SetTrunkNo(string trunkno)
{
	int iTrunkNoLen = trunkno.length();
	this->trunkNoLen = iTrunkNoLen + 1;
	this->trunkNo = new char[trunkNoLen];
	memset(trunkNo, 0, trunkNoLen);
	memcpy(trunkNo, trunkno.c_str(), iTrunkNoLen);
}

void SIPCCMsg_Gateway_CallInQueryConf::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_Gateway_SetTrunkState
SIPCCMsg_Gateway_SetTrunkState::SIPCCMsg_Gateway_SetTrunkState()
{
	msgType = Type_Gateway_SetTrunkState;
	this->gatewayName = NULL;
	this->gatewayNameLen = 0;
	this->computerSymbol = NULL;
	this->computerSymbolLen = 0;
	this->corporationName = NULL;
	this->corporationNameLen = 0;
	this->bIdle = 0;
	this->bIsCallin = 0;
}

void SIPCCMsg_Gateway_SetTrunkState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_SetTrunkState";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "computerSymbolLen", ip, port)) ) {return;}
	memmove(&this->computerSymbolLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	if ( !(VerifyTotalLen(theBufContent+computerSymbolLen, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memmove(computerSymbol, thebuf+theBufContent, computerSymbolLen);
	theBufContent += computerSymbolLen;
	//corporationNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "corporationNameLen", ip, port)) ) {return;}
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	if ( !(VerifyTotalLen(theBufContent+corporationNameLen, msgsize, strMsgName, "corporationName", ip, port)) ) {return;}
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	//bIdle
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsgName, "bIdle", ip, port)) ) {return;}
	memmove(&this->bIdle, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	//bIsCallin
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsgName, "bIsCallin", ip, port)) ) {return;}
	memmove(&this->bIsCallin, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_Gateway_SetTrunkState::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	memmove(thebuf+theBufContent, &this->computerSymbolLen, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	memmove(thebuf+theBufContent, this->computerSymbol, this->computerSymbolLen);
	theBufContent += computerSymbolLen;
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//bIdle
	memmove(thebuf+theBufContent, &this->bIdle, sizeof(char));
	theBufContent += sizeof(char);
	//bIsCallin
	memmove(thebuf+theBufContent, &this->bIsCallin, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_SetTrunkState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//computerSymbolLen
	memSize += this->computerSymbolLen;	//computerSymbol
	memSize += sizeof(int);				//corporationNameLen
	memSize += this->corporationNameLen;//corporationName
	memSize += sizeof(char);			//bIdle
	memSize += sizeof(char);			//bIsCallin
	
	return memSize;
}

void SIPCCMsg_Gateway_SetTrunkState::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_SetTrunkState::SetComputerSymbol(string computersymbol)
{
	int iComputerSymbolLen = computersymbol.length();
	this->computerSymbolLen = iComputerSymbolLen + 1;
	this->computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memcpy(computerSymbol, computersymbol.c_str(), iComputerSymbolLen);
}

void SIPCCMsg_Gateway_SetTrunkState::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_Gateway_AgentTestNetConf
SIPCCMsg_Gateway_AgentTestNetConf::SIPCCMsg_Gateway_AgentTestNetConf()
{
	msgType = Type_Gateway_AgentTestNetConf;
}

void SIPCCMsg_Gateway_AgentTestNetConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Gateway_AgentTestNetConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_AgentTestNetConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	return memSize;
}

///Type_Gateway_QueryGWLanInfoConf
SIPCCMsg_Gateway_QueryGWLanInfoConf::SIPCCMsg_Gateway_QueryGWLanInfoConf()
{
	msgType = Type_Gateway_QueryGWLanInfoConf;
	gwName = "";
	lanIP = 0;
	lanPort = 0;
}

void SIPCCMsg_Gateway_QueryGWLanInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gwName
	gwName = thebuf+theBufContent;
	theBufContent += (gwName.length()+1);
	//lanIP
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanPort
	memmove(&this->lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_Gateway_QueryGWLanInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gwName
	memmove(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += (gwName.length()+1);
	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//lanPort
	memmove(thebuf+theBufContent, &this->lanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_QueryGWLanInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += (gwName.length()+1);		//gwName
	memSize += sizeof(unsigned long);	//lanIP
	memSize += sizeof(unsigned short);	//lanPort
	return memSize;
}

///Type_Gateway_SyncTrunkState
SIPCCMsg_Gateway_SyncTrunkState::SIPCCMsg_Gateway_SyncTrunkState()
{
	msgType = Type_Gateway_SyncTrunkState;
	gatewayName = NULL;
	gatewayNameLen = 0;
	computerSymbol = NULL;
	computerSymbolLen = 0;
	stateList = NULL;
	stateListLen = 0;
}

void SIPCCMsg_Gateway_SyncTrunkState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_SyncTrunkState";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//gatewayNameLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "gatewayNameLen", ip, port)) ) {return;}
	memmove(&this->gatewayNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	if ( !(VerifyTotalLen(theBufContent+gatewayNameLen, msgsize, strMsgName, "gatewayName", ip, port)) ) {return;}
	gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memmove(gatewayName, thebuf+theBufContent, gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "computerSymbolLen", ip, port)) ) {return;}
	memmove(&this->computerSymbolLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	if ( !(VerifyTotalLen(theBufContent+computerSymbolLen, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memmove(computerSymbol, thebuf+theBufContent, computerSymbolLen);
	theBufContent += computerSymbolLen;
	//stateListLen
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "stateListLen", ip, port)) ) {return;}
	memmove(&this->stateListLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//stateList
	if ( !(VerifyTotalLen(theBufContent+stateListLen, msgsize, strMsgName, "stateList", ip, port)) ) {return;}
	stateList = new char[stateListLen];
	memset(stateList, 0, stateListLen);
	memmove(stateList, thebuf+theBufContent, stateListLen);
	theBufContent += stateListLen;
}

int SIPCCMsg_Gateway_SyncTrunkState::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//gatewayNameLen
	memmove(thebuf+theBufContent, &this->gatewayNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//gatewayName
	memmove(thebuf+theBufContent, this->gatewayName, this->gatewayNameLen);
	theBufContent += gatewayNameLen;
	//computerSymbolLen
	memmove(thebuf+theBufContent, &this->computerSymbolLen, sizeof(int));
	theBufContent += sizeof(int);
	//computerSymbol
	memmove(thebuf+theBufContent, this->computerSymbol, this->computerSymbolLen);
	theBufContent += computerSymbolLen;
	//stateListLen
	memmove(thebuf+theBufContent, &this->stateListLen, sizeof(int));
	theBufContent += sizeof(int);
	//stateList
	memmove(thebuf+theBufContent, this->stateList, this->stateListLen);
	theBufContent += stateListLen;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_SyncTrunkState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//gatewayNameLen
	memSize += this->gatewayNameLen;	//gatewayName
	memSize += sizeof(int);				//computerSymbolLen
	memSize += this->computerSymbolLen;	//computerSymbol
	memSize += sizeof(int);				//stateListLen
	memSize += stateListLen;			//stateList
	
	return memSize;
}

void SIPCCMsg_Gateway_SyncTrunkState::SetGatewayName(string gatewayname)
{
	int iGatewayNameLen = gatewayname.length();
	this->gatewayNameLen = iGatewayNameLen + 1;
	this->gatewayName = new char[gatewayNameLen];
	memset(gatewayName, 0, gatewayNameLen);
	memcpy(gatewayName, gatewayname.c_str(), iGatewayNameLen);
}

void SIPCCMsg_Gateway_SyncTrunkState::SetComputerSymbol(string computersymbol)
{
	int iComputerSymbolLen = computersymbol.length();
	this->computerSymbolLen = iComputerSymbolLen + 1;
	this->computerSymbol = new char[computerSymbolLen];
	memset(computerSymbol, 0, computerSymbolLen);
	memcpy(computerSymbol, computersymbol.c_str(), iComputerSymbolLen);
}

void SIPCCMsg_Gateway_SyncTrunkState::SetStateList(string sStateList)
{
	int iLen = sStateList.length();
	this->stateListLen = iLen + 1;
	this->stateList = new char[stateListLen];
	memset(stateList, 0, stateListLen);
	memcpy(stateList, sStateList.c_str(), iLen);
}

///Type_Gateway_ReConnect
SIPCCMsg_Gateway_ReConnect::SIPCCMsg_Gateway_ReConnect()
{
	msgType = Type_Gateway_ReConnect;
}

void SIPCCMsg_Gateway_ReConnect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Gateway_ReConnect::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_ReConnect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_Gateway_AgentTalkBegin
SIPCCMsg_Gateway_AgentTalkBegin::SIPCCMsg_Gateway_AgentTalkBegin()
{
	msgType = Type_Gateway_AgentTalkBegin;
	bAgentCallOut = 0;
	trunkPhoneNo = "";
	agentName = "";
	pstnPhoneNo = "";
	curTime = "";
	invokeID = "";
	lanIp = 0;
	wanIp = 0;
}

void SIPCCMsg_Gateway_AgentTalkBegin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&bAgentCallOut, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	trunkPhoneNo = thebuf+theBufContent;
	theBufContent += trunkPhoneNo.length()+1;
	
	agentName = thebuf+theBufContent;
	theBufContent += agentName.length()+1;
	
	pstnPhoneNo = thebuf+theBufContent;
	theBufContent += pstnPhoneNo.length()+1;
	
	curTime = thebuf+theBufContent;
	theBufContent += curTime.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	memcpy(&lanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(&wanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	chargeMode = thebuf+theBufContent;
	theBufContent += chargeMode.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	corpName = thebuf+theBufContent;
	theBufContent += corpName.length()+1;
}

int SIPCCMsg_Gateway_AgentTalkBegin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &bAgentCallOut, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, trunkPhoneNo.c_str(), trunkPhoneNo.length()+1);
	theBufContent += trunkPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;
	
	memcpy(thebuf+theBufContent, pstnPhoneNo.c_str(), pstnPhoneNo.length()+1);
	theBufContent += pstnPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, &lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(thebuf+theBufContent, &wanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(thebuf+theBufContent, chargeMode.c_str(), chargeMode.length()+1);
	theBufContent += chargeMode.length()+1;
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_AgentTalkBegin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += trunkPhoneNo.length()+1;
	memSize += agentName.length()+1;
	memSize += pstnPhoneNo.length()+1;
	memSize += curTime.length()+1;
	memSize += invokeID.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned long);
	memSize += chargeMode.length()+1;
	memSize += corpName.length()+1;
	
	return memSize;
}

///Type_Gateway_AgentTalkEnd
SIPCCMsg_Gateway_AgentTalkEnd::SIPCCMsg_Gateway_AgentTalkEnd()
{
	msgType = Type_Gateway_AgentTalkEnd;
	bAgentCallOut = 0;
	trunkPhoneNo = "";
	agentName = "";
	pstnPhoneNo = "";
	curTime = "";
	invokeID = "";
	lanIp = 0;
	wanIp = 0;
	chargeMode = "";
}

void SIPCCMsg_Gateway_AgentTalkEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&bAgentCallOut, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	trunkPhoneNo = thebuf+theBufContent;
	theBufContent += trunkPhoneNo.length()+1;
	
	agentName = thebuf+theBufContent;
	theBufContent += agentName.length()+1;
	
	pstnPhoneNo = thebuf+theBufContent;
	theBufContent += pstnPhoneNo.length()+1;
	
	curTime = thebuf+theBufContent;
	theBufContent += curTime.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	memcpy(&lanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(&wanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	chargeMode = thebuf+theBufContent;
	theBufContent += chargeMode.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	corpName = thebuf+theBufContent;
	theBufContent += corpName.length()+1;
}

int SIPCCMsg_Gateway_AgentTalkEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &bAgentCallOut, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, trunkPhoneNo.c_str(), trunkPhoneNo.length()+1);
	theBufContent += trunkPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;
	
	memcpy(thebuf+theBufContent, pstnPhoneNo.c_str(), pstnPhoneNo.length()+1);
	theBufContent += pstnPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, &lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(thebuf+theBufContent, &wanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memcpy(thebuf+theBufContent, chargeMode.c_str(), chargeMode.length()+1);
	theBufContent += chargeMode.length()+1;
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_AgentTalkEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += trunkPhoneNo.length()+1;
	memSize += agentName.length()+1;
	memSize += pstnPhoneNo.length()+1;
	memSize += curTime.length()+1;
	memSize += invokeID.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned long);
	memSize += chargeMode.length()+1;
	memSize += corpName.length()+1;
	
	return memSize;
}

///Type_Gateway_SetRecord
SIPCCMsg_Gateway_SetRecord::SIPCCMsg_Gateway_SetRecord()
{
	msgType = Type_Gateway_SetRecord;
	bSet = 0;
	agentName = "";
}

void SIPCCMsg_Gateway_SetRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&bSet, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	agentName = thebuf+theBufContent;
	theBufContent += agentName.length()+1;
}

int SIPCCMsg_Gateway_SetRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &bSet, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_SetRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName.length()+1;
	
	return memSize;
}

///Type_Gateway_SetRecordConf
SIPCCMsg_Gateway_SetRecordConf::SIPCCMsg_Gateway_SetRecordConf()
{
	msgType = Type_Gateway_SetRecordConf;
	bSucc = 0;
	oldAgent = "";
	curAgent = "";
}

void SIPCCMsg_Gateway_SetRecordConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&bSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	oldAgent = thebuf+theBufContent;
	theBufContent += oldAgent.length()+1;
	
	curAgent = thebuf+theBufContent;
	theBufContent += curAgent.length()+1;
}

int SIPCCMsg_Gateway_SetRecordConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &bSucc, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, oldAgent.c_str(), oldAgent.length()+1);
	theBufContent += oldAgent.length()+1;
	
	memcpy(thebuf+theBufContent, curAgent.c_str(), curAgent.length()+1);
	theBufContent += curAgent.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_SetRecordConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += oldAgent.length()+1;
	memSize += curAgent.length()+1;
	
	return memSize;
}

///Type_Gateway_GetTrunkState
SIPCCMsg_Gateway_GetTrunkState::SIPCCMsg_Gateway_GetTrunkState()
{
	msgType = Type_Gateway_GetTrunkState;
}

void SIPCCMsg_Gateway_GetTrunkState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
}

int SIPCCMsg_Gateway_GetTrunkState::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_GetTrunkState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_Gateway_GetTrunkStateConf
SIPCCMsg_Gateway_GetTrunkStateConf::SIPCCMsg_Gateway_GetTrunkStateConf()
{
	msgType = Type_Gateway_GetTrunkStateConf;
	bEnd = 0;
}

void SIPCCMsg_Gateway_GetTrunkStateConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&bEnd, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	StateString = thebuf+theBufContent;
	theBufContent += StateString.length()+1;
}

int SIPCCMsg_Gateway_GetTrunkStateConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, StateString.c_str(), StateString.length()+1);
	theBufContent += StateString.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_GetTrunkStateConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(char);
	memSize += StateString.length()+1;
	
	return memSize;
}

///Type_Gateway_ForceHangup
SIPCCMsg_Gateway_ForceHangup::SIPCCMsg_Gateway_ForceHangup()
{
	msgType = Type_Gateway_ForceHangup;
}

void SIPCCMsg_Gateway_ForceHangup::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	TrunkDn = thebuf+theBufContent;
	theBufContent += TrunkDn.length()+1;
}

int SIPCCMsg_Gateway_ForceHangup::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, TrunkDn.c_str(), TrunkDn.length()+1);
	theBufContent += TrunkDn.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_ForceHangup::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += TrunkDn.length()+1;
	
	return memSize;
}

///Type_Gateway_DisableSth
SIPCCMsg_Gateway_DisableSth::SIPCCMsg_Gateway_DisableSth()
{
	msgType = Type_Gateway_DisableSth;
	bDisable = 0;
}

void SIPCCMsg_Gateway_DisableSth::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&bDisable, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	AgentName = thebuf+theBufContent;
	theBufContent += AgentName.length()+1;
	
	CalledNum = thebuf+theBufContent;
	theBufContent += CalledNum.length()+1;
}

int SIPCCMsg_Gateway_DisableSth::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &bDisable, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length()+1);
	theBufContent += AgentName.length()+1;
	
	memcpy(thebuf+theBufContent, CalledNum.c_str(), CalledNum.length()+1);
	theBufContent += CalledNum.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_DisableSth::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(char);
	memSize += AgentName.length()+1;
	memSize += CalledNum.length()+1;
	
	return memSize;
}

///Type_Gateway_400CallBackCmd
SIPCCMsg_Gateway_400CallBackCmd::SIPCCMsg_Gateway_400CallBackCmd()
{
	msgType = Type_Gateway_400CallBackCmd;
}

void SIPCCMsg_Gateway_400CallBackCmd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_400CallBackCmd";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerID.length()+1, msgsize, strMsgName, "managerID", ip, port)) ) {return;}
	if ( !(VerifyData(managerID.length(), MANAGERID_LEN, strMsgName, "managerID", ip, port)) ) {return;}
	theBufContent += managerID.length()+1;
	
	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;
	
	callBackPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callBackPhoneNo.length()+1, msgsize, strMsgName, "callBackPhoneNo", ip, port)) ) {return;}
	if ( !(VerifyData(callBackPhoneNo.length(), PHONENO_LEN, strMsgName, "callBackPhoneNo", ip, port)) ) {return;}
	theBufContent += callBackPhoneNo.length()+1;
	
	if (theBufContent == msgsize)
	{
		return;
	}
	managerDialNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerDialNo.length()+1, msgsize, strMsgName, "managerDialNo", ip, port)) ) {return;}
	if ( !(VerifyData(managerDialNo.length(), PHONENO_LEN, strMsgName, "managerDialNo", ip, port)) ) {return;}
	theBufContent += managerDialNo.length()+1;
}

int SIPCCMsg_Gateway_400CallBackCmd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	memcpy(thebuf+theBufContent, callBackPhoneNo.c_str(), callBackPhoneNo.length()+1);
	theBufContent += callBackPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, managerDialNo.c_str(), managerDialNo.length()+1);
	theBufContent += managerDialNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_400CallBackCmd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += managerID.length()+1;	
	memSize += corpName.length()+1;	
	memSize += callBackPhoneNo.length()+1;
	memSize += managerDialNo.length()+1;
	
	return memSize;
}

///Type_Gateway_QueryAgentInfo
SIPCCMsg_Gateway_QueryAgentInfo::SIPCCMsg_Gateway_QueryAgentInfo()
{
	msgType = Type_Gateway_QueryAgentInfo;
}

void SIPCCMsg_Gateway_QueryAgentInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_QueryAgentInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length()+1;
	
	agentExtRealNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentExtRealNo.length()+1, msgsize, strMsgName, "agentExtRealNo", ip, port)) ) {return;}
	if ( !(VerifyData(agentExtRealNo.length(), AGENTID_LEN, strMsgName, "agentExtRealNo", ip, port)) ) {return;}
	theBufContent += agentExtRealNo.length()+1;
	
}

int SIPCCMsg_Gateway_QueryAgentInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, agentExtRealNo.c_str(), agentExtRealNo.length()+1);
	theBufContent += agentExtRealNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_QueryAgentInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;	
	memSize += agentExtRealNo.length()+1;	
	
	return memSize;
}

///Type_Gateway_IsAgentLogin
SIPCCMsg_Gateway_IsAgentLogin::SIPCCMsg_Gateway_IsAgentLogin()
{
	msgType = Type_Gateway_IsAgentLogin;
	agentID = "";
	
	invokeType = 0;
}

void SIPCCMsg_Gateway_IsAgentLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_IsAgentLogin";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "invokeType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->invokeType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsg, "invokeId.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsg, "invokeId", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += invokeId.length()+1;

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_IsAgentLogin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memmove(thebuf+theBufContent, &this->invokeType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_IsAgentLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length()+1;	
	memSize += sizeof(int);				//RequestID
	memSize += invokeId.length()+1;	//AgentName

	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

///Type_Gateway_CallAgentExtFailed
SIPCCMsg_Gateway_CallAgentExtFailed::SIPCCMsg_Gateway_CallAgentExtFailed()
{
	msgType = Type_Gateway_CallAgentExtFailed;
	agentID = "";
	managerId="";
}

void SIPCCMsg_Gateway_CallAgentExtFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallAgentExtFailed";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;

}

int SIPCCMsg_Gateway_CallAgentExtFailed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_CallAgentExtFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length()+1;	
	memSize += managerId.length()+1;
	
	return memSize;
}

///Type_Gateway_CallUserFailed_WpAgent
SIPCCMsg_Gateway_CallUserFailed_WpAgent::SIPCCMsg_Gateway_CallUserFailed_WpAgent()
{
	msgType = Type_Gateway_CallUserFailed_WpAgent;
	agentID = "";
	managerId="";
}

void SIPCCMsg_Gateway_CallUserFailed_WpAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallUserFailed_WpAgent";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;
}

int SIPCCMsg_Gateway_CallUserFailed_WpAgent::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_CallUserFailed_WpAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length()+1;	
	memSize += managerId.length()+1;
	
	return memSize;
}

///Type_Gateway_AgentExtCallerFailed
SIPCCMsg_Gateway_AgentExtCallerFailed::SIPCCMsg_Gateway_AgentExtCallerFailed()
{
	msgType = Type_Gateway_AgentExtCallerFailed;
	agentID = "";
}

void SIPCCMsg_Gateway_AgentExtCallerFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
}

int SIPCCMsg_Gateway_AgentExtCallerFailed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_AgentExtCallerFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length()+1;	
	
	return memSize;
}

///Type_Gateway_AgentExtCallSucc
SIPCCMsg_Gateway_AgentExtCallSucc::SIPCCMsg_Gateway_AgentExtCallSucc()
{
	msgType = Type_Gateway_AgentExtCallSucc;
	agentID = "";
	gwAgentLineIp = 0;
	gwAgentLinePort = 0;
	gwUserLineIp = 0;
	gwUserLinePort = 0;
	gwCtrlPort = 0;

	managerId = "";
}

void SIPCCMsg_Gateway_AgentExtCallSucc::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_AgentExtCallSucc";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}

	gwAgentLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAgentLine.length()+1, msgsize, strMsg, "gwAgentLine.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(gwAgentLine.length(), AGENTLINE_LEN, strMsg, "gwAgentLine", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += gwAgentLine.length()+1;

	gwUserLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwUserLine.length()+1, msgsize, strMsg, "gwUserLine.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(gwUserLine.length(), USERLINE_LEN, strMsg, "gwUserLine", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += gwUserLine.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "gwAgentLineIp", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->gwAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "gwAgentLinePort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->gwAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "gwUserLineIp", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->gwUserLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "gwUserLinePort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->gwUserLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "gwCtrlPort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->gwCtrlPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += managerId.length()+1;
}

int SIPCCMsg_Gateway_AgentExtCallSucc::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;
	
	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;
	
	memmove(thebuf+theBufContent, &this->gwAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->gwAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->gwUserLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->gwUserLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->gwCtrlPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_AgentExtCallSucc::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += agentID.length()+1;	
	memSize += gwAgentLine.length()+1;	
	memSize += gwUserLine.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned short);

	memSize += managerId.length()+1;	//managerId
	
	return memSize;
}


///Type_Gateway_LoadDataConf
SIPCCMsg_Gateway_LoadDataConf::SIPCCMsg_Gateway_LoadDataConf()
{
	msgType = Type_Gateway_LoadDataConf;
	invokeID = "";
}

void SIPCCMsg_Gateway_LoadDataConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Gateway_LoadDataConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_LoadDataConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;
	return memSize;
}

///Type_Gateway_ConfirmGWConf
SIPCCMsg_Gateway_ConfirmGWConf::SIPCCMsg_Gateway_ConfirmGWConf()
{
	msgType = Type_Gateway_ConfirmGWConf;
	invokeID = "";
	resultContent = "";
	GwName="";
	ComputerSymbol="";

}

void SIPCCMsg_Gateway_ConfirmGWConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;

	resultContent = thebuf + theBufContent;
	theBufContent += resultContent.length()+1;
	
	if ( theBufContent >= msgsize )
		return;

	//GwName
	GwName = thebuf + theBufContent;
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;	
	theBufContent += ComputerSymbol.length()+1;
}

int SIPCCMsg_Gateway_ConfirmGWConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	memcpy(thebuf+theBufContent, resultContent.c_str(), resultContent.length()+1);
	theBufContent += resultContent.length()+1;

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_ConfirmGWConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;
	memSize += resultContent.length()+1;

	memSize += GwName.length()+1;
	memSize += ComputerSymbol.length()+1;
	

	return memSize;
}

///Type_Gateway_HeartBeatConfirm
SIPCCMsg_Gateway_HeartBeatConfirm::SIPCCMsg_Gateway_HeartBeatConfirm()
{
	msgType = Type_Gateway_HeartBeatConfirm;
	invokeID = "";
	localIP = 0;
	localPort = 0;
	GwName = "";
	ComputerSymbol = "";
	isProxyRegister=0;
}

void SIPCCMsg_Gateway_HeartBeatConfirm::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_HeartBeatConfirm";
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;

	//localIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "localIP", ip, port)) ) {return;}
	memmove(&this->localIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//localPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "localPort", ip, port)) ) {return;}
	memmove(&this->localPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsgName, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsgName, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsgName, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsgName, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;
    //ServerType
	memmove(&this->ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//isProxyRegister
	memmove(&this->isProxyRegister, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Gateway_HeartBeatConfirm::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	//localIP
	memmove(thebuf+theBufContent, &this->localIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//localPort
	memmove(thebuf+theBufContent, &this->localPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//ServerType
	memmove(thebuf+theBufContent, &this->ServerType, sizeof(int));
	theBufContent += sizeof(int);


	//isProxyRegister
	memmove(thebuf+theBufContent, &this->isProxyRegister, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Gateway_HeartBeatConfirm::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += invokeID.length()+1;
	memSize += sizeof(unsigned long);		//localIP
	memSize += sizeof(unsigned short);		//localPort
	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += sizeof(int);		//ServerType

	memSize += sizeof(int);		//isProxyRegister

	return memSize;
}

///Type_Gateway_GetHeartBeat
SIPCCMsg_Gateway_GetHeartBeat::SIPCCMsg_Gateway_GetHeartBeat()
{
	msgType = Type_Gateway_GetHeartBeat;
	InvokeId = "";
	HeartBeatServerIP = 0;
	HeartBeatServerPort = 0;
	HeartBeatServerBackupIP = 0;
	HeartBeatServerBackupPort = 0;
	ServerID=0;
	ServerType=0;
	GatewayName="";
	ComputerSymbol="";
	
}

void SIPCCMsg_Gateway_GetHeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_GetHeartBeat";
	int theBufContent = AnalyzeMsgHead(thebuf);

	//InvokeId
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	//HeartBeatServerIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//HeartBeatServerBackupIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerBackupIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerBackupPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerBackupPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(theBufContent == msgsize)
		return;
	//ServerID
	memmove(&this->ServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
    //ServerType
	memmove(&this->ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//GatewayName
	GatewayName = thebuf + theBufContent;
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	theBufContent += ComputerSymbol.length()+1;
	

}

int SIPCCMsg_Gateway_GetHeartBeat::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	//HeartBeatServerIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//HeartBeatServerBackupIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerBackupPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//ServerID
	memmove(thebuf+theBufContent, &this->ServerID, sizeof(int));
	theBufContent += sizeof(int);

	//ServerType
	memmove(thebuf+theBufContent, &this->ServerType, sizeof(int));
	theBufContent += sizeof(int);


	//GatewayName
	memcpy(thebuf+theBufContent, GatewayName.c_str(), GatewayName.length()+1);
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;


	



	return theBufContent;
}

int SIPCCMsg_Gateway_GetHeartBeat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;		//InvokeId
	memSize += sizeof(unsigned long);	//HeartBeatServerIP
	memSize += sizeof(unsigned short);	//HeartBeatServerPort
	memSize += sizeof(unsigned long);	//HeartBeatServerBackupIP
	memSize += sizeof(unsigned short);	//HeartBeatServerBackupPort


	memSize += sizeof(int);	//ServerID
	memSize += sizeof(int );	//ServerType

	memSize += GatewayName.length()+1;		//GatewayName
	memSize += ComputerSymbol.length()+1;		//ComputerSymbol
	

	return memSize;
}

//Type_Gateway_GWLogoutConf
SIPCCMsg_Gateway_GWLogoutConf::SIPCCMsg_Gateway_GWLogoutConf()
{
	msgType = Type_Gateway_GWLogoutConf;

	GwName = "";
	ComputerSymbol = "";
}

void SIPCCMsg_Gateway_GWLogoutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_GWLogoutConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

}

int SIPCCMsg_Gateway_GWLogoutConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_GWLogoutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol

	return memSize;
}

///Type_Gateway_GWMRegister
SIPCCMsg_Gateway_GWMRegister::SIPCCMsg_Gateway_GWMRegister()
{
	msgType = Type_Gateway_GWMRegister;
	ServerName = "";
	ServerIp = 0;
	ServerPort = 0;
}

void SIPCCMsg_Gateway_GWMRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_GWMRegister";
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ServerName
	ServerName = thebuf + theBufContent;
	theBufContent += ServerName.length()+1;

	//ServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "ServerIp", ip, port)) ) {return;}
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "ServerPort", ip, port)) ) {return;}
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_Gateway_GWMRegister::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	//ServerIp
	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_Gateway_GWMRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;	//ServerName
	memSize += sizeof(unsigned long);	//ServerIp
	memSize += sizeof(unsigned short);	//ServerPort

	return memSize;
}

///Type_Gateway_GWMConfirmConf
SIPCCMsg_Gateway_GWMConfirmConf::SIPCCMsg_Gateway_GWMConfirmConf()
{
	msgType = Type_Gateway_GWMConfirmConf;
	invokeID = "";
}

void SIPCCMsg_Gateway_GWMConfirmConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Gateway_GWMConfirmConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_GWMConfirmConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;
	return memSize;
}

///Type_Gateway_LoadGWCorpInfo
SIPCCMsg_Gateway_LoadGWCorpInfo::SIPCCMsg_Gateway_LoadGWCorpInfo()
{
	msgType = Type_Gateway_LoadGWCorpInfo;
	ServerName = "";
}

void SIPCCMsg_Gateway_LoadGWCorpInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;
	theBufContent += ServerName.length()+1;
}

int SIPCCMsg_Gateway_LoadGWCorpInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_LoadGWCorpInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;
	return memSize;
}

///Class_Gateway
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_TextChat
SIPCCMsg_TextChat::SIPCCMsg_TextChat()
{
	msgClass = Class_TextChat;
}

///Type_Text_TextChat
SIPCCMsg_Text_TextChat::SIPCCMsg_Text_TextChat()
{
	msgType = Type_Text_TextChat;
	Sender = "";
	Receiver = "";
	ChatWords = "";
}

void SIPCCMsg_Text_TextChat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	Sender = thebuf;
	thebuf += ( Sender.length() + 1 );
	
	Receiver = thebuf;
	thebuf += ( Receiver.length() + 1 );
	
	ChatWords = thebuf;
	thebuf += ( ChatWords.length() + 1 );
}

int SIPCCMsg_Text_TextChat::FillBuf(char*& thebuf)
{
	int iLen = GetMyMemSize();
	thebuf = new char[iLen];
	char* pTemp = thebuf;
	
	int theBufContent = FillMsgHead(thebuf);
	pTemp += theBufContent;
	
	memcpy( pTemp, Sender.c_str(), Sender.length() + 1 );
	pTemp += ( Sender.length() + 1 );
	
	memcpy( pTemp, Receiver.c_str(), Receiver.length() + 1 );
	pTemp += ( Receiver.length() + 1 );
	
	memcpy( pTemp, ChatWords.c_str(), ChatWords.length() + 1 );
	pTemp += ( ChatWords.length() + 1 );
	
	return iLen;
}

int SIPCCMsg_Text_TextChat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ( Sender.length() + 1 );
	memSize += ( Receiver.length() + 1 );
	memSize += ( ChatWords.length() + 1 );
	
	return memSize;
}
///Class_TextChat

///////////////////////////////////////////////////////////////////////////
///Class_GwMonit

///Type_GwMonit_GetGwInfo
void SIPCCMsg_GwMonit_GetGwInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	GwName = thebuf;
	thebuf += ( GwName.length() + 1 );
}

int SIPCCMsg_GwMonit_GetGwInfo::FillBuf(char*& thebuf)
{
	int iLen = GetMyMemSize();
	thebuf = new char[iLen];
	char* pTemp = thebuf;
	
	int theBufContent = FillMsgHead(thebuf);
	pTemp += theBufContent;
	
	memcpy( pTemp, GwName.c_str(), GwName.length() + 1 );
	pTemp += ( GwName.length() + 1 );
	
	return iLen;
}

int SIPCCMsg_GwMonit_GetGwInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ( GwName.length() + 1 );
	
	return memSize;
}

///Type_GwMonit_GetGwInfoConf
void SIPCCMsg_GwMonit_GetGwInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	int iComputerLen = *(int*)thebuf;
	thebuf += sizeof(int);
	
	ComputerMap.clear();
	for ( int i = 0; i < iComputerLen; i++ )
	{
		string sComputer = thebuf;
		thebuf += ( sComputer.length() + 1 );
		
		IpPort ipPort = *(IpPort*)thebuf;
		thebuf += sizeof(IpPort);
		
		ComputerMap[sComputer] = ipPort;
	}
	
	int iCorporationLen = *(int*)thebuf;
	thebuf += sizeof(int);
	
	LicenceMap.clear();
	for ( int i1 = 0; i1 < iCorporationLen; i1++ )
	{
		string sCorporation = thebuf;
		thebuf += ( sCorporation.length() + 1 );
		
		Licence iLicence = *(Licence*)thebuf;
		thebuf += sizeof(Licence);
		
		LicenceMap[sCorporation] = iLicence;
	}
}

int SIPCCMsg_GwMonit_GetGwInfoConf::FillBuf(char*& thebuf)
{
	int iLen = GetMyMemSize();
	thebuf = new char[iLen];
	char* pTemp = thebuf;
	
	int theBufContent = FillMsgHead(thebuf);
	pTemp += theBufContent;
	
	int iSize = ComputerMap.size();
	memcpy( pTemp, &iSize, sizeof(int) );
	pTemp += sizeof(int);
	
	for ( map<string, IpPort>::iterator it1 = ComputerMap.begin()
		; it1 != ComputerMap.end(); it1++ )
	{
		memcpy( pTemp, it1->first.c_str(), it1->first.length() + 1 );
		pTemp += ( it1->first.length() + 1 );
		
		memcpy( pTemp, &it1->second, sizeof(IpPort) );
		pTemp += sizeof(IpPort);
	}
	
	iSize = LicenceMap.size();
	memcpy( pTemp, &iSize, sizeof(int) );
	pTemp += sizeof(int);
	
	for ( map<string, Licence>::iterator it2 = LicenceMap.begin()
		; it2 != LicenceMap.end(); it2++ )
	{
		memcpy( pTemp, it2->first.c_str(), it2->first.length() + 1 );
		pTemp += ( it2->first.length() + 1 );
		
		memcpy( pTemp, &it2->second, sizeof(Licence) );
		pTemp += sizeof(Licence);
	}
	
	return iLen;
}

int SIPCCMsg_GwMonit_GetGwInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);
	
	for ( map<string, IpPort>::iterator it1 = ComputerMap.begin()
		; it1 != ComputerMap.end(); it1++ )
	{
		memSize += ( it1->first.length() + 1 );
		memSize += sizeof(IpPort);
	}
	
	memSize += sizeof(int);
	
	for ( map<string, Licence>::iterator it2 = LicenceMap.begin()
		; it2 != LicenceMap.end(); it2++ )
	{
		memSize += ( it2->first.length() + 1 );
		memSize += sizeof(Licence);
	}
	
	return memSize;
}

void SIPCCMsg_GwMonit_GetGwInfoConf::AddComputer(string sName, unsigned long iIp, unsigned short iPort)
{
	IpPort temp = {iIp, iPort};
	ComputerMap[sName] = temp;
}

void SIPCCMsg_GwMonit_GetGwInfoConf::AddCorporation(string sName, int iInLicence, int iOutLicence)
{
	Licence temp = {iInLicence, iOutLicence};
	LicenceMap[sName] = temp;
}

///Type_GwMonit_RegMonit
void SIPCCMsg_GwMonit_RegMonit::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
}

int SIPCCMsg_GwMonit_RegMonit::FillBuf(char*& thebuf)
{
	int iLen = GetMyMemSize();
	thebuf = new char[iLen];
	char* pTemp = thebuf;
	
	int theBufContent = FillMsgHead(thebuf);
	pTemp += theBufContent;
	
	return iLen;
}

int SIPCCMsg_GwMonit_RegMonit::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_GwMonit_TrunkState
void SIPCCMsg_GwMonit_TrunkState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	ComputerName = thebuf;
	thebuf += ( ComputerName.length() + 1 );
	
	TrunkDN = thebuf;
	thebuf += ( TrunkDN.length() + 1 );
	
	memcpy( &State, thebuf, sizeof(int) );
	thebuf += sizeof(int);
	
	CorproationName = thebuf;
	thebuf += ( CorproationName.length() + 1 );
}

int SIPCCMsg_GwMonit_TrunkState::FillBuf(char*& thebuf)
{
	int iLen = GetMyMemSize();
	thebuf = new char[iLen];
	char* pTemp = thebuf;
	
	int theBufContent = FillMsgHead(thebuf);
	pTemp += theBufContent;
	
	memcpy( pTemp, ComputerName.c_str(), ComputerName.length() + 1 );
	pTemp += ( ComputerName.length() + 1 );
	
	memcpy( pTemp, TrunkDN.c_str(), TrunkDN.length() + 1 );
	pTemp += ( TrunkDN.length() + 1 );
	
	memcpy( pTemp, &State, sizeof(int) );
	pTemp += sizeof(int);
	
	memcpy( pTemp, CorproationName.c_str(), CorproationName.length() + 1 );
	pTemp += ( CorproationName.length() + 1 );
	
	return iLen;
}

int SIPCCMsg_GwMonit_TrunkState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ( ComputerName.length() + 1 );
	memSize += ( TrunkDN.length() + 1 );
	memSize += sizeof(int);
	memSize += ( CorproationName.length() + 1 );
	
	return memSize;
}
///Class_GwMonit
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_Redirect

///Type_Redirect_SearchPlatform
SIPCCMsg_Redirect_SearchPlatform::SIPCCMsg_Redirect_SearchPlatform()
{
	msgType = Type_Redirect_SearchPlatform;
	managerID = "";
	corpName = "";
	agentID="";
}

int SIPCCMsg_Redirect_SearchPlatform::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1 );
	theBufContent += ( managerID.length() + 1 );

	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += ( corpName.length() + 1 );	

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length() + 1 );
	theBufContent += ( agentID.length() + 1 );////by heyj

	memcpy(thebuf+theBufContent, loginRoute.c_str(), loginRoute.length() + 1 );
	theBufContent += ( loginRoute.length() + 1 );	
	return theBufContent;
}

void SIPCCMsg_Redirect_SearchPlatform::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	managerID = thebuf;
	thebuf += ( managerID.length() + 1 );

	if (theBufContent >= msgsize)
	{
		return;
	}

	corpName = thebuf;
	thebuf += ( corpName.length() + 1 );

	agentID = thebuf;
	thebuf += ( agentID.length() + 1 );////by heyj

	if (theBufContent >= msgsize)
	{
		return;
	}

	loginRoute = thebuf;
	thebuf += ( loginRoute.length() + 1 );
}

int SIPCCMsg_Redirect_SearchPlatform::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += ( managerID.length() + 1 );
	memSize += ( corpName.length() + 1 );
	memSize += ( agentID.length() + 1 );//by heyj
	memSize += ( loginRoute.length() + 1 );

	return memSize;
}

///Type_Redirect_SearchPlatformConf
SIPCCMsg_Redirect_SearchPlatformConf::SIPCCMsg_Redirect_SearchPlatformConf()
{
	msgType = Type_Redirect_SearchPlatformConf;
	platformIP = "";
}

int SIPCCMsg_Redirect_SearchPlatformConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, platformIP.c_str(), platformIP.length() + 1 );
	theBufContent += ( platformIP.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_Redirect_SearchPlatformConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	platformIP = thebuf;
	thebuf += ( platformIP.length() + 1 );
}

int SIPCCMsg_Redirect_SearchPlatformConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += ( platformIP.length() + 1 );
	
	return memSize;
}

///Type_Redirect_GetPlatformList
SIPCCMsg_Redirect_GetPlatformList::SIPCCMsg_Redirect_GetPlatformList()
{
	msgType = Type_Redirect_GetPlatformList;
}

int SIPCCMsg_Redirect_GetPlatformList::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length() + 1 );
	theBufContent += ( invokeID.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_Redirect_GetPlatformList::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;

	if(theBufContent >= msgsize)
		return;

	invokeID = thebuf;
	thebuf += ( invokeID.length() + 1 );
}

int SIPCCMsg_Redirect_GetPlatformList::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += invokeID.length()+1;

	return memSize;
}

///Type_Redirect_GetPlatformListConf
SIPCCMsg_Redirect_GetPlatformListConf::SIPCCMsg_Redirect_GetPlatformListConf()
{
	msgType = Type_Redirect_GetPlatformListConf;
	platformList = "";
	bEnd = 0;
}

int SIPCCMsg_Redirect_GetPlatformListConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, platformList.c_str(), platformList.length() + 1 );
	theBufContent += ( platformList.length() + 1 );
	
	memcpy(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);

	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length() + 1 );
	theBufContent += ( invokeID.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_Redirect_GetPlatformListConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	platformList = thebuf;
	thebuf += ( platformList.length() + 1 );
	
	memcpy(&bEnd, thebuf, sizeof(char));
	thebuf += sizeof(char);

	if(theBufContent >= msgsize)
		return;

	invokeID = thebuf;
	thebuf += ( invokeID.length() + 1 );
}

int SIPCCMsg_Redirect_GetPlatformListConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (platformList.length()+1);
	memSize += sizeof(char);
	memSize += invokeID.length() + 1;
	return memSize;
}

///Type_Redirect_CorpRegister
SIPCCMsg_Redirect_CorpRegister::SIPCCMsg_Redirect_CorpRegister()
{
	msgType = Type_Redirect_CorpRegister;
	managerID = "";
	corpName = "";
	platformIP = "";
	agentDNS = "";
}

int SIPCCMsg_Redirect_CorpRegister::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1 );
	theBufContent += ( managerID.length() + 1 );
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += ( corpName.length() + 1 );
	
	memcpy(thebuf+theBufContent, platformIP.c_str(), platformIP.length() + 1 );
	theBufContent += ( platformIP.length() + 1 );

	memcpy(thebuf+theBufContent, agentDNS.c_str(), agentDNS.length() + 1 );
	theBufContent += ( agentDNS.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_Redirect_CorpRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	managerID = thebuf;
	thebuf += ( managerID.length() + 1 );
	
	corpName = thebuf;
	thebuf += ( corpName.length() + 1 );
	
	platformIP = thebuf;
	thebuf += ( platformIP.length() + 1 );

	if(theBufContent >= msgsize)
		return;

	agentDNS = thebuf;
	thebuf += ( agentDNS.length() + 1 );
}

int SIPCCMsg_Redirect_CorpRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	memSize += (managerID.length()+1);
	memSize += (corpName.length()+1);
	memSize += (platformIP.length()+1);
	memSize += (agentDNS.length()+1);

	return memSize;
}

///Type_Redirect_GetCorpInfo
SIPCCMsg_Redirect_GetCorpInfo::SIPCCMsg_Redirect_GetCorpInfo()
{
	msgType = Type_Redirect_GetCorpInfo;
}

int SIPCCMsg_Redirect_GetCorpInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

void SIPCCMsg_Redirect_GetCorpInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
}

int SIPCCMsg_Redirect_GetCorpInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	return memSize;
}

///Type_Redirect_GetCorpInfoConf
SIPCCMsg_Redirect_GetCorpInfoConf::SIPCCMsg_Redirect_GetCorpInfoConf()
{
	msgType = Type_Redirect_GetCorpInfoConf;
	corpInfoList = "";
	bEnd = 0;
}

int SIPCCMsg_Redirect_GetCorpInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, corpInfoList.c_str(), corpInfoList.length() + 1 );
	theBufContent += ( corpInfoList.length() + 1 );
	
	memcpy(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

void SIPCCMsg_Redirect_GetCorpInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	corpInfoList = thebuf;
	thebuf += ( corpInfoList.length() + 1 );
	
	memcpy(&bEnd, thebuf, sizeof(char));
	thebuf += sizeof(char);
}

int SIPCCMsg_Redirect_GetCorpInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (corpInfoList.length()+1);
	memSize += sizeof(char);
	
	return memSize;
}

///Type_Redirect_LoadCorpInfo
SIPCCMsg_Redirect_LoadCorpInfo::SIPCCMsg_Redirect_LoadCorpInfo()
{
	msgType = Type_Redirect_LoadCorpInfo;
}

int SIPCCMsg_Redirect_LoadCorpInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

void SIPCCMsg_Redirect_LoadCorpInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
}

int SIPCCMsg_Redirect_LoadCorpInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	return memSize;
}

///Type_Redirect_LoadCorpInfoConf
SIPCCMsg_Redirect_LoadCorpInfoConf::SIPCCMsg_Redirect_LoadCorpInfoConf()
{
	msgType = Type_Redirect_LoadCorpInfoConf;
	corpInfoList = "";
	bEnd = 0;
}

int SIPCCMsg_Redirect_LoadCorpInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, corpInfoList.c_str(), corpInfoList.length() + 1 );
	theBufContent += ( corpInfoList.length() + 1 );
	
	memcpy(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

void SIPCCMsg_Redirect_LoadCorpInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	corpInfoList = thebuf;
	thebuf += ( corpInfoList.length() + 1 );
	
	memcpy(&bEnd, thebuf, sizeof(char));
	thebuf += sizeof(char);
}

int SIPCCMsg_Redirect_LoadCorpInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (corpInfoList.length()+1);
	memSize += sizeof(char);
	
	return memSize;
}

///Type_Redirect_LoadPlatformInfo
SIPCCMsg_Redirect_LoadPlatformInfo::SIPCCMsg_Redirect_LoadPlatformInfo()
{
	msgType = Type_Redirect_LoadPlatformInfo;
}

int SIPCCMsg_Redirect_LoadPlatformInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

void SIPCCMsg_Redirect_LoadPlatformInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
}

int SIPCCMsg_Redirect_LoadPlatformInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	return memSize;
}

///Type_Redirect_LoadPlatformInfoConf
SIPCCMsg_Redirect_LoadPlatformInfoConf::SIPCCMsg_Redirect_LoadPlatformInfoConf()
{
	msgType = Type_Redirect_LoadPlatformInfoConf;
	platformInfoList = "";
	bEnd = 0;
}

int SIPCCMsg_Redirect_LoadPlatformInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, platformInfoList.c_str(), platformInfoList.length() + 1 );
	theBufContent += ( platformInfoList.length() + 1 );
	
	memcpy(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

void SIPCCMsg_Redirect_LoadPlatformInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	platformInfoList = thebuf;
	thebuf += ( platformInfoList.length() + 1 );
	
	memcpy(&bEnd, thebuf, sizeof(char));
	thebuf += sizeof(char);
}

int SIPCCMsg_Redirect_LoadPlatformInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (platformInfoList.length()+1);
	memSize += sizeof(char);
	
	return memSize;
}

///Type_Redirect_AddCorpInfo
SIPCCMsg_Redirect_AddCorpInfo::SIPCCMsg_Redirect_AddCorpInfo()
{
	msgType = Type_Redirect_AddCorpInfo;
	this->managerID = "";
	this->corpName = "";
	this->platformIP = "";
}

int SIPCCMsg_Redirect_AddCorpInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1 );
	theBufContent += ( managerID.length() + 1 );
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1 );
	theBufContent += ( corpName.length() + 1 );
	
	memcpy(thebuf+theBufContent, platformIP.c_str(), platformIP.length() + 1 );
	theBufContent += ( platformIP.length() + 1 );	

	memcpy(thebuf+theBufContent, agentDNS.c_str(), agentDNS.length() + 1 );
	theBufContent += ( agentDNS.length() + 1 );	

	
	return theBufContent;
}

void SIPCCMsg_Redirect_AddCorpInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	managerID = thebuf;
	thebuf += ( managerID.length() + 1 );
	
	corpName = thebuf;
	thebuf += ( corpName.length() + 1 );
	
	platformIP = thebuf;
	thebuf += ( platformIP.length() + 1 );

	if ( theBufContent >= msgsize )
		return;

	agentDNS = thebuf;
	thebuf += ( agentDNS.length() + 1 );
}

int SIPCCMsg_Redirect_AddCorpInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (managerID.length()+1);
	memSize += (corpName.length()+1);
	memSize += (platformIP.length()+1);
	memSize += (agentDNS.length()+1);
	
	return memSize;
}

///Type_Redirect_DelCorpInfo
SIPCCMsg_Redirect_DelCorpInfo::SIPCCMsg_Redirect_DelCorpInfo()
{
	msgType = Type_Redirect_DelCorpInfo;
	this->managerID = "";
}

int SIPCCMsg_Redirect_DelCorpInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);	
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1 );
	theBufContent += ( managerID.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_Redirect_DelCorpInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	managerID = thebuf;
	thebuf += ( managerID.length() + 1 );
}

int SIPCCMsg_Redirect_DelCorpInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (managerID.length()+1);
	
	return memSize;
}

///Type_Redirect_AddPlatformInfo
SIPCCMsg_Redirect_AddPlatformInfo::SIPCCMsg_Redirect_AddPlatformInfo()
{
	msgType = Type_Redirect_AddPlatformInfo;
	this->platformIP = "";
	this->platformName = "";
}

int SIPCCMsg_Redirect_AddPlatformInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, platformIP.c_str(), platformIP.length() + 1 );
	theBufContent += ( platformIP.length() + 1 );
	
	memcpy(thebuf+theBufContent, platformName.c_str(), platformName.length() + 1 );
	theBufContent += ( platformName.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_Redirect_AddPlatformInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	platformIP = thebuf;
	thebuf += ( platformIP.length() + 1 );
	
	platformName = thebuf;
	thebuf += ( platformName.length() + 1 );
}

int SIPCCMsg_Redirect_AddPlatformInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (platformIP.length()+1);
	memSize += (platformName.length()+1);
	
	return memSize;
}

///Type_Redirect_DelPlatformInfo
SIPCCMsg_Redirect_DelPlatformInfo::SIPCCMsg_Redirect_DelPlatformInfo()
{
	msgType = Type_Redirect_DelPlatformInfo;
	this->platformIP = "";
}

int SIPCCMsg_Redirect_DelPlatformInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, platformIP.c_str(), platformIP.length() + 1 );
	theBufContent += ( platformIP.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_Redirect_DelPlatformInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	platformIP = thebuf;
	thebuf += ( platformIP.length() + 1 );
}

int SIPCCMsg_Redirect_DelPlatformInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (platformIP.length()+1);
	
	return memSize;
}

///Class_Redirect
///////////////////////////////////////////////////////////////////////////

///////////////////////////////////////////////////////////////////////////
///Class_DlyStrategy

///Type_DlyStrategy_QueryStrategy
SIPCCMsg_DlyStrategy_QueryStrategy::SIPCCMsg_DlyStrategy_QueryStrategy()
{
	msgType = Type_DlyStrategy_QueryStrategy;
	agentPartNo = "";
	gatewayPartNo = "";
	calledPartNo = "";
	GwLineDn = "";
}

int SIPCCMsg_DlyStrategy_QueryStrategy::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentPartNo.c_str(), agentPartNo.length() + 1 );
	theBufContent += ( agentPartNo.length() + 1 );
	
	memcpy(thebuf+theBufContent, gatewayPartNo.c_str(), gatewayPartNo.length() + 1 );
	theBufContent += ( gatewayPartNo.length() + 1 );
	
	memcpy(thebuf+theBufContent, calledPartNo.c_str(), calledPartNo.length() + 1 );
	theBufContent += ( calledPartNo.length() + 1 );
	
	memcpy(thebuf+theBufContent, GwLineDn.c_str(), GwLineDn.length() + 1 );
	theBufContent += ( GwLineDn.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_QueryStrategy::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentPartNo = thebuf + theBufContent;
	theBufContent += ( agentPartNo.length() + 1 );
	
	gatewayPartNo = thebuf + theBufContent;
	theBufContent += ( gatewayPartNo.length() + 1 );
	
	calledPartNo = thebuf + theBufContent;
	theBufContent += ( calledPartNo.length() + 1 );
	
	if ( theBufContent >= msgsize )
		return;
	
	GwLineDn = thebuf + theBufContent;
	theBufContent += ( GwLineDn.length() + 1 );
}

int SIPCCMsg_DlyStrategy_QueryStrategy::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += (agentPartNo.length()+1);
	memSize += (gatewayPartNo.length()+1);
	memSize += (calledPartNo.length()+1);
	memSize += (GwLineDn.length()+1);
	
	return memSize;
}

///Type_DlyStrategy_QueryStrategyConf
SIPCCMsg_DlyStrategy_QueryStrategyConf::SIPCCMsg_DlyStrategy_QueryStrategyConf()
{
	msgType = Type_DlyStrategy_QueryStrategyConf;
	agent2GwDelay = -1;	//-1 表示默认值
	gw2CalledDelay= -1;	//-1 表示默认值
	GwLineDn = "";
}

int SIPCCMsg_DlyStrategy_QueryStrategyConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &agent2GwDelay, sizeof(int) );
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, &gw2CalledDelay, sizeof(int) );
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, GwLineDn.c_str(), GwLineDn.length() + 1 );
	theBufContent += ( GwLineDn.length() + 1 );
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_QueryStrategyConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&agent2GwDelay, thebuf + theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(&gw2CalledDelay, thebuf + theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if ( theBufContent >= msgsize )
		return;
	
	GwLineDn = thebuf + theBufContent;
	theBufContent += ( GwLineDn.length() + 1 );
}

int SIPCCMsg_DlyStrategy_QueryStrategyConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);	//msgclass+msgtype
	memSize += sizeof(int);			//agent2GwDelay
	memSize += sizeof(int);			//gw2CalledDelay
	memSize += (GwLineDn.length()+1);
	
	return memSize;
}

///Type_DlyStrategy_AddStrategy
SIPCCMsg_DlyStrategy_AddStrategy::SIPCCMsg_DlyStrategy_AddStrategy()
{
	msgType = Type_DlyStrategy_AddStrategy;
	theType = Type_agent2GwDelay;	//0为 agent2GwDelay; 1为gw2CalledDelay
	leftPartNo = "";
	rightPartNo = "";
	delayValue = 0;
}

int SIPCCMsg_DlyStrategy_AddStrategy::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &theType, sizeof(int) );
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, leftPartNo.c_str(), leftPartNo.length()+1);
	theBufContent += leftPartNo.length()+1;
	
	memcpy(thebuf+theBufContent, rightPartNo.c_str(), rightPartNo.length()+1);
	theBufContent += rightPartNo.length()+1;
	
	memcpy(thebuf+theBufContent, &delayValue, sizeof(int) );
	theBufContent += sizeof(int);
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_AddStrategy::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	memcpy(&theType, thebuf, sizeof(int));
	thebuf += sizeof(int);
	
	leftPartNo = thebuf;
	thebuf += leftPartNo.length()+1;
	
	rightPartNo = thebuf;
	thebuf += rightPartNo.length()+1;
	
	memcpy(&delayValue, thebuf, sizeof(int));
	thebuf += sizeof(int);
}

int SIPCCMsg_DlyStrategy_AddStrategy::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theType
	memSize += leftPartNo.length()+1;	//leftPartNo
	memSize += rightPartNo.length()+1;	//rightPartNo
	memSize += sizeof(int);				//delayValue
	
	return memSize;
}

///Type_DlyStrategy_DelStrategy
SIPCCMsg_DlyStrategy_DelStrategy::SIPCCMsg_DlyStrategy_DelStrategy()
{
	msgType = Type_DlyStrategy_DelStrategy;
	theType = Type_agent2GwDelay;	//0为 agent2GwDelay; 1为gw2CalledDelay
	leftPartNo = "";
	rightPartNo = "";
}

int SIPCCMsg_DlyStrategy_DelStrategy::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &theType, sizeof(int) );
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, leftPartNo.c_str(), leftPartNo.length()+1);
	theBufContent += leftPartNo.length()+1;
	
	memcpy(thebuf+theBufContent, rightPartNo.c_str(), rightPartNo.length()+1);
	theBufContent += rightPartNo.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_DelStrategy::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	memcpy(&theType, thebuf, sizeof(int));
	thebuf += sizeof(int);
	
	leftPartNo = thebuf;
	thebuf += leftPartNo.length()+1;
	
	rightPartNo = thebuf;
	thebuf += rightPartNo.length()+1;
}

int SIPCCMsg_DlyStrategy_DelStrategy::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//theType
	memSize += leftPartNo.length()+1;	//leftPartNo
	memSize += rightPartNo.length()+1;	//rightPartNo
	
	return memSize;
}

///Type_DlyStrategy_LoadStrategy
SIPCCMsg_DlyStrategy_LoadStrategy::SIPCCMsg_DlyStrategy_LoadStrategy()
{
	msgType = Type_DlyStrategy_LoadStrategy;
}

int SIPCCMsg_DlyStrategy_LoadStrategy::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_LoadStrategy::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
}

int SIPCCMsg_DlyStrategy_LoadStrategy::GetMyMemSize()
{
	int memSize = 2*sizeof(int);	//msgclass+msgtype
	
	return memSize;
}

///Type_DlyStrategy_LoadStrategyConf
SIPCCMsg_DlyStrategy_LoadStrategyConf::SIPCCMsg_DlyStrategy_LoadStrategyConf()
{
	msgType = Type_DlyStrategy_LoadStrategyConf;
	strategyList = "";
}

int SIPCCMsg_DlyStrategy_LoadStrategyConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, strategyList.c_str(), strategyList.length()+1);
	theBufContent += strategyList.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_LoadStrategyConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	strategyList = thebuf;
	thebuf += strategyList.length()+1;
}

int SIPCCMsg_DlyStrategy_LoadStrategyConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strategyList.length()+1;	//strategyList
	
	return memSize;
}

///Type_DlyStrategy_GetStrategy
SIPCCMsg_DlyStrategy_GetStrategy::SIPCCMsg_DlyStrategy_GetStrategy()
{
	msgType = Type_DlyStrategy_GetStrategy;
}

int SIPCCMsg_DlyStrategy_GetStrategy::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_GetStrategy::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
}

int SIPCCMsg_DlyStrategy_GetStrategy::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

///Type_DlyStrategy_GetStrategyConf
SIPCCMsg_DlyStrategy_GetStrategyConf::SIPCCMsg_DlyStrategy_GetStrategyConf()
{
	msgType = Type_DlyStrategy_GetStrategyConf;
	strategyList = "";
	bEnd = 0;
}

int SIPCCMsg_DlyStrategy_GetStrategyConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, strategyList.c_str(), strategyList.length()+1);
	theBufContent += strategyList.length()+1;
	
	memcpy(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

void SIPCCMsg_DlyStrategy_GetStrategyConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	thebuf += theBufContent;
	
	strategyList = thebuf;
	thebuf += strategyList.length()+1;
	
	memcpy(&bEnd, thebuf, sizeof(char));
	thebuf += sizeof(char);
}

int SIPCCMsg_DlyStrategy_GetStrategyConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strategyList.length()+1;	//strategyList
	memSize += sizeof(char);
	
	return memSize;
}

///Class_DlyStrategy
///////////////////////////////////////////////////////////////////////////

void CIPCCMsgExchanger::SerializeDlyStrategyMsg(SIPCCMessage &msg, char *&thebuf, int &thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	
	switch(msgType)
	{
	case Type_DlyStrategy_QueryStrategy:
		thebufcontent = ((SIPCCMsg_DlyStrategy_QueryStrategy*)&msg)->FillBuf(thebuf);
		break;
	case Type_DlyStrategy_QueryStrategyConf:
		thebufcontent = ((SIPCCMsg_DlyStrategy_QueryStrategyConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_DlyStrategy_AddStrategy:
		thebufcontent = ((SIPCCMsg_DlyStrategy_AddStrategy*)&msg)->FillBuf(thebuf);
		break;
	case Type_DlyStrategy_DelStrategy:
		thebufcontent = ((SIPCCMsg_DlyStrategy_DelStrategy*)&msg)->FillBuf(thebuf);
		break;
	case Type_DlyStrategy_LoadStrategy:
		thebufcontent = ((SIPCCMsg_DlyStrategy_LoadStrategy*)&msg)->FillBuf(thebuf);
		break;
	case Type_DlyStrategy_LoadStrategyConf:
		thebufcontent = ((SIPCCMsg_DlyStrategy_LoadStrategyConf*)&msg)->FillBuf(thebuf);
		break;
	case Type_DlyStrategy_GetStrategy:
		thebufcontent = ((SIPCCMsg_DlyStrategy_GetStrategy*)&msg)->FillBuf(thebuf);
		break;
	case Type_DlyStrategy_GetStrategyConf:
		thebufcontent = ((SIPCCMsg_DlyStrategy_GetStrategyConf*)&msg)->FillBuf(thebuf);
		break;
	default:
		break;
	}
}

void CIPCCMsgExchanger::DeSerializeDlyStrategyMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_DlyStrategy_QueryStrategy:
		((SIPCCMsg_DlyStrategy_QueryStrategy*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_DlyStrategy_QueryStrategyConf:
		((SIPCCMsg_DlyStrategy_QueryStrategyConf*)&msg)->AnalyzeBuf(pmsg, msgsize);
		break;
	case Type_DlyStrategy_AddStrategy:
		((SIPCCMsg_DlyStrategy_AddStrategy*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_DlyStrategy_DelStrategy:
		((SIPCCMsg_DlyStrategy_DelStrategy*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_DlyStrategy_LoadStrategy:
		((SIPCCMsg_DlyStrategy_LoadStrategy*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_DlyStrategy_LoadStrategyConf:
		((SIPCCMsg_DlyStrategy_LoadStrategyConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_DlyStrategy_GetStrategy:
		((SIPCCMsg_DlyStrategy_GetStrategy*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	case Type_DlyStrategy_GetStrategyConf:
		((SIPCCMsg_DlyStrategy_GetStrategyConf*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
		break;
	default:
		break;
	}
}

/////////////////////////////////////////////////////////////////////////////////
///Class_TollQuery
SIPCCMsg_TollQuery::SIPCCMsg_TollQuery()
{
	msgClass = Class_TollQuery;
}

///Type_TollQuery_TollQuery
SIPCCMsg_TollQuery_TollQuery::SIPCCMsg_TollQuery_TollQuery()
{
	msgType = Type_TollQuery_TollQuery;
}

void SIPCCMsg_TollQuery_TollQuery::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
	
	if(theBufContent >= msgsize)
		return;
	
	ChargeType = thebuf + theBufContent;
	theBufContent += ChargeType.length() + 1;
	
	if(theBufContent >= msgsize)
		return;
	
	PhoneNum = thebuf + theBufContent;
	theBufContent += PhoneNum.length() + 1;

	if(theBufContent >= msgsize)
		return;

	Managerid = thebuf + theBufContent;
	theBufContent += Managerid.length() + 1;
}

int SIPCCMsg_TollQuery_TollQuery::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length()+1);
	theBufContent += AgentName.length()+1;
	
	memcpy(thebuf+theBufContent, ChargeType.c_str(), ChargeType.length()+1);
	theBufContent += ChargeType.length()+1;
	
	memcpy(thebuf+theBufContent, PhoneNum.c_str(), PhoneNum.length()+1);
	theBufContent += PhoneNum.length()+1;

	memcpy(thebuf+theBufContent, Managerid.c_str(), Managerid.length()+1);
	theBufContent += Managerid.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_TollQuery_TollQuery::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += AgentName.length()+1;	//AgentName
	memSize += ChargeType.length()+1;	//ChargeType
	memSize += PhoneNum.length()+1;		//PhoneNum
	memSize += Managerid.length()+1;	//Managerid
	
	return memSize;
}

///Type_TollQuery_TollQueryConf
SIPCCMsg_TollQuery_TollQueryConf::SIPCCMsg_TollQuery_TollQueryConf()
{
	msgType = Type_TollQuery_TollQueryConf;
}

void SIPCCMsg_TollQuery_TollQueryConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&ErrorCode, thebuf + theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	memcpy(&UsableTime, thebuf + theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	memcpy(&LeftMoney, thebuf + theBufContent, sizeof(double));
	theBufContent += sizeof(double);

	memcpy(&ValidDay, thebuf + theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_TollQuery_TollQueryConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &ErrorCode, sizeof(int) );
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, &UsableTime, sizeof(int) );
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &LeftMoney, sizeof(double));
	theBufContent += sizeof(double);

	memcpy(thebuf+theBufContent, &ValidDay, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_TollQuery_TollQueryConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	memSize += sizeof(int);					//ErrorCode
	memSize += sizeof(int);					//usableTime
	memSize += sizeof(double);				//LeftMoney
	memSize += sizeof(int);					//ValidDay
	
	return memSize;
}

///Type_TollQuery_GwTollQuery
SIPCCMsg_TollQuery_GwTollQuery::SIPCCMsg_TollQuery_GwTollQuery()
{
	msgType = Type_TollQuery_GwTollQuery;
}

void SIPCCMsg_TollQuery_GwTollQuery::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
	
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;
}

int SIPCCMsg_TollQuery_GwTollQuery::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length()+1);
	theBufContent += AgentName.length()+1;
	
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_TollQuery_GwTollQuery::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += AgentName.length()+1;	//AgentName
	memSize += InvokeId.length()+1;		//InvokeId
	
	return memSize;
}

///Type_TollQuery_GwTollQueryConf
SIPCCMsg_TollQuery_GwTollQueryConf::SIPCCMsg_TollQuery_GwTollQueryConf()
{
	msgType = Type_TollQuery_GwTollQueryConf;
}

void SIPCCMsg_TollQuery_GwTollQueryConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&ErrorCode, thebuf + theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(&UsableTime, thebuf + theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;
}

int SIPCCMsg_TollQuery_GwTollQueryConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, &ErrorCode, sizeof(int) );
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, &UsableTime, sizeof(int) );
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_TollQuery_GwTollQueryConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	memSize += sizeof(int);					//ErrorCode
	memSize += sizeof(int);					//usableTime
	
	memSize += InvokeId.length()+1;			//InvokeId
	
	return memSize;
}
///Class_TollQuery
/////////////////////////////////////////////////////////////////////////////////

void CIPCCMsgExchanger::DeSerializeTollQueryMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::SerializeTollQueryMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::DeSerializeSmsMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::SerializeSmsMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}

void CIPCCMsgExchanger::DeSerializeTollMsg(char *pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	msg.AnalyzeBuf(pmsg, msgsize, ip, port);
}

void CIPCCMsgExchanger::SerializeTollMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	thebufcontent = msg.FillBuf( thebuf );
}
/////////////////////////////////////////////////////////////////////////////////
///Class_SMS
SIPCCMsg_SMS::SIPCCMsg_SMS()
{
	msgClass = Class_SMS;
}

///Type_SMS_AddLinkman
SIPCCMsg_SMS_AddLinkman::SIPCCMsg_SMS_AddLinkman()
{
	msgType = Type_SMS_AddLinkman;
}

void SIPCCMsg_SMS_AddLinkman::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
	
	LinkManName = thebuf + theBufContent;
	theBufContent += LinkManName.length()+1;
	
	PhoneNum = thebuf + theBufContent;
	theBufContent += PhoneNum.length()+1;
	
	Description = thebuf + theBufContent;
	theBufContent += Description.length()+1;
}

int SIPCCMsg_SMS_AddLinkman::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;
	
	memcpy(thebuf+theBufContent, LinkManName.c_str(), LinkManName.length() + 1);
	theBufContent += LinkManName.length() + 1;
	
	memcpy(thebuf+theBufContent, PhoneNum.c_str(), PhoneNum.length() + 1);
	theBufContent += PhoneNum.length() + 1;
	
	memcpy(thebuf+theBufContent, Description.c_str(), Description.length() + 1);
	theBufContent += Description.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_AddLinkman::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += AgentName.length()+1;	//AgentName
	memSize += LinkManName.length()+1;	//LinkManName
	memSize += PhoneNum.length()+1;		//PhoneNum
	memSize += Description.length()+1;	//Description
	
	return memSize;
}

///Type_SMS_DelLinkman
SIPCCMsg_SMS_DelLinkman::SIPCCMsg_SMS_DelLinkman()
{
	msgType = Type_SMS_DelLinkman;
}

void SIPCCMsg_SMS_DelLinkman::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
	
	LinkManName = thebuf + theBufContent;
	theBufContent += LinkManName.length()+1;
	
}

int SIPCCMsg_SMS_DelLinkman::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;
	
	memcpy(thebuf+theBufContent, LinkManName.c_str(), LinkManName.length() + 1);
	theBufContent += LinkManName.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_DelLinkman::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += AgentName.length()+1;	//AgentName
	memSize += LinkManName.length()+1;	//LinkManName
	
	return memSize;
}

///Type_SMS_ModifyLinkman
SIPCCMsg_SMS_ModifyLinkman::SIPCCMsg_SMS_ModifyLinkman()
{
	msgType = Type_SMS_ModifyLinkman;
}

void SIPCCMsg_SMS_ModifyLinkman::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
	
	LinkManName = thebuf + theBufContent;
	theBufContent += LinkManName.length()+1;
	
	PhoneNum = thebuf + theBufContent;
	theBufContent += PhoneNum.length()+1;
	
	Description = thebuf + theBufContent;
	theBufContent += Description.length()+1;
}

int SIPCCMsg_SMS_ModifyLinkman::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;
	
	memcpy(thebuf+theBufContent, LinkManName.c_str(), LinkManName.length() + 1);
	theBufContent += LinkManName.length() + 1;
	
	memcpy(thebuf+theBufContent, PhoneNum.c_str(), PhoneNum.length() + 1);
	theBufContent += PhoneNum.length() + 1;
	
	memcpy(thebuf+theBufContent, Description.c_str(), Description.length() + 1);
	theBufContent += Description.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_ModifyLinkman::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += AgentName.length()+1;	//AgentName
	memSize += LinkManName.length()+1;	//LinkManName
	memSize += PhoneNum.length()+1;		//PhoneNum
	memSize += Description.length()+1;	//Description
	
	return memSize;
}

///Type_SMS_Send
SIPCCMsg_SMS_Send::SIPCCMsg_SMS_Send()
{
	msgType = Type_SMS_Send;
	AgentName="";
	PhoneNum="";
	Text="";
	m_uPhoneCount=0;
	m_strManagerID="";
	m_strSPNumber="";
	m_strShort="";
}

void SIPCCMsg_SMS_Send::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
	
	PhoneNum = thebuf + theBufContent;
	theBufContent += PhoneNum.length()+1;
	
	Text = thebuf + theBufContent;
	theBufContent += Text.length()+1;
	
	/*	if ( theBufContent >= msgsize )
	{
	return;
}*/
	memcpy(&m_uPhoneCount, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	m_strManagerID=thebuf + theBufContent;
	theBufContent += m_strManagerID.length()+1;
	
	m_strSPNumber=thebuf + theBufContent;
	theBufContent += m_strSPNumber.length()+1;
	
	m_strShort=thebuf + theBufContent;
	theBufContent += m_strShort.length()+1;
}

int SIPCCMsg_SMS_Send::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;
	
	memcpy(thebuf+theBufContent, PhoneNum.c_str(), PhoneNum.length() + 1);
	theBufContent += PhoneNum.length() + 1;
	
	memcpy(thebuf+theBufContent, Text.c_str(), Text.length() + 1);
	theBufContent += Text.length() + 1;
	
	memcpy(thebuf+theBufContent, &m_uPhoneCount, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, m_strManagerID.c_str(), m_strManagerID.length() + 1);
	theBufContent += m_strManagerID.length() + 1;
	
	memcpy(thebuf+theBufContent, m_strSPNumber.c_str(), m_strSPNumber.length() + 1);
	theBufContent += m_strSPNumber.length() + 1;
	
	memcpy(thebuf+theBufContent, m_strShort.c_str(), m_strShort.length() + 1);
	theBufContent += m_strShort.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_Send::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += AgentName.length()+1;	//AgentName
	memSize += PhoneNum.length()+1;		//PhoneNum
	memSize += Text.length()+1;			//Text
	memSize += sizeof(unsigned short);  // PhoneCount
	memSize += m_strManagerID.length()+1;
	memSize += m_strSPNumber.length()+1;
	memSize += m_strShort.length()+1;
	
	return memSize;
}

///Type_SMS_SendConf
SIPCCMsg_SMS_SendConf::SIPCCMsg_SMS_SendConf()
{
	msgType = Type_SMS_SendConf;
	bSucc = 0;
}

void SIPCCMsg_SMS_SendConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//bSucc
	memmove(&this->bSucc, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	PhoneNum = thebuf + theBufContent;
	theBufContent += PhoneNum.length()+1;
	
	m_PSucc = thebuf + theBufContent;
	theBufContent += m_PSucc.length()+1;

	m_strManagerID = thebuf + theBufContent;
	theBufContent += m_strManagerID.length()+1;

	m_sAgentID= thebuf + theBufContent;
	theBufContent += m_sAgentID.length()+1;

	m_sText= thebuf + theBufContent;
	theBufContent += m_sText.length()+1;
}

int SIPCCMsg_SMS_SendConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//bSucc
	memmove(thebuf+theBufContent, &this->bSucc, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, PhoneNum.c_str(), PhoneNum.length() + 1);
	theBufContent += PhoneNum.length() + 1;
	
	memcpy(thebuf+theBufContent, m_PSucc.c_str(), m_PSucc.length() + 1);
	theBufContent += m_PSucc.length() + 1;

	memcpy(thebuf+theBufContent, m_strManagerID.c_str(), m_strManagerID.length() + 1);
	theBufContent += m_strManagerID.length() + 1;

	memcpy(thebuf+theBufContent, m_sAgentID.c_str(), m_sAgentID.length() + 1);
	theBufContent += m_sAgentID.length() + 1;

	memcpy(thebuf+theBufContent, m_sText.c_str(), m_sText.length() + 1);
	theBufContent += m_sText.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_SendConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(char);			//bSucc
	memSize += PhoneNum.length()+1;		//PhoneNum
	memSize += m_PSucc.length()+1;		//m_PSucc
	memSize += m_strManagerID.length()+1;
	memSize += m_sAgentID.length()+1;
	memSize += m_sText.length()+1;
	
	return memSize;
}

///Type_SMS_QueryLinkmanList
SIPCCMsg_SMS_QueryLinkmanList::SIPCCMsg_SMS_QueryLinkmanList()
{
	msgType = Type_SMS_QueryLinkmanList;
}

void SIPCCMsg_SMS_QueryLinkmanList::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
	
}

int SIPCCMsg_SMS_QueryLinkmanList::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_QueryLinkmanList::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += AgentName.length()+1;	//AgentName
	
	return memSize;
}

///Type_SMS_QueryLinkmanListConf
SIPCCMsg_SMS_QueryLinkmanListConf::SIPCCMsg_SMS_QueryLinkmanListConf()
{
	msgType = Type_SMS_QueryLinkmanListConf;
}

void SIPCCMsg_SMS_QueryLinkmanListConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	ID = thebuf + theBufContent;
	theBufContent += ID.length()+1;
	
	LinkManName = thebuf + theBufContent;
	theBufContent += LinkManName.length()+1;
	
	PhoneNum = thebuf + theBufContent;
	theBufContent += PhoneNum.length()+1;
	
	Description = thebuf + theBufContent;
	theBufContent += Description.length()+1;
}

int SIPCCMsg_SMS_QueryLinkmanListConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, ID.c_str(), ID.length() + 1);
	theBufContent += ID.length() + 1;
	
	memcpy(thebuf+theBufContent, LinkManName.c_str(), LinkManName.length() + 1);
	theBufContent += LinkManName.length() + 1;
	
	memcpy(thebuf+theBufContent, PhoneNum.c_str(), PhoneNum.length() + 1);
	theBufContent += PhoneNum.length() + 1;
	
	memcpy(thebuf+theBufContent, Description.c_str(), Description.length() + 1);
	theBufContent += Description.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_QueryLinkmanListConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += ID.length()+1;			//ID
	memSize += LinkManName.length()+1;	//LinkManName
	memSize += PhoneNum.length()+1;		//PhoneNum
	memSize += Description.length()+1;	//Description
	
	return memSize;
}
// Type_SMS_OperServerLogin
SIPCCMsg_SMS_OperServerLogin::SIPCCMsg_SMS_OperServerLogin(){
	msgType = Type_SMS_OperServerLogin;
}
	
void SIPCCMsg_SMS_OperServerLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	corName = thebuf + theBufContent;
	theBufContent += corName.length()+1;
}

int SIPCCMsg_SMS_OperServerLogin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
		
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1);
	theBufContent += managerID.length() + 1;
	
	memcpy(thebuf+theBufContent, corName.c_str(), corName.length() + 1);
	theBufContent += corName.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_OperServerLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += managerID.length()+1;		//
	memSize += corName.length()+1;		//
	
	return memSize;
}
// Type_SMS_OperServerLoginConf,
SIPCCMsg_SMS_OperServerLoginConf::SIPCCMsg_SMS_OperServerLoginConf(){
	msgType = Type_SMS_OperServerLoginConf;
	bLoginSuccess=false;
}
	
void SIPCCMsg_SMS_OperServerLoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->bLoginSuccess, 	thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);
}

int SIPCCMsg_SMS_OperServerLoginConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->bLoginSuccess, sizeof(bool));
	theBufContent += sizeof(bool);
			
	return theBufContent;
}

int SIPCCMsg_SMS_OperServerLoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(bool);

	return memSize;
}
// Type_SMS_OperServerLogout,
SIPCCMsg_SMS_OperServerLogout::SIPCCMsg_SMS_OperServerLogout(){
	msgType = Type_SMS_OperServerLogout;
}
	
void SIPCCMsg_SMS_OperServerLogout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	corName = thebuf + theBufContent;
	theBufContent += corName.length()+1;
}

int SIPCCMsg_SMS_OperServerLogout::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
		
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1);
	theBufContent += managerID.length() + 1;
	
	memcpy(thebuf+theBufContent, corName.c_str(), corName.length() + 1);
	theBufContent += corName.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_SMS_OperServerLogout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += managerID.length()+1;		//
	memSize += corName.length()+1;		//
	
	return memSize;
}

// Type_SMS_OperServerLogoutConf,
SIPCCMsg_SMS_OperServerLogoutConf::SIPCCMsg_SMS_OperServerLogoutConf(){
	msgType = Type_SMS_OperServerLogoutConf;
	bLogoutSuccess=false;
}
	
void SIPCCMsg_SMS_OperServerLogoutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->bLogoutSuccess, 	thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);
}

int SIPCCMsg_SMS_OperServerLogoutConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->bLogoutSuccess, sizeof(bool));
	theBufContent += sizeof(bool);
			
	return theBufContent;
}

int SIPCCMsg_SMS_OperServerLogoutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(bool);

	return memSize;
}
// Type_SMS_Recved,
SIPCCMsg_SMS_Recved::SIPCCMsg_SMS_Recved(){
	msgType = Type_SMS_Recved;
}
	
void SIPCCMsg_SMS_Recved::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	m_strPhoneNum = thebuf + theBufContent;
	theBufContent += m_strPhoneNum.length()+1;

	m_strManagerID = thebuf + theBufContent;
	theBufContent += m_strManagerID.length()+1;
	
	m_sText = thebuf + theBufContent;
	theBufContent += m_sText.length()+1;

	m_sTime=thebuf + theBufContent;
	theBufContent += m_sTime.length()+1;
}

int SIPCCMsg_SMS_Recved::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, m_strPhoneNum.c_str(), m_strPhoneNum.length() + 1);
	theBufContent += m_strPhoneNum.length() + 1;
		
	memcpy(thebuf+theBufContent, m_strManagerID.c_str(), m_strManagerID.length() + 1);
	theBufContent += m_strManagerID.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sText.c_str(), m_sText.length() + 1);
	theBufContent += m_sText.length() + 1;

	memcpy(thebuf+theBufContent, m_sTime.c_str(), m_sTime.length() + 1);
	theBufContent += m_sTime.length() + 1;	
	
	return theBufContent;
}

int SIPCCMsg_SMS_Recved::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += m_strPhoneNum.length()+1;	
	memSize += m_strManagerID.length()+1;		//
	memSize += m_sText.length()+1;		//
	memSize += m_sTime.length()+1;
	
	return memSize;
}

// Type_SMS_RecvedConf,
SIPCCMsg_SMS_RecvedConf::SIPCCMsg_SMS_RecvedConf(){
	msgType = Type_SMS_RecvedConf;
	m_bSuccess=false;
}
	
void SIPCCMsg_SMS_RecvedConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->m_bSuccess, 	thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);
}

int SIPCCMsg_SMS_RecvedConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->m_bSuccess, sizeof(bool));
	theBufContent += sizeof(bool);
			
	return theBufContent;
}

int SIPCCMsg_SMS_RecvedConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(bool);

	return memSize;
}
///Class_SMS
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_Toll
SIPCCMsg_Toll::SIPCCMsg_Toll()
{
	msgClass = Class_Toll;
}

///Type_Toll_400TrunkConnected
SIPCCMsg_Toll_400TrunkConnected::SIPCCMsg_Toll_400TrunkConnected()
{
	msgType = Type_Toll_400TrunkConnected;
}

void SIPCCMsg_Toll_400TrunkConnected::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callerNo = thebuf + theBufContent;
	theBufContent += callerNo.length()+1;
	
	RealNo_400 = thebuf + theBufContent;
	theBufContent += RealNo_400.length()+1;
	
	trunkNo = thebuf + theBufContent;
	theBufContent += trunkNo.length()+1;
}

int SIPCCMsg_Toll_400TrunkConnected::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callerNo.c_str(), callerNo.length()+1);
	theBufContent += callerNo.length()+1;
	
	memcpy(thebuf+theBufContent, RealNo_400.c_str(), RealNo_400.length()+1);
	theBufContent += RealNo_400.length()+1;
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_400TrunkConnected::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;	//AgentName
	memSize += curTime.length()+1;	//AgentName
	memSize += callerNo.length()+1;	//AgentName
	memSize += RealNo_400.length()+1;	//AgentName
	memSize += trunkNo.length()+1;	//AgentName
	
	return memSize;
}

///Type_Toll_400TrunkDisconnected
SIPCCMsg_Toll_400TrunkDisconnected::SIPCCMsg_Toll_400TrunkDisconnected()
{
	msgType = Type_Toll_400TrunkDisconnected;
}

void SIPCCMsg_Toll_400TrunkDisconnected::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callerNo = thebuf + theBufContent;
	theBufContent += callerNo.length()+1;
	
	RealNo_400 = thebuf + theBufContent;
	theBufContent += RealNo_400.length()+1;
	
	trunkNo = thebuf + theBufContent;
	theBufContent += trunkNo.length()+1;
}

int SIPCCMsg_Toll_400TrunkDisconnected::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callerNo.c_str(), callerNo.length()+1);
	theBufContent += callerNo.length()+1;
	
	memcpy(thebuf+theBufContent, RealNo_400.c_str(), RealNo_400.length()+1);
	theBufContent += RealNo_400.length()+1;
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_400TrunkDisconnected::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;	//AgentName
	memSize += curTime.length()+1;	//AgentName
	memSize += callerNo.length()+1;	//AgentName
	memSize += RealNo_400.length()+1;	//AgentName
	memSize += trunkNo.length()+1;	//AgentName
	
	return memSize;
}

///Type_Toll_400P2PTalkBegin
SIPCCMsg_Toll_400P2PTalkBegin::SIPCCMsg_Toll_400P2PTalkBegin()
{
	msgType = Type_Toll_400P2PTalkBegin;
}

void SIPCCMsg_Toll_400P2PTalkBegin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callerNo = thebuf + theBufContent;
	theBufContent += callerNo.length()+1;
	
	RealNo_400 = thebuf + theBufContent;
	theBufContent += RealNo_400.length()+1;
	
	calledNo = thebuf + theBufContent;
	theBufContent += calledNo.length()+1;
	
	callerTrunkNo = thebuf + theBufContent;
	theBufContent += callerTrunkNo.length()+1;
	
	calledTrunkNo = thebuf + theBufContent;
	theBufContent += calledTrunkNo.length()+1;
}

int SIPCCMsg_Toll_400P2PTalkBegin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callerNo.c_str(), callerNo.length()+1);
	theBufContent += callerNo.length()+1;
	
	memcpy(thebuf+theBufContent, RealNo_400.c_str(), RealNo_400.length()+1);
	theBufContent += RealNo_400.length()+1;
	
	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;
	
	memcpy(thebuf+theBufContent, callerTrunkNo.c_str(), callerTrunkNo.length()+1);
	theBufContent += callerTrunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, calledTrunkNo.c_str(), calledTrunkNo.length()+1);
	theBufContent += calledTrunkNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_400P2PTalkBegin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;	//AgentName
	memSize += curTime.length()+1;	//AgentName
	memSize += callerNo.length()+1;	//AgentName
	memSize += RealNo_400.length()+1;	//AgentName
	memSize += calledNo.length()+1;	//AgentName
	memSize += callerTrunkNo.length()+1;	//AgentName
	memSize += calledTrunkNo.length()+1;	//AgentName
	
	return memSize;
}

///Type_Toll_400P2PTalkEnd
SIPCCMsg_Toll_400P2PTalkEnd::SIPCCMsg_Toll_400P2PTalkEnd()
{
	msgType = Type_Toll_400P2PTalkEnd;
}

void SIPCCMsg_Toll_400P2PTalkEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callerNo = thebuf + theBufContent;
	theBufContent += callerNo.length()+1;
	
	RealNo_400 = thebuf + theBufContent;
	theBufContent += RealNo_400.length()+1;
	
	calledNo = thebuf + theBufContent;
	theBufContent += calledNo.length()+1;
	
	callerTrunkNo = thebuf + theBufContent;
	theBufContent += callerTrunkNo.length()+1;
	
	calledTrunkNo = thebuf + theBufContent;
	theBufContent += calledTrunkNo.length()+1;
}

int SIPCCMsg_Toll_400P2PTalkEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callerNo.c_str(), callerNo.length()+1);
	theBufContent += callerNo.length()+1;
	
	memcpy(thebuf+theBufContent, RealNo_400.c_str(), RealNo_400.length()+1);
	theBufContent += RealNo_400.length()+1;
	
	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;
	
	memcpy(thebuf+theBufContent, callerTrunkNo.c_str(), callerTrunkNo.length()+1);
	theBufContent += callerTrunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, calledTrunkNo.c_str(), calledTrunkNo.length()+1);
	theBufContent += calledTrunkNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_400P2PTalkEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	memSize += invokeID.length()+1;			//AgentName
	memSize += curTime.length()+1;			//AgentName
	memSize += callerNo.length()+1;			//AgentName
	memSize += RealNo_400.length()+1;		//AgentName
	memSize += calledNo.length()+1;			//AgentName
	memSize += callerTrunkNo.length()+1;	//AgentName
	memSize += calledTrunkNo.length()+1;	//AgentName
	
	return memSize;
}

///Type_Toll_TollInfo
SIPCCMsg_Toll_TollInfo::SIPCCMsg_Toll_TollInfo()
{
	msgType = Type_Toll_TollInfo;

	sTimeStamp = "";
}

void SIPCCMsg_Toll_TollInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove( &InfoType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;
	
	BeginTime = thebuf + theBufContent;
	theBufContent += BeginTime.length()+1;
	
	EndTime = thebuf + theBufContent;
	theBufContent += EndTime.length()+1;
	
	Content1 = thebuf + theBufContent;
	theBufContent += Content1.length()+1;
	
	Content2 = thebuf + theBufContent;
	theBufContent += Content2.length()+1;

	if ( theBufContent >= msgsize )
		return;

	sTimeStamp = thebuf + theBufContent;
	theBufContent += sTimeStamp.length()+1;
}

int SIPCCMsg_Toll_TollInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &InfoType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, BeginTime.c_str(), BeginTime.length()+1);
	theBufContent += BeginTime.length()+1;
	
	memcpy(thebuf+theBufContent, EndTime.c_str(), EndTime.length()+1);
	theBufContent += EndTime.length()+1;
	
	memcpy(thebuf+theBufContent, Content1.c_str(), Content1.length()+1);
	theBufContent += Content1.length()+1;
	
	memcpy(thebuf+theBufContent, Content2.c_str(), Content2.length()+1);
	theBufContent += Content2.length()+1;

	memcpy(thebuf+theBufContent, sTimeStamp.c_str(), sTimeStamp.length()+1);
	theBufContent += sTimeStamp.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_TollInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);
	memSize += InvokeId.length() + 1;	//AgentName
	memSize += BeginTime.length() + 1;	//AgentName
	memSize += EndTime.length() + 1;	//AgentName
	memSize += Content1.length() + 1;	//AgentName
	memSize += Content2.length() + 1;

	memSize += sTimeStamp.length() + 1;
	
	return memSize;
}

///Type_Toll_TollInfoAck
SIPCCMsg_Toll_TollInfoAck::SIPCCMsg_Toll_TollInfoAck()
{
	msgType = Type_Toll_TollInfoAck;

	sTimeStamp = "";
}

void SIPCCMsg_Toll_TollInfoAck::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove( &InfoType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	if ( theBufContent >= msgsize )
		return;

	sTimeStamp = thebuf + theBufContent;
	theBufContent += sTimeStamp.length()+1;
}

int SIPCCMsg_Toll_TollInfoAck::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &InfoType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, sTimeStamp.c_str(), sTimeStamp.length()+1);
	theBufContent += sTimeStamp.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_TollInfoAck::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);
	memSize += InvokeId.length() + 1;	//AgentName

	memSize += sTimeStamp.length() + 1;
	
	return memSize;
}

///Type_Toll_UniversalInfo
SIPCCMsg_Toll_UniversalInfo::SIPCCMsg_Toll_UniversalInfo()
{
	msgType = Type_Toll_UniversalInfo;
	m_iTollType = -1;
	m_iTollOperType = -1;
}

void SIPCCMsg_Toll_UniversalInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	m_sInvokeID = thebuf + theBufContent;
	theBufContent += m_sInvokeID.length() + 1;
	
	m_sCurTime = thebuf + theBufContent;
	theBufContent += m_sCurTime.length() + 1;
	
	memmove( &m_iCallDirection, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	m_sAgentID = thebuf + theBufContent;
	theBufContent += m_sAgentID.length() + 1;
	
	m_sCorpName = thebuf + theBufContent;
	theBufContent += m_sCorpName.length() + 1;
	
	m_sFirstNo = thebuf + theBufContent;
	theBufContent += m_sFirstNo.length() + 1;
	
	m_sFirstTrunkDn = thebuf + theBufContent;
	theBufContent += m_sFirstTrunkDn.length() + 1;
	
	m_sSecondNo = thebuf + theBufContent;
	theBufContent += m_sSecondNo.length() + 1;
	
	m_sSecondTrunkDn = thebuf + theBufContent;
	theBufContent += m_sSecondTrunkDn.length() + 1;
	
	m_sWanIp = thebuf + theBufContent;
	theBufContent += m_sWanIp.length() + 1;
	
	m_sLanIp = thebuf + theBufContent;
	theBufContent += m_sLanIp.length() + 1;
	
	m_sPresideTrunkDn = thebuf + theBufContent;
	theBufContent += m_sPresideTrunkDn.length() + 1;
	
	m_sPresidePhoneNo = thebuf + theBufContent;
	theBufContent += m_sPresidePhoneNo.length() + 1;
	
	memmove( &m_iTollType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove( &m_iTollOperType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Toll_UniversalInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, m_sInvokeID.c_str(), m_sInvokeID.length() + 1);
	theBufContent += m_sInvokeID.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sCurTime.c_str(), m_sCurTime.length() + 1);
	theBufContent += m_sCurTime.length() + 1;
	
	memmove(thebuf+theBufContent, &m_iCallDirection, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, m_sAgentID.c_str(), m_sAgentID.length() + 1);
	theBufContent += m_sAgentID.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sCorpName.c_str(), m_sCorpName.length() + 1);
	theBufContent += m_sCorpName.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sFirstNo.c_str(), m_sFirstNo.length() + 1);
	theBufContent += m_sFirstNo.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sFirstTrunkDn.c_str(), m_sFirstTrunkDn.length() + 1);
	theBufContent += m_sFirstTrunkDn.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sSecondNo.c_str(), m_sSecondNo.length() + 1);
	theBufContent += m_sSecondNo.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sSecondTrunkDn.c_str(), m_sSecondTrunkDn.length() + 1);
	theBufContent += m_sSecondTrunkDn.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sWanIp.c_str(), m_sWanIp.length() + 1);
	theBufContent += m_sWanIp.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sLanIp.c_str(), m_sLanIp.length() + 1);
	theBufContent += m_sLanIp.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sPresideTrunkDn.c_str(), m_sPresideTrunkDn.length() + 1);
	theBufContent += m_sPresideTrunkDn.length() + 1;
	
	memcpy(thebuf+theBufContent, m_sPresidePhoneNo.c_str(), m_sPresidePhoneNo.length() + 1);
	theBufContent += m_sPresidePhoneNo.length() + 1;
	
	memmove(thebuf+theBufContent, &m_iTollType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &m_iTollOperType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Toll_UniversalInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += m_sInvokeID.length() + 1;
	memSize += m_sCurTime.length() + 1;
	memSize += sizeof(int);
	memSize += m_sAgentID.length() + 1;
	memSize += m_sCorpName.length() + 1;
	memSize += m_sFirstNo.length() + 1;
	memSize += m_sFirstTrunkDn.length() + 1;
	memSize += m_sSecondNo.length() + 1;
	memSize += m_sSecondTrunkDn.length() + 1;
	memSize += m_sWanIp.length() + 1;
	memSize += m_sLanIp.length() + 1;
	memSize += m_sPresideTrunkDn.length() + 1;
	memSize += m_sPresidePhoneNo.length() + 1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	return memSize;
}

//Type_Toll_TollTransation

SIPCCMsg_Toll_TollTransation::SIPCCMsg_Toll_TollTransation()
{
	msgType = Type_Toll_TollTransation;
}

void SIPCCMsg_Toll_TollTransation::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	transation = thebuf + theBufContent;
	theBufContent += transation.length() + 1;
}

int SIPCCMsg_Toll_TollTransation::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, transation.c_str(), transation.length() + 1);
	theBufContent += transation.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_TollTransation::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += transation.length() + 1;
	
	return memSize;
}

///Class_Toll
/////////////////////////////////////////////////////////////////////////////////

/////////////////////////////////////////////////////////////////////////////////
///Class_PhoneSearch
SIPCCMsg_PhoneSearch::SIPCCMsg_PhoneSearch()
{
	msgClass = Class_PhoneSearch;
}

///Type_PhoneSearch_IncomingCall
SIPCCMsg_PhoneSearch_IncomingCall::SIPCCMsg_PhoneSearch_IncomingCall()
{
	msgType = Type_PhoneSearch_IncomingCall;
}

void SIPCCMsg_PhoneSearch_IncomingCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	trunkNo = thebuf + theBufContent;
	theBufContent += trunkNo.length()+1;
	
	callerNo = thebuf + theBufContent;
	theBufContent += callerNo.length()+1;
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	calledNo = thebuf + theBufContent;
	theBufContent += calledNo.length()+1;
}

int SIPCCMsg_PhoneSearch_IncomingCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, callerNo.c_str(), callerNo.length()+1);
	theBufContent += callerNo.length()+1;
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_IncomingCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += trunkNo.length()+1;	
	memSize += callerNo.length()+1;
	memSize += invokeID.length()+1;	
	memSize += calledNo.length()+1;	
	
	return memSize;
}

///Type_PhoneSearch_IncomingCallConf
SIPCCMsg_PhoneSearch_IncomingCallConf::SIPCCMsg_PhoneSearch_IncomingCallConf()
{
	msgType = Type_PhoneSearch_IncomingCallConf;
	bIsInnerCall = 0;
}

void SIPCCMsg_PhoneSearch_IncomingCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_IncomingCallConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	trunkNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+trunkNo.length()+1, msgsize, strMsgName, "trunkNo", ip, port)) ) {return;}
	if ( !(VerifyData(trunkNo.length(), TRUNKNO_LEN, strMsgName, "trunkNo", ip, port)) ) {return;}
	theBufContent += trunkNo.length()+1;
	
	managerID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerID.length()+1, msgsize, strMsgName, "managerID", ip, port)) ) {return;}
	if ( !(VerifyData(managerID.length(), MANAGERID_LEN, strMsgName, "managerID", ip, port)) ) {return;}
	theBufContent += managerID.length()+1;
	
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsgName, "bIsInnerCall", ip, port)) ) {return;}
	memmove(&bIsInnerCall, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	invokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length()+1;
	
}

int SIPCCMsg_PhoneSearch_IncomingCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, &bIsInnerCall, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_IncomingCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += trunkNo.length()+1;		
	memSize += managerID.length()+1;
	memSize += sizeof(char);			
	memSize += invokeID.length()+1;
	
	return memSize;
}

///Type_PhoneSearch_ExtNoInfo
SIPCCMsg_PhoneSearch_ExtNoInfo::SIPCCMsg_PhoneSearch_ExtNoInfo()
{
	msgType = Type_PhoneSearch_ExtNoInfo;
}

void SIPCCMsg_PhoneSearch_ExtNoInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_ExtNoInfo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length()+1;
	
	managerID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerID.length()+1, msgsize, strMsgName, "managerID", ip, port)) ) {return;}
	if ( !(VerifyData(managerID.length(), MANAGERID_LEN, strMsgName, "managerID", ip, port)) ) {return;}
	theBufContent += managerID.length()+1;
	
	extNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extNo.length()+1, msgsize, strMsgName, "extNo", ip, port)) ) {return;}
	if ( !(VerifyData(extNo.length(), PHONENO_LEN, strMsgName, "extNo", ip, port)) ) {return;}
	theBufContent += extNo.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	manageConnectNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+manageConnectNo.length()+1, msgsize, strMsgName, "manageConnectNo", ip, port)) ) {return;}
	if ( !(VerifyData(manageConnectNo.length(), MANAGECONNECTNO_LEN, strMsgName, "manageConnectNo", ip, port)) ) {return;}
	theBufContent += manageConnectNo.length()+1;
}

int SIPCCMsg_PhoneSearch_ExtNoInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, extNo.c_str(), extNo.length()+1);
	theBufContent += extNo.length()+1;
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	memcpy(thebuf+theBufContent, manageConnectNo.c_str(), manageConnectNo.length()+1);
	theBufContent += manageConnectNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_ExtNoInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;	//invokeID
	memSize += managerID.length()+1;	//managerID
	memSize += extNo.length()+1;	//extNo
	memSize += corpName.length()+1;	//AgentName
	memSize += manageConnectNo.length()+1;	//AgentName
	
	return memSize;
}

///Type_PhoneSearch_ExtNoInfoConf
SIPCCMsg_PhoneSearch_ExtNoInfoConf::SIPCCMsg_PhoneSearch_ExtNoInfoConf()
{
	msgType = Type_PhoneSearch_ExtNoInfoConf;
}

void SIPCCMsg_PhoneSearch_ExtNoInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	realNoList = thebuf + theBufContent;
	theBufContent += realNoList.length()+1;
	
	if (theBufContent >= msgsize)
	{
		return;
	}
	
	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;
}

int SIPCCMsg_PhoneSearch_ExtNoInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, realNoList.c_str(), realNoList.length()+1);
	theBufContent += realNoList.length()+1;
	
	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length()+1);
	theBufContent += agentId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_ExtNoInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;	//AgentName
	memSize += managerID.length()+1;	//AgentName
	memSize += realNoList.length()+1;	//AgentName
	memSize += agentId.length()+1;	//AgentName
	
	return memSize;
}

///Type_PhoneSearch_400CallIn
SIPCCMsg_PhoneSearch_400CallIn::SIPCCMsg_PhoneSearch_400CallIn()
{
	msgType = Type_PhoneSearch_400CallIn;
}

void SIPCCMsg_PhoneSearch_400CallIn::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	callBackPhoneNo = thebuf + theBufContent;
	theBufContent += callBackPhoneNo.length()+1;
}

int SIPCCMsg_PhoneSearch_400CallIn::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, callBackPhoneNo.c_str(), callBackPhoneNo.length()+1);
	theBufContent += callBackPhoneNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_400CallIn::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += managerID.length()+1;	//AgentName
	memSize += callBackPhoneNo.length()+1;	//AgentName
	
	return memSize;
}


///Type_PhoneSearch_QueryAgentInfoConf
SIPCCMsg_PhoneSearch_QueryAgentInfoConf::SIPCCMsg_PhoneSearch_QueryAgentInfoConf()
{
	msgType = Type_PhoneSearch_QueryAgentInfoConf;
}

void SIPCCMsg_PhoneSearch_QueryAgentInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
	
	corpDepartName = thebuf + theBufContent;
	theBufContent += corpDepartName.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryAgentInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, corpDepartName.c_str(), corpDepartName.length()+1);
	theBufContent += corpDepartName.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryAgentInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;			//invokeID
	memSize += agentID.length()+1;			//agentID
	memSize += corpDepartName.length()+1;	//corpDepartName
	
	return memSize;
}

///Type_PhoneSearch_QueryBlackList
SIPCCMsg_PhoneSearch_QueryBlackList::SIPCCMsg_PhoneSearch_QueryBlackList()
{
	msgType = Type_PhoneSearch_QueryBlackList;
	agentPhoneNo = "";
	customerPhoneNo = "";
	extNo = "";
	invokeID = "";
	managerCalledNo = "";
	managerID = "";
}

void SIPCCMsg_PhoneSearch_QueryBlackList::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_QueryBlackList";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsgName, "invokeID", ip, port)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsgName, "invokeID", ip, port)) ) {return;}
	theBufContent += invokeID.length()+1;
	
	agentPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentPhoneNo.length()+1, msgsize, strMsgName, "agentPhoneNo", ip, port)) ) {return;}
	if ( !(VerifyData(agentPhoneNo.length(), AGENTPHONENO_LEN, strMsgName, "agentPhoneNo", ip, port)) ) {return;}
	theBufContent += agentPhoneNo.length()+1;
	
	extNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extNo.length()+1, msgsize, strMsgName, "extNo", ip, port)) ) {return;}
	if ( !(VerifyData(extNo.length(), PHONENO_LEN, strMsgName, "extNo", ip, port)) ) {return;}
	theBufContent += extNo.length()+1;
	
	customerPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+customerPhoneNo.length()+1, msgsize, strMsgName, "customerPhoneNo", ip, port)) ) {return;}
	if ( !(VerifyData(customerPhoneNo.length(), PHONENO_LEN, strMsgName, "customerPhoneNo", ip, port)) ) {return;}
	theBufContent += customerPhoneNo.length()+1;
	
	managerID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerID.length()+1, msgsize, strMsgName, "managerID", ip, port)) ) {return;}
	if ( !(VerifyData(managerID.length(), MANAGERID_LEN, strMsgName, "managerID", ip, port)) ) {return;}
	theBufContent += managerID.length()+1;
	
	managerCalledNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerCalledNo.length()+1, msgsize, strMsgName, "managerCalledNo", ip, port)) ) {return;}
	if ( !(VerifyData(managerCalledNo.length(), PHONENO_LEN, strMsgName, "managerCalledNo", ip, port)) ) {return;}
	theBufContent += managerCalledNo.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryBlackList::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, agentPhoneNo.c_str(), agentPhoneNo.length()+1);
	theBufContent += agentPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, extNo.c_str(), extNo.length()+1);
	theBufContent += extNo.length()+1;
	
	memcpy(thebuf+theBufContent, customerPhoneNo.c_str(), customerPhoneNo.length()+1);
	theBufContent += customerPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, managerCalledNo.c_str(), managerCalledNo.length()+1);
	theBufContent += managerCalledNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryBlackList::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;			//invokeID
	memSize += agentPhoneNo.length()+1;		//agentPhoneNo
	memSize += extNo.length()+1;			//extNo
	memSize += customerPhoneNo.length()+1;	//customerPhoneNo
	memSize += managerID.length()+1;		//managerID
	memSize += managerCalledNo.length()+1;		//managerID
	
	return memSize;
}


///Type_PhoneSearch_QueryBlackListConf
SIPCCMsg_PhoneSearch_QueryBlackListConf::SIPCCMsg_PhoneSearch_QueryBlackListConf()
{
	msgType = Type_PhoneSearch_QueryBlackListConf;
}

void SIPCCMsg_PhoneSearch_QueryBlackListConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	memmove(&this->bBlacklist, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
}

int SIPCCMsg_PhoneSearch_QueryBlackListConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memmove(thebuf+theBufContent, &this->bBlacklist, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryBlackListConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;		//invokeID
	memSize += sizeof(char);			//blacklistNo
	
	return memSize;
}

///Type_PhoneSearch_GetWaitingMusic
SIPCCMsg_PhoneSearch_GetWaitingMusic::SIPCCMsg_PhoneSearch_GetWaitingMusic()
{
	msgType = Type_PhoneSearch_GetWaitingMusic;
	invokeId = "";
	callee = "";
	deptname = "";
}

void SIPCCMsg_PhoneSearch_GetWaitingMusic::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_GetWaitingMusic";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsgName, "invokeId", ip, port)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsgName, "invokeId", ip, port)) ) {return;}
	theBufContent += invokeId.length()+1;

	callee = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callee.length()+1, msgsize, strMsgName, "callee", ip, port)) ) {return;}
	if ( !(VerifyData(callee.length(), PHONENO_LEN, strMsgName, "callee", ip, port)) ) {return;}
	theBufContent += callee.length()+1;

	deptname = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptname.length()+1, msgsize, strMsgName, "deptname", ip, port)) ) {return;}
	if ( !(VerifyData(deptname.length(), DEPTID_LEN, strMsgName, "deptname", ip, port)) ) {return;}
	theBufContent += deptname.length()+1;

}

int SIPCCMsg_PhoneSearch_GetWaitingMusic::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	memcpy(thebuf+theBufContent, callee.c_str(), callee.length()+1);
	theBufContent += callee.length()+1;

	memcpy(thebuf+theBufContent, deptname.c_str(), deptname.length()+1);
	theBufContent += deptname.length()+1;

	return theBufContent;
}

int SIPCCMsg_PhoneSearch_GetWaitingMusic::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeId.length()+1;		//invokeId
	memSize += callee.length()+1;		//callee
	memSize += deptname.length()+1;		//deptname

	return memSize;
}


///Type_PhoneSearch_GetWaitingMusicConf
SIPCCMsg_PhoneSearch_GetWaitingMusicConf::SIPCCMsg_PhoneSearch_GetWaitingMusicConf()
{
	msgType = Type_PhoneSearch_GetWaitingMusicConf;
}

void SIPCCMsg_PhoneSearch_GetWaitingMusicConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;

	musicPath = thebuf + theBufContent;
	theBufContent += musicPath.length()+1;

}

int SIPCCMsg_PhoneSearch_GetWaitingMusicConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	memcpy(thebuf+theBufContent, musicPath.c_str(), musicPath.length()+1);
	theBufContent += musicPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_PhoneSearch_GetWaitingMusicConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeId.length()+1;		//invokeId
	memSize += musicPath.length()+1;	//musicPath

	return memSize;
}
///Class_PhoneSearch
//////////////////////////////////////////////////////////////////////////
//////////////////////////////////////////////////////////////////////////
///Type_Toll_400CBPreTalkBegin
SIPCCMsg_Toll_400CBPreTalkBegin::SIPCCMsg_Toll_400CBPreTalkBegin()
{
	msgType = Type_Toll_400CBPreTalkBegin;
}

int SIPCCMsg_Toll_400CBPreTalkBegin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callbackNo.c_str(), callbackNo.length()+1);
	theBufContent += callbackNo.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_Toll_400CBPreTalkBegin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callbackNo = thebuf + theBufContent;
	theBufContent += callbackNo.length()+1;
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	trunkNo = thebuf + theBufContent;
	theBufContent += trunkNo.length()+1;
}

int SIPCCMsg_Toll_400CBPreTalkBegin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;		//invokeID
	memSize += curTime.length()+1;		//curTime
	memSize += callbackNo.length()+1;	//callbackNo
	memSize += managerID.length()+1;	//managerID
	memSize += trunkNo.length()+1;		//trunkNo
	
	return memSize;
}

///Type_Toll_400CBPreTalkEnd
SIPCCMsg_Toll_400CBPreTalkEnd::SIPCCMsg_Toll_400CBPreTalkEnd()
{
	msgType = Type_Toll_400CBPreTalkEnd;
}

int SIPCCMsg_Toll_400CBPreTalkEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callbackNo.c_str(), callbackNo.length()+1);
	theBufContent += callbackNo.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_Toll_400CBPreTalkEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callbackNo = thebuf + theBufContent;
	theBufContent += callbackNo.length()+1;
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	trunkNo = thebuf + theBufContent;
	theBufContent += trunkNo.length()+1;
}

int SIPCCMsg_Toll_400CBPreTalkEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;		//invokeID
	memSize += curTime.length()+1;		//curTime
	memSize += callbackNo.length()+1;	//callbackNo
	memSize += managerID.length()+1;	//managerID
	memSize += trunkNo.length()+1;		//trunkNo
	
	return memSize;
}


///Type_Toll_400CBTransTalkBegin
SIPCCMsg_Toll_400CBTransTalkBegin::SIPCCMsg_Toll_400CBTransTalkBegin()
{
	msgType = Type_Toll_400CBTransTalkBegin;
}

int SIPCCMsg_Toll_400CBTransTalkBegin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callbackNo.c_str(), callbackNo.length()+1);
	theBufContent += callbackNo.length()+1;
	
	memcpy(thebuf+theBufContent, transNo.c_str(), transNo.length()+1);
	theBufContent += transNo.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_Toll_400CBTransTalkBegin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callbackNo = thebuf + theBufContent;
	theBufContent += callbackNo.length()+1;
	
	transNo = thebuf + theBufContent;
	theBufContent += transNo.length()+1;
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	trunkNo = thebuf + theBufContent;
	theBufContent += trunkNo.length()+1;
}

int SIPCCMsg_Toll_400CBTransTalkBegin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;		//invokeID
	memSize += curTime.length()+1;		//curTime
	memSize += callbackNo.length()+1;	//callbackNo
	memSize += transNo.length()+1;		//transNo
	memSize += managerID.length()+1;	//managerID
	memSize += trunkNo.length()+1;		//trunkNo
	
	return memSize;
}

//Type_Toll_400CBTransTalkEnd
SIPCCMsg_Toll_400CBTransTalkEnd::SIPCCMsg_Toll_400CBTransTalkEnd()
{
	msgType = Type_Toll_400CBTransTalkEnd;
}

int SIPCCMsg_Toll_400CBTransTalkEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, callbackNo.c_str(), callbackNo.length()+1);
	theBufContent += callbackNo.length()+1;
	
	memcpy(thebuf+theBufContent, transNo.c_str(), transNo.length()+1);
	theBufContent += transNo.length()+1;
	
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length()+1);
	theBufContent += managerID.length()+1;
	
	memcpy(thebuf+theBufContent, trunkNo.c_str(), trunkNo.length()+1);
	theBufContent += trunkNo.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_Toll_400CBTransTalkEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	callbackNo = thebuf + theBufContent;
	theBufContent += callbackNo.length()+1;
	
	transNo = thebuf + theBufContent;
	theBufContent += transNo.length()+1;
	
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;
	
	trunkNo = thebuf + theBufContent;
	theBufContent += trunkNo.length()+1;
}

int SIPCCMsg_Toll_400CBTransTalkEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;		//invokeID
	memSize += curTime.length()+1;		//curTime
	memSize += callbackNo.length()+1;	//callbackNo
	memSize += transNo.length()+1;	//callbackNo
	memSize += managerID.length()+1;	//managerID
	memSize += trunkNo.length()+1;		//trunkNo
	
	return memSize;
}

///Type_Toll_AgentTransP2PTalkBegin
SIPCCMsg_Toll_AgentTransP2PTalkBegin::SIPCCMsg_Toll_AgentTransP2PTalkBegin()
{
	msgType = Type_Toll_AgentTransP2PTalkBegin;
}

int SIPCCMsg_Toll_AgentTransP2PTalkBegin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, preNo.c_str(), preNo.length()+1);
	theBufContent += preNo.length()+1;
	
	memcpy(thebuf+theBufContent, transNo.c_str(), transNo.length()+1);
	theBufContent += transNo.length()+1;
	
	memcpy(thebuf+theBufContent, preTrunkNo.c_str(), preTrunkNo.length()+1);
	theBufContent += preTrunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, transTrunkNo.c_str(), transTrunkNo.length()+1);
	theBufContent += transTrunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, chargeMode.c_str(), chargeMode.length()+1);
	theBufContent += chargeMode.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_Toll_AgentTransP2PTalkBegin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	preNo = thebuf + theBufContent;
	theBufContent += preNo.length()+1;
	
	transNo = thebuf + theBufContent;
	theBufContent += transNo.length()+1;
	
	preTrunkNo = thebuf + theBufContent;
	theBufContent += preTrunkNo.length()+1;
	
	transTrunkNo = thebuf + theBufContent;
	theBufContent += transTrunkNo.length()+1;
	
	chargeMode = thebuf + theBufContent;
	theBufContent += chargeMode.length()+1;
}

int SIPCCMsg_Toll_AgentTransP2PTalkBegin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;		//invokeID
	memSize += agentID.length()+1;		//agentID
	memSize += curTime.length()+1;		//curTime
	memSize += preNo.length()+1;		//callbackNo
	memSize += transNo.length()+1;		//transNo
	memSize += preTrunkNo.length()+1;	//managerID
	memSize += transTrunkNo.length()+1;	//trunkNo
	memSize += chargeMode.length()+1;	//trunkNo
	
	return memSize;
}

///Type_Toll_AgentTransP2PTalkEnd
SIPCCMsg_Toll_AgentTransP2PTalkEnd::SIPCCMsg_Toll_AgentTransP2PTalkEnd()
{
	msgType = Type_Toll_AgentTransP2PTalkEnd;
}

int SIPCCMsg_Toll_AgentTransP2PTalkEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;
	
	memcpy(thebuf+theBufContent, preNo.c_str(), preNo.length()+1);
	theBufContent += preNo.length()+1;
	
	memcpy(thebuf+theBufContent, transNo.c_str(), transNo.length()+1);
	theBufContent += transNo.length()+1;
	
	memcpy(thebuf+theBufContent, preTrunkNo.c_str(), preTrunkNo.length()+1);
	theBufContent += preTrunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, transTrunkNo.c_str(), transTrunkNo.length()+1);
	theBufContent += transTrunkNo.length()+1;
	
	memcpy(thebuf+theBufContent, chargeMode.c_str(), chargeMode.length()+1);
	theBufContent += chargeMode.length()+1;
	
	return theBufContent;
}

void SIPCCMsg_Toll_AgentTransP2PTalkEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
	
	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
	
	preNo = thebuf + theBufContent;
	theBufContent += preNo.length()+1;
	
	transNo = thebuf + theBufContent;
	theBufContent += transNo.length()+1;
	
	preTrunkNo = thebuf + theBufContent;
	theBufContent += preTrunkNo.length()+1;
	
	transTrunkNo = thebuf + theBufContent;
	theBufContent += transTrunkNo.length()+1;
	
	chargeMode = thebuf + theBufContent;
	theBufContent += chargeMode.length()+1;
}

int SIPCCMsg_Toll_AgentTransP2PTalkEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += invokeID.length()+1;		//invokeID
	memSize += agentID.length()+1;		//agentID
	memSize += curTime.length()+1;		//curTime
	memSize += preNo.length()+1;		//callbackNo
	memSize += transNo.length()+1;		//transNo
	memSize += preTrunkNo.length()+1;	//managerID
	memSize += transTrunkNo.length()+1;	//trunkNo
	memSize += chargeMode.length()+1;	//trunkNo
	
	return memSize;
}

///Class_PhoneSearch
/////////////////////////////////////////////////////////////////////////////////

///Type_UState_RingAgentExt
SIPCCMsg_UState_RingAgentExt::SIPCCMsg_UState_RingAgentExt()
{
	msgType = Type_UState_RingAgentExt;
	agentID = NULL;
	agentIDLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	callID = NULL;
	callIDLen = 0;
	corporationName = NULL;
	corporationNameLen = 0;
	callerNoForSend = "";
	callerPartyType = CallParty_Agent;
	IsOutCall = 0;
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_RingAgentExt::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_RingAgentExt";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	
	//uuiDataLen
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	
	if(theBufContent == msgsize)
		return;
	
	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1;
	
	if(theBufContent == msgsize)
		return;
	
	//callerPartyType
	memmove(&callerPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent == msgsize)
		return;
	
	ipPhoneNo_User = thebuf+theBufContent;
	theBufContent += ( ipPhoneNo_User.length() + 1 );

	if(theBufContent == msgsize)
		return;

	// IsOutCall
	memmove(&this->IsOutCall, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;
}

int SIPCCMsg_UState_RingAgentExt::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	//callerPartyType
	memmove(thebuf+theBufContent, &this->callerPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, ipPhoneNo_User.c_str(), ipPhoneNo_User.length() + 1 );
	theBufContent += ( ipPhoneNo_User.length() + 1 );
	
	// IsOutCall
	memmove(thebuf+theBufContent, &this->IsOutCall, sizeof(char));
	theBufContent += sizeof(char);

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_RingAgentExt::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//agentIDLen
	memSize += this->agentIDLen;			//agentID
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += sizeof(int);					//callerPartyType
	
	memSize += ipPhoneNo_User.length() + 1;

	memSize += sizeof(char);

	memSize += managerId.length()+1;		//managerId

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	
	return memSize;
}

void SIPCCMsg_UState_RingAgentExt::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_UState_RingAgentExt::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_UState_RingAgentExt::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_UState_RingAgentExt::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_UState_RingAgentExt2
SIPCCMsg_UState_RingAgentExt2::SIPCCMsg_UState_RingAgentExt2()
{
	msgType = Type_UState_RingAgentExt2;
	agentID = NULL;
	agentIDLen = 0;
	uuiData = NULL;
	uuiDataLen = 0;
	callID = NULL;
	callIDLen = 0;
	corporationName = NULL;
	corporationNameLen = 0;
	callerNoForSend = "";
	callerPartyType = CallParty_Agent;
	invokeID = "";
	usableTime = 0;
	userName = "";
	
	lanIp = 0;
	wanIp = 0;
	
	outDialType = OutDialType_Normal;

	callTransID = "";
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_RingAgentExt2::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_RingAgentExt2";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//agentIDLen
	memmove(&this->agentIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memmove(agentID, thebuf+theBufContent, agentIDLen);
	theBufContent += agentIDLen;
	
	//uuiDataLen
	memmove(&this->uuiDataLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memmove(uuiData, thebuf+theBufContent, uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(&this->callIDLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memmove(callID, thebuf+theBufContent, callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(&this->corporationNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memmove(corporationName, thebuf+theBufContent, corporationNameLen);
	theBufContent += corporationNameLen;
	
	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1;
	
	//callerPartyType
	memmove(&callerPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
	
	//usableTime
	memmove(&this->usableTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	//userName
	userName = thebuf+theBufContent;
	theBufContent += userName.length()+1;
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	//lanIp
	memmove(&this->lanIp, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//wanIp
	memmove(&this->wanIp, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	callTransID = thebuf + theBufContent;
	theBufContent += callTransID.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;


	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;
}

int SIPCCMsg_UState_RingAgentExt2::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentIDLen
	memmove(thebuf+theBufContent, &this->agentIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//agentID
	memmove(thebuf+theBufContent, this->agentID, this->agentIDLen);
	theBufContent += agentIDLen;
	
	//uuiDataLen
	memmove(thebuf+theBufContent, &this->uuiDataLen, sizeof(int));
	theBufContent += sizeof(int);
	//uuiData
	memmove(thebuf+theBufContent, this->uuiData, this->uuiDataLen);
	theBufContent += uuiDataLen;
	
	//callIDLen
	memmove(thebuf+theBufContent, &this->callIDLen, sizeof(int));
	theBufContent += sizeof(int);
	//callID
	memmove(thebuf+theBufContent, this->callID, this->callIDLen);
	theBufContent += callIDLen;
	
	//corporationNameLen
	memmove(thebuf+theBufContent, &this->corporationNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//corporationName
	memmove(thebuf+theBufContent, this->corporationName, this->corporationNameLen);
	theBufContent += corporationNameLen;
	//callerNoForSend
	memmove(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;
	//callerPartyType
	memmove(thebuf+theBufContent, &this->callerPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(),invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	//usableTime
	memmove(thebuf+theBufContent, &this->usableTime, sizeof(int));
	theBufContent += sizeof(int);
	
	//userName
	memmove(thebuf+theBufContent, this->userName.c_str(),userName.length()+1);
	theBufContent += userName.length()+1;
	
	//lanIp
	memmove(thebuf+theBufContent, &this->lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	//wanIp
	memmove(thebuf+theBufContent, &this->wanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);

	//callTransID
	memcpy(thebuf+theBufContent, callTransID.c_str(), callTransID.length()+1);
	theBufContent += callTransID.length()+1;
	
	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;


	return theBufContent;
}

int SIPCCMsg_UState_RingAgentExt2::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += sizeof(int);					//agentIDLen
	memSize += this->agentIDLen;			//agentID
	memSize += sizeof(int);					//uuiDataLen
	memSize += this->uuiDataLen;			//uuiData
	memSize += sizeof(int);					//callIDLen
	memSize += this->callIDLen;				//callID
	memSize += sizeof(int);					//corporationNameLen
	memSize += this->corporationNameLen;	//corporationName
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += sizeof(int);					//callerPartyType
	memSize += invokeID.length()+1;			//invokeID
	memSize += sizeof(int);					//usableTime
	memSize += userName.length()+1;			//userName
	
	memSize += sizeof(unsigned long);		//lanIp
	memSize += sizeof(unsigned long);		//wanIp
	
	memSize += sizeof(int);

	memSize += callTransID.length()+1;		//callTransID

	memSize += managerId.length()+1;		//managerId

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol
	
	return memSize;
}

void SIPCCMsg_UState_RingAgentExt2::SetAgentID(string agentid)
{
	int iAgentIDLen = agentid.length();
	this->agentIDLen = iAgentIDLen + 1;
	this->agentID = new char[agentIDLen];
	memset(agentID, 0, agentIDLen);
	memcpy(agentID, agentid.c_str(), iAgentIDLen);
}

void SIPCCMsg_UState_RingAgentExt2::SetUUIData(string uuidata)
{
	int iUUIDataLen = uuidata.length();
	this->uuiDataLen = iUUIDataLen + 1;
	this->uuiData = new char[uuiDataLen];
	memset(uuiData, 0, uuiDataLen);
	memcpy(uuiData, uuidata.c_str(), iUUIDataLen);
}

void SIPCCMsg_UState_RingAgentExt2::SetCallID(string callid)
{
	int iCallIDLen = callid.length();
	this->callIDLen = iCallIDLen + 1;
	this->callID = new char[callIDLen];
	memset(callID, 0, callIDLen);
	memcpy(callID, callid.c_str(), iCallIDLen);
}

void SIPCCMsg_UState_RingAgentExt2::SetCorporationName(string corporationname)
{
	int iCorporationNameLen = corporationname.length();
	this->corporationNameLen = iCorporationNameLen + 1;
	this->corporationName = new char[corporationNameLen];
	memset(corporationName, 0, corporationNameLen);
	memcpy(corporationName, corporationname.c_str(), iCorporationNameLen);
}

///Type_Gateway_RingAgentExtConf
SIPCCMsg_Gateway_RingAgentExtConf::SIPCCMsg_Gateway_RingAgentExtConf()
{
	msgType = Type_Gateway_RingAgentExtConf;
	ipNo_AgentExt = "";
	agentID = "";
	bCallFailed = 1;
	calledNo = "";
	invokeID = "";
	
	outDialType = OutDialType_Normal;
}

void SIPCCMsg_Gateway_RingAgentExtConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_RingAgentExtConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ipNo_AgentExt
	ipNo_AgentExt = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ipNo_AgentExt.length()+1, msgsize, strMsg, "ipNo_AgentExt.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(ipNo_AgentExt.length(), IPNOAGENTEXT_LEN, strMsg, "ipNo_AgentExt", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ipNo_AgentExt.length()+1;

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	//bCallFailed
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bCallFailed", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->bCallFailed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	//failedCause
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "failedCause", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//calledNo
	calledNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsg, "calledNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(calledNo.length(), CALLEDNO_LEN, strMsg, "calledNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += calledNo.length()+1;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += invokeID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	CalledAgentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CalledAgentID.length()+1, msgsize, strMsg, "CalledAgentID.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(CalledAgentID.length(), AGENTID_LEN, strMsg, "CalledAgentID", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += CalledAgentID.length()+1;

	calledAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledAgentLineNo.length()+1, msgsize, strMsg, "calledAgentLineNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(calledAgentLineNo.length(), AGENTLINENO_LEN, strMsg, "calledAgentLineNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += calledAgentLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "calledAgentLineIp", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->calledAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "calledAgentLinePort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->calledAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

    if ( theBufContent >= msgsize )
		return;
  
	memmove(&primarySourceIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&primarySourcePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);




}

int SIPCCMsg_Gateway_RingAgentExtConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ipNo_AgentExt
	memmove(thebuf+theBufContent, this->ipNo_AgentExt.c_str(), this->ipNo_AgentExt.length()+1);
	theBufContent += this->ipNo_AgentExt.length()+1;
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;
	//bCallFailed
	memmove(thebuf+theBufContent, &this->bCallFailed, sizeof(char));
	theBufContent += sizeof(char);
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo.c_str(), this->calledNo.length()+1);
	theBufContent += this->calledNo.length()+1;
	
	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), this->invokeID.length()+1);
	theBufContent += this->invokeID.length()+1;
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, CalledAgentID.c_str(), CalledAgentID.length()+1);
	theBufContent += CalledAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, calledAgentLineNo.c_str(), calledAgentLineNo.length()+1);
	theBufContent += calledAgentLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->calledAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->calledAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;



	memmove(thebuf+theBufContent, &primarySourceIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &primarySourcePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);




	return theBufContent;
}

int SIPCCMsg_Gateway_RingAgentExtConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ipNo_AgentExt.length()+1;//ipNo_AgentExt
	memSize += agentID.length()+1;	//agentID
	memSize += sizeof(char);			//bCallFailed
	memSize += sizeof(int);				//failedCause
	memSize += calledNo.length()+1;		//calledNo
	memSize += invokeID.length()+1;		//invokeID
	
	memSize += sizeof(int);
	memSize += CalledAgentID.length()+1;
	memSize += calledAgentLineNo.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += CalledAgentID.length()+1;
	memSize += calledAgentLineNo.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;

    

	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	return memSize;
}

///Type_Gateway_RingAgentExtFailed
SIPCCMsg_Gateway_RingAgentExtFailed::SIPCCMsg_Gateway_RingAgentExtFailed()
{
	msgType = Type_Gateway_RingAgentExtFailed;
	ipNo_AgentExt = "";
	agentID = "";
	calledNo = "";
	outDialType = OutDialType_Normal;
}

void SIPCCMsg_Gateway_RingAgentExtFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_RingAgentExtFailed";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ipNo_AgentExt
	ipNo_AgentExt = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ipNo_AgentExt.length()+1, msgsize, strMsg, "ipNo_AgentExt.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(ipNo_AgentExt.length(), IPNOAGENTEXT_LEN, strMsg, "ipNo_AgentExt", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ipNo_AgentExt.length()+1;

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	//failedCause
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "failedCause", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//calledNo
	calledNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsg, "calledNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(calledNo.length(), CALLEDNO_LEN, strMsg, "calledNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += calledNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_RingAgentExtFailed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ipNo_AgentExt
	memmove(thebuf+theBufContent, this->ipNo_AgentExt.c_str(), this->ipNo_AgentExt.length()+1);
	theBufContent += this->ipNo_AgentExt.length()+1;
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;
	
	//failedCause
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);
	
	//calledNo
	memmove(thebuf+theBufContent, this->calledNo.c_str(), this->calledNo.length()+1);
	theBufContent += this->calledNo.length()+1;
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_RingAgentExtFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ipNo_AgentExt.length()+1;//ipNo_AgentExt
	memSize += agentID.length()+1;	//agentID
	memSize += sizeof(int);				//failedCause
	memSize += calledNo.length()+1;		//calledNo
	
	memSize += sizeof(int);
	
	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

//Type_Gateway_AgentAnswerCall
SIPCCMsg_Gateway_AgentAnswerCall::SIPCCMsg_Gateway_AgentAnswerCall()
{
	msgType = Type_Gateway_AgentAnswerCall;
	ipNo_AgentExt = "";
	agentID = "";
	outDialType = OutDialType_RingAgentExt;
	
	agentLineIp = 0;
	agentLinePort = 0;
	
	userLineIp = 0;
	userLinePort = 0;
}

void SIPCCMsg_Gateway_AgentAnswerCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_AgentAnswerCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ipNo_AgentExt
	ipNo_AgentExt = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ipNo_AgentExt.length()+1, msgsize, strMsg, "ipNo_AgentExt.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(ipNo_AgentExt.length(), IPNOAGENTEXT_LEN, strMsg, "ipNo_AgentExt", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ipNo_AgentExt.length()+1;

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (theBufContent >= msgsize)
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "calledOperType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove( &calledOperType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	agentLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentLineNo.length()+1, msgsize, strMsg, "agentLineNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(agentLineNo.length(), AGENTLINENO_LEN, strMsg, "agentLineNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += agentLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "agentLineIp", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->agentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "agentLinePort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->agentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	userLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userLineNo.length()+1, msgsize, strMsg, "userLineNo.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(userLineNo.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += userLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "userLineIp", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->userLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "userLinePort", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove(&this->userLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	wpAgentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+wpAgentID.length()+1, msgsize, strMsg, "wpAgentID.length()", ip, port, g_bIsACDServer, agentID)) ) {return;}
	if ( !(VerifyData(wpAgentID.length(), AGENTID_LEN, strMsg, "wpAgentID", ip, port, g_bIsACDServer, agentID)) ) {return;}
	theBufContent += wpAgentID.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_AgentAnswerCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ipNo_AgentExt
	memmove(thebuf+theBufContent, this->ipNo_AgentExt.c_str(), this->ipNo_AgentExt.length()+1);
	theBufContent += this->ipNo_AgentExt.length()+1;
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &calledOperType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, agentLineNo.c_str(), agentLineNo.length()+1);
	theBufContent += agentLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->agentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->agentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length()+1);
	theBufContent += userLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->userLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->userLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;
	
	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_AgentAnswerCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ipNo_AgentExt.length()+1;
	memSize += agentID.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	memSize += userLineNo.length()+1;
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);
	memSize += agentLineNo.length()+1;
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);
	
	memSize += wpAgentID.length()+1;
	
	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

//Type_Gateway_AgentHangupCall
SIPCCMsg_Gateway_AgentHangupCall::SIPCCMsg_Gateway_AgentHangupCall()
{
	msgType = Type_Gateway_AgentHangupCall;
	ipNo_AgentExt = "";
	agentID = "";
	outDialType = OutDialType_RingAgentExt;
}

void SIPCCMsg_Gateway_AgentHangupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_AgentHangupCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ipNo_AgentExt
	ipNo_AgentExt = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ipNo_AgentExt.length()+1, msgsize, strMsg, "ipNo_AgentExt.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(ipNo_AgentExt.length(), IPNOAGENTEXT_LEN, strMsg, "ipNo_AgentExt", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ipNo_AgentExt.length()+1;

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_AgentHangupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ipNo_AgentExt
	memmove(thebuf+theBufContent, this->ipNo_AgentExt.c_str(), this->ipNo_AgentExt.length()+1);
	theBufContent += this->ipNo_AgentExt.length()+1;
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_AgentHangupCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ipNo_AgentExt.length()+1;
	memSize += agentID.length()+1;
	memSize += sizeof(int);
	
	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

SIPCCMsg_Gateway_UserHangupCall::SIPCCMsg_Gateway_UserHangupCall()
{
	msgType = Type_Gateway_UserHangupCall;
	userLineNo = "";
	agentID = "";
	outDialType = OutDialType_RingAgentExt;
}

void SIPCCMsg_Gateway_UserHangupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_UserHangupCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ipNo_AgentExt
	userLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userLineNo.length()+1, msgsize, strMsg, "userLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(userLineNo.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += userLineNo.length()+1;

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "outDialType", ip, port, g_bIsACDServer, agentID)) ) {return;}
	memmove( &outDialType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_UserHangupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ipNo_AgentExt
	memmove(thebuf+theBufContent, this->userLineNo.c_str(), this->userLineNo.length()+1);
	theBufContent += this->userLineNo.length()+1;
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;
	
	memmove(thebuf+theBufContent, &outDialType, sizeof(int));
	theBufContent += sizeof(int);
	
	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_UserHangupCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += userLineNo.length()+1;
	memSize += agentID.length()+1;
	memSize += sizeof(int);

	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

//Type_ACD_StopRingAgentExt
SIPCCMsg_ACD_StopRingAgentExt::SIPCCMsg_ACD_StopRingAgentExt()
{
	msgType = Type_ACD_StopRingAgentExt;
	ipNo_AgentExt = "";
	agentID = "";

	primarySourceIp=0;
	primarySourcePort=0;
}

void SIPCCMsg_ACD_StopRingAgentExt::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_StopRingAgentExt";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//ipNo_AgentExt
	ipNo_AgentExt = thebuf+theBufContent;
	theBufContent += ipNo_AgentExt.length()+1;
	
	//agentID
	agentID = thebuf+theBufContent;
	theBufContent += agentID.length()+1;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
	
	if ( theBufContent >= msgsize )
		return;

	userName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userName.length()+1, msgsize, strMsg, "userName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(userName.length(), USERNAME_LEN, strMsg, "userName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += userName.length()+1;


	if ( theBufContent >= msgsize )
		return;

	memmove(&primarySourceIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&primarySourcePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


}

int SIPCCMsg_ACD_StopRingAgentExt::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ipNo_AgentExt
	memmove(thebuf+theBufContent, this->ipNo_AgentExt.c_str(), this->ipNo_AgentExt.length()+1);
	theBufContent += this->ipNo_AgentExt.length()+1;
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	//userName
	memcpy(thebuf+theBufContent, userName.c_str(), userName.length()+1);
	theBufContent += userName.length()+1;

   
	memmove(thebuf+theBufContent, &primarySourceIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &primarySourcePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	
	return theBufContent;
}

int SIPCCMsg_ACD_StopRingAgentExt::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ipNo_AgentExt.length()+1;
	memSize += agentID.length()+1;

	memSize += handleId.length()+1;			//handleId
	memSize += userName.length()+1;			//userName
	
	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	return memSize;
}

//Type_Gateway_StopRingAgentExtConf
SIPCCMsg_Gateway_StopRingAgentExtConf::SIPCCMsg_Gateway_StopRingAgentExtConf()
{
	msgType = Type_Gateway_StopRingAgentExtConf;
	ipNo_AgentExt = "";
	agentID = "";
}

void SIPCCMsg_Gateway_StopRingAgentExtConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_StopRingAgentExtConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ipNo_AgentExt
	ipNo_AgentExt = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ipNo_AgentExt.length()+1, msgsize, strMsg, "ipNo_AgentExt.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(ipNo_AgentExt.length(), IPNOAGENTEXT_LEN, strMsg, "ipNo_AgentExt", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ipNo_AgentExt.length()+1;

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;

}

int SIPCCMsg_Gateway_StopRingAgentExtConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//ipNo_AgentExt
	memmove(thebuf+theBufContent, this->ipNo_AgentExt.c_str(), this->ipNo_AgentExt.length()+1);
	theBufContent += this->ipNo_AgentExt.length()+1;
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_StopRingAgentExtConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ipNo_AgentExt.length()+1;
	memSize += agentID.length()+1;

	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;
	memSize += handleId.length()+1;
	
	return memSize;
}

//Type_Gateway_StopRingAgentExtConf
SIPCCMsg_Gateway_CancelRingAgentExt::SIPCCMsg_Gateway_CancelRingAgentExt()
{
	msgType = Type_Gateway_CancelRingAgentExt;
	agentID = "";
}

void SIPCCMsg_Gateway_CancelRingAgentExt::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CancelRingAgentExt";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentID
	agentID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;
}

int SIPCCMsg_Gateway_CancelRingAgentExt::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//agentID
	memmove(thebuf+theBufContent, this->agentID.c_str(), this->agentID.length()+1);
	theBufContent += this->agentID.length()+1;
	
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_CancelRingAgentExt::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;

	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;
	
	return memSize;
}

///////////////////////////////////////////////////////////////////////////
///Class_Wap
SIPCCMsg_Wap::SIPCCMsg_Wap()
{
	msgClass = Class_Wap;
}

///Type_Wap_CallOut
SIPCCMsg_Wap_CallOut::SIPCCMsg_Wap_CallOut()
{
	msgType = Type_Wap_CallOut;
	targetType = 0;
}

void SIPCCMsg_Wap_CallOut::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Wap_CallOut";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	localPhone = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+localPhone.length()+1, msgsize, strMsgName, "localPhone", ip, port)) ) {return;}
	if ( !(VerifyData(localPhone.length(), PHONENO_LEN, strMsgName, "localPhone", ip, port)) ) {return;}
	theBufContent += localPhone.length()+1;
	
	targetPhone = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+targetPhone.length()+1, msgsize, strMsgName, "targetPhone", ip, port)) ) {return;}
	if ( !(VerifyData(targetPhone.length(), PHONENO_LEN, strMsgName, "targetPhone", ip, port)) ) {return;}
	theBufContent += targetPhone.length()+1;
	
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsgName, "targetType", ip, port)) ) {return;}
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;
	
	deptName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptName.length()+1, msgsize, strMsgName, "deptName", ip, port)) ) {return;}
	if ( !(VerifyData(deptName.length(), CORPNDEPT_LEN, strMsgName, "deptName", ip, port)) ) {return;}
	theBufContent += deptName.length()+1;
	
	agentId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentId.length()+1, msgsize, strMsgName, "agentId", ip, port)) ) {return;}
	if ( !(VerifyData(agentId.length(), AGENTID_LEN, strMsgName, "agentId", ip, port)) ) {return;}
	theBufContent += agentId.length()+1;

	if (theBufContent == msgsize)
	{
		return;
	}

	CallTransID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CallTransID.length()+1, msgsize, strMsgName, "CallTransID", ip, port)) ) {return;}
	if ( !(VerifyData(CallTransID.length(), CALLTRANSID_LEN, strMsgName, "CallTransID", ip, port)) ) {return;}
	theBufContent += CallTransID.length()+1;
}

int SIPCCMsg_Wap_CallOut::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, localPhone.c_str(), localPhone.length()+1);
	theBufContent += localPhone.length()+1;
	
	memcpy(thebuf+theBufContent, targetPhone.c_str(), targetPhone.length()+1);
	theBufContent += targetPhone.length()+1;
	
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;
	
	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length()+1);
	theBufContent += agentId.length()+1;

	memcpy(thebuf+theBufContent, CallTransID.c_str(), CallTransID.length()+1);
	theBufContent += CallTransID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Wap_CallOut::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += localPhone.length()+1;	//AgentName
	memSize += targetPhone.length()+1;	//AgentName
	memSize += sizeof(int);				//RequestID
	memSize += corpName.length()+1;	//AgentName
	memSize += deptName.length()+1;	//AgentName
	memSize += agentId.length()+1;	//AgentName
	memSize += CallTransID.length()+1;	//CallTransID
	
	return memSize;
}

///Type_Client_WebPSTNDial
SIPCCMsg_Client_WebPSTNDial::SIPCCMsg_Client_WebPSTNDial()
{
	msgType = Type_Client_WebPSTNDial;	
	NeedReturnClient = 0;
	handleId="";		
	userData="";	
}

void SIPCCMsg_Client_WebPSTNDial::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Client_WebPSTNDial";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsgName, "agentID", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsgName, "agentID", ip, port)) ) {return;}
	theBufContent += agentID.length()+1;
	
	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;
	
	agentPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentPhoneNo.length()+1, msgsize, strMsgName, "agentPhoneNo", ip, port)) ) {return;}
	if ( !(VerifyData(agentPhoneNo.length(), AGENTPHONENO_LEN, strMsgName, "agentPhoneNo", ip, port)) ) {return;}
	theBufContent += agentPhoneNo.length()+1;
	
	userPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userPhoneNo.length()+1, msgsize, strMsgName, "userPhoneNo", ip, port)) ) {return;}
	if ( !(VerifyData(userPhoneNo.length(), PHONENO_LEN, strMsgName, "userPhoneNo", ip, port)) ) {return;}
	theBufContent += userPhoneNo.length()+1;
	
	deptName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+deptName.length()+1, msgsize, strMsgName, "deptName", ip, port)) ) {return;}
	if ( !(VerifyData(deptName.length(), CORPNDEPT_LEN, strMsgName, "deptName", ip, port)) ) {return;}
	theBufContent += deptName.length()+1;
	
	if (theBufContent == msgsize)
	{
		return;
	}
	managerDialNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerDialNo.length()+1, msgsize, strMsgName, "managerDialNo", ip, port)) ) {return;}
	if ( !(VerifyData(managerDialNo.length(), PHONENO_LEN, strMsgName, "managerDialNo", ip, port)) ) {return;}
	theBufContent += managerDialNo.length()+1;

	if (theBufContent == msgsize)
	{
		return;
	}

	CallTransID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CallTransID.length()+1, msgsize, strMsgName, "CallTransID", ip, port)) ) {return;}
	if ( !(VerifyData(CallTransID.length(), CALLTRANSID_LEN, strMsgName, "CallTransID", ip, port)) ) {return;}
	theBufContent += CallTransID.length()+1;

	if (theBufContent == msgsize)
	{
		return;
	}

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsgName, "managerId", ip, port)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsgName, "managerId", ip, port)) ) {return;}
	theBufContent += managerId.length()+1;

	computerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+computerSymbol.length()+1, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	if ( !(VerifyData(computerSymbol.length(), COMSYMBOL_LEN, strMsgName, "computerSymbol", ip, port)) ) {return;}
	theBufContent += computerSymbol.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	// NeedReturnClient
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsgName, "NeedReturnClient", ip, port)) ) {return;}
	memmove(&this->NeedReturnClient, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);


	if (theBufContent >= msgsize)
	{
		return;
	}
	//handleId
	handleId = thebuf + theBufContent;	
	theBufContent += handleId.length()+1;

	//userData
	userData = thebuf + theBufContent;	
	theBufContent += userData.length()+1;



}

int SIPCCMsg_Client_WebPSTNDial::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	memcpy(thebuf+theBufContent, agentPhoneNo.c_str(), agentPhoneNo.length()+1);
	theBufContent += agentPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, userPhoneNo.c_str(), userPhoneNo.length()+1);
	theBufContent += userPhoneNo.length()+1;
	
	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;
	
	memcpy(thebuf+theBufContent, managerDialNo.c_str(), managerDialNo.length()+1);
	theBufContent += managerDialNo.length()+1;

	memcpy(thebuf+theBufContent, CallTransID.c_str(), CallTransID.length()+1);
	theBufContent += CallTransID.length()+1;

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	// NeedReturnClient
	memmove(thebuf+theBufContent, &this->NeedReturnClient, sizeof(char));
	theBufContent += sizeof(char);

	// handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	// userData
	memcpy(thebuf+theBufContent, userData.c_str(), userData.length()+1);
	theBufContent += userData.length()+1;

	
	return theBufContent;
}

int SIPCCMsg_Client_WebPSTNDial::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;	//AgentName
	memSize += corpName.length()+1;	//AgentName
	memSize += agentPhoneNo.length()+1;	//AgentName
	memSize += userPhoneNo.length()+1;	//AgentName
	memSize += deptName.length()+1;	//AgentName
	memSize += managerDialNo.length()+1;
	memSize += CallTransID.length()+1;
	memSize += managerId.length()+1;
	memSize += computerSymbol.length()+1;
	memSize += sizeof(char);	// NeedReturnClient

	memSize += handleId.length()+1;	//handleId

	memSize += userData.length()+1;	//userData
	
	return memSize;
}

///Type_ACD_AddCorpNDeptInfo
SIPCCMsg_ACD_AddCorpNDeptInfo::SIPCCMsg_ACD_AddCorpNDeptInfo()
{
	msgType = Type_ACD_AddCorpNDeptInfo;
}

void SIPCCMsg_ACD_AddCorpNDeptInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;
	
	deptName = thebuf + theBufContent;
	theBufContent += deptName.length()+1;
}

int SIPCCMsg_ACD_AddCorpNDeptInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_AddCorpNDeptInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += corpName.length()+1;	//AgentName
	memSize += deptName.length()+1;	//AgentName
	
	return memSize;
}

///Type_Toll_SMS
SIPCCMsg_Toll_SMS::SIPCCMsg_Toll_SMS()
{
	msgType = Type_Toll_SMS;
	sendCount = 0;
}

void SIPCCMsg_Toll_SMS::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
	
	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;
	
	memmove(&this->sendCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Toll_SMS::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;
	
	memmove(thebuf+theBufContent, &this->sendCount, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Toll_SMS::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;	//AgentName
	memSize += managerId.length()+1;	//AgentName
	memSize += sizeof(int);	
	
	return memSize;
}

///Type_Toll_SMSAck
SIPCCMsg_Toll_SMSAck::SIPCCMsg_Toll_SMSAck()
{
	msgType = Type_Toll_SMSAck;
}

void SIPCCMsg_Toll_SMSAck::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
	
}

int SIPCCMsg_Toll_SMSAck::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Toll_SMSAck::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;	//AgentName
	
	return memSize;
}

///Type_Gateway_UnAnsweredCall
SIPCCMsg_Gateway_UnAnsweredCall::SIPCCMsg_Gateway_UnAnsweredCall()
{
	msgType = Type_Gateway_UnAnsweredCall;

	sessionID = "";
}

void SIPCCMsg_Gateway_UnAnsweredCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_Gateway_UnAnsweredCall";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	manageId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+manageId.length()+1, msgsize, strMsgName, "manageId", ip, port)) ) {return;}
	if ( !(VerifyData(manageId.length(), MANAGERID_LEN, strMsgName, "manageId", ip, port)) ) {return;}
	theBufContent += manageId.length()+1;
	
	corpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corpName.length()+1, msgsize, strMsgName, "corpName", ip, port)) ) {return;}
	if ( !(VerifyData(corpName.length(), CORPNAME_LEN, strMsgName, "corpName", ip, port)) ) {return;}
	theBufContent += corpName.length()+1;
	
	key = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+key.length()+1, msgsize, strMsgName, "key", ip, port)) ) {return;}
	if ( !(VerifyData(key.length(), KEYWORD_LEN, strMsgName, "key", ip, port)) ) {return;}
	theBufContent += key.length()+1;
	
	extNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+extNo.length()+1, msgsize, strMsgName, "extNo", ip, port)) ) {return;}
	if ( !(VerifyData(extNo.length(), PHONENO_LEN, strMsgName, "extNo", ip, port)) ) {return;}
	theBufContent += extNo.length()+1;
	
	customerNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+customerNo.length()+1, msgsize, strMsgName, "customerNo", ip, port)) ) {return;}
	if ( !(VerifyData(customerNo.length(), PHONENO_LEN, strMsgName, "customerNo", ip, port)) ) {return;}
	theBufContent += customerNo.length()+1;
	
	time = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+time.length()+1, msgsize, strMsgName, "time", ip, port)) ) {return;}
	if ( !(VerifyData(time.length(), TIME_LEN, strMsgName, "time", ip, port)) ) {return;}
	theBufContent += time.length()+1;

	if(theBufContent == msgsize)
		return;

	calledNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsgName, "calledNo", ip, port)) ) {return;}
	if ( !(VerifyData(calledNo.length(), PHONENO_LEN, strMsgName, "calledNo", ip, port)) ) {return;}
	theBufContent += calledNo.length()+1;
	
	if(theBufContent == msgsize)
		return;

	sessionID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+sessionID.length()+1, msgsize, strMsgName, "sessionID", ip, port)) ) {return;}
	if ( !(VerifyData(sessionID.length(), SESSIONID_LEN, strMsgName, "sessionID", ip, port)) ) {return;}
	theBufContent += sessionID.length()+1;

	if(theBufContent == msgsize)
		return;

	hangupTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+hangupTime.length()+1, msgsize, strMsgName, "hangupTime", ip, port)) ) {return;}
	if ( !(VerifyData(hangupTime.length(), HANGUPTIME_LEN, strMsgName, "hangupTime", ip, port)) ) {return;}
	theBufContent += hangupTime.length()+1;

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsgName, "invokeId", ip, port)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsgName, "invokeId", ip, port)) ) {return;}
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_Gateway_UnAnsweredCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, manageId.c_str(), manageId.length()+1);
	theBufContent += manageId.length()+1;
	
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;
	
	memcpy(thebuf+theBufContent, key.c_str(), key.length()+1);
	theBufContent += key.length()+1;
	
	memcpy(thebuf+theBufContent, extNo.c_str(), extNo.length()+1);
	theBufContent += extNo.length()+1;
	
	memcpy(thebuf+theBufContent, customerNo.c_str(), customerNo.length()+1);
	theBufContent += customerNo.length()+1;
	
	memcpy(thebuf+theBufContent, time.c_str(), time.length()+1);
	theBufContent += time.length()+1;

	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;

	memcpy(thebuf+theBufContent, sessionID.c_str(), sessionID.length()+1);
	theBufContent += sessionID.length()+1;

	memcpy(thebuf+theBufContent, hangupTime.c_str(), hangupTime.length()+1);
	theBufContent += hangupTime.length()+1;

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_UnAnsweredCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += manageId.length()+1;	//manageId
	memSize += corpName.length()+1;	//corpName
	memSize += key.length()+1;	//key
	memSize += extNo.length()+1;	//extNo
	memSize += customerNo.length()+1;	//customerNo
	memSize += time.length()+1;	//time
	memSize += calledNo.length()+1;	//calledNo
	memSize += sessionID.length()+1;	//sessionID
	memSize += hangupTime.length()+1;	//hangupTime
	memSize += invokeId.length()+1;

	return memSize;
}

///Type_ACD_SetClientAgentState
SIPCCMsg_ACD_SetClientAgentState::SIPCCMsg_ACD_SetClientAgentState()
{
	msgType = Type_ACD_SetClientAgentState;
	operType = SetAgentStateOperType_Unknown;
}

void SIPCCMsg_ACD_SetClientAgentState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->agentState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	gwAgentLine = thebuf + theBufContent;
	theBufContent += gwAgentLine.length()+1;
	
	gwUserLine = thebuf + theBufContent;
	theBufContent += gwUserLine.length()+1;
	
	transedAgentID = thebuf + theBufContent;
	theBufContent += transedAgentID.length()+1;
	
	transedGwAgentLine = thebuf + theBufContent;
	theBufContent += transedGwAgentLine.length()+1;
	
	memmove(&this->gwAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&this->gwAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(&this->gwUserLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&this->gwUserLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(&this->operType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	
}

int SIPCCMsg_ACD_SetClientAgentState::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->agentState, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;
	
	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;
	
	memcpy(thebuf+theBufContent, transedAgentID.c_str(), transedAgentID.length()+1);
	theBufContent += transedAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, transedGwAgentLine.c_str(), transedGwAgentLine.length()+1);
	theBufContent += transedGwAgentLine.length()+1;
	
	memmove(thebuf+theBufContent, &this->gwAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->gwAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->gwUserLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->gwUserLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->operType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_SetClientAgentState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);	
	memSize += gwAgentLine.length()+1;
	memSize += gwUserLine.length()+1;
	memSize += transedAgentID.length()+1;
	memSize += transedGwAgentLine.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);
	
	return memSize;
}

///Type_Client_WebPSTNAgentHoldCall
SIPCCMsg_Client_WebPSTNAgentHoldCall::SIPCCMsg_Client_WebPSTNAgentHoldCall()
{
	msgType = Type_Client_WebPSTNAgentHoldCall;
}

void SIPCCMsg_Client_WebPSTNAgentHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_WebPSTNAgentHoldCall", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, "SIPCCMsg_Client_WebPSTNAgentHoldCall", "agentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, "SIPCCMsg_Client_WebPSTNAgentHoldCall", "agentID", ip, port)) ) {return;}
	theBufContent += agentID.length()+1;

	gwAgentLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAgentLine.length()+1, msgsize, "SIPCCMsg_Client_WebPSTNAgentHoldCall", "gwAgentLine.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwAgentLine.length(), AGENTLINE_LEN, "SIPCCMsg_Client_WebPSTNAgentHoldCall", "gwAgentLine", ip, port)) ) {return;}
	theBufContent += gwAgentLine.length()+1;

	gwUserLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwUserLine.length()+1, msgsize, "SIPCCMsg_Client_WebPSTNAgentHoldCall", "gwUserLine.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwUserLine.length(), USERLINE_LEN, "SIPCCMsg_Client_WebPSTNAgentHoldCall", "gwUserLine", ip, port)) ) {return;}
	theBufContent += gwUserLine.length()+1;
}

int SIPCCMsg_Client_WebPSTNAgentHoldCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;
	
	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_WebPSTNAgentHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;
	memSize += gwAgentLine.length()+1;	//AgentName
	memSize += gwUserLine.length()+1;	//AgentName
	
	return memSize;
}

///Type_Client_WebPSTNAgentUnHoldCall
SIPCCMsg_Client_WebPSTNAgentUnHoldCall::SIPCCMsg_Client_WebPSTNAgentUnHoldCall()
{
	msgType = Type_Client_WebPSTNAgentUnHoldCall;
}

void SIPCCMsg_Client_WebPSTNAgentUnHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_WebPSTNAgentUnHoldCall", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, "SIPCCMsg_Client_WebPSTNAgentUnHoldCall", "agentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, "SIPCCMsg_Client_WebPSTNAgentUnHoldCall", "agentID", ip, port)) ) {return;}
	theBufContent += agentID.length()+1;

	gwAgentLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAgentLine.length()+1, msgsize, "SIPCCMsg_Client_WebPSTNAgentUnHoldCall", "gwAgentLine.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwAgentLine.length(), AGENTLINE_LEN, "SIPCCMsg_Client_WebPSTNAgentUnHoldCall", "gwAgentLine", ip, port)) ) {return;}
	theBufContent += gwAgentLine.length()+1;

	gwUserLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwUserLine.length()+1, msgsize, "SIPCCMsg_Client_WebPSTNAgentUnHoldCall", "gwUserLine.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwUserLine.length(), USERLINE_LEN, "SIPCCMsg_Client_WebPSTNAgentUnHoldCall", "gwUserLine", ip, port)) ) {return;}
	theBufContent += gwUserLine.length()+1;
}

int SIPCCMsg_Client_WebPSTNAgentUnHoldCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;
	
	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_WebPSTNAgentUnHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;
	memSize += gwAgentLine.length()+1;	//AgentName
	memSize += gwUserLine.length()+1;	//AgentName
	
	return memSize;
}

///Type_UState_WebPSTNAgentHoldCall
SIPCCMsg_UState_WebPSTNAgentHoldCall::SIPCCMsg_UState_WebPSTNAgentHoldCall()
{
	msgType = Type_UState_WebPSTNAgentHoldCall;
	gatewayName="";
	computerSymbol="";
	handleId="";
}

void SIPCCMsg_UState_WebPSTNAgentHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
	
	gwAgentLine = thebuf + theBufContent;
	theBufContent += gwAgentLine.length()+1;
	
	gwUserLine = thebuf + theBufContent;
	theBufContent += gwUserLine.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

	//handleId
	handleId = thebuf + theBufContent;
	theBufContent+= handleId.length()+1;
}

int SIPCCMsg_UState_WebPSTNAgentHoldCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;
	
	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;


	//handleId 
	memcpy(thebuf+theBufContent, handleId .c_str(), handleId .length()+1);
	theBufContent += handleId .length()+1;

	
	return theBufContent;
}

int SIPCCMsg_UState_WebPSTNAgentHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;
	memSize += gwAgentLine.length()+1;	//AgentName
	memSize += gwUserLine.length()+1;	//AgentName

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	memSize += handleId.length()+1;		//handleId

	return memSize;
}

///Type_UState_WebPSTNAgentUnHoldCall
SIPCCMsg_UState_WebPSTNAgentUnHoldCall::SIPCCMsg_UState_WebPSTNAgentUnHoldCall()
{
	msgType = Type_UState_WebPSTNAgentUnHoldCall;
}

void SIPCCMsg_UState_WebPSTNAgentUnHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
	
	gwAgentLine = thebuf + theBufContent;
	theBufContent += gwAgentLine.length()+1;
	
	gwUserLine = thebuf + theBufContent;
	theBufContent += gwUserLine.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

}

int SIPCCMsg_UState_WebPSTNAgentUnHoldCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;
	
	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_UState_WebPSTNAgentUnHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;
	memSize += gwAgentLine.length()+1;	//AgentName
	memSize += gwUserLine.length()+1;	//AgentName

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol
	
	return memSize;
}

///Type_UState_WebPSTNAgentHoldCallConf
SIPCCMsg_UState_WebPSTNAgentHoldCallConf::SIPCCMsg_UState_WebPSTNAgentHoldCallConf()
{
	msgType = Type_UState_WebPSTNAgentHoldCallConf;
	bHoldSucc = 0;
	gatewayName="";
	computerSymbol="";
	handleId="";
}

void SIPCCMsg_UState_WebPSTNAgentHoldCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->bHoldSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

	//handleId
	handleId = thebuf + theBufContent;
	theBufContent+= handleId.length()+1;
}

int SIPCCMsg_UState_WebPSTNAgentHoldCallConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->bHoldSucc, sizeof(char));
	theBufContent += sizeof(char);

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	//handleId 
	memcpy(thebuf+theBufContent, handleId .c_str(), handleId .length()+1);
	theBufContent += handleId .length()+1;

	
	return theBufContent;
}

int SIPCCMsg_UState_WebPSTNAgentHoldCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);			//bQuerySucess

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol
	memSize += handleId.length()+1;		//handleId
	
	return memSize;
}

///Type_ACD_CallAnswered_WebPstnAgent
SIPCCMsg_ACD_CallAnswered_WebPstnAgent::SIPCCMsg_ACD_CallAnswered_WebPstnAgent()
{
	msgType = Type_ACD_CallAnswered_WebPstnAgent;
}

void SIPCCMsg_ACD_CallAnswered_WebPstnAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	gwAgentLine = thebuf + theBufContent;
	theBufContent += gwAgentLine.length()+1;
	
	otherAgentID = thebuf + theBufContent;
	theBufContent += otherAgentID.length()+1;
}

int SIPCCMsg_ACD_CallAnswered_WebPstnAgent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;
	
	memcpy(thebuf+theBufContent, otherAgentID.c_str(), otherAgentID.length()+1);
	theBufContent += otherAgentID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_CallAnswered_WebPstnAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gwAgentLine.length()+1;
	memSize += otherAgentID.length()+1;
	
	return memSize;
}

///Type_Client_WpAgentTrans2VoipAgent
SIPCCMsg_Client_WpAgentTrans2VoipAgent::SIPCCMsg_Client_WpAgentTrans2VoipAgent()
{
	msgType = Type_Client_WpAgentTrans2VoipAgent;
}

void SIPCCMsg_Client_WpAgentTrans2VoipAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "otherPartyType", ip, port)) ) {return;}
	memmove(&this->otherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	theParty = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+theParty.length()+1, msgsize, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "theParty.length()", ip, port)) ) {return;}
	if ( !(VerifyData(theParty.length(), THEPARTY_LEN, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "theParty", ip, port)) ) {return;}
	theBufContent += theParty.length()+1;

	presideAgent = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+presideAgent.length()+1, msgsize, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "presideAgent.length()", ip, port)) ) {return;}
	if ( !(VerifyData(presideAgent.length(), PRESIDEAGENT_LEN, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "presideAgent", ip, port)) ) {return;}
	theBufContent += presideAgent.length()+1;

	otherParty = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+otherParty.length()+1, msgsize, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "otherParty.length()", ip, port)) ) {return;}
	if ( !(VerifyData(otherParty.length(), OTHERPARTY_LEN, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "otherParty", ip, port)) ) {return;}
	theBufContent += otherParty.length()+1;

	wpAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+wpAgentLineNo.length()+1, msgsize, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "wpAgentLineNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(wpAgentLineNo.length(), AGENTLINENO_LEN, "SIPCCMsg_Client_WpAgentTrans2VoipAgent", "wpAgentLineNo", ip, port)) ) {return;}
	theBufContent += wpAgentLineNo.length()+1;
}

int SIPCCMsg_Client_WpAgentTrans2VoipAgent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, theParty.c_str(), theParty.length()+1);
	theBufContent += theParty.length()+1;
	
	memcpy(thebuf+theBufContent, presideAgent.c_str(), presideAgent.length()+1);
	theBufContent += presideAgent.length()+1;
	
	memcpy(thebuf+theBufContent, otherParty.c_str(), otherParty.length()+1);
	theBufContent += otherParty.length()+1;
	
	memcpy(thebuf+theBufContent, wpAgentLineNo.c_str(), wpAgentLineNo.length()+1);
	theBufContent += wpAgentLineNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_WpAgentTrans2VoipAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);	
	memSize += theParty.length()+1;
	memSize += presideAgent.length()+1;
	memSize += otherParty.length()+1;
	memSize += wpAgentLineNo.length()+1;
	
	return memSize;
}

///Type_UState_WpAgentTrans2VoipAgent
SIPCCMsg_UState_WpAgentTrans2VoipAgent::SIPCCMsg_UState_WpAgentTrans2VoipAgent()
{
	msgType = Type_UState_WpAgentTrans2VoipAgent;

	gatewayName="";
	computerSymbol="";

}

void SIPCCMsg_UState_WpAgentTrans2VoipAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->otherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	theParty = thebuf + theBufContent;
	theBufContent += theParty.length()+1;
	
	presideAgent = thebuf + theBufContent;
	theBufContent += presideAgent.length()+1;
	
	otherParty = thebuf + theBufContent;
	theBufContent += otherParty.length()+1;
	
	wpAgentLineNo = thebuf + theBufContent;
	theBufContent += wpAgentLineNo.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;


}

int SIPCCMsg_UState_WpAgentTrans2VoipAgent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, theParty.c_str(), theParty.length()+1);
	theBufContent += theParty.length()+1;
	
	memcpy(thebuf+theBufContent, presideAgent.c_str(), presideAgent.length()+1);
	theBufContent += presideAgent.length()+1;
	
	memcpy(thebuf+theBufContent, otherParty.c_str(), otherParty.length()+1);
	theBufContent += otherParty.length()+1;
	
	memcpy(thebuf+theBufContent, wpAgentLineNo.c_str(), wpAgentLineNo.length()+1);
	theBufContent += wpAgentLineNo.length()+1;


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_UState_WpAgentTrans2VoipAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);	
	memSize += theParty.length()+1;
	memSize += presideAgent.length()+1;
	memSize += otherParty.length()+1;
	memSize += wpAgentLineNo.length()+1;
	

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol


	return memSize;
}

///Type_ACD_CallReleased_WpAgent
SIPCCMsg_ACD_CallReleased_WpAgent::SIPCCMsg_ACD_CallReleased_WpAgent()
{
	msgType = Type_ACD_CallReleased_WpAgent;
}

void SIPCCMsg_ACD_CallReleased_WpAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_CallReleased_WpAgent";
	
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	userLineNo = thebuf + theBufContent;
	theBufContent += userLineNo.length()+1;
	
	agentLineNo = thebuf + theBufContent;
	theBufContent += agentLineNo.length()+1;

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_CallReleased_WpAgent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length()+1);
	theBufContent += userLineNo.length()+1;
	
	memcpy(thebuf+theBufContent, agentLineNo.c_str(), agentLineNo.length()+1);
	theBufContent += agentLineNo.length()+1;
	
	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_CallReleased_WpAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += userLineNo.length()+1;
	memSize += agentLineNo.length()+1;

	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

SIPCCMsg_Gateway_CallAgentConf::SIPCCMsg_Gateway_CallAgentConf()
{
	msgType = Type_Gateway_CallAgentConf;
	
	bCallFailed = 0;
	originAgentIp = 0;
	originAgentPort = 0;
	calledAgentLineIp = 0;
	calledAgentLinePort = 0;
}

void SIPCCMsg_Gateway_CallAgentConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallAgentConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bCallFailed", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->bCallFailed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	invokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeID.length()+1;

	calledNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsg, "calledNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(calledNo.length(), CALLEDNO_LEN, strMsg, "calledNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += calledNo.length()+1;

	originAgentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+originAgentID.length()+1, msgsize, strMsg, "originAgentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(originAgentID.length(), AGENTID_LEN, strMsg, "originAgentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += originAgentID.length()+1;

	CalledAgentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CalledAgentID.length()+1, msgsize, strMsg, "CalledAgentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(CalledAgentID.length(), AGENTID_LEN, strMsg, "CalledAgentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += CalledAgentID.length()+1;

	originAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+originAgentLineNo.length()+1, msgsize, strMsg, "originAgentLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(originAgentLineNo.length(), AGENTLINENO_LEN, strMsg, "originAgentLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += originAgentLineNo.length()+1;

	calledAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledAgentLineNo.length()+1, msgsize, strMsg, "calledAgentLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(calledAgentLineNo.length(), AGENTLINENO_LEN, strMsg, "calledAgentLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += calledAgentLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "originAgentIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->originAgentIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "originAgentPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->originAgentPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "calledAgentLineIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->calledAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "calledAgentLinePort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->calledAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;
}

int SIPCCMsg_Gateway_CallAgentConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->bCallFailed, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;
	
	memcpy(thebuf+theBufContent, originAgentID.c_str(), originAgentID.length()+1);
	theBufContent += originAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, CalledAgentID.c_str(), CalledAgentID.length()+1);
	theBufContent += CalledAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, originAgentLineNo.c_str(), originAgentLineNo.length()+1);
	theBufContent += originAgentLineNo.length()+1;
	
	memcpy(thebuf+theBufContent, calledAgentLineNo.c_str(), calledAgentLineNo.length()+1);
	theBufContent += calledAgentLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->originAgentIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->originAgentPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->calledAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->calledAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_CallAgentConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += invokeID.length()+1;
	memSize += calledNo.length()+1;
	memSize += originAgentID.length()+1;
	memSize += CalledAgentID.length()+1;
	memSize += originAgentLineNo.length()+1;
	memSize += calledAgentLineNo.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;
	
	return memSize;
}

SIPCCMsg_ACD_RingWpAgentExtFailed::SIPCCMsg_ACD_RingWpAgentExtFailed()
{
	msgType = Type_ACD_RingWpAgentExtFailed;
}

void SIPCCMsg_ACD_RingWpAgentExtFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
}

int SIPCCMsg_ACD_RingWpAgentExtFailed::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	return theBufContent;
}

int SIPCCMsg_ACD_RingWpAgentExtFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	return memSize;
}

SIPCCMsg_Gateway_CallAgentFailed::SIPCCMsg_Gateway_CallAgentFailed()
{
	msgType = Type_Gateway_CallAgentFailed;
	
	bCallFailed = 0;
	originAgentIp = 0;
	originAgentPort = 0;
	calledAgentLineIp = 0;
	calledAgentLinePort = 0;
	failedCause = 0;
}

void SIPCCMsg_Gateway_CallAgentFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallAgentFailed";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->bCallFailed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	calledNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledNo.length()+1, msgsize, strMsg, "calledNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(calledNo.length(), CALLEDNO_LEN, strMsg, "calledNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += calledNo.length()+1;

	originAgentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+originAgentID.length()+1, msgsize, strMsg, "originAgentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(originAgentID.length(), AGENTID_LEN, strMsg, "originAgentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += originAgentID.length()+1;

	CalledAgentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CalledAgentID.length()+1, msgsize, strMsg, "CalledAgentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(CalledAgentID.length(), AGENTID_LEN, strMsg, "CalledAgentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += CalledAgentID.length()+1;

	originAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+originAgentLineNo.length()+1, msgsize, strMsg, "originAgentLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(originAgentLineNo.length(), AGENTLINENO_LEN, strMsg, "originAgentLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += originAgentLineNo.length()+1;

	calledAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+calledAgentLineNo.length()+1, msgsize, strMsg, "calledAgentLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(calledAgentLineNo.length(), AGENTLINENO_LEN, strMsg, "calledAgentLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += calledAgentLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "originAgentIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->originAgentIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "originAgentPort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->originAgentPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "calledAgentLineIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->calledAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "calledAgentLinePort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->calledAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "failedCause", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->failedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_CallAgentFailed::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->bCallFailed, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;
	
	memcpy(thebuf+theBufContent, originAgentID.c_str(), originAgentID.length()+1);
	theBufContent += originAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, CalledAgentID.c_str(), CalledAgentID.length()+1);
	theBufContent += CalledAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, originAgentLineNo.c_str(), originAgentLineNo.length()+1);
	theBufContent += originAgentLineNo.length()+1;
	
	memcpy(thebuf+theBufContent, calledAgentLineNo.c_str(), calledAgentLineNo.length()+1);
	theBufContent += calledAgentLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->originAgentIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->originAgentPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->calledAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->calledAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->failedCause, sizeof(int));
	theBufContent += sizeof(int);

	//managerId
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_CallAgentFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);	
	memSize += calledNo.length()+1;
	memSize += originAgentID.length()+1;
	memSize += CalledAgentID.length()+1;
	memSize += originAgentLineNo.length()+1;
	memSize += calledAgentLineNo.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);	

	memSize += managerId.length()+1;		//managerId
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

SIPCCMsg_ACD_CallWpAgentConf::SIPCCMsg_ACD_CallWpAgentConf()
{
	msgType = Type_ACD_CallWpAgentConf;
	
	bCallFailed = 0;
	wpAgentLineIp = 0;
	wpAgentLinePort = 0;
	lanIp = 0;
}

void SIPCCMsg_ACD_CallWpAgentConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->bCallFailed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
	
	wpAgentID = thebuf + theBufContent;
	theBufContent += wpAgentID.length()+1;
	
	wpAgentLineNo = thebuf + theBufContent;
	theBufContent += wpAgentLineNo.length()+1;
	
	memmove(&this->wpAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&this->wpAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(&this->lanIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_ACD_CallWpAgentConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->bCallFailed, sizeof(char));
	theBufContent += sizeof(char);
	
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	memcpy(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, wpAgentLineNo.c_str(), wpAgentLineNo.length()+1);
	theBufContent += wpAgentLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->wpAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->wpAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memmove(thebuf+theBufContent, &this->lanIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	return theBufContent;
}

int SIPCCMsg_ACD_CallWpAgentConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += invokeID.length()+1;
	memSize += wpAgentID.length()+1;
	memSize += wpAgentLineNo.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	
	return memSize;
}

SIPCCMsg_ACD_TransferCall_WpAgent::SIPCCMsg_ACD_TransferCall_WpAgent()
{
	msgType = Type_ACD_TransferCall_WpAgent;
	presideAgent = NULL;
	presideAgentLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	
	otherPartyType = CallParty_UnKnown;
}

void SIPCCMsg_ACD_TransferCall_WpAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//presideAgentLen
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(&this->otherPartyType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	wpAgentID = thebuf + theBufContent;
	theBufContent += wpAgentID.length()+1;
	
	wpAgentLineNo = thebuf + theBufContent;
	theBufContent += wpAgentLineNo.length()+1;
}

int SIPCCMsg_ACD_TransferCall_WpAgent::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, wpAgentLineNo.c_str(), wpAgentLineNo.length()+1);
	theBufContent += wpAgentLineNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_TransferCall_WpAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	
	memSize += sizeof(int);				//otherPartyType
	
	memSize += wpAgentID.length()+1;
	memSize += wpAgentLineNo.length()+1;
	
	return memSize;
}

void SIPCCMsg_ACD_TransferCall_WpAgent::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_ACD_TransferCall_WpAgent::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

SIPCCMsg_ACD_BeforeTransferCall_WpAgent::SIPCCMsg_ACD_BeforeTransferCall_WpAgent()
{
	msgType = Type_ACD_BeforeTransferCall_WpAgent;
	presideAgent = NULL;
	presideAgentLen = 0;
	otherParty = NULL;
	otherPartyLen = 0;
	
	otherPartyType = CallParty_UnKnown;
}

void SIPCCMsg_ACD_BeforeTransferCall_WpAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//presideAgentLen
	memmove(&this->presideAgentLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memmove(presideAgent, 	thebuf+theBufContent, presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(&this->otherPartyLen, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	otherParty = new char[otherPartyLen];
	memset(otherParty, 0, otherPartyLen);
	memmove(otherParty, 	thebuf+theBufContent, otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(&this->otherPartyType, 	thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	wpAgentID = thebuf + theBufContent;
	theBufContent += wpAgentID.length()+1;
	
	wpAgentLineNo = thebuf + theBufContent;
	theBufContent += wpAgentLineNo.length()+1;
}

int SIPCCMsg_ACD_BeforeTransferCall_WpAgent::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//presideAgentLen
	memmove(thebuf+theBufContent, &this->presideAgentLen, sizeof(int));
	theBufContent += sizeof(int);
	//presideAgent
	memmove(thebuf+theBufContent, this->presideAgent, this->presideAgentLen);
	theBufContent += presideAgentLen;
	
	//otherPartyLen
	memmove(thebuf+theBufContent, &this->otherPartyLen, sizeof(int));
	theBufContent += sizeof(int);
	//otherParty
	memmove(thebuf+theBufContent, this->otherParty, this->otherPartyLen);
	theBufContent += otherPartyLen;
	
	//otherPartyType
	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;
	
	memcpy(thebuf+theBufContent, wpAgentLineNo.c_str(), wpAgentLineNo.length()+1);
	theBufContent += wpAgentLineNo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_BeforeTransferCall_WpAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//presideAgentLen
	memSize += this->presideAgentLen;	//presideAgent
	memSize += sizeof(int);				//otherPartyLen
	memSize += this->otherPartyLen;		//otherParty
	
	memSize += sizeof(int);				//otherPartyType
	
	memSize += wpAgentID.length()+1;
	memSize += wpAgentLineNo.length()+1;
	
	return memSize;
}

void SIPCCMsg_ACD_BeforeTransferCall_WpAgent::SetPresideAgent(string presideagent)
{
	int iAgentLen = presideagent.length();
	this->presideAgentLen = iAgentLen + 1;
	this->presideAgent = new char[presideAgentLen];
	memset(presideAgent, 0, presideAgentLen);
	memcpy(presideAgent, presideagent.c_str(), iAgentLen);
}

void SIPCCMsg_ACD_BeforeTransferCall_WpAgent::SetOtherParty(string otherParty)
{
	int iOtherPartyLen = otherParty.length();
	this->otherPartyLen = iOtherPartyLen + 1;
	this->otherParty = new char[otherPartyLen];
	memset(this->otherParty, 0, otherPartyLen);
	memcpy(this->otherParty, otherParty.c_str(), iOtherPartyLen);
}

SIPCCMsg_ACD_CallWpAgentExtFailed::SIPCCMsg_ACD_CallWpAgentExtFailed()
{
	msgType = Type_ACD_CallWpAgentExtFailed;
}

void SIPCCMsg_ACD_CallWpAgentExtFailed::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	wpAgentID = thebuf + theBufContent;
	theBufContent += wpAgentID.length()+1;
}

int SIPCCMsg_ACD_CallWpAgentExtFailed::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, wpAgentID.c_str(), wpAgentID.length()+1);
	theBufContent += wpAgentID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_CallWpAgentExtFailed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += wpAgentID.length()+1;
	
	return memSize;
}

SIPCCMsg_PhoneSearch_QueryTestKeyword::SIPCCMsg_PhoneSearch_QueryTestKeyword()
{
	msgType = Type_PhoneSearch_QueryTestKeyword;
}

void SIPCCMsg_PhoneSearch_QueryTestKeyword::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_QueryTestKeyword";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerSign = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerSign.length()+1, msgsize, strMsgName, "managerSign", ip, port)) ) {return;}
	if ( !(VerifyData(managerSign.length(), MANAGERSIGN_LEN, strMsgName, "managerSign", ip, port)) ) {return;}
	theBufContent += managerSign.length()+1;
	
	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsgName, "invokeId", ip, port)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsgName, "invokeId", ip, port)) ) {return;}
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryTestKeyword::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerSign.c_str(), managerSign.length()+1);
	theBufContent += managerSign.length()+1;
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryTestKeyword::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += managerSign.length()+1;
	memSize += invokeId.length()+1;
	
	return memSize;
}

SIPCCMsg_PhoneSearch_QueryTestKeywordConf::SIPCCMsg_PhoneSearch_QueryTestKeywordConf()
{
	msgType = Type_PhoneSearch_QueryTestKeywordConf;
}

void SIPCCMsg_PhoneSearch_QueryTestKeywordConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	testKeyWord = thebuf + theBufContent;
	theBufContent += testKeyWord.length()+1;
	
	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryTestKeywordConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, testKeyWord.c_str(), testKeyWord.length()+1);
	theBufContent += testKeyWord.length()+1;
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryTestKeywordConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += testKeyWord.length()+1;
	memSize += invokeId.length()+1;
	
	return memSize;
}

SIPCCMsg_Gateway_CallCleared::SIPCCMsg_Gateway_CallCleared()
{
	msgType = Type_Gateway_CallCleared;
}

void SIPCCMsg_Gateway_CallCleared::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallCleared";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	userLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+userLineNo.length()+1, msgsize, strMsg, "userLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(userLineNo.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += userLineNo.length()+1;

	agentid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentid.length()+1, msgsize, strMsg, "agentid.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentid.length(), AGENTID_LEN, strMsg, "agentid", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentid.length()+1;
}

int SIPCCMsg_Gateway_CallCleared::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, userLineNo.c_str(), userLineNo.length()+1);
	theBufContent += userLineNo.length()+1;
	
	memcpy(thebuf+theBufContent, agentid.c_str(), agentid.length()+1);
	theBufContent += agentid.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_CallCleared::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += userLineNo.length()+1;
	memSize += agentid.length()+1;
	
	return memSize;
}

///Type_UState_EchoRemoveCtrl
SIPCCMsg_UState_EchoRemoveCtrl::SIPCCMsg_UState_EchoRemoveCtrl()
{
	msgType = Type_UState_EchoRemoveCtrl;
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_EchoRemoveCtrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	gwLineNo = thebuf + theBufContent;
	theBufContent += gwLineNo.length()+1;
	
	memmove(&this->allow, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

	
}

int SIPCCMsg_UState_EchoRemoveCtrl::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, gwLineNo.c_str(), gwLineNo.length()+1);
	theBufContent += gwLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->allow, sizeof(char));
	theBufContent += sizeof(char);

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_UState_EchoRemoveCtrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += gwLineNo.length()+1;		//invokeID
	memSize += sizeof(char);			//blacklistNo
	

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	return memSize;
}

///Type_Client_EchoRemoveCtrl
SIPCCMsg_Client_EchoRemoveCtrl::SIPCCMsg_Client_EchoRemoveCtrl()
{
	msgType = Type_Client_EchoRemoveCtrl;
}

void SIPCCMsg_Client_EchoRemoveCtrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_EchoRemoveCtrl", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	gwLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwLineNo.length()+1, msgsize, "SIPCCMsg_Client_EchoRemoveCtrl", "gwLineNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwLineNo.length(), USERLINENO_LEN, "SIPCCMsg_Client_EchoRemoveCtrl", "gwLineNo", ip, port)) ) {return;}
	theBufContent += gwLineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, "SIPCCMsg_Client_EchoRemoveCtrl", "allow", ip, port)) ) {return;}
	memmove(&this->allow, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_Client_EchoRemoveCtrl::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, gwLineNo.c_str(), gwLineNo.length()+1);
	theBufContent += gwLineNo.length()+1;
	
	memmove(thebuf+theBufContent, &this->allow, sizeof(char));
	theBufContent += sizeof(char);
	
	return theBufContent;
}

int SIPCCMsg_Client_EchoRemoveCtrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += gwLineNo.length()+1;		//invokeID
	memSize += sizeof(char);			//blacklistNo
	
	return memSize;
}

SIPCCMsg_PhoneSearch_QueryManagerId::SIPCCMsg_PhoneSearch_QueryManagerId()
{
	msgType = Type_PhoneSearch_QueryManagerId;
}

void SIPCCMsg_PhoneSearch_QueryManagerId::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_QueryManagerId";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerSign = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerSign.length()+1, msgsize, strMsgName, "managerSign", ip, port)) ) {return;}
	if ( !(VerifyData(managerSign.length(), MANAGERSIGN_LEN, strMsgName, "managerSign", ip, port)) ) {return;}
	theBufContent += managerSign.length()+1;
	
	telephone_Real = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+telephone_Real.length()+1, msgsize, strMsgName, "telephone_Real", ip, port)) ) {return;}
	if ( !(VerifyData(telephone_Real.length(), PHONENO_LEN, strMsgName, "telephone_Real", ip, port)) ) {return;}
	theBufContent += telephone_Real.length()+1;
	
	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsgName, "invokeId", ip, port)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsgName, "invokeId", ip, port)) ) {return;}
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryManagerId::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerSign.c_str(), managerSign.length()+1);
	theBufContent += managerSign.length()+1;
	
	memcpy(thebuf+theBufContent, telephone_Real.c_str(), telephone_Real.length()+1);
	theBufContent += telephone_Real.length()+1;
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryManagerId::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += managerSign.length()+1;
	memSize += telephone_Real.length()+1;
	memSize += invokeId.length()+1;
	
	return memSize;
}

SIPCCMsg_PhoneSearch_QueryManagerIdConf::SIPCCMsg_PhoneSearch_QueryManagerIdConf()
{
	msgType = Type_PhoneSearch_QueryManagerIdConf;
}

void SIPCCMsg_PhoneSearch_QueryManagerIdConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;
	
	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryManagerIdConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryManagerIdConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += managerId.length()+1;
	memSize += invokeId.length()+1;
	
	return memSize;
}

//////////////////////////////////////////////////////////////////////////
///Class_DataRoute
void SIPCCMsg_DataRoute_QueryTransServerConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->bQuerySucc, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
	
	memmove(&this->dataTransIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&this->dataTransPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_DataRoute_QueryTransServerConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->bQuerySucc, sizeof(char));
	theBufContent += sizeof(char);
	
	memmove(thebuf+theBufContent, &this->dataTransIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->dataTransPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_DataRoute_QueryTransServerConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += sizeof(char);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	
	return memSize;
}

//////////////////////////////////////////////////////////////////////////
///Class_DataTrans
///Type_DataTrans_Register
void SIPCCMsg_DataTrans_Register::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->dataTransIP, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&this->type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->capacity, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
}

int SIPCCMsg_DataTrans_Register::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->dataTransIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->type, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->capacity, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_DataTrans_Register::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += sizeof(unsigned long);
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	return memSize;
}

///Type_DataTrans_UnRegister
void SIPCCMsg_DataTrans_UnRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->dataTransIP, 	thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_DataTrans_UnRegister::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->dataTransIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	return theBufContent;
}

int SIPCCMsg_DataTrans_UnRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += sizeof(unsigned long);
	
	return memSize;
}

SIPCCMsg_DataTrans_StartTrans::SIPCCMsg_DataTrans_StartTrans()
{
	msgType = Type_DataTrans_StartTrans;
	
	gwLineIp = 0;
	gwLinePort = 0;
}

void SIPCCMsg_DataTrans_StartTrans::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;
	
	memmove(&this->gwLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(&this->gwLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_DataTrans_StartTrans::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length()+1);
	theBufContent += agentId.length()+1;
	
	memmove(thebuf+theBufContent, &this->gwLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	
	memmove(thebuf+theBufContent, &this->gwLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_DataTrans_StartTrans::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentId.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	
	return memSize;
}

SIPCCMsg_DataTrans_StartTransConf::SIPCCMsg_DataTrans_StartTransConf()
{
	msgType = Type_DataTrans_StartTransConf;
	
	channelIndex = -1;
	port = 0;
}

void SIPCCMsg_DataTrans_StartTransConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->channelIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_DataTrans_StartTransConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->channelIndex, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	return theBufContent;
}

int SIPCCMsg_DataTrans_StartTransConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(unsigned short);
	
	return memSize;
}

SIPCCMsg_DataTrans_StopTrans::SIPCCMsg_DataTrans_StopTrans()
{
	msgType = Type_DataTrans_StopTrans;
	
	channelIndex = -1;
}

void SIPCCMsg_DataTrans_StopTrans::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->channelIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_DataTrans_StopTrans::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->channelIndex, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_DataTrans_StopTrans::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	
	return memSize;
}

SIPCCMsg_Client_GetTalkingAgent::SIPCCMsg_Client_GetTalkingAgent()
{
	msgType = Type_Client_GetTalkingAgent;
	Group = "";
	invokeID = "";
}

void SIPCCMsg_Client_GetTalkingAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_GetTalkingAgent";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	Group = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+Group.length()+1, msgsize, strMsg, "Group.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(Group.length(), GROUP_LEN, strMsg, "Group", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += Group.length()+1;

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeID.length()+1, msgsize, strMsg, "invokeID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeID.length(), INVOKEID_LEN, strMsg, "invokeID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_GetTalkingAgent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, Group.c_str(), Group.length()+1);
	theBufContent += Group.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Client_GetTalkingAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += Group.length()+1;
	memSize += invokeID.length()+1;		//invokeID

	return memSize;
}

SIPCCMsg_ACD_GetTalkingAgentConf::SIPCCMsg_ACD_GetTalkingAgentConf()
{
	msgType = Type_ACD_GetTalkingAgentConf;
	bEnd = 0;
	invokeID = "";
}

void SIPCCMsg_ACD_GetTalkingAgentConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	theList = thebuf + theBufContent;
	theBufContent += theList.length()+1;
	
	if(theBufContent >= msgsize)
		return;

	//bEnd
	memmove(&bEnd, 	thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_ACD_GetTalkingAgentConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, theList.c_str(), theList.length()+1);
	theBufContent += theList.length()+1;

	//bEnd
	memmove(thebuf+theBufContent, &bEnd, sizeof(char));
	theBufContent += sizeof(char);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_GetTalkingAgentConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += theList.length()+1;
	memSize += sizeof(char);			//bEnd
	memSize += invokeID.length()+1;		//invokeID
	
	return memSize;
}

SIPCCMsg_Client_MonitRequest::SIPCCMsg_Client_MonitRequest()
{
	msgType = Type_Client_MonitRequest;
	
	ip = 0;
	port = 0;
}

void SIPCCMsg_Client_MonitRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_MonitRequest";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "ip", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->ip, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "port", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	agentName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentName.length()+1, msgsize, strMsg, "agentName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentName.length(), AGENTNAME_LEN, strMsg, "agentName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	agentName_Src = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentName_Src.length()+1, msgsize, strMsg, "agentName_Src.length()", ip, port, g_bIsACDServer, agentName)) ) {return;}
	if ( !(VerifyData(agentName_Src.length(), AGENTNAMESRC_LEN, strMsg, "agentName_Src", ip, port, g_bIsACDServer, agentName)) ) {return;}
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentName_Dest.length()+1, msgsize, strMsg, "agentName_Dest.length()", ip, port, g_bIsACDServer, agentName)) ) {return;}
	if ( !(VerifyData(agentName_Dest.length(), AGENTNAMEDEST_LEN, strMsg, "agentName_Dest", ip, port, g_bIsACDServer, agentName)) ) {return;}
	theBufContent += agentName_Dest.length()+1;
}

int SIPCCMsg_Client_MonitRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->ip, sizeof(unsigned long));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;
	
	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_MonitRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += agentName.length()+1;
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	
	return memSize;
}

SIPCCMsg_Client_MonitRequestConf::SIPCCMsg_Client_MonitRequestConf()
{
	msgType = Type_Client_MonitRequestConf;
	
	bAllow = 0;
	bSucc = 0;
}

void SIPCCMsg_Client_MonitRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->bAllow, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if (theBufContent >= msgsize)
	{
		return;
	}

	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;

	memmove(&this->bSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	CallId = thebuf + theBufContent;
	theBufContent += CallId.length()+1;
}

int SIPCCMsg_Client_MonitRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->bAllow, sizeof(char));
	theBufContent += sizeof(char);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	memmove(thebuf+theBufContent, &this->bSucc, sizeof(char));
	theBufContent += sizeof(char);

	memcpy(thebuf+theBufContent, CallId.c_str(), CallId.length()+1);
	theBufContent += CallId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_MonitRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	memSize += sizeof(char);
	memSize += CallId.length()+1;
	
	return memSize;
}

// begin---libh 2007/12/28
// Type_Gateway_GetDeptQueueNum
SIPCCMsg_Gateway_GetDeptQueueNum::SIPCCMsg_Gateway_GetDeptQueueNum()
{
	msgType = Type_Gateway_GetDeptQueueNum;
	invokeId="";
	m_ssDeptName="";
}

void SIPCCMsg_Gateway_GetDeptQueueNum::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_GetDeptQueueNum";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsg, "invokeId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsg, "invokeId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeId.length()+1;

	m_ssDeptName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssDeptName.length()+1, msgsize, strMsg, "m_ssDeptName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssDeptName.length(), CORPNDEPT_LEN, strMsg, "m_ssDeptName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssDeptName.length()+1;

	m_ssCorpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssCorpName.length()+1, msgsize, strMsg, "m_ssCorpName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssCorpName.length(), CORPNAME_LEN, strMsg, "m_ssCorpName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssCorpName.length()+1;

	/*	if ( theBufContent >= msgsize )
	{
	return;
}*/

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_GetDeptQueueNum::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1);
	theBufContent += invokeId.length() + 1;
	memcpy(thebuf+theBufContent, m_ssDeptName.c_str(), m_ssDeptName.length() + 1);
	theBufContent += m_ssDeptName.length() + 1;
	memcpy(thebuf+theBufContent, m_ssCorpName.c_str(), m_ssCorpName.length() + 1);
	theBufContent += m_ssCorpName.length() + 1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_GetDeptQueueNum::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += m_ssDeptName.length()+1;	//m_ssDeptName
	memSize += m_ssCorpName.length()+1;
	
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}
// Type_ACD_GetDeptQueueNumConf
SIPCCMsg_ACD_GetDeptQueueNumConf::SIPCCMsg_ACD_GetDeptQueueNumConf()
{
	msgType = Type_ACD_GetDeptQueueNumConf;
	invokeId="";
	m_ssDeptName="";
	m_uCount=0;
}

void SIPCCMsg_ACD_GetDeptQueueNumConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_GetDeptQueueNumConf";
	
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeId= thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
	m_ssDeptName = thebuf + theBufContent;
	theBufContent += m_ssDeptName.length()+1;
	memcpy(&m_uCount, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	/*	if ( theBufContent >= msgsize )
	{
	return;
}*/

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_GetDeptQueueNumConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1);
	theBufContent += invokeId.length() + 1;
	memcpy(thebuf+theBufContent, m_ssDeptName.c_str(), m_ssDeptName.length() + 1);
	theBufContent += m_ssDeptName.length() + 1;
	
	memcpy(thebuf+theBufContent, &m_uCount, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_GetDeptQueueNumConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;	
	memSize += m_ssDeptName.length()+1;	//m_ssDeptName
	memSize += sizeof(unsigned short);

	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

// Type_Gateway_GetAgentState
SIPCCMsg_Gateway_GetAgentState::SIPCCMsg_Gateway_GetAgentState()
{
	msgType = Type_Gateway_GetAgentState;
	invokeId="";
	m_ssAgentName="";
}

void SIPCCMsg_Gateway_GetAgentState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_GetAgentState";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsg, "invokeId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsg, "invokeId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeId.length()+1;

	m_ssAgentName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssAgentName.length()+1, msgsize, strMsg, "m_ssAgentName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssAgentName.length(), AGENTNAME_LEN, strMsg, "m_ssAgentName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssAgentName.length()+1;
	/*	if ( theBufContent >= msgsize )
	{
	return;
}*/

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_GetAgentState::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1);
	theBufContent += invokeId.length() + 1;
	memcpy(thebuf+theBufContent, m_ssAgentName.c_str(), m_ssAgentName.length() + 1);
	theBufContent += m_ssAgentName.length() + 1;
	
	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_GetAgentState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;	
	memSize += m_ssAgentName.length()+1;	//
	
	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

// Type_ACD_GetAgentStateConf
SIPCCMsg_ACD_GetAgentStateConf::SIPCCMsg_ACD_GetAgentStateConf()
{
	msgType = Type_ACD_GetAgentStateConf;
	invokeId="";
	m_ssAgentName="";
	m_ssState="";
}

void SIPCCMsg_ACD_GetAgentStateConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_GetAgentStateConf";

	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeId=thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
	m_ssAgentName = thebuf + theBufContent;
	theBufContent += m_ssAgentName.length()+1;
	m_ssState = thebuf + theBufContent;
	theBufContent += m_ssState.length()+1;
	/*	if ( theBufContent >= msgsize )
	{
	return;
}*/

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_GetAgentStateConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1);
	theBufContent += invokeId.length() + 1;
	
	memcpy(thebuf+theBufContent, m_ssAgentName.c_str(), m_ssAgentName.length() + 1);
	theBufContent += m_ssAgentName.length() + 1;
	
	memcpy(thebuf+theBufContent, m_ssState.c_str(), m_ssState.length() + 1);
	theBufContent += m_ssState.length() + 1;
	
	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_GetAgentStateConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += m_ssAgentName.length()+1;	//
	memSize += m_ssState.length()+1;	//

	memSize += handleId.length()+1;			//handleId
	
	return memSize;
}

// end---libh 2007/12/28
//////////////////////////////////////////////////////////////////////////
/// Class_Alert

SIPCCMsg_Alert_NotifyInfo::SIPCCMsg_Alert_NotifyInfo()
{
	msgType = Type_Alert_NotifyInfo;
	notifyType = AlertType_Record_HardDisk;
	notifyDescription ="";
	notifyMode = AlertMode_Telephone;
	notifyInfo = "";
}

void SIPCCMsg_Alert_NotifyInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->notifyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	notifyDescription = thebuf + theBufContent;
	theBufContent += notifyDescription.length()+1;
	
	memmove(&this->notifyMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	notifyInfo = thebuf + theBufContent;
	theBufContent += notifyInfo.length()+1;
	
}

int SIPCCMsg_Alert_NotifyInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->notifyType, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, notifyDescription.c_str(), notifyDescription.length()+1);
	theBufContent += notifyDescription.length()+1;
	
	memmove(thebuf+theBufContent, &this->notifyMode, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, notifyInfo.c_str(), notifyInfo.length()+1);
	theBufContent += notifyInfo.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Alert_NotifyInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);	
	memSize += notifyDescription.length()+1;	//
	memSize += sizeof(int);	
	memSize += notifyInfo.length()+1;	//
	
	return memSize;
}

///Type_Gateway_GetGetwayInfo
SIPCCMsg_Gateway_GetGetwayInfo::SIPCCMsg_Gateway_GetGetwayInfo()
{
	msgType = Type_Gateway_GetGetwayInfo;
}

void SIPCCMsg_Gateway_GetGetwayInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

}

int SIPCCMsg_Gateway_GetGetwayInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	return theBufContent;
}

int SIPCCMsg_Gateway_GetGetwayInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	return memSize;
}

///Type_Gateway_GetGetwayInfoConf
SIPCCMsg_Gateway_GetGetwayInfoConf::SIPCCMsg_Gateway_GetGetwayInfoConf()
{
	msgType = Type_Gateway_GetGetwayInfoConf;
}

void SIPCCMsg_Gateway_GetGetwayInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	GetwayInfoString = thebuf+theBufContent;
	theBufContent += GetwayInfoString.length()+1;
}

int SIPCCMsg_Gateway_GetGetwayInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, GetwayInfoString.c_str(), GetwayInfoString.length()+1);
	theBufContent += GetwayInfoString.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_GetGetwayInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += GetwayInfoString.length()+1;

	return memSize;
}

///Type_Gateway_AddRecordForTH
SIPCCMsg_Gateway_AddRecordForTH::SIPCCMsg_Gateway_AddRecordForTH()
{
	msgType = Type_Gateway_AddRecordForTH;
}

void SIPCCMsg_Gateway_AddRecordForTH::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	phoneNo = thebuf+theBufContent;
	theBufContent += phoneNo.length()+1;
}

int SIPCCMsg_Gateway_AddRecordForTH::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, phoneNo.c_str(), phoneNo.length()+1);
	theBufContent += phoneNo.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_AddRecordForTH::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += phoneNo.length()+1;

	return memSize;
}

///Type_Gateway_DelRecordForTH
SIPCCMsg_Gateway_DelRecordForTH::SIPCCMsg_Gateway_DelRecordForTH()
{
	msgType = Type_Gateway_DelRecordForTH;
}

void SIPCCMsg_Gateway_DelRecordForTH::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	phoneNo = thebuf+theBufContent;
	theBufContent += phoneNo.length()+1;
}

int SIPCCMsg_Gateway_DelRecordForTH::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, phoneNo.c_str(), phoneNo.length()+1);
	theBufContent += phoneNo.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_DelRecordForTH::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += phoneNo.length()+1;

	return memSize;
}

///Type_Gateway_DelAllRecordForTH
SIPCCMsg_Gateway_DelAllRecordForTH::SIPCCMsg_Gateway_DelAllRecordForTH()
{
	msgType = Type_Gateway_DelAllRecordForTH;
}

void SIPCCMsg_Gateway_DelAllRecordForTH::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_Gateway_DelAllRecordForTH::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	return theBufContent;
}

int SIPCCMsg_Gateway_DelAllRecordForTH::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	return memSize;
}

SIPCCMsg_ACD_MonitRequest::SIPCCMsg_ACD_MonitRequest()
{
	msgType = Type_ACD_MonitRequest;
}

void SIPCCMsg_ACD_MonitRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;

	trunkDn = thebuf + theBufContent;
	theBufContent += trunkDn.length()+1;
}

int SIPCCMsg_ACD_MonitRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	memcpy(thebuf+theBufContent, trunkDn.c_str(), trunkDn.length()+1);
	theBufContent += trunkDn.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_MonitRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	memSize += trunkDn.length()+1;

	return memSize;
}

SIPCCMsg_ACD_MonitRequestConf::SIPCCMsg_ACD_MonitRequestConf()
{
	msgType = Type_ACD_MonitRequestConf;

	bSucc = 0;
	ip = 0;
	port = 0;
}

void SIPCCMsg_ACD_MonitRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;

	memmove(&this->bSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	trunkDn = thebuf + theBufContent;
	theBufContent += trunkDn.length()+1;

	CallId = thebuf + theBufContent;
	theBufContent += CallId.length()+1;

	memmove(&this->ip, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&this->port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_ACD_MonitRequestConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	memmove(thebuf+theBufContent, &this->bSucc, sizeof(char));
	theBufContent += sizeof(char);

	memcpy(thebuf+theBufContent, trunkDn.c_str(), trunkDn.length()+1);
	theBufContent += trunkDn.length()+1;

	memcpy(thebuf+theBufContent, CallId.c_str(), CallId.length()+1);
	theBufContent += CallId.length()+1;

	memmove(thebuf+theBufContent, &this->ip, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_ACD_MonitRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	//memSize += sizeof(char);			// [scq/2010-07-05]
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	memSize += sizeof(char);
	memSize += trunkDn.length()+1;		// [scq/2010-07-05]
	memSize += CallId.length()+1;
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);

	return memSize;
}

SIPCCMsg_Client_MediaRequest_Monit::SIPCCMsg_Client_MediaRequest_Monit()
{
	msgType = Type_Client_MediaRequest_Monit;

	seq = 0;
}

void SIPCCMsg_Client_MediaRequest_Monit::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;

	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_MediaRequest_Monit::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Client_MediaRequest_Monit::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_ACD_MediaRequest_Monit::SIPCCMsg_ACD_MediaRequest_Monit()
{
	msgType = Type_ACD_MediaRequest_Monit;

	seq = 0;
}

void SIPCCMsg_ACD_MediaRequest_Monit::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;

	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_MediaRequest_Monit::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_ACD_MediaRequest_Monit::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_Client_MediaReady_Monit::SIPCCMsg_Client_MediaReady_Monit()
{
	msgType = Type_Client_MediaReady_Monit;
}

void SIPCCMsg_Client_MediaReady_Monit::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_MediaReady_Monit";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName_Src = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentName_Src.length()+1, msgsize, strMsg, "agentName_Src.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentName_Src.length(), AGENTNAMESRC_LEN, strMsg, "agentName_Src", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentName_Dest.length()+1, msgsize, strMsg, "agentName_Dest.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentName_Dest.length(), AGENTNAMEDEST_LEN, strMsg, "agentName_Dest", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentName_Dest.length()+1;
}

int SIPCCMsg_Client_MediaReady_Monit::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_MediaReady_Monit::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;

	return memSize;
}

SIPCCMsg_ACD_MediaReady_Monit::SIPCCMsg_ACD_MediaReady_Monit()
{
	msgType = Type_ACD_MediaReady_Monit;
}

void SIPCCMsg_ACD_MediaReady_Monit::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;
}

int SIPCCMsg_ACD_MediaReady_Monit::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_MediaReady_Monit::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;

	return memSize;
}

SIPCCMsg_Client_StopMonit::SIPCCMsg_Client_StopMonit()
{
	msgType = Type_Client_StopMonit;
}

void SIPCCMsg_Client_StopMonit::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName = thebuf + theBufContent;
	theBufContent += agentName.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}
	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;

	trunkDn = thebuf + theBufContent;
	theBufContent += trunkDn.length()+1;
}

int SIPCCMsg_Client_StopMonit::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	memcpy(thebuf+theBufContent, trunkDn.c_str(), trunkDn.length()+1);
	theBufContent += trunkDn.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_StopMonit::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName.length()+1;
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	memSize += trunkDn.length()+1;

	return memSize;
}

SIPCCMsg_ACD_StopMonit::SIPCCMsg_ACD_StopMonit()
{
	msgType = Type_ACD_StopMonit;
}

void SIPCCMsg_ACD_StopMonit::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName_Src = thebuf + theBufContent;
	theBufContent += agentName_Src.length()+1;

	agentName_Dest = thebuf + theBufContent;
	theBufContent += agentName_Dest.length()+1;

	trunkDn = thebuf + theBufContent;
	theBufContent += trunkDn.length()+1;
}

int SIPCCMsg_ACD_StopMonit::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentName_Src.c_str(), agentName_Src.length()+1);
	theBufContent += agentName_Src.length()+1;

	memcpy(thebuf+theBufContent, agentName_Dest.c_str(), agentName_Dest.length()+1);
	theBufContent += agentName_Dest.length()+1;

	memcpy(thebuf+theBufContent, trunkDn.c_str(), trunkDn.length()+1);
	theBufContent += trunkDn.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_StopMonit::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += agentName_Src.length()+1;
	memSize += agentName_Dest.length()+1;
	memSize += trunkDn.length()+1;

	return memSize;
}

SIPCCMsg_DataRoute_QueryTransServer_IP::SIPCCMsg_DataRoute_QueryTransServer_IP()
{
	msgType = Type_DataRoute_QueryTransServer_IP;
}

void SIPCCMsg_DataRoute_QueryTransServer_IP::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	callId = thebuf + theBufContent;
	theBufContent += callId.length()+1;
}

int SIPCCMsg_DataRoute_QueryTransServer_IP::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, callId.c_str(), callId.length()+1);
	theBufContent += callId.length()+1;

	return theBufContent;
}

int SIPCCMsg_DataRoute_QueryTransServer_IP::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += callId.length()+1;

	return memSize;
}

SIPCCMsg_DataRoute_QueryTransServerConf_IP::SIPCCMsg_DataRoute_QueryTransServerConf_IP()
{
	msgType = Type_DataRoute_QueryTransServerConf_IP;

	transServerIp = 0;
	transServerPort = 0;
}

void SIPCCMsg_DataRoute_QueryTransServerConf_IP::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	callId = thebuf + theBufContent;
	theBufContent += callId.length()+1;

	memmove(&this->transServerIp, thebuf+theBufContent, sizeof(transServerIp));
	theBufContent += sizeof(transServerIp);

	memmove(&this->transServerPort, thebuf+theBufContent, sizeof(transServerPort));
	theBufContent += sizeof(transServerPort);
}

int SIPCCMsg_DataRoute_QueryTransServerConf_IP::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, callId.c_str(), callId.length()+1);
	theBufContent += callId.length()+1;

	memmove(thebuf+theBufContent, &this->transServerIp, sizeof(transServerIp));
	theBufContent += sizeof(transServerIp);

	memmove(thebuf+theBufContent, &this->transServerPort, sizeof(transServerPort));
	theBufContent += sizeof(transServerPort);

	return theBufContent;
}

int SIPCCMsg_DataRoute_QueryTransServerConf_IP::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += callId.length()+1;
	memSize += sizeof(transServerIp);
	memSize += sizeof(transServerPort);

	return memSize;
}

SIPCCMsg_DataTrans_StartTrans_IP::SIPCCMsg_DataTrans_StartTrans_IP()
{
	msgType = Type_DataTrans_StartTrans_IP;
}

void SIPCCMsg_DataTrans_StartTrans_IP::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	callId = thebuf + theBufContent;
	theBufContent += callId.length()+1;
}

int SIPCCMsg_DataTrans_StartTrans_IP::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, callId.c_str(), callId.length()+1);
	theBufContent += callId.length()+1;

	return theBufContent;
}

int SIPCCMsg_DataTrans_StartTrans_IP::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += callId.length()+1;

	return memSize;
}

SIPCCMsg_DataTrans_StartTransConf_IP::SIPCCMsg_DataTrans_StartTransConf_IP()
{
	msgType = Type_DataTrans_StartTransConf_IP;

	channelIndex = 0;
	port = 0;
}

void SIPCCMsg_DataTrans_StartTransConf_IP::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	callId = thebuf + theBufContent;
	theBufContent += callId.length()+1;

	memmove(&this->channelIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->port, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_DataTrans_StartTransConf_IP::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, callId.c_str(), callId.length()+1);
	theBufContent += callId.length()+1;

	memmove(thebuf+theBufContent, &this->channelIndex, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_DataTrans_StartTransConf_IP::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += callId.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(unsigned short);

	return memSize;
}

SIPCCMsg_DataTrans_StopTrans_IP::SIPCCMsg_DataTrans_StopTrans_IP()
{
	msgType = Type_DataTrans_StopTrans_IP;

	channelIndex = 0;
}

void SIPCCMsg_DataTrans_StopTrans_IP::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	callId = thebuf + theBufContent;
	theBufContent += callId.length()+1;

	memmove(&this->channelIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_DataTrans_StopTrans_IP::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, callId.c_str(), callId.length()+1);
	theBufContent += callId.length()+1;

	memmove(thebuf+theBufContent, &this->channelIndex, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_DataTrans_StopTrans_IP::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += callId.length()+1;
	memSize += sizeof(int);

	return memSize;
}



SIPCCMsg_Gateway_GetDeptWaitingAgentNum::SIPCCMsg_Gateway_GetDeptWaitingAgentNum()
{
	msgType = Type_Gateway_GetDeptWaitingAgentNum;
}

void SIPCCMsg_Gateway_GetDeptWaitingAgentNum::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_GetDeptWaitingAgentNum";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsg, "invokeId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsg, "invokeId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeId.length()+1;

	m_ssDeptName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssDeptName.length()+1, msgsize, strMsg, "m_ssDeptName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssDeptName.length(), CORPNDEPT_LEN, strMsg, "m_ssDeptName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssDeptName.length()+1;

	m_ssCorpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssCorpName.length()+1, msgsize, strMsg, "m_ssCorpName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssCorpName.length(), CORPNAME_LEN, strMsg, "m_ssCorpName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssCorpName.length()+1;

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_GetDeptWaitingAgentNum::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	memcpy(thebuf+theBufContent, m_ssDeptName.c_str(), m_ssDeptName.length()+1);
	theBufContent += m_ssDeptName.length()+1;

	memcpy(thebuf+theBufContent, m_ssCorpName.c_str(), m_ssCorpName.length()+1);
	theBufContent += m_ssCorpName.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_GetDeptWaitingAgentNum::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += m_ssDeptName.length()+1;
	memSize += m_ssCorpName.length()+1;

	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

SIPCCMsg_ACD_GetDeptWaitingAgentNumConf::SIPCCMsg_ACD_GetDeptWaitingAgentNumConf()
{
	msgType = Type_ACD_GetDeptWaitingAgentNumConf;

	m_uCount = 0;
}

void SIPCCMsg_ACD_GetDeptWaitingAgentNumConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_GetDeptWaitingAgentNumConf";
	
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;

	memmove(&this->m_uCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_GetDeptWaitingAgentNumConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	memmove(thebuf+theBufContent, &this->m_uCount, sizeof(int));
	theBufContent += sizeof(int);

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_GetDeptWaitingAgentNumConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += sizeof(int);

	memSize += handleId.length()+1;			//handleId

	return memSize;
}

SIPCCMsg_Client_SendDtmf::SIPCCMsg_Client_SendDtmf()
{
	msgType = Type_Client_SendDtmf;
	
	dtmf = '0';
	seq = 0;
}

void SIPCCMsg_Client_SendDtmf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->dtmf, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_SendDtmf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->dtmf, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Client_SendDtmf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(char);
	memSize += sizeof(int);
	
	return memSize;
}

///

//[SIPCCMsg_Client_ReceiveDtmf

SIPCCMsg_Client_ReceiveDtmf::SIPCCMsg_Client_ReceiveDtmf()
{
	msgType = Type_Client_ReceiveDtmf;
	
	seq = 0;
	count = 0;
}

void SIPCCMsg_Client_ReceiveDtmf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->seq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

    memmove(&this->count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_ReceiveDtmf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->seq, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->count, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Client_ReceiveDtmf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	return memSize;
}

//]SIPCCMsg_Client_ReceiveDtmf


void SIPCCMsg_Client_ChangePassword::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	username = thebuf + theBufContent;
	theBufContent += username.length()+1;

	oldpassword = thebuf + theBufContent;
	theBufContent += oldpassword.length()+1;

	newpassword = thebuf + theBufContent;
	theBufContent += newpassword.length()+1;

}

int SIPCCMsg_Client_ChangePassword::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, username.c_str(), username.length() + 1);
	theBufContent += username.length() + 1;

	memcpy(thebuf+theBufContent, oldpassword.c_str(), oldpassword.length() + 1);
	theBufContent += oldpassword.length() + 1;

	memcpy(thebuf+theBufContent, newpassword.c_str(), newpassword.length() + 1);
	theBufContent += newpassword.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Client_ChangePassword::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += username.length()+1;
	memSize += oldpassword.length()+1;
	memSize += newpassword.length()+1;
	
	return memSize;
}

//////////////////////////////////////////////////////////////////////////
SIPCCMsg_ACD_DelDepartment::SIPCCMsg_ACD_DelDepartment()
{
	msgType = Type_ACD_DelDepartment;
}

void SIPCCMsg_ACD_DelDepartment::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;
	deptName = thebuf + theBufContent;
	theBufContent += deptName.length()+1;
}

int SIPCCMsg_ACD_DelDepartment::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1);
	theBufContent += corpName.length() + 1;
	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length() + 1);
	theBufContent += deptName.length() + 1;

	return theBufContent;
}

int SIPCCMsg_ACD_DelDepartment::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += corpName.length()+1;
	memSize += deptName.length()+1;	//m_ssDeptName

	return memSize;
}

SIPCCMsg_Client_GetTrunkCount::SIPCCMsg_Client_GetTrunkCount()
{
	msgType = Type_Client_GetTrunkCount;
	invokeID = "";
}

void SIPCCMsg_Client_GetTrunkCount::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent == msgsize)
		return;

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_Client_GetTrunkCount::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//invokeID
	memmove(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_GetTrunkCount::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeID.length()+1;		//invokeID
	
	return memSize;
}

SIPCCMsg_Gateway_GetTrunkCountConf::SIPCCMsg_Gateway_GetTrunkCountConf()
{
	msgType = Type_Gateway_GetTrunkCountConf;
	
	count = 0;
	free = 0;
}

void SIPCCMsg_Gateway_GetTrunkCountConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memmove(&this->count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->free, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Gateway_GetTrunkCountConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->count, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->free, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Gateway_GetTrunkCountConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	return memSize;
}

SIPCCMsg_ACD_SetTalkSpan::SIPCCMsg_ACD_SetTalkSpan()
{
	msgType = Type_ACD_SetTalkSpan;
	
	span = 0;
	caseId = 0;
}

void SIPCCMsg_ACD_SetTalkSpan::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	dept = thebuf + theBufContent;
	theBufContent += dept.length()+1;

	memmove(&this->span, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->caseId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_ACD_SetTalkSpan::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, dept.c_str(), dept.length() + 1);
	theBufContent += dept.length() + 1;

	memmove(thebuf+theBufContent, &this->span, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->caseId, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_ACD_SetTalkSpan::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += dept.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	return memSize;
}

SIPCCMsg_ACD_SetAgentCount::SIPCCMsg_ACD_SetAgentCount()
{
	msgType = Type_ACD_SetAgentCount;
	
	count = 0;
	free = 0;
}

void SIPCCMsg_ACD_SetAgentCount::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	dept = thebuf + theBufContent;
	theBufContent += dept.length()+1;
	
	memmove(&this->count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->free, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	callLen = thebuf + theBufContent;
	theBufContent += callLen.length()+1;
}

int SIPCCMsg_ACD_SetAgentCount::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, dept.c_str(), dept.length() + 1);
	theBufContent += dept.length() + 1;
	
	memmove(thebuf+theBufContent, &this->count, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->free, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, callLen.c_str(), callLen.length() + 1);
	theBufContent += callLen.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_SetAgentCount::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += dept.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);		//msgclass+msgtype
	memSize += callLen.length()+1;
	
	
	return memSize;
}

SIPCCMsg_Client_SetOutDialResult::SIPCCMsg_Client_SetOutDialResult()
{
	msgType = Type_Client_SetOutDialResult;
	
	result = 0;
}

void SIPCCMsg_Client_SetOutDialResult::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	tag = thebuf + theBufContent;
	theBufContent += tag.length()+1;
	
	memmove(&this->result, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	dailTime = thebuf + theBufContent;
	theBufContent += dailTime.length()+1;
}

int SIPCCMsg_Client_SetOutDialResult::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, tag.c_str(), tag.length() + 1);
	theBufContent += tag.length() + 1;

	memmove(thebuf+theBufContent, &this->result, sizeof(int));
	theBufContent += sizeof(int);
	
	memcpy(thebuf+theBufContent, dailTime.c_str(), dailTime.length() + 1);
	theBufContent += dailTime.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Client_SetOutDialResult::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += tag.length()+1;
	memSize += sizeof(int);
	memSize += dailTime.length()+1;
	
	return memSize;
}

SIPCCMsg_Gateway_GetDeptOverflow::SIPCCMsg_Gateway_GetDeptOverflow()
{
	msgType = Type_Gateway_GetDeptOverflow;
}

void SIPCCMsg_Gateway_GetDeptOverflow::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_GetDeptOverflow";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsg, "invokeId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsg, "invokeId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeId.length()+1;

	m_ssDeptName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssDeptName.length()+1, msgsize, strMsg, "m_ssDeptName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssDeptName.length(), CORPNDEPT_LEN, strMsg, "m_ssDeptName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssDeptName.length()+1;

	m_ssCorpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssCorpName.length()+1, msgsize, strMsg, "m_ssCorpName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssCorpName.length(), CORPNAME_LEN, strMsg, "m_ssCorpName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssCorpName.length()+1;

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_GetDeptOverflow::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1);
	theBufContent += invokeId.length() + 1;

	memcpy(thebuf+theBufContent, m_ssDeptName.c_str(), m_ssDeptName.length() + 1);
	theBufContent += m_ssDeptName.length() + 1;

	memcpy(thebuf+theBufContent, m_ssCorpName.c_str(), m_ssCorpName.length() + 1);
	theBufContent += m_ssCorpName.length() + 1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_GetDeptOverflow::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += m_ssDeptName.length()+1;
	memSize += m_ssCorpName.length()+1;

	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

SIPCCMsg_ACD_GetDeptOverflowConf::SIPCCMsg_ACD_GetDeptOverflowConf()
{
	msgType = Type_ACD_GetDeptOverflowConf;

	timeoutValue = 0;
	overFlowDestType = 0;
}

void SIPCCMsg_ACD_GetDeptOverflowConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_GetDeptOverflowConf";

	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;

	memmove(&this->timeoutValue, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	overFlowDest = thebuf + theBufContent;
	theBufContent += overFlowDest.length()+1;

	memmove(&this->overFlowDestType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_GetDeptOverflowConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1);
	theBufContent += invokeId.length() + 1;

	memmove(thebuf+theBufContent, &this->timeoutValue, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, overFlowDest.c_str(), overFlowDest.length() + 1);
	theBufContent += overFlowDest.length() + 1;

	memmove(thebuf+theBufContent, &this->overFlowDestType, sizeof(int));
	theBufContent += sizeof(int);

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_GetDeptOverflowConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += sizeof(int);
	memSize += overFlowDest.length()+1;
	memSize += sizeof(int);

	memSize += handleId.length()+1;			//handleId

	return memSize;
}



SIPCCMsg_Client_SetOutdialCase::SIPCCMsg_Client_SetOutdialCase()
{
	msgType = Type_Client_SetOutdialCase;
	
	talkNProcessSpan = 0;
	caseId = 0;
}

void SIPCCMsg_Client_SetOutdialCase::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_SetOutdialCase";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	corp = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+corp.length()+1, msgsize, strMsg, "corp.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(corp.length(), CORPNAME_LEN, strMsg, "corp", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += corp.length()+1;

	dept = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+dept.length()+1, msgsize, strMsg, "dept.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(dept.length(), CORPNDEPT_LEN, strMsg, "dept", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += dept.length()+1;

	agent = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agent.length()+1, msgsize, strMsg, "agent.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agent.length(), AGENTID_LEN, strMsg, "agent", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agent.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "talkNProcessSpan", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->talkNProcessSpan, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "caseId", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->caseId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Client_SetOutdialCase::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memcpy(thebuf+theBufContent, corp.c_str(), corp.length() + 1);
	theBufContent += corp.length() + 1;
	
	memcpy(thebuf+theBufContent, dept.c_str(), dept.length() + 1);
	theBufContent += dept.length() + 1;
	
	memcpy(thebuf+theBufContent, agent.c_str(), agent.length() + 1);
	theBufContent += agent.length() + 1;
	
	memmove(thebuf+theBufContent, &this->talkNProcessSpan, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(thebuf+theBufContent, &this->caseId, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Client_SetOutdialCase::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += corp.length()+1;		//msgclass+msgtype
	memSize += dept.length()+1;		//msgclass+msgtype
	memSize += agent.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	
	return memSize;
}

// begin---yany 2008/11/20
SIPCCMsg_PhoneSearch_QueryDelieverNo::SIPCCMsg_PhoneSearch_QueryDelieverNo()
{
	msgType = Type_PhoneSearch_QueryDelieverNo;
}

void SIPCCMsg_PhoneSearch_QueryDelieverNo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_QueryDelieverNo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsgName, "managerId", ip, port)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsgName, "managerId", ip, port)) ) {return;}
	theBufContent += managerId.length()+1;

	computerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+computerSymbol.length()+1, msgsize, strMsgName, "computerSymbol", ip, port)) ) {return;}
	if ( !(VerifyData(computerSymbol.length(), COMSYMBOL_LEN, strMsgName, "computerSymbol", ip, port)) ) {return;}
	theBufContent += computerSymbol.length()+1;

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsgName, "invokeId", ip, port)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsgName, "invokeId", ip, port)) ) {return;}
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryDelieverNo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryDelieverNo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += managerId.length()+1;
	memSize += computerSymbol.length()+1;
	memSize += invokeId.length()+1;

	return memSize;
}

SIPCCMsg_PhoneSearch_QueryDelieverNoConf::SIPCCMsg_PhoneSearch_QueryDelieverNoConf()
{
	msgType = Type_PhoneSearch_QueryDelieverNoConf;
}

void SIPCCMsg_PhoneSearch_QueryDelieverNoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	connectPhoneNo = thebuf + theBufContent;
	theBufContent += connectPhoneNo.length()+1;

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_QueryDelieverNoConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_PhoneSearch_QueryDelieverNoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += connectPhoneNo.length()+1;
	memSize += invokeId.length()+1;

	return memSize;
}
// end---yany 2008/11/20

// begin---yany 2009/09/01
SIPCCMsg_PhoneSearch_GetCallTarget::SIPCCMsg_PhoneSearch_GetCallTarget()
{
	msgType = Type_PhoneSearch_GetCallTarget;
}

void SIPCCMsg_PhoneSearch_GetCallTarget::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_PhoneSearch_GetCallTarget";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsgName, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsgName, "managerId", ip, port)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsgName, "managerId", ip, port)) ) {return;}
	theBufContent += managerId.length()+1;

	caller = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+caller.length()+1, msgsize, strMsgName, "caller", ip, port)) ) {return;}
	if ( !(VerifyData(caller.length(), PHONENO_LEN, strMsgName, "caller", ip, port)) ) {return;}
	theBufContent += caller.length()+1;

	callee = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callee.length()+1, msgsize, strMsgName, "callee", ip, port)) ) {return;}
	if ( !(VerifyData(callee.length(), CALLEDNO_LEN, strMsgName, "callee", ip, port)) ) {return;}
	theBufContent += callee.length()+1;

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsgName, "invokeId", ip, port)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsgName, "invokeId", ip, port)) ) {return;}
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_GetCallTarget::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, caller.c_str(), caller.length()+1);
	theBufContent += caller.length()+1;

	memcpy(thebuf+theBufContent, callee.c_str(), callee.length()+1);
	theBufContent += callee.length()+1;

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_PhoneSearch_GetCallTarget::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += managerId.length()+1;
	memSize += caller.length()+1;
	memSize += callee.length()+1;
	memSize += invokeId.length()+1;

	return memSize;
}

SIPCCMsg_PhoneSearch_GetCallTargetConf::SIPCCMsg_PhoneSearch_GetCallTargetConf()
{
	msgType = Type_PhoneSearch_GetCallTargetConf;
}

void SIPCCMsg_PhoneSearch_GetCallTargetConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	keyword = thebuf + theBufContent;
	theBufContent += keyword.length()+1;

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_PhoneSearch_GetCallTargetConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, keyword.c_str(), keyword.length()+1);
	theBufContent += keyword.length()+1;

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_PhoneSearch_GetCallTargetConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += keyword.length()+1;
	memSize += invokeId.length()+1;

	return memSize;
}
// end---yany 2009/09/01

SIPCCMsg_OutDial_SetAgentCount::SIPCCMsg_OutDial_SetAgentCount()
{
	msgType = Type_OutDial_SetAgentCount;

	GroupId = 0;
	WorkAgentCount = 0;
	FreeAgentCount = 0;
}

void SIPCCMsg_OutDial_SetAgentCount::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->GroupId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	GroupName = thebuf + theBufContent;
	theBufContent += GroupName.length()+1;

	memmove(&this->WorkAgentCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->FreeAgentCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OutDial_SetAgentCount::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->GroupId, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, GroupName.c_str(), GroupName.length() + 1);
	theBufContent += GroupName.length() + 1;

	memmove(thebuf+theBufContent, &this->WorkAgentCount, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->FreeAgentCount, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_SetAgentCount::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += GroupName.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_OutDial_DialCmd::SIPCCMsg_OutDial_DialCmd()
{
	msgType = Type_OutDial_DialCmd;

	TaskId = 0;
	PhoneId = 0;
	DialSeq = 0;
}

void SIPCCMsg_OutDial_DialCmd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->DialSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	CalleeNum = thebuf + theBufContent;
	theBufContent += CalleeNum.length()+1;

	CallerForSend = thebuf + theBufContent;
	theBufContent += CallerForSend.length()+1;

	TransDest = thebuf + theBufContent;
	theBufContent += TransDest.length()+1;

	UuiData_Task = thebuf + theBufContent;
	theBufContent += UuiData_Task.length()+1;

	UuiData_Phone = thebuf + theBufContent;
	theBufContent += UuiData_Phone.length()+1;

	Url = thebuf + theBufContent;
	theBufContent += Url.length()+1;

	UuiData_managerid = thebuf + theBufContent;
	theBufContent += UuiData_managerid.length()+1;
}

int SIPCCMsg_OutDial_DialCmd::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->DialSeq, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, CalleeNum.c_str(), CalleeNum.length() + 1);
	theBufContent += CalleeNum.length() + 1;

	memcpy(thebuf+theBufContent, CallerForSend.c_str(), CallerForSend.length() + 1);
	theBufContent += CallerForSend.length() + 1;

	memcpy(thebuf+theBufContent, TransDest.c_str(), TransDest.length() + 1);
	theBufContent += TransDest.length() + 1;

	memcpy(thebuf+theBufContent, UuiData_Task.c_str(), UuiData_Task.length() + 1);
	theBufContent += UuiData_Task.length() + 1;

	memcpy(thebuf+theBufContent, UuiData_Phone.c_str(), UuiData_Phone.length() + 1);
	theBufContent += UuiData_Phone.length() + 1;

	memcpy(thebuf+theBufContent, Url.c_str(), Url.length() + 1);
	theBufContent += Url.length() + 1;

	memcpy(thebuf+theBufContent, UuiData_managerid.c_str(), UuiData_managerid.length() + 1);
	theBufContent += UuiData_managerid.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_DialCmd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += CalleeNum.length()+1;
	memSize += CallerForSend.length()+1;
	memSize += TransDest.length()+1;
	memSize += UuiData_Task.length()+1;
	memSize += UuiData_Phone.length()+1;
	memSize += Url.length()+1;
	memSize += UuiData_managerid.length()+1;

	return memSize;
}

SIPCCMsg_OutDial_DialResult::SIPCCMsg_OutDial_DialResult()
{
	msgType = Type_OutDial_DialResult;

	TaskId = 0;
	PhoneId = 0;
	DialSeq = 0;
	IsSucc = true;
	ResultCode = 0;
}

void SIPCCMsg_OutDial_DialResult::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->DialSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->IsSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	memmove(&this->ResultCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	if(theBufContent >= msgsize)
		return;

	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;
}

int SIPCCMsg_OutDial_DialResult::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->DialSeq, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->IsSucc, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->ResultCode, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length() + 1);
	theBufContent += InvokeId.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_DialResult::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(char);
	memSize += sizeof(int);
	memSize += InvokeId.length()+1;

	return memSize;
}

SIPCCMsg_OutDial_AnalyzeResult::SIPCCMsg_OutDial_AnalyzeResult()
{
	msgType = Type_OutDial_AnalyzeResult;

	TaskId = 0;
	PhoneId = 0;
	DialSeq = 0;
	ResultCode = 0;
}

void SIPCCMsg_OutDial_AnalyzeResult::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->DialSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->ResultCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OutDial_AnalyzeResult::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->DialSeq, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ResultCode, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_AnalyzeResult::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_OutDial_TransResult::SIPCCMsg_OutDial_TransResult()
{
	msgType = Type_OutDial_TransResult;

	TaskId = 0;
	PhoneId = 0;
	DialSeq = 0;
	IsSucc = 0;
}

void SIPCCMsg_OutDial_TransResult::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->DialSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->IsSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
}

int SIPCCMsg_OutDial_TransResult::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->DialSeq, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->IsSucc, sizeof(char));
	theBufContent += sizeof(char);

	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_TransResult::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(char);
	memSize += AgentName.length()+1;

	return memSize;
}

SIPCCMsg_OutDial_EndTalk::SIPCCMsg_OutDial_EndTalk()
{
	msgType = Type_OutDial_EndTalk;

	TaskId = 0;
	PhoneId = 0;
	DialSeq = 0;
}

void SIPCCMsg_OutDial_EndTalk::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->DialSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
}

int SIPCCMsg_OutDial_EndTalk::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->DialSeq, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_EndTalk::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += AgentName.length()+1;

	return memSize;
}

SIPCCMsg_OutDial_EndProcess::SIPCCMsg_OutDial_EndProcess()
{
	msgType = Type_OutDial_EndProcess;

	TaskId = 0;
	PhoneId = 0;
	DialSeq = 0;
}

void SIPCCMsg_OutDial_EndProcess::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->DialSeq, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	AgentName = thebuf + theBufContent;
	theBufContent += AgentName.length()+1;
}

int SIPCCMsg_OutDial_EndProcess::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->DialSeq, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length() + 1);
	theBufContent += AgentName.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_EndProcess::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += AgentName.length()+1;

	return memSize;
}

SIPCCMsg_OutDial_GwLineSynchronize::SIPCCMsg_OutDial_GwLineSynchronize()
{
	msgType = Type_OutDial_GwLineSynchronize;

	GwId = 0;
	AllLineCount = 0;
	FreeLineCount = 0;
}

void SIPCCMsg_OutDial_GwLineSynchronize::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->GwId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->AllLineCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->FreeLineCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (theBufContent >= msgsize)
	{
		return;
	}

	GwName = thebuf + theBufContent;
	theBufContent += GwName.length()+1;
}

int SIPCCMsg_OutDial_GwLineSynchronize::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->GwId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->AllLineCount, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->FreeLineCount, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length() + 1);
	theBufContent += GwName.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_GwLineSynchronize::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += GwName.length()+1;

	return memSize;
}
SIPCCMsg_OutDial_TaskStateCtrl::SIPCCMsg_OutDial_TaskStateCtrl()
{
	msgType = Type_OutDial_TaskStateCtrl;

	//TaskId = 0;
	StateCode = 0;
}

void SIPCCMsg_OutDial_TaskStateCtrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	//theBufContent += sizeof(int);
	TaskId = thebuf + theBufContent;
	theBufContent += TaskId.length()+1;

	memmove(&this->StateCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OutDial_TaskStateCtrl::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	//theBufContent += sizeof(int);
	memcpy(thebuf+theBufContent, TaskId.c_str(), TaskId.length() + 1);
	theBufContent += TaskId.length() + 1;

	memmove(thebuf+theBufContent, &this->StateCode, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_TaskStateCtrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	//memSize += sizeof(int);
	memSize += TaskId.length()+1;
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_OutDial_SetMaxBotherRate::SIPCCMsg_OutDial_SetMaxBotherRate()
{
	msgType = Type_OutDial_SetMaxBotherRate;

	//TaskId = 0;
	AllowValue = 0;
}

void SIPCCMsg_OutDial_SetMaxBotherRate::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	//theBufContent += sizeof(int);
	TaskId = thebuf + theBufContent;
	theBufContent += TaskId.length()+1;

	memmove(&this->AllowValue, thebuf+theBufContent, sizeof(double));
	theBufContent += sizeof(double);
}

int SIPCCMsg_OutDial_SetMaxBotherRate::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	//theBufContent += sizeof(int);
	memcpy(thebuf+theBufContent, TaskId.c_str(), TaskId.length() + 1);
	theBufContent += TaskId.length() + 1;

	memmove(thebuf+theBufContent, &this->AllowValue, sizeof(double));
	theBufContent += sizeof(double);

	return theBufContent;
}

int SIPCCMsg_OutDial_SetMaxBotherRate::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	//memSize += sizeof(int);
	memSize += TaskId.length()+1;
	memSize += sizeof(double);

	return memSize;
}

SIPCCMsg_OutDial_SetForecastIntensity::SIPCCMsg_OutDial_SetForecastIntensity()
{
	msgType = Type_OutDial_SetForecastIntensity;

	InvokeId = 0;
	Intensity = 0;
}

void SIPCCMsg_OutDial_SetForecastIntensity::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	TaskId = thebuf + theBufContent;
	theBufContent += TaskId.length()+1;

	memmove(&this->Intensity, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OutDial_SetForecastIntensity::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, TaskId.c_str(), TaskId.length() + 1);
	theBufContent += TaskId.length() + 1;

	memmove(thebuf+theBufContent, &this->Intensity, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_SetForecastIntensity::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += TaskId.length()+1;
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_OutDial_SetForecastIntensityConf::SIPCCMsg_OutDial_SetForecastIntensityConf()
{
	msgType = Type_OutDial_SetForecastIntensityConf;

	InvokeId = 0;
	Intensity = 0;
}

void SIPCCMsg_OutDial_SetForecastIntensityConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	TaskId = thebuf + theBufContent;
	theBufContent += TaskId.length()+1;

	memmove(&this->Intensity, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OutDial_SetForecastIntensityConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, TaskId.c_str(), TaskId.length() + 1);
	theBufContent += TaskId.length() + 1;

	memmove(thebuf+theBufContent, &this->Intensity, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_SetForecastIntensityConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += TaskId.length()+1;
	memSize += sizeof(int);

	return memSize;
}

//Type_OutDial_ResultStorage

SIPCCMsg_OutDial_ResultStorage::SIPCCMsg_OutDial_ResultStorage()
{
	msgType = Type_OutDial_ResultStorage;

}

void SIPCCMsg_OutDial_ResultStorage::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	StrResult = thebuf + theBufContent;
	theBufContent += StrResult.length()+1;

	StorageType = thebuf + theBufContent;
	theBufContent += StorageType.length()+1;
}

int SIPCCMsg_OutDial_ResultStorage::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);	

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length() + 1);
	theBufContent += InvokeId.length() + 1;

	memcpy(thebuf+theBufContent, StrResult.c_str(), StrResult.length() + 1);
	theBufContent += StrResult.length() + 1;

	memcpy(thebuf+theBufContent, StorageType.c_str(), StorageType.length() + 1);
	theBufContent += StorageType.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_ResultStorage::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += InvokeId.length()+1;
	memSize += StrResult.length()+1;
	memSize += StorageType.length()+1;

	return memSize;
}

//Type_OutDial_TaskStatus

SIPCCMsg_OutDial_TaskStatus::SIPCCMsg_OutDial_TaskStatus()
{
	msgType = Type_OutDial_TaskStatus;

}

void SIPCCMsg_OutDial_TaskStatus::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	TaskID = thebuf + theBufContent;
	theBufContent += TaskID.length()+1;

	memmove(&this->bQuery, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	memmove(&this->TaskTatus, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->AnalysisID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OutDial_TaskStatus::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);	

	memcpy(thebuf+theBufContent, TaskID.c_str(), TaskID.length() + 1);
	theBufContent += TaskID.length() + 1;

	memmove(thebuf+theBufContent, &this->bQuery, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->TaskTatus, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->AnalysisID, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_TaskStatus::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += TaskID.length()+1;
	memSize += sizeof(char);
	memSize += sizeof(int);
	memSize += sizeof(int);
	return memSize;
}

//Type_OutDial_TaskStatusConf

SIPCCMsg_OutDial_TaskStatusConf::SIPCCMsg_OutDial_TaskStatusConf()
{
	msgType = Type_OutDial_TaskStatusConf;
	TaskTatus = 0;
	AnalysisID = 0;
}

void SIPCCMsg_OutDial_TaskStatusConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	TaskID = thebuf + theBufContent;
	theBufContent += TaskID.length()+1;

	memmove(&this->bQuery, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	memmove(&this->TaskTatus, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->AnalysisID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OutDial_TaskStatusConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);	

	memcpy(thebuf+theBufContent, TaskID.c_str(), TaskID.length() + 1);
	theBufContent += TaskID.length() + 1;

	memmove(thebuf+theBufContent, &this->bQuery, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->TaskTatus, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->AnalysisID, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_TaskStatusConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += TaskID.length()+1;
	memSize += sizeof(char);
	memSize += sizeof(int);
	memSize += sizeof(int);
	return memSize;
}

/////////////////////////////////////////////////////////////////////////////////
///Class_Notify
SIPCCMsg_Notify::SIPCCMsg_Notify()
{
	msgClass = Class_Notify;
}

///SIPCCMsg_Notify_ErrorOccurred
SIPCCMsg_Notify_ErrorOccurred::SIPCCMsg_Notify_ErrorOccurred()
{
	msgType = Type_Notify_ErrorOccurred;
	errorType = -1;
}

void SIPCCMsg_Notify_ErrorOccurred::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	//errorType
	memmove(&this->errorType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Notify_ErrorOccurred::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//errorType
	memmove(thebuf+theBufContent, &this->errorType, sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_Notify_ErrorOccurred::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//errorType
	
	return memSize;
}
///Class_Notify
/////////////////////////////////////////////////////////////////////////////////

int SIPCCMsg_Client_SendStrMsg::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	// destAgents
	memcpy(thebuf+theBufContent, destAgents.c_str(), destAgents.length() + 1);
	theBufContent += destAgents.length() + 1;
	
	// msgContent
	memmove(thebuf+theBufContent, msgContent.c_str(), msgContent.length() + 1);
	theBufContent += msgContent.length() + 1;

	// theSender
	memcpy(thebuf+theBufContent, theSender.c_str(), theSender.length() + 1);
	theBufContent += theSender.length() + 1;

	return theBufContent;
}

void SIPCCMsg_Client_SendStrMsg::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip, unsigned short port )
{
	string strMsg = "SIPCCMsg_Client_SendStrMsg";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	// destAgents
	destAgents = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+destAgents.length()+1, msgsize, strMsg, "destAgents.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(destAgents.length(), DESTAGENTS_LEN, strMsg, "destAgents", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += destAgents.length() + 1;

	if(theBufContent >= msgsize)
		return;

	// msgContent
	msgContent = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+msgContent.length()+1, msgsize, strMsg, "msgContent.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(msgContent.length(), MSGCONTENT_LEN, strMsg, "msgContent", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += msgContent.length() + 1;

	if(theBufContent >= msgsize)
		return;

	// theSender
	theSender = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+theSender.length()+1, msgsize, strMsg, "theSender.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(theSender.length(), THESENDER_LEN, strMsg, "theSender", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += theSender.length() + 1;
}

int SIPCCMsg_ACD_SendStrMsg::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	// msgContent
	memmove(thebuf+theBufContent, msgContent.c_str(), msgContent.length() + 1);
	theBufContent += msgContent.length() + 1;

	// theSender
	memcpy(thebuf+theBufContent, theSender.c_str(), theSender.length() + 1);
	theBufContent += theSender.length() + 1;

	return theBufContent;
}

void SIPCCMsg_ACD_SendStrMsg::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip, unsigned short port )
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	// msgContent
	msgContent = thebuf + theBufContent;
	theBufContent += msgContent.length() + 1;

	if(theBufContent >= msgsize)
		return;

	// theSender
	theSender = thebuf + theBufContent;
	theBufContent += theSender.length() + 1;	
}

// 函数调用的头
int SIPCCMsg_OCXFuncHead::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;	//invokeID
	return memSize;
}
int SIPCCMsg_OCXFuncHead::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	// msgContent
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	return theBufContent;		
}
void SIPCCMsg_OCXFuncHead::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
}

// 序列化
int SIPCCMsg_OCXFuncHead::FillOurBuf(char* thebuf)
{
	assert(thebuf !=  NULL);
	int theBufContent = FillMsgHead(thebuf);
	// msgContent
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;
	
	return theBufContent;		
}
int SIPCCMsg_OCXFuncHead::ReadOurBuf(char* thebuf, int msgsize)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;
	
	return theBufContent;		
}


// 填充字符串
int SIPCCMsg_OCXFuncHead::FillString(char* thebuf, const string& str)
{
	assert(thebuf !=  NULL);
	int theBufContent = 0;
	// msgContent
	memcpy(thebuf+theBufContent, str.c_str(), str.length()+1);
	theBufContent += str.length()+1;
	
	return theBufContent;		
}
int SIPCCMsg_OCXFuncHead::GetString(char* thebuf, string& str)
{
	str = thebuf;
	return str.length()+1;
}


///Type_Login_ServerRegister
SIPCCMsg_OCXService_SubTrans::SIPCCMsg_OCXService_SubTrans()
{
	msgType = Type_OCXService_SubTrans;
	// 包ID
	PackID = 0;
	// 当前包数
	NowNum =  1;
	// 总包数
	TotNum = 1;
	// 数据长度
	DataLen = 0;
	// 数据内容
	memset(DataBuf, sizeof(DataBuf), 0);
}

void SIPCCMsg_OCXService_SubTrans::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	// PackID
	memmove(&PackID, thebuf+theBufContent, sizeof(PackID));
	theBufContent += sizeof(PackID);
	// TotNum
	memmove(&TotNum, thebuf+theBufContent, sizeof(TotNum));
	theBufContent += sizeof(TotNum);
	// NowNum
	memmove(&NowNum, thebuf+theBufContent, sizeof(NowNum));
	theBufContent += sizeof(NowNum);
	// DataLen
	memmove(&DataLen, thebuf+theBufContent, sizeof(DataLen));
	theBufContent += sizeof(DataLen);
	if(DataLen > sizeof(DataBuf))
	{
		DataLen = 0;
	}
	// 数据
	memmove(DataBuf, thebuf+theBufContent, DataLen);
}

int SIPCCMsg_OCXService_SubTrans::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	//PackID
	memmove(thebuf+theBufContent, &this->PackID, sizeof(PackID));
	theBufContent += sizeof(PackID);
	//TotNum
	memmove(thebuf+theBufContent, &this->TotNum, sizeof(TotNum));
	theBufContent += sizeof(TotNum);
	//NowNum
	memmove(thebuf+theBufContent, &this->NowNum, sizeof(NowNum));
	theBufContent += sizeof(NowNum);
	//数据长度
	memmove(thebuf+theBufContent, &this->DataLen, sizeof(DataLen));
	theBufContent += sizeof(DataLen);
	//数据
	memmove(thebuf+theBufContent, DataBuf, DataLen);
	theBufContent += DataLen;	

	return theBufContent;
}

int SIPCCMsg_OCXService_SubTrans::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(PackID);
	memSize += sizeof(TotNum);
	memSize += sizeof(NowNum);
	memSize += sizeof(DataLen);
	memSize += DataLen;
	return memSize;
}


SIPCCMsg_Gateway_GetDeptLoginAgentNum::SIPCCMsg_Gateway_GetDeptLoginAgentNum()
{
	msgType = Type_Gateway_GetDeptLoginAgentNum;
}

void SIPCCMsg_Gateway_GetDeptLoginAgentNum::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_GetDeptLoginAgentNum";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+invokeId.length()+1, msgsize, strMsg, "invokeId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(invokeId.length(), INVOKEID_LEN, strMsg, "invokeId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += invokeId.length()+1;

	m_ssDeptName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssDeptName.length()+1, msgsize, strMsg, "m_ssDeptName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssDeptName.length(), CORPNDEPT_LEN, strMsg, "m_ssDeptName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssDeptName.length()+1;

	m_ssCorpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+m_ssCorpName.length()+1, msgsize, strMsg, "m_ssCorpName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(m_ssCorpName.length(), CORPNAME_LEN, strMsg, "m_ssCorpName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += m_ssCorpName.length()+1;

	if ( theBufContent >= msgsize )
		return;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_Gateway_GetDeptLoginAgentNum::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	memcpy(thebuf+theBufContent, m_ssDeptName.c_str(), m_ssDeptName.length()+1);
	theBufContent += m_ssDeptName.length()+1;

	memcpy(thebuf+theBufContent, m_ssCorpName.c_str(), m_ssCorpName.length()+1);
	theBufContent += m_ssCorpName.length()+1;

	//connectPhoneNo
	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_GetDeptLoginAgentNum::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += m_ssDeptName.length()+1;
	memSize += m_ssCorpName.length()+1;

	memSize += connectPhoneNo.length()+1;	//connectPhoneNo
	memSize += handleId.length()+1;			//handleId

	return memSize;
}

SIPCCMsg_ACD_GetDeptLoginAgentNumConf::SIPCCMsg_ACD_GetDeptLoginAgentNumConf()
{
	msgType = Type_ACD_GetDeptLoginAgentNumConf;

	m_uCount = 0;
}

void SIPCCMsg_ACD_GetDeptLoginAgentNumConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_GetDeptLoginAgentNumConf";

	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;

	memmove(&this->m_uCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	handleId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+handleId.length()+1, msgsize, strMsg, "handleId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(handleId.length(), INVOKEID_LEN, strMsg, "handleId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += handleId.length()+1;
}

int SIPCCMsg_ACD_GetDeptLoginAgentNumConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	memmove(thebuf+theBufContent, &this->m_uCount, sizeof(int));
	theBufContent += sizeof(int);

	//handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_GetDeptLoginAgentNumConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += invokeId.length()+1;
	memSize += sizeof(int);

	memSize += handleId.length()+1;			//handleId

	return memSize;
}

SIPCCMsg_Operator::SIPCCMsg_Operator()
{
	msgClass = Class_Operator;
}

SIPCCMsg_Operator2ACD_SendStrMsg::SIPCCMsg_Operator2ACD_SendStrMsg()
{
	msgType = Type_Operator2ACD_SendStrMsg;
	strCompany = "";
	destAgents = "";	
	theSender = "";
	msgContent = "";
};

SIPCCMsg_Operator2Login_SendStrMsg::SIPCCMsg_Operator2Login_SendStrMsg()
{
	msgType = Type_Operator2Login_SendStrMsg;
}

SIPCCMsg_Operator2Login_GetStrMsg::SIPCCMsg_Operator2Login_GetStrMsg()
{
	msgType = Type_Operator2Login_GetStrMsg;
}

SIPCCMsg_Login_GetStrMsgRes::SIPCCMsg_Login_GetStrMsgRes()
{
	msgType = Type_Login_GetStrMsgRes;
}

SIPCCMsg_Operator2Login_CancelStrMsg::SIPCCMsg_Operator2Login_CancelStrMsg()
{
	msgType = Type_Operator2Login_CancelStrMsg;
}

SIPCCMsg_Gateway_TrunkStat::SIPCCMsg_Gateway_TrunkStat()
{
	msgType = Type_Gateway_TrunkStat;

	GroupId = 0;
}

void SIPCCMsg_Gateway_TrunkStat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_TrunkStat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(),GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "GroupId", ip, port)) ) {return;}
	memmove(&this->GroupId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	StartTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+StartTime.length()+1, msgsize, strMsg, "StartTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(StartTime.length(), CURTIME_LEN, strMsg, "StartTime", ip, port)) ) {return;}
	theBufContent += StartTime.length()+1;

	EndTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+EndTime.length()+1, msgsize, strMsg, "EndTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(EndTime.length(), CURTIME_LEN, strMsg, "EndTime", ip, port)) ) {return;}
	theBufContent += EndTime.length()+1;

	Stat = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+Stat.length()+1, msgsize, strMsg, "Stat.length()", ip, port)) ) {return;}
	if ( !(VerifyData(Stat.length(), TRUNKSTAT_LEN, strMsg, "Stat", ip, port)) ) {return;}
	theBufContent += Stat.length()+1;
}

int SIPCCMsg_Gateway_TrunkStat::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memmove(thebuf+theBufContent, &this->GroupId, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, StartTime.c_str(), StartTime.length()+1);
	theBufContent += StartTime.length()+1;

	memcpy(thebuf+theBufContent, EndTime.c_str(), EndTime.length()+1);
	theBufContent += EndTime.length()+1;

	memcpy(thebuf+theBufContent, Stat.c_str(), Stat.length()+1);
	theBufContent += Stat.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_TrunkStat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;
	memSize += sizeof(int);
	memSize += StartTime.length()+1;
	memSize += EndTime.length()+1;
	memSize += Stat.length()+1;

	return memSize;
}

SIPCCMsg_Gateway_TrunkSeizeRate::SIPCCMsg_Gateway_TrunkSeizeRate()
{
	msgType = Type_Gateway_TrunkSeizeRate;

	LineCount = 0;
	MaxSeizeCount = 0;
}

void SIPCCMsg_Gateway_TrunkSeizeRate::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_TrunkSeizeRate";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "LineCount", ip, port)) ) {return;}
	memmove(&this->LineCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//if ( !(VerifyData(LineCount, TRUNKLINECOUT_LEN, strMsg, "LineCount", ip, port)) ) {return;}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "MaxSeizeCount", ip, port)) ) {return;}
	memmove(&this->MaxSeizeCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//if ( !(VerifyData(MaxSeizeCount, TRUNKLINECOUT_LEN, strMsg, "MaxSeizeCount", ip, port)) ) {return;}

	StartTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+StartTime.length()+1, msgsize, strMsg, "StartTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(StartTime.length(), CURTIME_LEN, strMsg, "StartTime", ip, port)) ) {return;}
	theBufContent += StartTime.length()+1;

	EndTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+EndTime.length()+1, msgsize, strMsg, "EndTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(EndTime.length(), CURTIME_LEN, strMsg, "EndTime", ip, port)) ) {return;}
	theBufContent += EndTime.length()+1;

	GroupSeize = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GroupSeize.length()+1, msgsize, strMsg, "GroupSeize.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GroupSeize.length(), GROUPSEIZE_LEN, strMsg, "GroupSeize", ip, port)) ) {return;}
	theBufContent += GroupSeize.length()+1;
}

int SIPCCMsg_Gateway_TrunkSeizeRate::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memmove(thebuf+theBufContent, &this->LineCount, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->MaxSeizeCount, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, StartTime.c_str(), StartTime.length()+1);
	theBufContent += StartTime.length()+1;

	memcpy(thebuf+theBufContent, EndTime.c_str(), EndTime.length()+1);
	theBufContent += EndTime.length()+1;

	memcpy(thebuf+theBufContent, GroupSeize.c_str(), GroupSeize.length()+1);
	theBufContent += GroupSeize.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_TrunkSeizeRate::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += StartTime.length()+1;
	memSize += EndTime.length()+1;
	memSize += GroupSeize.length()+1;

	return memSize;
}

SIPCCMsg_Gateway_CallInStat::SIPCCMsg_Gateway_CallInStat()
{
	msgType = Type_Gateway_CallInStat;

	Times = 0;
	TotalSpan = 0;

	HookTimes = 0;

	MaxSeizeCount = 0;
}

void SIPCCMsg_Gateway_CallInStat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallInStat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	CalleeNum = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CalleeNum.length()+1, msgsize, strMsg, "CalleeNum.length()", ip, port)) ) {return;}
	if ( !(VerifyData(CalleeNum.length(), CALLEENUM_LEN, strMsg, "CalleeNum", ip, port)) ) {return;}
	theBufContent += CalleeNum.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "Times", ip, port)) ) {return;}
	memmove(&this->Times, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "TotalSpan", ip, port)) ) {return;}
	memmove(&this->TotalSpan, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	StartTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+StartTime.length()+1, msgsize, strMsg, "StartTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(StartTime.length(), CURTIME_LEN, strMsg, "StartTime", ip, port)) ) {return;}
	theBufContent += StartTime.length()+1;

	EndTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+EndTime.length()+1, msgsize, strMsg, "EndTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(EndTime.length(), CURTIME_LEN, strMsg, "EndTime", ip, port)) ) {return;}
	theBufContent += EndTime.length()+1;

	if ( theBufContent >= msgsize )
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "HookTimes", ip, port)) ) {return;}
	memmove(&this->HookTimes, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "MaxSeizeCount", ip, port)) ) {return;}
	memmove(&this->MaxSeizeCount, thebuf+theBufContent, sizeof(int));
}

int SIPCCMsg_Gateway_CallInStat::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memcpy(thebuf+theBufContent, CalleeNum.c_str(), CalleeNum.length()+1);
	theBufContent += CalleeNum.length()+1;

	memmove(thebuf+theBufContent, &this->Times, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->TotalSpan, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, StartTime.c_str(), StartTime.length()+1);
	theBufContent += StartTime.length()+1;

	memcpy(thebuf+theBufContent, EndTime.c_str(), EndTime.length()+1);
	theBufContent += EndTime.length()+1;

	memmove(thebuf+theBufContent, &this->HookTimes, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->MaxSeizeCount, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Gateway_CallInStat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;
	memSize += CalleeNum.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += StartTime.length()+1;
	memSize += EndTime.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_Gateway_CallInOutStat::SIPCCMsg_Gateway_CallInOutStat()
{
	msgType = Type_Gateway_CallInOutStat;

	Times = 0;
	TotalSpan = 0;

	HookTimes = 0;

	MaxSeizeCount = 0;
}

void SIPCCMsg_Gateway_CallInOutStat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallInOutStat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	CalleeNum = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CalleeNum.length()+1, msgsize, strMsg, "CalleeNum.length()", ip, port)) ) {return;}
	if ( !(VerifyData(CalleeNum.length(), CALLEENUM_LEN, strMsg, "CalleeNum", ip, port)) ) {return;}
	theBufContent += CalleeNum.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "Times", ip, port)) ) {return;}
	memmove(&this->Times, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "TotalSpan", ip, port)) ) {return;}
	memmove(&this->TotalSpan, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	StartTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+StartTime.length()+1, msgsize, strMsg, "StartTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(StartTime.length(), CURTIME_LEN, strMsg, "StartTime", ip, port)) ) {return;}
	theBufContent += StartTime.length()+1;

	EndTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+EndTime.length()+1, msgsize, strMsg, "EndTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(EndTime.length(), CURTIME_LEN, strMsg, "EndTime", ip, port)) ) {return;}
	theBufContent += EndTime.length()+1;

	if ( theBufContent >= msgsize )
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "HookTimes", ip, port)) ) {return;}
	memmove(&this->HookTimes, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "MaxSeizeCount", ip, port)) ) {return;}
	memmove(&this->MaxSeizeCount, thebuf+theBufContent, sizeof(int));
}

int SIPCCMsg_Gateway_CallInOutStat::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memcpy(thebuf+theBufContent, CalleeNum.c_str(), CalleeNum.length()+1);
	theBufContent += CalleeNum.length()+1;

	memmove(thebuf+theBufContent, &this->Times, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->TotalSpan, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, StartTime.c_str(), StartTime.length()+1);
	theBufContent += StartTime.length()+1;

	memcpy(thebuf+theBufContent, EndTime.c_str(), EndTime.length()+1);
	theBufContent += EndTime.length()+1;

	memmove(thebuf+theBufContent, &this->HookTimes, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->MaxSeizeCount, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Gateway_CallInOutStat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;
	memSize += CalleeNum.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += StartTime.length()+1;
	memSize += EndTime.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_Gateway_CallOutStat::SIPCCMsg_Gateway_CallOutStat()
{
	msgType = Type_Gateway_CallOutStat;

	Times = 0;
	TotalSpan = 0;

	HookTimes = 0;

	MaxSeizeCount = 0;
}

void SIPCCMsg_Gateway_CallOutStat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_CallOutStat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	ManagerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ManagerId.length()+1, msgsize, strMsg, "ManagerId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ManagerId.length(), MANAGERID_LEN, strMsg, "ManagerId", ip, port)) ) {return;}
	theBufContent += ManagerId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "Times", ip, port)) ) {return;}
	memmove(&this->Times, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "TotalSpan", ip, port)) ) {return;}
	memmove(&this->TotalSpan, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	StartTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+StartTime.length()+1, msgsize, strMsg, "StartTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(StartTime.length(), CURTIME_LEN, strMsg, "StartTime", ip, port)) ) {return;}
	theBufContent += StartTime.length()+1;

	EndTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+EndTime.length()+1, msgsize, strMsg, "EndTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(EndTime.length(), CURTIME_LEN, strMsg, "EndTime", ip, port)) ) {return;}
	theBufContent += EndTime.length()+1;

	if ( theBufContent >= msgsize )
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "HookTimes", ip, port)) ) {return;}
	memmove(&this->HookTimes, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "MaxSeizeCount", ip, port)) ) {return;}
	memmove(&this->MaxSeizeCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Gateway_CallOutStat::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memcpy(thebuf+theBufContent, ManagerId.c_str(), ManagerId.length()+1);
	theBufContent += ManagerId.length()+1;

	memmove(thebuf+theBufContent, &this->Times, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->TotalSpan, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, StartTime.c_str(), StartTime.length()+1);
	theBufContent += StartTime.length()+1;

	memcpy(thebuf+theBufContent, EndTime.c_str(), EndTime.length()+1);
	theBufContent += EndTime.length()+1;

	memmove(thebuf+theBufContent, &this->HookTimes, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->MaxSeizeCount, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Gateway_CallOutStat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;
	memSize += ManagerId.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += StartTime.length()+1;
	memSize += EndTime.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_Gateway_NotifyTrunkState::SIPCCMsg_Gateway_NotifyTrunkState()
{
	msgType = Type_Gateway_NotifyTrunkState;

	ComputerSymbol = "";
	GwName = "";
	LineNo = "";
	GroupId = -1;
	CallDirection = -1;
	LastState = 0;
	NewState = 0;
	CallKey = "";
	newStatetime = 0;
	MappingName=0;
}

void SIPCCMsg_Gateway_NotifyTrunkState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_NotifyTrunkState";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	LineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+LineNo.length()+1, msgsize, strMsg, "LineNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(LineNo.length(), USERLINENO_LEN, strMsg, "LineNo", ip, port)) ) {return;}
	theBufContent += LineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "GroupId", ip, port)) ) {return;}
	memmove(&this->GroupId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "CallDirection", ip, port)) ) {return;}
	memmove(&this->CallDirection, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "LastState", ip, port)) ) {return;}
	memmove(&this->LastState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "NewState", ip, port)) ) {return;}
	memmove(&this->NewState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	CallKey = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CallKey.length()+1, msgsize, strMsg, "CallKey.length()", ip, port)) ) {return;}
	if ( !(VerifyData(CallKey.length(), MANAGERID_LEN, strMsg, "CallKey", ip, port)) ) {return;}
	theBufContent += CallKey.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(time_t), msgsize, strMsg, "newStatetime.length()", ip, port)) ) {return;}
	memmove(&this->newStatetime, thebuf+theBufContent, sizeof(time_t));
	theBufContent += sizeof(time_t);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "MappingName", ip, port)) ) {return;}
	memmove(&this->MappingName, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Gateway_NotifyTrunkState::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memcpy(thebuf+theBufContent, LineNo.c_str(), LineNo.length()+1);
	theBufContent += LineNo.length()+1;

	memmove(thebuf+theBufContent, &this->GroupId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CallDirection, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->LastState, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->NewState, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, CallKey.c_str(), CallKey.length()+1);
	theBufContent += CallKey.length()+1;



     memcpy(thebuf+theBufContent,&this->newStatetime, sizeof(time_t));
	theBufContent += sizeof(time_t);


	memmove(thebuf+theBufContent, &this->MappingName, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Gateway_NotifyTrunkState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;
	memSize += LineNo.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += CallKey.length()+1;
	memSize += sizeof(time_t);
	memSize += sizeof(int);

	return memSize;
}

// SIPCCMsg_Monitor
SIPCCMsg_Monitor::SIPCCMsg_Monitor()
{
	msgClass = Class_Monitor;
}
// Type_Monitor_SrvLogin
SIPCCMsg_Monitor_SrvLogin::SIPCCMsg_Monitor_SrvLogin()
{
	msgType = Type_Monitor_SrvLogin;

	m_iCmd=0; // 注册注销
	memset(m_szIP,0,sizeof(m_szIP));  // 服务器ip
	m_uPort=0;  // 服务器端口
	m_uCliNum=0;  // 服务器客户端连接数
	m_uDK=0;  // 带宽单位M
	m_uAgentNum=0;  // 最大连接座席数
	m_uAgentNum=0; // 当前座席连接数
	m_uTrunkNum=0;  // 最大连接中继数
	m_uTCNum=0; // 当前中继连接数
	m_sSrvCode="";// 服务器编码
}

void SIPCCMsg_Monitor_SrvLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&m_iCmd, thebuf+theBufContent, sizeof(int)); // m_iCmd
	theBufContent += sizeof(int);

	memcpy(&m_szIP, thebuf+theBufContent, sizeof(m_szIP)); // m_szIP
	theBufContent += sizeof(m_szIP);

	memcpy(&m_uPort, thebuf+theBufContent, sizeof(unsigned short)); // m_uPort
	theBufContent += sizeof(unsigned short);

	memcpy(&m_uCliNum, thebuf+theBufContent, sizeof(unsigned short)); // m_uCliNum
	theBufContent += sizeof(unsigned short);

	memcpy(&m_uDK, thebuf+theBufContent, sizeof(unsigned short)); // m_uDK
	theBufContent += sizeof(unsigned short);

	memcpy(&m_uAgentNum, thebuf+theBufContent, sizeof(unsigned short)); // m_uAgentNum
	theBufContent += sizeof(unsigned short);

	memcpy(&m_uAgentCNum, thebuf+theBufContent, sizeof(unsigned short)); // m_uAgentCNum
	theBufContent += sizeof(unsigned short);

	memcpy(&m_uTrunkNum, thebuf+theBufContent, sizeof(unsigned short)); // m_uTrunkNum
	theBufContent += sizeof(unsigned short);

	memcpy(&m_uTCNum, thebuf+theBufContent, sizeof(unsigned short)); // m_uTCNum
	theBufContent += sizeof(unsigned short);

	m_sSrvCode = thebuf + theBufContent;
	theBufContent += m_sSrvCode.length()+1;

	if(theBufContent >= msgsize)
		return;

	memcpy(&iLoginType, thebuf+theBufContent, sizeof(int)); // m_iCmd
	theBufContent += sizeof(int);

}

int SIPCCMsg_Monitor_SrvLogin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, &m_iCmd, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &m_szIP, sizeof(m_szIP));
	theBufContent += sizeof(m_szIP);

	memcpy(thebuf+theBufContent, &m_uPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, &m_uCliNum, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, &m_uDK, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, &m_uAgentNum, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, &m_uAgentCNum, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, &m_uTrunkNum, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, &m_uTCNum, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, m_sSrvCode.c_str(), m_sSrvCode.length() + 1);
	theBufContent += m_sSrvCode.length() + 1;

	memcpy(thebuf+theBufContent, &iLoginType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Monitor_SrvLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);			//
	memSize += sizeof(m_szIP);
	memSize += sizeof(unsigned short); // m_uPort
	memSize += sizeof(unsigned short); // m_uCliNum
	memSize += sizeof(unsigned short); // m_uDK
	memSize += sizeof(unsigned short); // m_uAgentNum
	memSize += sizeof(unsigned short); // m_uAgentcNum
	memSize += sizeof(unsigned short); // m_uTrunkNum
	memSize += sizeof(unsigned short); // m_uTCNum
	memSize += m_sSrvCode.length()+1;
	memSize += sizeof(int);	
	
	return memSize;
}
// Type_Monitor_SrvLoginConf
SIPCCMsg_Monitor_SrvLoginConf::SIPCCMsg_Monitor_SrvLoginConf()
{
	msgType =Type_Monitor_SrvLoginConf;

	m_bSucc=false;
}

void SIPCCMsg_Monitor_SrvLoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&m_bSucc, thebuf+theBufContent, sizeof(bool)); // 
	theBufContent += sizeof(bool);

	if(theBufContent >= msgsize)
		return;

	memcpy(&iLoginType, thebuf+theBufContent, sizeof(int)); // 
	theBufContent += sizeof(int);
}

int	SIPCCMsg_Monitor_SrvLoginConf::FillBuf(char*& thebuf) 
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, &m_bSucc, sizeof(bool));
	theBufContent += sizeof(bool);

	memcpy(thebuf+theBufContent, &iLoginType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Monitor_SrvLoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(bool);	
	memSize += sizeof(int);

	return memSize;
}
// Type_Monitor_SrvLogout
SIPCCMsg_Monitor_SrvLogout::SIPCCMsg_Monitor_SrvLogout()
{
	msgType =Type_Monitor_SrvLogout;

	m_iCmd=0; // 注册注销
	memset(m_szIP,0,sizeof(m_szIP));  // 服务器ip
	m_uPort=0;  // 服务器端口
	m_sSrvCode="";
}

void SIPCCMsg_Monitor_SrvLogout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&m_iCmd, thebuf+theBufContent, sizeof(int)); // m_iCmd
	theBufContent += sizeof(int);

	memcpy(&m_szIP, thebuf+theBufContent, sizeof(m_szIP)); // m_szIP
	theBufContent += sizeof(unsigned short);

	memcpy(&m_uPort, thebuf+theBufContent, sizeof(unsigned short)); // m_uPort
	theBufContent += sizeof(unsigned short);

	m_sSrvCode = thebuf + theBufContent;
	theBufContent += m_sSrvCode.length()+1;
}

int	SIPCCMsg_Monitor_SrvLogout::FillBuf(char*& thebuf) 
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, &m_iCmd, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &m_szIP, sizeof(m_szIP));
	theBufContent += sizeof(m_szIP);

	memcpy(thebuf+theBufContent, &m_uPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, m_sSrvCode.c_str(), m_sSrvCode.length() + 1);
	theBufContent += m_sSrvCode.length() + 1;

	return theBufContent;
}

int SIPCCMsg_Monitor_SrvLogout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(int);			//
	memSize += sizeof(m_szIP);
	memSize += sizeof(unsigned short); // m_uPort
	memSize += m_sSrvCode.length()+1;
	
	return memSize;
}

// Type_Monitor_SrvLogoutConf
SIPCCMsg_Monitor_SrvLogoutConf::SIPCCMsg_Monitor_SrvLogoutConf()
{
	msgType =Type_Monitor_SrvLogoutConf;

	m_bSucc=false;
}

void SIPCCMsg_Monitor_SrvLogoutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&m_bSucc, thebuf+theBufContent, sizeof(bool)); // 
	theBufContent += sizeof(bool);
}

int	SIPCCMsg_Monitor_SrvLogoutConf::FillBuf(char*& thebuf) 
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, &m_bSucc, sizeof(bool));
	theBufContent += sizeof(bool);

	return theBufContent;
}

int SIPCCMsg_Monitor_SrvLogoutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(bool);	
	
	return memSize;
}
// Type_Monitor_UpdateCliCount
SIPCCMsg_Monitor_UpdateCliCount::SIPCCMsg_Monitor_UpdateCliCount()
{
	msgType =Type_Monitor_UpdateCliCount;

	m_uCliCount=0;
}

void SIPCCMsg_Monitor_UpdateCliCount::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	
	memcpy(&m_uCliCount, thebuf+theBufContent, sizeof(unsigned short)); // 
	theBufContent += sizeof(unsigned short);
}

int	SIPCCMsg_Monitor_UpdateCliCount::FillBuf(char*& thebuf) 
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, &m_uCliCount, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_Monitor_UpdateCliCount::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(unsigned short);	
	
	return memSize;
}

///Type_Client_NotifyAgentLogin
SIPCCMsg_Client_NotifyAgentLogin::SIPCCMsg_Client_NotifyAgentLogin()
{
	msgType =Type_Client_NotifyAgentLogin;
	agentName = "";
	managerID = "";
	corpName = "";
	departmentName = "";
}

void SIPCCMsg_Client_NotifyAgentLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	//agentName
	agentName = thebuf + theBufContent;
	theBufContent += agentName.length()+1;
	//departmentName
	departmentName = thebuf + theBufContent;
	theBufContent += departmentName.length()+1;
	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;
	//managerID
	managerID = thebuf + theBufContent;
	theBufContent += managerID.length()+1;

	if(theBufContent == msgsize)
		return;
}

int SIPCCMsg_Client_NotifyAgentLogin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//agentName
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length() + 1);
	theBufContent += agentName.length() + 1;
	//departmentName
	memcpy(thebuf+theBufContent, departmentName.c_str(), departmentName.length() + 1);
	theBufContent += departmentName.length() + 1;
	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1);
	theBufContent += corpName.length() + 1;
	//managerID
	memcpy(thebuf+theBufContent, managerID.c_str(), managerID.length() + 1);
	theBufContent += managerID.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Client_NotifyAgentLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentName.length() + 1;				//agentName
	memSize += departmentName.length() + 1;		//departmentName
	memSize += corpName.length() + 1;  //corpName
	memSize += managerID.length() + 1;  //managerID
	return memSize;
}

///Type_OutDial_HeartBeat
SIPCCMsg_OutDial_HeartBeat::SIPCCMsg_OutDial_HeartBeat()
{
	msgType =Type_OutDial_HeartBeat;
	GatewayId = "";
}

void SIPCCMsg_OutDial_HeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	//agentName
	GatewayId = thebuf + theBufContent;
	theBufContent += GatewayId.length()+1;
}

int SIPCCMsg_OutDial_HeartBeat::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//GatewayId
	memcpy(thebuf+theBufContent, GatewayId.c_str(), GatewayId.length() + 1);
	theBufContent += GatewayId.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_HeartBeat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += GatewayId.length() + 1;				//agentName
	return memSize;
}

///Type_OutDial_ToGw
SIPCCMsg_OutDial_ToGw::SIPCCMsg_OutDial_ToGw()
{
	msgType =Type_OutDial_ToGw;
	GatewayId = "";
	Message = "";
}

void SIPCCMsg_OutDial_ToGw::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	//agentName
	GatewayId = thebuf + theBufContent;
	theBufContent += GatewayId.length()+1;
	//agentName
	Message = thebuf + theBufContent;
	theBufContent += Message.length()+1;
}

int SIPCCMsg_OutDial_ToGw::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//GatewayId
	memcpy(thebuf+theBufContent, GatewayId.c_str(), GatewayId.length() + 1);
	theBufContent += GatewayId.length() + 1;
	//GatewayId
	memcpy(thebuf+theBufContent, Message.c_str(), Message.length() + 1);
	theBufContent += Message.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_ToGw::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += GatewayId.length() + 1;				//agentName
	memSize += Message.length() + 1;				//agentName
	return memSize;
}

///Type_OutDial_FromGw
SIPCCMsg_OutDial_FromGw::SIPCCMsg_OutDial_FromGw()
{
	msgType =Type_OutDial_FromGw;
	GatewayId = "";
	Message = "";
}

void SIPCCMsg_OutDial_FromGw::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	//agentName
	GatewayId = thebuf + theBufContent;
	theBufContent += GatewayId.length()+1;
	//agentName
	Message = thebuf + theBufContent;
	theBufContent += Message.length()+1;
}

int SIPCCMsg_OutDial_FromGw::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//GatewayId
	memcpy(thebuf+theBufContent, GatewayId.c_str(), GatewayId.length() + 1);
	theBufContent += GatewayId.length() + 1;
	//GatewayId
	memcpy(thebuf+theBufContent, Message.c_str(), Message.length() + 1);
	theBufContent += Message.length() + 1;

	return theBufContent;
}

int SIPCCMsg_OutDial_FromGw::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += GatewayId.length() + 1;				//agentName
	memSize += Message.length() + 1;				//agentName
	return memSize;
}

SIPCCMsg_Log::SIPCCMsg_Log()
{
	msgClass = Class_Log;
	msgType = Type_Log;
}



///Type_Client_WpAgentHanupCall
SIPCCMsg_Client_WpAgentHanupCall::SIPCCMsg_Client_WpAgentHanupCall()
{
	msgType = Type_Client_WpAgentHanupCall;
	agentID = "";
}

void SIPCCMsg_Client_WpAgentHanupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_Client_WpAgentHanupCall", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, "SIPCCMsg_Client_WpAgentHanupCall", "agentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, "SIPCCMsg_Client_WpAgentHanupCall", "agentID", ip, port)) ) {return;}
	theBufContent += agentID.length()+1;

	gwAgentLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAgentLine.length()+1, msgsize, "SIPCCMsg_Client_WpAgentHanupCall", "gwAgentLine.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwAgentLine.length(), AGENTLINE_LEN, "SIPCCMsg_Client_WpAgentHanupCall", "gwAgentLine", ip, port)) ) {return;}
	theBufContent += gwAgentLine.length()+1;

	gwUserLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwUserLine.length()+1, msgsize, "SIPCCMsg_Client_WpAgentHanupCall", "gwUserLine.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwUserLine.length(), USERLINE_LEN, "SIPCCMsg_Client_WpAgentHanupCall", "gwUserLine", ip, port)) ) {return;}
	theBufContent += gwUserLine.length()+1;
}

int SIPCCMsg_Client_WpAgentHanupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;

	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_WpAgentHanupCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += agentID.length()+1;	
	memSize += gwAgentLine.length()+1;	
	memSize += gwUserLine.length()+1;

	return memSize;
}



///Type_UState_WpAgentHanupCall
SIPCCMsg_UState_WpAgentHanupCall::SIPCCMsg_UState_WpAgentHanupCall()
{
	msgType = Type_UState_WpAgentHanupCall;
	agentID = "";
	gatewayName="";
	computerSymbol="";
}

void SIPCCMsg_UState_WpAgentHanupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;

	gwAgentLine = thebuf + theBufContent;
	theBufContent += gwAgentLine.length()+1;

	gwUserLine = thebuf + theBufContent;
	theBufContent += gwUserLine.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;


}

int SIPCCMsg_UState_WpAgentHanupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;

	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;


	return theBufContent;
}

int SIPCCMsg_UState_WpAgentHanupCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += agentID.length()+1;	
	memSize += gwAgentLine.length()+1;	
	memSize += gwUserLine.length()+1;

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	return memSize;
}
///Type_UState_WpAgentHanupCallConf
SIPCCMsg_UState_WpAgentHanupCallConf::SIPCCMsg_UState_WpAgentHanupCallConf()
{
	msgType = Type_UState_WpAgentHanupCallConf;
	agentID = "";
}

void SIPCCMsg_UState_WpAgentHanupCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;
}

int SIPCCMsg_UState_WpAgentHanupCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_WpAgentHanupCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += agentID.length()+1;	

	return memSize;
}

///Type_Gateway_WpAgent_LineNo
SIPCCMsg_Gateway_WpAgent_LineNo::SIPCCMsg_Gateway_WpAgent_LineNo()
{
	msgType = Type_Gateway_WpAgent_LineNo;
	agentID = "";
}

void SIPCCMsg_Gateway_WpAgent_LineNo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_WpAgent_LineNo";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	gwAgentLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAgentLine.length()+1, msgsize, strMsg, "gwAgentLine.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwAgentLine.length(), AGENTLINE_LEN, strMsg, "gwAgentLine", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += gwAgentLine.length()+1;

	gwUserLine = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwUserLine.length()+1, msgsize, strMsg, "gwUserLine.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwUserLine.length(), USERLINE_LEN, strMsg, "gwUserLine", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += gwUserLine.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;
}

int SIPCCMsg_Gateway_WpAgent_LineNo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;

	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_WpAgent_LineNo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += agentID.length()+1;	
	memSize += gwAgentLine.length()+1;	
	memSize += gwUserLine.length()+1;
	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;

	return memSize;
}

///Type_ACD_WpAgent_LineNo
SIPCCMsg_ACD_WpAgent_LineNo::SIPCCMsg_ACD_WpAgent_LineNo()
{
	msgType = Type_ACD_WpAgent_LineNo;
	agentID = "";
}

void SIPCCMsg_ACD_WpAgent_LineNo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;

	gwAgentLine = thebuf + theBufContent;
	theBufContent += gwAgentLine.length()+1;

	gwUserLine = thebuf + theBufContent;
	theBufContent += gwUserLine.length()+1;

}

int SIPCCMsg_ACD_WpAgent_LineNo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, gwAgentLine.c_str(), gwAgentLine.length()+1);
	theBufContent += gwAgentLine.length()+1;

	memcpy(thebuf+theBufContent, gwUserLine.c_str(), gwUserLine.length()+1);
	theBufContent += gwUserLine.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_WpAgent_LineNo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += agentID.length()+1;	
	memSize += gwAgentLine.length()+1;	
	memSize += gwUserLine.length()+1;

	return memSize;
}

///Type_Gateway_WpAgentRelease
SIPCCMsg_Gateway_WpAgentRelease::SIPCCMsg_Gateway_WpAgentRelease()
{
	msgType = Type_Gateway_WpAgentRelease;
	agentID = "";
}

void SIPCCMsg_Gateway_WpAgentRelease::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_WpAgentRelease";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	if ( theBufContent >= msgsize )
		return;

	managerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerId.length()+1, msgsize, strMsg, "managerId.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(managerId.length(), MANAGERID_LEN, strMsg, "managerId", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += managerId.length()+1;

	connectPhoneNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+connectPhoneNo.length()+1, msgsize, strMsg, "connectPhoneNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(connectPhoneNo.length(), CALLEENUM_LEN, strMsg, "connectPhoneNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += connectPhoneNo.length()+1;
}

int SIPCCMsg_Gateway_WpAgentRelease::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, connectPhoneNo.c_str(), connectPhoneNo.length()+1);
	theBufContent += connectPhoneNo.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_WpAgentRelease::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += agentID.length()+1;	

	memSize += managerId.length()+1;	
	memSize += connectPhoneNo.length()+1;

	return memSize;
}

SIPCCMsg_Gateway_WebPSTNDialConf::SIPCCMsg_Gateway_WebPSTNDialConf()
{
	msgType = Type_Gateway_WebPSTNDialConf;
	agentID = "";
	comSymbol = "";
	gwName = "";
	newUserPhoneNo = "";
	newAgentPhoneNo = "";
	gwPartNo = "";
	dtmfEN = 0;
	 handleId="";	
		
}

void SIPCCMsg_Gateway_WebPSTNDialConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;

	comSymbol = thebuf + theBufContent;
	theBufContent += comSymbol.length()+1;

	gwName = thebuf + theBufContent;
	theBufContent += gwName.length()+1;

	newUserPhoneNo = thebuf + theBufContent;
	theBufContent += newUserPhoneNo.length()+1;

	newAgentPhoneNo = thebuf + theBufContent;
	theBufContent += newAgentPhoneNo.length()+1;

	gwPartNo = thebuf + theBufContent;
	theBufContent += gwPartNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	memmove(&this->dtmfEN, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (theBufContent >= msgsize)
	{
		return;
	}
	//handleId
	handleId = thebuf + theBufContent;	
	theBufContent += handleId.length()+1;




}

int SIPCCMsg_Gateway_WebPSTNDialConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, comSymbol.c_str(), comSymbol.length()+1);
	theBufContent += comSymbol.length()+1;

	memcpy(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += gwName.length()+1;

	memcpy(thebuf+theBufContent, newUserPhoneNo.c_str(), newUserPhoneNo.length()+1);
	theBufContent += newUserPhoneNo.length()+1;

	memcpy(thebuf+theBufContent, newAgentPhoneNo.c_str(), newAgentPhoneNo.length()+1);
	theBufContent += newAgentPhoneNo.length()+1;

	memcpy(thebuf+theBufContent, gwPartNo.c_str(), gwPartNo.length()+1);
	theBufContent += gwPartNo.length()+1;

	memmove(thebuf+theBufContent, &this->dtmfEN, sizeof(int));
	theBufContent += sizeof(int);

	// handleId
	memcpy(thebuf+theBufContent, handleId.c_str(), handleId.length()+1);
	theBufContent += handleId.length()+1;


	


	return theBufContent;
}

int SIPCCMsg_Gateway_WebPSTNDialConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;	
	memSize += comSymbol.length()+1;	
	memSize += gwName.length()+1;	
	memSize += newUserPhoneNo.length()+1;	
	memSize += newAgentPhoneNo.length()+1;	
	memSize += gwPartNo.length()+1;	
	memSize += sizeof(int);	
	memSize += handleId.length()+1;	//handleId
	

	return memSize;
}

SIPCCMessage_Client_WpAgentMakeCall::SIPCCMessage_Client_WpAgentMakeCall()
{
	msgType = Type_Client_WpAgentMakeCall;
	agentID = "";
	CorpName = "";
	UUIData = "";
	callerNoForSend = "";
	outdialPrefixNo = "";
	AgentLineNo = "";
	agentLineIp = 0;
	agentLinePort = 0;
	theParty = "";
	thePartyType = 0;
	otherParty = "";
	otherPartyType = 0;
	needPreConnect = 0;
	needPreRecord = 0;  
}

void SIPCCMessage_Client_WpAgentMakeCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "agentID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "agentID", ip, port)) ) {return;}
	theBufContent += agentID.length()+1;

	CorpName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+CorpName.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "CorpName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(CorpName.length(), CORPNAME_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "CorpName", ip, port)) ) {return;}
	theBufContent += CorpName.length()+1;

	UUIData = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+UUIData.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "UUIData.length()", ip, port)) ) {return;}
	if ( !(VerifyData(UUIData.length(), UUIDATA_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "UUIData", ip, port)) ) {return;}
	theBufContent += UUIData.length()+1;

	callerNoForSend = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+callerNoForSend.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "callerNoForSend.length()", ip, port)) ) {return;}
	if ( !(VerifyData(callerNoForSend.length(), CALLERNOFORSEND_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "callerNoForSend", ip, port)) ) {return;}
	theBufContent += callerNoForSend.length()+1;

	outdialPrefixNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+outdialPrefixNo.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "outdialPrefixNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(outdialPrefixNo.length(), OUTDIALPREFIXNO_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "outdialPrefixNo", ip, port)) ) {return;}
	theBufContent += outdialPrefixNo.length()+1;

	AgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AgentLineNo.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "AgentLineNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AgentLineNo.length(), AGENTLINENO_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "AgentLineNo", ip, port)) ) {return;}
	theBufContent += AgentLineNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "agentLineIp", ip, port)) ) {return;}
	memmove(&this->agentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "agentLinePort", ip, port)) ) {return;}
	memmove(&this->agentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	theParty = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+theParty.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "theParty.length()", ip, port)) ) {return;}
	if ( !(VerifyData(theParty.length(), THEPARTY_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "theParty", ip, port)) ) {return;}
	theBufContent += theParty.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "thePartyType", ip, port)) ) {return;}
	memmove(&this->thePartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	otherParty = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+otherParty.length()+1, msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "otherParty.length()", ip, port)) ) {return;}
	if ( !(VerifyData(otherParty.length(), OTHERPARTY_LEN, "SIPCCMessage_Client_WpAgentMakeCall", "otherParty", ip, port)) ) {return;}
	theBufContent += otherParty.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "otherPartyType", ip, port)) ) {return;}
	memmove(&this->otherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "needPreConnect", ip, port)) ) {return;}
	memmove(&this->needPreConnect, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, "SIPCCMessage_Client_WpAgentMakeCall", "needPreRecord", ip, port)) ) {return;}
	memmove(&this->needPreRecord, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMessage_Client_WpAgentMakeCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, CorpName.c_str(), CorpName.length()+1);
	theBufContent += CorpName.length()+1;

	memcpy(thebuf+theBufContent, UUIData.c_str(), UUIData.length()+1);
	theBufContent += UUIData.length()+1;

	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;

	memcpy(thebuf+theBufContent, outdialPrefixNo.c_str(), outdialPrefixNo.length()+1);
	theBufContent += outdialPrefixNo.length()+1;

	memcpy(thebuf+theBufContent, AgentLineNo.c_str(), AgentLineNo.length()+1);
	theBufContent += AgentLineNo.length()+1;

	memmove(thebuf+theBufContent, &this->agentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->agentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, theParty.c_str(), theParty.length()+1);
	theBufContent += theParty.length()+1;

	memmove(thebuf+theBufContent, &this->thePartyType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, otherParty.c_str(), otherParty.length()+1);
	theBufContent += otherParty.length()+1;

	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->needPreConnect, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->needPreRecord, sizeof(char));
	theBufContent += sizeof(char);

	return theBufContent;
}

int SIPCCMessage_Client_WpAgentMakeCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;	
	memSize += CorpName.length()+1;	
	memSize += UUIData.length()+1;	
	memSize += callerNoForSend.length()+1;	
	memSize += outdialPrefixNo.length()+1;	
	memSize += AgentLineNo.length()+1;	
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);
	memSize += theParty.length()+1;	
	memSize += sizeof(int);	
	memSize += otherParty.length()+1;	
	memSize += sizeof(int);	
	memSize += sizeof(char);	
	memSize += sizeof(char);

	return memSize;
}

SIPCCMessage_UState_WpAgentMakeCall::SIPCCMessage_UState_WpAgentMakeCall()
{
	msgType = Type_UState_WpAgentMakeCall;
	agentID = "";
	CorpName = "";
	UUIData = "";
	callerNoForSend = "";
	outdialPrefixNo = "";
	AgentLineNo = "";
	agentLineIp = 0;
	agentLinePort = 0;
	theParty = "";
	thePartyType = 0;
	otherParty = "";
	otherPartyType = 0;
	needPreConnect = 0;
	needPreRecord = 0;  
	gatewayName="";
	computerSymbol="";
}

void SIPCCMessage_UState_WpAgentMakeCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	theBufContent += agentID.length()+1;

	CorpName = thebuf + theBufContent;
	theBufContent += CorpName.length()+1;

	UUIData = thebuf + theBufContent;
	theBufContent += UUIData.length()+1;

	callerNoForSend = thebuf + theBufContent;
	theBufContent += callerNoForSend.length()+1;

	outdialPrefixNo = thebuf + theBufContent;
	theBufContent += outdialPrefixNo.length()+1;

	AgentLineNo = thebuf + theBufContent;
	theBufContent += AgentLineNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	memmove(&this->agentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->agentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	theParty = thebuf + theBufContent;
	theBufContent += theParty.length()+1;

	if(theBufContent >= msgsize)
		return;

	memmove(&this->thePartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	otherParty = thebuf + theBufContent;
	theBufContent += otherParty.length()+1;

	if(theBufContent >= msgsize)
		return;

	memmove(&this->otherPartyType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->needPreConnect, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->needPreRecord, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

}

int SIPCCMessage_UState_WpAgentMakeCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, CorpName.c_str(), CorpName.length()+1);
	theBufContent += CorpName.length()+1;

	memcpy(thebuf+theBufContent, UUIData.c_str(), UUIData.length()+1);
	theBufContent += UUIData.length()+1;

	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;

	memcpy(thebuf+theBufContent, outdialPrefixNo.c_str(), outdialPrefixNo.length()+1);
	theBufContent += outdialPrefixNo.length()+1;

	memcpy(thebuf+theBufContent, AgentLineNo.c_str(), AgentLineNo.length()+1);
	theBufContent += AgentLineNo.length()+1;

	memmove(thebuf+theBufContent, &this->agentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->agentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memcpy(thebuf+theBufContent, theParty.c_str(), theParty.length()+1);
	theBufContent += theParty.length()+1;

	memmove(thebuf+theBufContent, &this->thePartyType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, otherParty.c_str(), otherParty.length()+1);
	theBufContent += otherParty.length()+1;

	memmove(thebuf+theBufContent, &this->otherPartyType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->needPreConnect, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->needPreRecord, sizeof(char));
	theBufContent += sizeof(char);


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;


	return theBufContent;
}

int SIPCCMessage_UState_WpAgentMakeCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;	
	memSize += CorpName.length()+1;	
	memSize += UUIData.length()+1;	
	memSize += callerNoForSend.length()+1;	
	memSize += outdialPrefixNo.length()+1;	
	memSize += AgentLineNo.length()+1;	
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);
	memSize += theParty.length()+1;	
	memSize += sizeof(int);	
	memSize += otherParty.length()+1;	
	memSize += sizeof(int);	
	memSize += sizeof(char);	
	memSize += sizeof(char);

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	return memSize;
}

//
SIPCCMsg_Gateway_WpAgentCallAnswerred::SIPCCMsg_Gateway_WpAgentCallAnswerred()
{
	msgType = Type_Gateway_WpAgentCallAnswerred;
	agentID = "";
	gwAgentLineNo = "";
	gwUserLineNo = "";
	gwAgentLineIp = 0;
	gwAgentLinePort = 0;
	gwUserLineIp = 0;
	gwUserLinePort = 0;
	managerId="";
}

void SIPCCMsg_Gateway_WpAgentCallAnswerred::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_WpAgentCallAnswerred";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+agentID.length()+1, msgsize, strMsg, "agentID.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(agentID.length(), AGENTID_LEN, strMsg, "agentID", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += agentID.length()+1;

	gwAgentLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwAgentLineNo.length()+1, msgsize, strMsg, "gwAgentLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwAgentLineNo.length(), AGENTLINENO_LEN, strMsg, "gwAgentLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += gwAgentLineNo.length()+1;

	gwUserLineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwUserLineNo.length()+1, msgsize, strMsg, "gwUserLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(gwUserLineNo.length(), USERLINENO_LEN, strMsg, "gwUserLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += gwUserLineNo.length()+1;

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "gwAgentLineIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->gwAgentLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "gwAgentLinePort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->gwAgentLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "gwUserLineIp", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->gwUserLineIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if(theBufContent >= msgsize)
		return;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "gwUserLinePort", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->gwUserLinePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

   if(theBufContent >= msgsize)
		return;

	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;
}

int SIPCCMsg_Gateway_WpAgentCallAnswerred::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;

	memcpy(thebuf+theBufContent, gwAgentLineNo.c_str(), gwAgentLineNo.length()+1);
	theBufContent += gwAgentLineNo.length()+1;

	memcpy(thebuf+theBufContent, gwUserLineNo.c_str(), gwUserLineNo.length()+1);
	theBufContent += gwUserLineNo.length()+1;

	memmove(thebuf+theBufContent, &this->gwAgentLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->gwAgentLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->gwUserLineIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->gwUserLinePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_WpAgentCallAnswerred::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += agentID.length()+1;	
	memSize += gwAgentLineNo.length()+1;	
	memSize += gwUserLineNo.length()+1;	
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);	
	memSize += sizeof(unsigned short);

	memSize += managerId.length()+1;	

	return memSize;
}

//
SIPCCMsg_ACD_ResetDataCollect::SIPCCMsg_ACD_ResetDataCollect()
{
	msgType = Type_ACD_ResetDataCollect;
	curTime = "";
}

void SIPCCMsg_ACD_ResetDataCollect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_ResetDataCollect";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	curTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+curTime.length()+1, msgsize, strMsg, "curTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(curTime.length(), CURTIME_LEN, strMsg, "curTime", ip, port)) ) {return;}
	theBufContent += curTime.length()+1;
}

int SIPCCMsg_ACD_ResetDataCollect::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_ResetDataCollect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += curTime.length()+1;	

	return memSize;
}

//
SIPCCMsg_ACD_ResetMonitor::SIPCCMsg_ACD_ResetMonitor()
{
	msgType = Type_ACD_ResetMonitor;
	curTime = "";
}

void SIPCCMsg_ACD_ResetMonitor::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	curTime = thebuf + theBufContent;
	theBufContent += curTime.length()+1;
}

int SIPCCMsg_ACD_ResetMonitor::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, curTime.c_str(), curTime.length()+1);
	theBufContent += curTime.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_ResetMonitor::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += curTime.length()+1;	

	return memSize;
}

/////////////////////////////////////////////////////////////////////////////////
///Class_AreaCode
SIPCCMsg_AreaCode::SIPCCMsg_AreaCode()
{
	msgClass = Class_AreaCode;
}

//
SIPCCMsg_AreaQuery::SIPCCMsg_AreaQuery()
{
	msgType = Type_AreaCode_AreaQuery;
	strPhoneNum = "";
	strInvokeId = "";

	iOperationType = 0;
	managerid = "";
	deptName = "";
	agentName = "";
}

void SIPCCMsg_AreaQuery::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	strPhoneNum = thebuf + theBufContent;
	theBufContent += strPhoneNum.length()+1;

	if(theBufContent >= msgsize)
		return;

	strInvokeId = thebuf + theBufContent;
	theBufContent += strInvokeId.length()+1;

	if(theBufContent >= msgsize)
		return;

	//iOperationType
	memmove(&this->iOperationType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//managerid
	managerid = thebuf + theBufContent;
	theBufContent += managerid.length()+1;

	//deptName
	deptName = thebuf + theBufContent;
	theBufContent += deptName.length()+1;

	//agentName
	agentName = thebuf + theBufContent;
	theBufContent += agentName.length()+1;

}

int SIPCCMsg_AreaQuery::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, strPhoneNum.c_str(), strPhoneNum.length()+1);
	theBufContent += strPhoneNum.length()+1;

	memcpy(thebuf+theBufContent, strInvokeId.c_str(), strInvokeId.length()+1);
	theBufContent += strInvokeId.length()+1;

	//iOperationType
	memmove(thebuf+theBufContent, &this->iOperationType, sizeof(int));
	theBufContent += sizeof(int);

	//managerid
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length()+1);
	theBufContent += managerid.length()+1;

	//deptName
	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;

	//agentName
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;

	return theBufContent;
}

int SIPCCMsg_AreaQuery::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strPhoneNum.length()+1;	
	memSize += strInvokeId.length()+1;	

	memSize += sizeof(int);				//iOperationType
	memSize += managerid.length()+1;	//managerid
	memSize += deptName.length()+1;		//deptName
	memSize += agentName.length()+1;	//agentName

	return memSize;
}

//
SIPCCMsg_AreaAnswer::SIPCCMsg_AreaAnswer()
{
	msgType = Type_AreaCode_AreaAnswer;
	strPhoneInfo = "";
	//limitVersion = "";
	//limitVersion_Ocx = "";
	//limitVersion_GUI = "";

	iDialAuthorize = 0; 
}

void SIPCCMsg_AreaAnswer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	strPhoneInfo = thebuf + theBufContent;
	theBufContent += strPhoneInfo.length()+1;

	if(theBufContent >= msgsize)
		return;

	strInvokeId = thebuf + theBufContent;
	theBufContent += strInvokeId.length()+1;

	/*if(theBufContent >= msgsize)
		return;

	limitVersion = thebuf + theBufContent;
	theBufContent += limitVersion.length()+1;

	if(theBufContent >= msgsize)
		return;

	limitVersion_Ocx = thebuf + theBufContent;
	theBufContent += limitVersion_Ocx.length()+1;

	if(theBufContent >= msgsize)
		return;

	limitVersion_GUI = thebuf + theBufContent;
	theBufContent += limitVersion_GUI.length()+1;*/

	if(theBufContent >= msgsize)
		return;

	//iDialAuthorize
	memmove(&this->iDialAuthorize, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_AreaAnswer::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, strPhoneInfo.c_str(), strPhoneInfo.length()+1);
	theBufContent += strPhoneInfo.length()+1;

	memcpy(thebuf+theBufContent, strInvokeId.c_str(), strInvokeId.length()+1);
	theBufContent += strInvokeId.length()+1;

	/*memcpy(thebuf+theBufContent, limitVersion.c_str(), limitVersion.length()+1);
	theBufContent += limitVersion.length()+1;

	memcpy(thebuf+theBufContent, limitVersion_Ocx.c_str(), limitVersion_Ocx.length()+1);
	theBufContent += limitVersion_Ocx.length()+1;

	memcpy(thebuf+theBufContent, limitVersion_GUI.c_str(), limitVersion_GUI.length()+1);
	theBufContent += limitVersion_GUI.length()+1;*/

	//iDialAuthorize
	memmove(thebuf+theBufContent, &this->iDialAuthorize, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_AreaAnswer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strPhoneInfo.length()+1;	
	memSize += strInvokeId.length()+1;	
	//memSize += limitVersion.length()+1;	
	//memSize += limitVersion_Ocx.length()+1;	
	//memSize += limitVersion_GUI.length()+1;

	memSize += sizeof(int);				//iDialAuthorize

	return memSize;
}

SIPCCMsg_OutDial_GwLogin::SIPCCMsg_OutDial_GwLogin()
{
	msgType = Type_OutDial_GwLogin;

	GwId = 0;
	LineCount = 0;
}

void SIPCCMsg_OutDial_GwLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->GwId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	memmove(&this->LineCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OutDial_GwLogin::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->GwId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->LineCount, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OutDial_GwLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}

//
SIPCCMsg_Client_QueryNowVersion::SIPCCMsg_Client_QueryNowVersion()
{
	msgType = Type_Client_QueryNowVersion;
	curVersion = "";
	curVersion_Ocx = "";
	curVersion_GUI = "";
	agentId = "";
	managerId = "";
	lastLoginTime = "";
}

void SIPCCMsg_Client_QueryNowVersion::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	curVersion = thebuf + theBufContent;
	theBufContent += curVersion.length()+1;

	if(theBufContent >= msgsize)
		return;

	curVersion_Ocx = thebuf + theBufContent;
	theBufContent += curVersion_Ocx.length()+1;

	if(theBufContent >= msgsize)
		return;

	curVersion_GUI = thebuf + theBufContent;
	theBufContent += curVersion_GUI.length()+1;

	if(theBufContent >= msgsize)
		return;

	agentId = thebuf + theBufContent;
	theBufContent += agentId.length()+1;

	managerId = thebuf + theBufContent;
	theBufContent += managerId.length()+1;

	if(theBufContent >= msgsize)
		return;

	lastLoginTime = thebuf + theBufContent;
	theBufContent += lastLoginTime.length()+1;
}

int SIPCCMsg_Client_QueryNowVersion::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, curVersion.c_str(), curVersion.length()+1);
	theBufContent += curVersion.length()+1;

	memcpy(thebuf+theBufContent, curVersion_Ocx.c_str(), curVersion_Ocx.length()+1);
	theBufContent += curVersion_Ocx.length()+1;

	memcpy(thebuf+theBufContent, curVersion_GUI.c_str(), curVersion_GUI.length()+1);
	theBufContent += curVersion_GUI.length()+1;

	memcpy(thebuf+theBufContent, agentId.c_str(), agentId.length()+1);
	theBufContent += agentId.length()+1;

	memcpy(thebuf+theBufContent, managerId.c_str(), managerId.length()+1);
	theBufContent += managerId.length()+1;

	memcpy(thebuf+theBufContent, lastLoginTime.c_str(), lastLoginTime.length()+1);
	theBufContent += lastLoginTime.length()+1;

	return theBufContent;
}

int SIPCCMsg_Client_QueryNowVersion::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += curVersion.length()+1;
	memSize += curVersion_Ocx.length()+1;
	memSize += curVersion_GUI.length()+1;
	memSize += agentId.length()+1;
	memSize += managerId.length()+1;
	memSize += lastLoginTime.length()+1;

	return memSize;
}

///Type_Client_UserReLoginStateSvr
SIPCCMsg_Client_UserReLoginStateSvr::SIPCCMsg_Client_UserReLoginStateSvr()
{
	msgType = Type_Client_UserReLoginStateSvr;
	userName = NULL;
	userNameLen = 0;

	natType = NatType_Unknown;

	this->localIP = 0;
	this->localPort = 0;
}

void SIPCCMsg_Client_UserReLoginStateSvr::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//userNameLen
	memmove(&this->userNameLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	if ( (userNameLen>USERNAME_LEN)||(userNameLen<0) )
	{
#ifdef MAKEMSGLOG
		WriteMsgError("SIPCCMsg_Client_UserReLoginStateSvr", "userNameLen too long", ip, port);
#endif
		return;
	}
	//userName
	userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memmove(userName, thebuf+theBufContent, userNameLen);
	theBufContent += userNameLen;

	//natType
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent >= msgsize)
		return;

	//localIP
	memmove(&this->localIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	memmove(&this->localPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_Client_UserReLoginStateSvr::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//userNameLen
	memmove(thebuf+theBufContent, &this->userNameLen, sizeof(int));
	theBufContent += sizeof(int);
	//userName
	memmove(thebuf+theBufContent, this->userName, this->userNameLen);
	theBufContent += userNameLen;

	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);
	//localIP
	memmove(thebuf+theBufContent, &this->localIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	//localPort
	memmove(thebuf+theBufContent, &this->localPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_Client_UserReLoginStateSvr::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//userNameLen
	memSize += this->userNameLen;		//userName
	memSize += sizeof(int);				//natType
	memSize += sizeof(unsigned long);	//localIP
	memSize += sizeof(unsigned short);	//localPort

	return memSize;
}

void SIPCCMsg_Client_UserReLoginStateSvr::SetUserName(string username)
{
	int iUserNameLen = username.length();
	this->userNameLen = iUserNameLen + 1;
	this->userName = new char[userNameLen];
	memset(userName, 0, userNameLen);
	memcpy(userName, username.c_str(), iUserNameLen);
}

//
SIPCCMsg_AreaCode_QueryNowVersionConf::SIPCCMsg_AreaCode_QueryNowVersionConf()
{
	msgType = Type_AreaCode_QueryNowVersionConf;
	limitVersion = "";
	limitVersion_Ocx = "";
	limitVersion_GUI = "";
	haveForceUpdatePower = false;
}

void SIPCCMsg_AreaCode_QueryNowVersionConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	limitVersion = thebuf + theBufContent;
	theBufContent += limitVersion.length()+1;

	limitVersion_Ocx = thebuf + theBufContent;
	theBufContent += limitVersion_Ocx.length()+1;

	limitVersion_GUI = thebuf + theBufContent;
	theBufContent += limitVersion_GUI.length()+1;

	memmove(&this->haveForceUpdatePower, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_AreaCode_QueryNowVersionConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, limitVersion.c_str(), limitVersion.length()+1);
	theBufContent += limitVersion.length()+1;

	memcpy(thebuf+theBufContent, limitVersion_Ocx.c_str(), limitVersion_Ocx.length()+1);
	theBufContent += limitVersion_Ocx.length()+1;

	memcpy(thebuf+theBufContent, limitVersion_GUI.c_str(), limitVersion_GUI.length()+1);
	theBufContent += limitVersion_GUI.length()+1;

	memmove(thebuf+theBufContent, &this->haveForceUpdatePower, sizeof(char));
	theBufContent += sizeof(char);

	return theBufContent;
}

int SIPCCMsg_AreaCode_QueryNowVersionConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += limitVersion.length()+1;
	memSize += limitVersion_Ocx.length()+1;
	memSize += limitVersion_GUI.length()+1;
	memSize += sizeof(char);

	return memSize;
}

//
SIPCCMsg_Gateway_IVRStat::SIPCCMsg_Gateway_IVRStat()
{
	msgType = Type_Gateway_IVRStat;
	nTime = 0;              //当前时间(组合信令时的时间) 32位time_t
	strCallerId = "";		//客户号码
	strCalleeId = "";		//IVR号码
	strSessionId = "";		//会话ID
	strServiceName = "";	//业务名
	nStayTime = 0;			//驻留时间 单位秒
	nEnterTime = 0;			//进入时间 32位time_t
	nLeaveTime = 0;         //离开时间 32位time_t
}

void SIPCCMsg_Gateway_IVRStat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->nTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	strCallerId = thebuf + theBufContent;
	theBufContent += strCallerId.length()+1;

	strCalleeId = thebuf + theBufContent;
	theBufContent += strCalleeId.length()+1;

	strSessionId = thebuf + theBufContent;
	theBufContent += strSessionId.length()+1;

	strServiceName = thebuf + theBufContent;
	theBufContent += strServiceName.length()+1;

	memmove(&this->nStayTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->nEnterTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->nLeaveTime, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Gateway_IVRStat::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->nTime, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, strCallerId.c_str(), strCallerId.length()+1);
	theBufContent += strCallerId.length()+1;

	memcpy(thebuf+theBufContent, strCalleeId.c_str(), strCalleeId.length()+1);
	theBufContent += strCalleeId.length()+1;

	memcpy(thebuf+theBufContent, strSessionId.c_str(), strSessionId.length()+1);
	theBufContent += strSessionId.length()+1;

	memcpy(thebuf+theBufContent, strServiceName.c_str(), strServiceName.length()+1);
	theBufContent += strServiceName.length()+1;

	memmove(thebuf+theBufContent, &this->nStayTime, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->nEnterTime, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->nLeaveTime, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Gateway_IVRStat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				
	memSize += strCallerId.length()+1;
	memSize += strCalleeId.length()+1;
	memSize += strSessionId.length()+1;
	memSize += strServiceName.length()+1;
	memSize += sizeof(int);				
	memSize += sizeof(int);				
	memSize += sizeof(int);				

	return memSize;
}

int SIPCCMsg_alarmRequest::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, strComponentName.c_str(), strComponentName.length()+1);
	theBufContent += strComponentName.length()+1;

	memmove(thebuf+theBufContent, &this->nLevel, sizeof(nLevel));
	theBufContent += sizeof(nLevel);

	memcpy(thebuf+theBufContent,  &this->nErrorNo,sizeof(nErrorNo));
	theBufContent +=  sizeof(nErrorNo);;

	memcpy(thebuf+theBufContent, strDescription.c_str(), strDescription.length()+1);
	theBufContent += strDescription.length()+1;

	memmove(thebuf+theBufContent, &this->nComponentId, sizeof(nComponentId));
	theBufContent += sizeof(nComponentId);

	return theBufContent;
}

void SIPCCMsg_alarmRequest::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_alarmRequest";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strComponentName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strComponentName.length()+1, msgsize, strMsg, "strComponentName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strComponentName.length(), TARGETNUMS_LEN, strMsg, "strComponentName", ip, port)) ) {return;}
	theBufContent += strComponentName.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(nLevel), msgsize, strMsg, "nLevel", ip, port)) ) {return;}
	memmove(&this->nLevel, thebuf+theBufContent, sizeof(nLevel));
	theBufContent += sizeof(nLevel);

	if ( !(VerifyTotalLen(theBufContent+sizeof(nErrorNo), msgsize, strMsg, "nErrorNo", ip, port)) ) {return;}
	memmove(&this->nErrorNo, thebuf+theBufContent, sizeof(nErrorNo));
	theBufContent += sizeof(nErrorNo);

	strDescription = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strDescription.length()+1, msgsize, strMsg, "strDescription.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strDescription.length(), DESCRIPTION_LEN, strMsg, "strDescription", ip, port)) ) {return;}
	theBufContent += strDescription.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(nComponentId), msgsize, strMsg, "nComponentId", ip, port)) ) {return;}
	memmove(&this->nComponentId, thebuf+theBufContent, sizeof(nComponentId));
	theBufContent += sizeof(nComponentId);
}

int SIPCCMsg_alarmRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strComponentName.length()+1;
	memSize += sizeof(nLevel);
	memSize += sizeof(nErrorNo);
	memSize += strDescription.length()+1;
	memSize += sizeof(nComponentId);
	
	return memSize;
}

SIPCCMsg_AgentRecord::SIPCCMsg_AgentRecord()
{
	msgClass = Class_AgentRecord;
}

SIPCCMsg_Record_AgentRecordQueryPort::SIPCCMsg_Record_AgentRecordQueryPort()
{
	msgType = Type_Record_AgentRecordQueryPort;
	nSeq=0;
}

void SIPCCMsg_Record_AgentRecordQueryPort::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_Record_AgentRecordQueryPort";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strInvokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strInvokeID.length()+1, msgsize, strMsg, "strInvokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strInvokeID.length(), INVOKEID_LEN, strMsg, "strInvokeID", ip, port)) ) {return;}
	theBufContent += strInvokeID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(nSeq), msgsize, strMsg, "nSeq", ip, port)) ) {return;}
	memmove(&this->nSeq, thebuf+theBufContent, sizeof(nSeq));
	theBufContent += sizeof(nSeq);

	strPresideAgentAccount = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strPresideAgentAccount.length()+1, msgsize, strMsg, "strPresideAgentAccount.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strPresideAgentAccount.length(), AGENTID_LEN, strMsg, "strPresideAgentAccount", ip, port)) ) {return;}
	theBufContent += strPresideAgentAccount.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	theBufContent += audioStreamDescription.Deserialize(thebuf+theBufContent, msgsize-theBufContent);
}

int SIPCCMsg_Record_AgentRecordQueryPort::FillBuf( char*& thebuf )
{
	int bufsize = GetMyMemSize();
	thebuf = new char[bufsize];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, strInvokeID.c_str(), strInvokeID.length()+1);
	theBufContent += strInvokeID.length()+1;

	memmove(thebuf+theBufContent, &this->nSeq, sizeof(nSeq));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, strPresideAgentAccount.c_str(), strPresideAgentAccount.length()+1);
	theBufContent += strPresideAgentAccount.length()+1;

	//audioStreamDescription
	theBufContent += audioStreamDescription.Serialize(thebuf+theBufContent, bufsize-theBufContent);

	return theBufContent;
}

int SIPCCMsg_Record_AgentRecordQueryPort::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strInvokeID.length()+1;
	memSize += sizeof(nSeq);
	memSize += strPresideAgentAccount.length()+1;

	memSize += audioStreamDescription.GetMemSize();

	return memSize;
}

SIPCCMsg_Record_AgentRecordQueryPortConf::SIPCCMsg_Record_AgentRecordQueryPortConf()
{
	msgType = Type_Record_AgentRecordQueryPortConf;
	nSeq=0;
	nPort=0;

	iResult = 0;
}

int SIPCCMsg_Record_AgentRecordQueryPortConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strInvokeID.length()+1;
	memSize += sizeof(nSeq);
	memSize += strPresideAgentAccount.length()+1;
	memSize += sizeof(nPort);

	memSize += sizeof(int);				//iResult

	return memSize;
}

int SIPCCMsg_Record_AgentRecordQueryPortConf::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, strInvokeID.c_str(), strInvokeID.length()+1);
	theBufContent += strInvokeID.length()+1;

	memmove(thebuf+theBufContent, &this->nSeq, sizeof(nSeq));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, strPresideAgentAccount.c_str(), strPresideAgentAccount.length()+1);
	theBufContent += strPresideAgentAccount.length()+1;

	memmove(thebuf+theBufContent, &this->nPort, sizeof(nPort));
	theBufContent += sizeof(int);

	//iResult
	memmove(thebuf+theBufContent, &this->iResult, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

void SIPCCMsg_Record_AgentRecordQueryPortConf::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_Record_AgentRecordQueryPortConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strInvokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strInvokeID.length()+1, msgsize, strMsg, "strInvokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strInvokeID.length(), INVOKEID_LEN, strMsg, "strInvokeID", ip, port)) ) {return;}
	theBufContent += strInvokeID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(nSeq), msgsize, strMsg, "nSeq", ip, port)) ) {return;}
	memmove(&this->nSeq, thebuf+theBufContent, sizeof(nSeq));
	theBufContent += sizeof(nSeq);

	strPresideAgentAccount = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strPresideAgentAccount.length()+1, msgsize, strMsg, "strPresideAgentAccount.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strPresideAgentAccount.length(), AGENTID_LEN, strMsg, "strPresideAgentAccount", ip, port)) ) {return;}
	theBufContent += strPresideAgentAccount.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(nPort), msgsize, strMsg, "nPort", ip, port)) ) {return;}
	memmove(&this->nPort, thebuf+theBufContent, sizeof(nPort));
	theBufContent += sizeof(nPort);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//iResult
	memmove(&this->iResult, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Record_AgentRecordStart::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, strInvokeID.c_str(), strInvokeID.length()+1);
	theBufContent += strInvokeID.length()+1;

	memmove(thebuf+theBufContent, &this->nSeq, sizeof(nSeq));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, strPresideAgentAccount.c_str(), strPresideAgentAccount.length()+1);
	theBufContent += strPresideAgentAccount.length()+1;

	memcpy(thebuf+theBufContent, strOpTalkingAgentAccount.c_str(), strOpTalkingAgentAccount.length()+1);
	theBufContent += strOpTalkingAgentAccount.length()+1;

	memcpy(thebuf+theBufContent, strStartTime.c_str(), strStartTime.length()+1);
	theBufContent += strStartTime.length()+1;

	memcpy(thebuf+theBufContent, strRecServerSymbol.c_str(), strRecServerSymbol.length()+1);
	theBufContent += strRecServerSymbol.length()+1;

	memcpy(thebuf+theBufContent, strPresideAgentNickname.c_str(), strPresideAgentNickname.length()+1);
	theBufContent += strPresideAgentNickname.length()+1;
	
	memcpy(thebuf+theBufContent, strOpTalkingAgentNickname.c_str(), strOpTalkingAgentNickname.length()+1);
	theBufContent += strOpTalkingAgentNickname.length()+1;

	memcpy(thebuf+theBufContent, strManagerid.c_str(), strManagerid.length()+1);
	theBufContent += strManagerid.length()+1;

	//PresidePhoneNo
	memcpy(thebuf+theBufContent, PresidePhoneNo.c_str(), PresidePhoneNo.length()+1);
	theBufContent += PresidePhoneNo.length()+1;

	//RecordMode
	memmove(thebuf+theBufContent, &this->RecordMode, sizeof(RecordMode));
	theBufContent += sizeof(int);

	//iCallType
	memmove(thebuf+theBufContent, &this->iCallType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

void SIPCCMsg_Record_AgentRecordStart::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_Record_AgentRecordStart";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strInvokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strInvokeID.length()+1, msgsize, strMsg, "strInvokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strInvokeID.length(), INVOKEID_LEN, strMsg, "strInvokeID", ip, port)) ) {return;}
	theBufContent += strInvokeID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(nSeq), msgsize, strMsg, "nSeq", ip, port)) ) {return;}
	memmove(&this->nSeq, thebuf+theBufContent, sizeof(nSeq));
	theBufContent += sizeof(nSeq);

	strPresideAgentAccount = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strPresideAgentAccount.length()+1, msgsize, strMsg, "strPresideAgentAccount.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strPresideAgentAccount.length(), AGENTID_LEN, strMsg, "strPresideAgentAccount", ip, port)) ) {return;}
	theBufContent += strPresideAgentAccount.length()+1;

	strOpTalkingAgentAccount = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strOpTalkingAgentAccount.length()+1, msgsize, strMsg, "strOpTalkingAgentAccount.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strOpTalkingAgentAccount.length(), AGENTID_LEN, strMsg, "strOpTalkingAgentAccount", ip, port)) ) {return;}
	theBufContent += strOpTalkingAgentAccount.length()+1;

	strStartTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strStartTime.length()+1, msgsize, strMsg, "strStartTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strStartTime.length(), TIME_LEN, strMsg, "strStartTime", ip, port)) ) {return;}
	theBufContent += strStartTime.length()+1;

	strRecServerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strRecServerSymbol.length()+1, msgsize, strMsg, "strRecServerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strRecServerSymbol.length(), COMSYMBOL_LEN, strMsg, "strRecServerSymbol", ip, port)) ) {return;}
	theBufContent += strRecServerSymbol.length()+1;

	if ( theBufContent >= msgsize )
		return;
	strPresideAgentNickname = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strPresideAgentNickname.length()+1, msgsize, strMsg, "strPresideAgentNickname.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strPresideAgentNickname.length(), COMSYMBOL_LEN, strMsg, "strPresideAgentNickname", ip, port)) ) {return;}
	theBufContent += strPresideAgentNickname.length()+1;
	
	if ( theBufContent >= msgsize )
		return;
	strOpTalkingAgentNickname = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strOpTalkingAgentNickname.length()+1, msgsize, strMsg, "strOpTalkingAgentNickname.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strOpTalkingAgentNickname.length(), COMSYMBOL_LEN, strMsg, "strOpTalkingAgentNickname", ip, port)) ) {return;}
	theBufContent += strOpTalkingAgentNickname.length()+1;

	strManagerid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strManagerid.length()+1, msgsize, strMsg, "strManagerid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strManagerid.length(), COMSYMBOL_LEN, strMsg, "strManagerid", ip, port)) ) {return;}
	theBufContent += strManagerid.length()+1;

	if(theBufContent >= msgsize)
		return;

	//PresidePhoneNo
	PresidePhoneNo = thebuf + theBufContent;
	theBufContent += PresidePhoneNo.length()+1;

	//RecordMode
	memmove(&this->RecordMode, thebuf+theBufContent, sizeof(RecordMode));
	theBufContent += sizeof(RecordMode);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//iCallType
	memmove(&this->iCallType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_Record_AgentRecordStart::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strInvokeID.length()+1;
	memSize += sizeof(nSeq);
	memSize += strPresideAgentAccount.length()+1;

	memSize += strOpTalkingAgentAccount.length()+1;
	memSize += strStartTime.length()+1;
	memSize += strRecServerSymbol.length()+1;

	memSize += strPresideAgentNickname.length()+1;
	memSize += strOpTalkingAgentNickname.length()+1;
	memSize += strManagerid.length()+1;

	memSize += PresidePhoneNo.length()+1;			//PresidePhoneNo
	memSize += sizeof(RecordMode);					//RecordMode

	memSize += sizeof(int);				//iCallType

	return memSize;
}

SIPCCMsg_Record_AgentRecordStart::SIPCCMsg_Record_AgentRecordStart()
{
	msgType = Type_Record_AgentRecordStart;
	nSeq=0;
	RecordMode = 0;
	PresidePhoneNo = "";

	iCallType = 0;
}

SIPCCMsg_Record_AgentRecordStop::SIPCCMsg_Record_AgentRecordStop()
{
	msgType = Type_Record_AgentRecordStop;
	nSeq=0;
}

int SIPCCMsg_Record_AgentRecordStop::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, strInvokeID.c_str(), strInvokeID.length()+1);
	theBufContent += strInvokeID.length()+1;

	memmove(thebuf+theBufContent, &this->nSeq, sizeof(nSeq));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, stopTime.c_str(), stopTime.length()+1);
	theBufContent += stopTime.length()+1;

	memcpy(thebuf+theBufContent, strPresideAgentAccount.c_str(), strPresideAgentAccount.length()+1);
	theBufContent += strPresideAgentAccount.length()+1;

	memcpy(thebuf+theBufContent, &callEstablished, sizeof(bool));
	theBufContent += sizeof(bool);

	return theBufContent;
}

void SIPCCMsg_Record_AgentRecordStop::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_Record_AgentRecordQueryPort";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strInvokeID = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strInvokeID.length()+1, msgsize, strMsg, "strInvokeID.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strInvokeID.length(), INVOKEID_LEN, strMsg, "strInvokeID", ip, port)) ) {return;}
	theBufContent += strInvokeID.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(nSeq), msgsize, strMsg, "nSeq", ip, port)) ) {return;}
	memmove(&this->nSeq, thebuf+theBufContent, sizeof(nSeq));
	theBufContent += sizeof(nSeq);

	stopTime = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+stopTime.length()+1, msgsize, strMsg, "stopTime.length()", ip, port)) ) {return;}
	if ( !(VerifyData(stopTime.length(), TIME_LEN, strMsg, "stopTime", ip, port)) ) {return;}
	theBufContent += stopTime.length()+1;

	strPresideAgentAccount = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+strPresideAgentAccount.length()+1, msgsize, strMsg, "strPresideAgentAccount.length()", ip, port)) ) {return;}
	if ( !(VerifyData(strPresideAgentAccount.length(), AGENTID_LEN, strMsg, "strPresideAgentAccount", ip, port)) ) {return;}
	theBufContent += strPresideAgentAccount.length()+1;

	if ( theBufContent >= msgsize )
		return;

	memcpy(&callEstablished, thebuf+theBufContent, sizeof(bool)); // 
	theBufContent += sizeof(bool);

}

int SIPCCMsg_Record_AgentRecordStop::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += strInvokeID.length()+1;
	memSize += sizeof(nSeq);
	memSize += stopTime.length()+1;
	memSize += strPresideAgentAccount.length()+1;

	memSize += sizeof(callEstablished);

	return memSize;
}

//////////////////////////////////////////////////////////////////////////

SIPCCMsg_ServerProxy_LoadServerInfo::SIPCCMsg_ServerProxy_LoadServerInfo()
{
	msgType = Type_ServerProxy_LoadServerInfo;
	InvokeID="";
	managerid="";
	acdserverid="";
	indexnum=0;

}

int SIPCCMsg_ServerProxy_LoadServerInfo::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	//InvokeID
	memcpy(thebuf+theBufContent, InvokeID.c_str(), InvokeID.length()+1);
	theBufContent += InvokeID.length()+1;

	//managerid
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length()+1);
	theBufContent += managerid.length()+1;

    //acdserverid
	memcpy(thebuf+theBufContent, acdserverid.c_str(), acdserverid.length()+1);
	theBufContent += acdserverid.length()+1;


    //indexnum
	memmove(thebuf+theBufContent, &this->indexnum, sizeof(indexnum));
	theBufContent += sizeof(int);

	return theBufContent;
}

void SIPCCMsg_ServerProxy_LoadServerInfo::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_Record_AgentRecordQueryPort";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);	


    //InvokeID
	InvokeID = thebuf + theBufContent;	
	theBufContent += InvokeID.length()+1;


	//managerid
	managerid = thebuf + theBufContent;	
	theBufContent += managerid.length()+1;

	//acdserverid
	acdserverid = thebuf + theBufContent;	
	theBufContent += acdserverid.length()+1;

    //indexnum
	memmove(&this->indexnum, thebuf+theBufContent, sizeof(indexnum));
	theBufContent += sizeof(indexnum);


}

int SIPCCMsg_ServerProxy_LoadServerInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeID.length()+1;     //InvokeID
	memSize += managerid.length()+1;    //managerid
	memSize += acdserverid.length()+1;  //acdserverid
	memSize += sizeof(indexnum);        //indexnum

	return memSize;
}

void	CIPCCMsgExchanger::SerializeSamplerMsg(SIPCCMessage& msg, char*& thebuf, int& thebufcontent)
{
	__EIPCCMsgType msgType = (__EIPCCMsgType)msg.msgType;
	switch(msgType)
	{
	case Type_SAMPLER_REPORT:
		{
			thebufcontent = ((SIPCCMSG_SAMPLER_REPORT*)&msg)->FillBuf(thebuf);
			break;
		}
	case Type_SAMPLER_NetDelay:
		{
			thebufcontent = ((SIPCCMSG_SAMPLER_NETDELAY*)&msg)->FillBuf(thebuf);
			break;
		}
	case Type_ACD_SAMPLER_Query:
		{
			thebufcontent = ((SIPCCMSG_ACD_SAMPLER_Query*)&msg)->FillBuf(thebuf);
			break;
		}
	case Type_ACD_SAMPLER_Agreed:
		{
			thebufcontent = ((SIPCCMSG_ACD_SAMPLER_Agreed*)&msg)->FillBuf(thebuf);
			break;
		}
	case Type_SAMPLER_Query:
		{
			thebufcontent = ((SIPCCMSG_SAMPLER_Query*)&msg)->FillBuf(thebuf);
			break;
		}
	case Type_SAMPLER_Agreed:
		{
			thebufcontent = ((SIPCCMSG_SAMPLER_Agreed*)&msg)->FillBuf(thebuf);
			break;
		}
	}
}

void	CIPCCMsgExchanger::DeSerializeSamplerMsg(char* pmsg, int msgsize, int &msgtype, SIPCCMessage &msg, unsigned long ip, unsigned short port)
{
	switch(msgtype)
	{
	case Type_SAMPLER_REPORT:
		{
			((SIPCCMSG_SAMPLER_REPORT*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
			break;
		}
	case Type_SAMPLER_NetDelay:
		{
			((SIPCCMSG_SAMPLER_NETDELAY*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
			break;
		}
	case Type_ACD_SAMPLER_Query:
		{
			((SIPCCMSG_ACD_SAMPLER_Query*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
			break;
		}
	case Type_ACD_SAMPLER_Agreed:
		{
			((SIPCCMSG_ACD_SAMPLER_Agreed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
			break;
		}
	case Type_SAMPLER_Query:
		{
			((SIPCCMSG_SAMPLER_Query*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
			break;
		}
	case Type_SAMPLER_Agreed:
		{
			((SIPCCMSG_SAMPLER_Agreed*)&msg)->AnalyzeBuf(pmsg, msgsize, ip, port);
			break;
		}
	}
}

SIPCCMSG_SAMPLER_REPORT::SIPCCMSG_SAMPLER_REPORT()
{
	this->msgType = Type_SAMPLER_REPORT;
}

int SIPCCMSG_SAMPLER_REPORT::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//samplerlen
	memSize += m_samplerRepData.sSampleData.length() + 1;
	return memSize;
}

int SIPCCMSG_SAMPLER_REPORT::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	int nDataLen = m_samplerRepData.sSampleData.length();
	//samplerlen
	memmove(thebuf+theBufContent, &nDataLen, sizeof(int));
	theBufContent += sizeof(int);

	//samplerdata
	memmove(thebuf+theBufContent, m_samplerRepData.sSampleData.c_str(), nDataLen + 1);
	theBufContent += nDataLen + 1;

	return theBufContent;
}

void SIPCCMSG_SAMPLER_REPORT::AnalyzeBuf(char* thebuf, int msgsize,
										 unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//samplerLen
	int nSamplerLen = 0;
	memmove(&nSamplerLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (nSamplerLen == 0) return;

	TCHAR* pSzSamplerData = new TCHAR[nSamplerLen];
	memset(pSzSamplerData,0,nSamplerLen);

	memmove(pSzSamplerData, thebuf+theBufContent, nSamplerLen);
	m_samplerRepData.sSampleData = pSzSamplerData;
	delete pSzSamplerData;

}

void SIPCCMSG_SAMPLER_REPORT::ReleaseMemory()
{
	int nSize = m_samplerRepData.sSampleData.size();
	m_samplerRepData.sSampleData.erase(0,nSize - 1);
}

void SIPCCMSG_SAMPLER_REPORT::SetSamplerRepData(const SamplerReportData& samplerRepData)
{
	m_samplerRepData.sSampleData = samplerRepData.sSampleData;
}

SamplerReportData SIPCCMSG_SAMPLER_REPORT::GetSamplerRepData()
{
	return m_samplerRepData;
}

SIPCCMSG_SAMPLER_NETDELAY::SIPCCMSG_SAMPLER_NETDELAY()
{
	this->msgType = Type_SAMPLER_NetDelay;
	m_uTimeSendClinet = 0;
	m_uTimeRecClinet = 0;
	m_uTimeSendSrv = 0;
	m_uTimeRecSrv = 0;
	m_nId = 0;
}

int SIPCCMSG_SAMPLER_NETDELAY::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += 4*sizeof(ULONG);			//m_uTimeSendClinet + m_uTimeRecClinet + m_uTimeSendSrv + m_uTimeRecSrv
	memSize += 2*sizeof(int);			//idLen + samplerlen
	memSize += m_samplerRepData.sSampleData.length() + 1;
	return memSize;
}

int SIPCCMSG_SAMPLER_NETDELAY::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &m_uTimeSendClinet, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(thebuf+theBufContent, &m_uTimeRecClinet, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(thebuf+theBufContent, &m_uTimeSendSrv, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(thebuf+theBufContent, &m_uTimeRecSrv, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(thebuf+theBufContent, &m_nId, sizeof(int));
	theBufContent += sizeof(int);

	int nDataLen = m_samplerRepData.sSampleData.length();
	//samplerlen
	memmove(thebuf+theBufContent, &nDataLen, sizeof(int));
	theBufContent += sizeof(int);

	//samplerdata
	memmove(thebuf+theBufContent, m_samplerRepData.sSampleData.c_str(), nDataLen + 1);
	theBufContent += nDataLen + 1;

	return theBufContent;
}

void SIPCCMSG_SAMPLER_NETDELAY::AnalyzeBuf(char* thebuf, int msgsize,
										 unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&m_uTimeSendClinet, thebuf+theBufContent, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(&m_uTimeRecClinet, thebuf+theBufContent, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(&m_uTimeSendSrv, thebuf+theBufContent, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(&m_uTimeRecSrv, thebuf+theBufContent, sizeof(ULONG));
	theBufContent += sizeof(ULONG);

	memmove(&m_nId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//samplerLen
	int nSamplerLen = 0;
	memmove(&nSamplerLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (nSamplerLen == 0) return;

	TCHAR* pSzSamplerData = new TCHAR[nSamplerLen];
	memset(pSzSamplerData,0,nSamplerLen);

	memmove(pSzSamplerData, thebuf+theBufContent, nSamplerLen);
	m_samplerRepData.sSampleData = pSzSamplerData;
	delete pSzSamplerData;

}

void SIPCCMSG_SAMPLER_NETDELAY::ReleaseMemory()
{
}

SIPCCMSG_ACD_SAMPLER_Query::SIPCCMSG_ACD_SAMPLER_Query()
{
	this->msgType = Type_ACD_SAMPLER_Query;
}

int SIPCCMSG_ACD_SAMPLER_Query::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//samplerlen
	memSize += m_samplerData.strategy.length() + 1;
	return memSize;
}

int SIPCCMSG_ACD_SAMPLER_Query::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	int nDataLen = m_samplerData.strategy.length();
	//samplerlen
	memmove(thebuf+theBufContent, &nDataLen, sizeof(int));
	theBufContent += sizeof(int);

	//samplerdata
	memmove(thebuf+theBufContent, m_samplerData.strategy.c_str(), nDataLen + 1);
	theBufContent += nDataLen + 1;

	return theBufContent;
}

void SIPCCMSG_ACD_SAMPLER_Query::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip,
											unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//samplerLen
	int nSamplerLen = 0;
	memmove(&nSamplerLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (nSamplerLen == 0) return;

	TCHAR* pSzSamplerData = new TCHAR[nSamplerLen];
	memset(pSzSamplerData,0,nSamplerLen);

	memmove(pSzSamplerData, thebuf+theBufContent, nSamplerLen);
	m_samplerData.strategy = pSzSamplerData;
	delete pSzSamplerData;

}

void SIPCCMSG_ACD_SAMPLER_Query::ReleaseMemory()
{
}

void SIPCCMSG_ACD_SAMPLER_Query::SetSamplerData(const SamplerData& samplerData)
{
	m_samplerData.strategy = samplerData.strategy;
}

void SIPCCMSG_ACD_SAMPLER_Query::GetSamplerData(SamplerData& samplerData)
{
	samplerData.strategy = m_samplerData.strategy;
}

SIPCCMSG_ACD_SAMPLER_Agreed::SIPCCMSG_ACD_SAMPLER_Agreed()
{
	this->msgType = Type_ACD_SAMPLER_Agreed;

}

int SIPCCMSG_ACD_SAMPLER_Agreed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//samplerlen
	memSize += m_samplerData.strategy.length() + 1;
	return memSize;
}

int SIPCCMSG_ACD_SAMPLER_Agreed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	int nDataLen = m_samplerData.strategy.length();
	//samplerlen
	memmove(thebuf+theBufContent, &nDataLen, sizeof(int));
	theBufContent += sizeof(int);

	//samplerdata
	memmove(thebuf+theBufContent, m_samplerData.strategy.c_str(), nDataLen + 1);
	theBufContent += nDataLen + 1;

	return theBufContent;
}

void SIPCCMSG_ACD_SAMPLER_Agreed::AnalyzeBuf(char* thebuf, int msgsize,
											 unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//samplerLen
	int nSamplerLen = 0;
	memmove(&nSamplerLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (nSamplerLen == 0) return;

	TCHAR* pSzSamplerData = new TCHAR[nSamplerLen];
	memset(pSzSamplerData,0,nSamplerLen);

	memmove(pSzSamplerData, thebuf+theBufContent, nSamplerLen);
	m_samplerData.strategy = pSzSamplerData;
	delete pSzSamplerData;

}

void SIPCCMSG_ACD_SAMPLER_Agreed::ReleaseMemory()
{
}

void SIPCCMSG_ACD_SAMPLER_Agreed::SetSamplerData(const SamplerData& samplerData)
{
	m_samplerData.strategy = samplerData.strategy;
}

void SIPCCMSG_ACD_SAMPLER_Agreed::GetSamplerData(SamplerData& samplerData)
{
	samplerData.strategy = m_samplerData.strategy;
}

SIPCCMSG_SAMPLER_Query::SIPCCMSG_SAMPLER_Query()
{
	this->msgType = Type_SAMPLER_Query;

}

int SIPCCMSG_SAMPLER_Query::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//samplerlen
	memSize += m_samplerData.strategy.length() + 1;
	return memSize;
}

int SIPCCMSG_SAMPLER_Query::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	int nDataLen = m_samplerData.strategy.length();
	//samplerlen
	memmove(thebuf+theBufContent, &nDataLen, sizeof(int));
	theBufContent += sizeof(int);

	//samplerdata
	memmove(thebuf+theBufContent, m_samplerData.strategy.c_str(), nDataLen + 1);
	theBufContent += nDataLen + 1;

	return theBufContent;
}

void SIPCCMSG_SAMPLER_Query::AnalyzeBuf(char* thebuf, int msgsize,
										unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//samplerLen
	int nSamplerLen = 0;
	memmove(&nSamplerLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (nSamplerLen == 0) return;

	TCHAR* pSzSamplerData = new TCHAR[nSamplerLen];
	memset(pSzSamplerData,0,nSamplerLen);

	memmove(pSzSamplerData, thebuf+theBufContent, nSamplerLen);
	m_samplerData.strategy = pSzSamplerData;
	delete pSzSamplerData;

}

void SIPCCMSG_SAMPLER_Query::ReleaseMemory()
{
}

void SIPCCMSG_SAMPLER_Query::SetSamplerData(const SamplerData& samplerData)
{
	m_samplerData.strategy = samplerData.strategy;
}

void SIPCCMSG_SAMPLER_Query::GetSamplerData(SamplerData& samplerData)
{
	samplerData.strategy = m_samplerData.strategy;
}

SIPCCMSG_SAMPLER_Agreed::SIPCCMSG_SAMPLER_Agreed()
{
	this->msgType = Type_SAMPLER_Agreed;

}

int SIPCCMSG_SAMPLER_Agreed::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);				//samplerlen
	memSize += m_samplerData.strategy.length() + 1;
	return memSize;
}

int SIPCCMSG_SAMPLER_Agreed::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	int nDataLen = m_samplerData.strategy.length();
	//samplerlen
	memmove(thebuf+theBufContent, &nDataLen, sizeof(int));
	theBufContent += sizeof(int);

	//samplerdata
	memmove(thebuf+theBufContent, m_samplerData.strategy.c_str(), nDataLen + 1);
	theBufContent += nDataLen + 1;

	return theBufContent;
}

void SIPCCMSG_SAMPLER_Agreed::AnalyzeBuf(char* thebuf, int msgsize,
										 unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//samplerLen
	int nSamplerLen = 0;
	memmove(&nSamplerLen, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if (nSamplerLen == 0) return;

	TCHAR* pSzSamplerData = new TCHAR[nSamplerLen];
	memset(pSzSamplerData,0,nSamplerLen);

	memmove(pSzSamplerData, thebuf+theBufContent, nSamplerLen);
	m_samplerData.strategy = pSzSamplerData;
	delete pSzSamplerData;

}

void SIPCCMSG_SAMPLER_Agreed::ReleaseMemory()
{
}

void SIPCCMSG_SAMPLER_Agreed::SetSamplerData(const SamplerData& samplerData)
{
	m_samplerData.strategy = samplerData.strategy;
}

void SIPCCMSG_SAMPLER_Agreed::GetSamplerData(SamplerData& samplerData)
{
	samplerData.strategy = m_samplerData.strategy;
}

SIPCCMSG_OutDial_SetOutdialGroup::SIPCCMSG_OutDial_SetOutdialGroup()
{
	msgType = Type_OutDial_SetOutdialGroup;
}

void SIPCCMSG_OutDial_SetOutdialGroup::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMSG_OutDial_SetOutdialGroup";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	GroupName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GroupName.length()+1, msgsize, strMsg, "GroupName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GroupName.length(), GROUP_LEN, strMsg, "GroupName", ip, port)) ) {return;}
	theBufContent += GroupName.length()+1;
}

int SIPCCMSG_OutDial_SetOutdialGroup::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, GroupName.c_str(), GroupName.length()+1);
	theBufContent += GroupName.length()+1;

	return theBufContent;
}

int SIPCCMSG_OutDial_SetOutdialGroup::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += GroupName.length()+1;	

	return memSize;
}

int SIPCCMsg_CallControl_RegisterGateway::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memmove(thebuf+theBufContent,gateway_name.c_str(),gateway_name.length()+1);
	theBufContent += gateway_name.length()+1;
	
	/*
	memmove(thebuf + theBufContent,&expire_time,sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	*/
	return theBufContent;
}

void SIPCCMsg_CallControl_RegisterGateway::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_CallControl_GetTrunkSetting";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	gateway_name = thebuf + theBufContent;
	theBufContent += gateway_name.length()+1;

	if ( !(VerifyTotalLen(theBufContent+gateway_name.length()+1, msgsize, strMsg, "gateway_name.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gateway_name.length(), GWNAME_LEN, strMsg, "gateway_name", ip, port)) ) {return;}

	
	//not used now
	/*
	const unsigned int * const p_expire_time = (const unsigned int * const)(thebuf + theBufContent);
	expire_time = *p_expire_time;
	theBufContent += sizeof(unsigned int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned int), msgsize, strMsg, "sizeof(expire_time)", ip, port)) ) {return;}	
	*/
	
}

int SIPCCMsg_CallControl_RegisterGateway::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gateway_name.length()+1;	

	//memSize += sizeof(unsigned int);
	return memSize;
}

int SIPCCMsg_CallControl_SetTrunkSetting::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memmove(thebuf+theBufContent,gateway_name.c_str(),gateway_name.length()+1);
	theBufContent += gateway_name.length()+1;

	map<string,unsigned int>::iterator it = trunk_setting.begin();
	
	ostringstream oss;
	while(it != trunk_setting.end()){
		oss << it->first << ',';
		oss << it->second << ';';	
		it++;
	}
	memmove(thebuf + theBufContent, oss.str().c_str(),oss.str().length()+1);

	return theBufContent;
}

void SIPCCMsg_CallControl_SetTrunkSetting::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_CallControl_SetTrunkSetting";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	gateway_name = thebuf + theBufContent;
	theBufContent += gateway_name.length()+1;

	if ( !(VerifyTotalLen(theBufContent+gateway_name.length()+1, msgsize, strMsg, "gateway_name.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gateway_name.length(), GWNAME_LEN, strMsg, "gateway_name", ip, port)) ) {return;}

	
	
	string str_trunk_setting = thebuf + theBufContent;
	theBufContent += str_trunk_setting.length()+1;

	if ( !(VerifyTotalLen(theBufContent+str_trunk_setting.length()+1, msgsize, strMsg, "trunk_setting.length()", ip, port)) ) {return;}
	if ( !(VerifyData(str_trunk_setting.length(), TRUNKSTAT_LEN, strMsg, "trunk_setting", ip, port)) ) {return;}

	size_t i = 0;
	while(i < str_trunk_setting.length()){
		size_t comma = str_trunk_setting.find(',',i);
		if(comma != -1){
			size_t semicolon = str_trunk_setting.find(';',comma);
			if(semicolon != -1){
				string trunk = str_trunk_setting.substr(i,comma);
				string limit = str_trunk_setting.substr(comma+1,semicolon);
				unsigned int int_limit = atoi(limit.c_str());

				trunk_setting.insert(make_pair(trunk,int_limit));

				i+= semicolon + 1;
			}else{
				break;
			}
		}else{
			break;
		}
	}

}

int SIPCCMsg_CallControl_SetTrunkSetting::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gateway_name.length()+1;	
	
	map<string,unsigned int>::iterator it = trunk_setting.begin();
	ostringstream oss;

	while(it != trunk_setting.end()){		
		oss << it->first << ',';
		oss << it->second << ';';		
	}

	memSize += oss.str().length() + 1;

	return memSize;
}

int SIPCCMsg_CallControl_KeepAlive::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memmove(thebuf+theBufContent,gateway_name.c_str(),gateway_name.length()+1);
	theBufContent += gateway_name.length()+1;

	return theBufContent;
}



void SIPCCMsg_CallControl_KeepAlive::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_CallControl_SetTrunkSetting";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	gateway_name = thebuf + theBufContent;
	theBufContent += gateway_name.length()+1;

	if ( !(VerifyTotalLen(theBufContent+gateway_name.length()+1, msgsize, strMsg, "gateway_name.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gateway_name.length(), GWNAME_LEN, strMsg, "gateway_name", ip, port)) ) {return;}
}

int SIPCCMsg_CallControl_KeepAlive::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gateway_name.length()+1;	
	
	return memSize;
}

int SIPCCMsg_CallControl_CallDetail::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memmove(thebuf+theBufContent,src_gateway_name.c_str(),src_gateway_name.length()+1);
	theBufContent += src_gateway_name.length()+1;

	memmove(thebuf+theBufContent,called_number.c_str(),called_number.length()+1);
	theBufContent += called_number.length()+1;

	memmove(thebuf+theBufContent,calling_number.c_str(),calling_number.length()+1);
	theBufContent += calling_number.length()+1;

	memmove(thebuf+theBufContent,orig_time.c_str(),orig_time.length()+1);
	theBufContent += orig_time.length()+1;
	

	return theBufContent;
}

void SIPCCMsg_CallControl_CallDetail::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_CallControl_CallDetail";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	src_gateway_name = thebuf + theBufContent;
	theBufContent += src_gateway_name.length()+1;

	if ( !(VerifyTotalLen(theBufContent+src_gateway_name.length()+1, msgsize, strMsg, "src_gateway_name.length()", ip, port)) ) {return;}
	if ( !(VerifyData(src_gateway_name.length(), GWNAME_LEN, strMsg, "src_gateway_name", ip, port)) ) {return;}

	called_number = thebuf + theBufContent;
	theBufContent += called_number.length()+1;

	if ( !(VerifyTotalLen(theBufContent+called_number.length()+1, msgsize, strMsg, "called_number.length()", ip, port)) ) {return;}
	if ( !(VerifyData(called_number.length(), PHONENO_LEN, strMsg, "called_number", ip, port)) ) {return;}

	calling_number = thebuf + theBufContent;
	theBufContent += calling_number.length()+1;

	if ( !(VerifyTotalLen(theBufContent+calling_number.length()+1, msgsize, strMsg, "calling_number.length()", ip, port)) ) {return;}
	if ( !(VerifyData(calling_number.length(), PHONENO_LEN, strMsg, "calling_number", ip, port)) ) {return;}

	orig_time = thebuf + theBufContent;
	theBufContent += orig_time.length()+1;

	if ( !(VerifyTotalLen(theBufContent+orig_time.length()+1, msgsize, strMsg, "orig_time.length()", ip, port)) ) {return;}
	if ( !(VerifyData(orig_time.length(), TIME_LEN, strMsg, "orig_time", ip, port)) ) {return;}


}

int SIPCCMsg_CallControl_CallDetail::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += src_gateway_name.length()+1;	
	memSize += called_number.length()+1;	
	memSize += calling_number.length()+1;	
	memSize += orig_time.length()+1;	

	return memSize;
}

void SIPCCMSG_OutDial_ExitOutDial::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMSG_OutDial_ExitOutDial";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	AgentId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AgentId.length()+1, msgsize, strMsg, "AgentId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AgentId.length(), AGENTNAME_LEN, strMsg, "AgentId", ip, port)) ) {return;}
	theBufContent += AgentId.length()+1;
}

int SIPCCMSG_OutDial_ExitOutDial::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, AgentId.c_str(), AgentId.length()+1);
	theBufContent += AgentId.length()+1;

	return theBufContent;
}

int SIPCCMSG_OutDial_ExitOutDial::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += AgentId.length()+1;	

	return memSize;
}

void SIPCCMSG_OutDial_JoinOutDial::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMSG_OutDial_JoinOutDial";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	AgentId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AgentId.length()+1, msgsize, strMsg, "AgentId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AgentId.length(), AGENTNAME_LEN, strMsg, "AgentId", ip, port)) ) {return;}
	theBufContent += AgentId.length()+1;
}

int SIPCCMSG_OutDial_JoinOutDial::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, AgentId.c_str(), AgentId.length()+1);
	theBufContent += AgentId.length()+1;

	return theBufContent;
}

int SIPCCMSG_OutDial_JoinOutDial::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += AgentId.length()+1;	

	return memSize;
}

void SIPCCMSG_SysManage_MoveAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMSG_SysManage_MoveAgent";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	DeptmentId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+DeptmentId.length()+1, msgsize, strMsg, "DeptmentId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(DeptmentId.length(), GROUP_LEN, strMsg, "DeptmentId", ip, port)) ) {return;}
	theBufContent += DeptmentId.length()+1;

	AgentList = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AgentList.length()+1, msgsize, strMsg, "AgentList.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AgentList.length(), GROUP_LEN, strMsg, "AgentList", ip, port)) ) {return;}
	theBufContent += AgentList.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}

	IsOutdial = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+IsOutdial.length()+1, msgsize, strMsg, "DeptmentId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(IsOutdial.length(), GROUP_LEN, strMsg, "DeptmentId", ip, port)) ) {return;}
	theBufContent += IsOutdial.length()+1;
}

int SIPCCMSG_SysManage_MoveAgent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, DeptmentId.c_str(), DeptmentId.length()+1);
	theBufContent += DeptmentId.length()+1;

	memcpy(thebuf+theBufContent, AgentList.c_str(), AgentList.length()+1);
	theBufContent += AgentList.length()+1;

	memcpy(thebuf+theBufContent, IsOutdial.c_str(), IsOutdial.length()+1);
	theBufContent += IsOutdial.length()+1;

	return theBufContent;
}

int SIPCCMSG_SysManage_MoveAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += DeptmentId.length()+1;	
	memSize += AgentList.length()+1;	
	memSize += IsOutdial.length()+1;	

	return memSize;
}

void SIPCCMSG_ACD_SwitchDept::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMSG_SysManage_MoveAgent";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	Corp = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+Corp.length()+1, msgsize, strMsg, "Corp.length()", ip, port)) ) {return;}
	if ( !(VerifyData(Corp.length(), GROUP_LEN, strMsg, "Corp", ip, port)) ) {return;}
	theBufContent += Corp.length()+1;

	Dept = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+Dept.length()+1, msgsize, strMsg, "Dept.length()", ip, port)) ) {return;}
	if ( !(VerifyData(Dept.length(), GROUP_LEN, strMsg, "Dept", ip, port)) ) {return;}
	theBufContent += Dept.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "IsOutdial", ip, port)) ) {return;}
	memmove(&this->IsOutdial, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMSG_ACD_SwitchDept::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, Corp.c_str(), Corp.length()+1);
	theBufContent += Corp.length()+1;

	memcpy(thebuf+theBufContent, Dept.c_str(), Dept.length()+1);
	theBufContent += Dept.length()+1;

	memmove(thebuf+theBufContent, &this->IsOutdial, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMSG_ACD_SwitchDept::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += Corp.length()+1;	
	memSize += Dept.length()+1;	
	memSize += sizeof(int);	

	return memSize;
}

int SIPCCMsg_DIDControl_QueryGatewayConfig::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, gateway_name.c_str(), gateway_name.length()+1);
	theBufContent += gateway_name.length()+1;

	return theBufContent;
}

void SIPCCMsg_DIDControl_QueryGatewayConfig::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_DIDControl_QueryGatewayConfig";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	gateway_name = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gateway_name.length()+1, msgsize, strMsg, "gateway_name.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gateway_name.length(), GWNAME_LEN, strMsg, "gateway_name", ip, port)) ) {return;}
	theBufContent += gateway_name.length()+1;
}

int SIPCCMsg_DIDControl_QueryGatewayConfig::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gateway_name.length()+1;		

	return memSize;
}

int SIPCCMsg_DIDControl_Response::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memmove(thebuf+theBufContent,&_size,sizeof(_size));
	theBufContent += sizeof(_size);
	
	vector<string>::iterator it = _did_num.begin();

	ostringstream oss;
	while(it != _did_num.end()){
		oss << *it++;
		if(it != _did_num.end()){
			oss << ",";
		}else{
			oss << ";";
		}
	}
	
	/*it = _corp_name.begin();

	while(it != _corp_name.end()){
		oss << *it++;
		if(it != _corp_name.end()){
			oss << ",";
		}else{
			oss << ";";
		}
	}
	*/
	it = _tts_stg.begin();

	while(it != _tts_stg.end()){
		oss << *it++;
		if(it != _tts_stg.end()){
			oss << ",";
		}else{
			oss << ";";
		}
	}

	memmove(thebuf + theBufContent, oss.str().c_str(),oss.str().length()+1);

	return theBufContent;
}

void SIPCCMsg_DIDControl_Response::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_DIDControl_Response";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->_size,thebuf+theBufContent, sizeof(_size));
	theBufContent += sizeof(_size);

	if ( !(VerifyTotalLen(theBufContent+sizeof(_size), msgsize, strMsg, "sizeof(_size)", ip, port)) ) {return;}
	if ( !(VerifyData(sizeof(_size), sizeof(_size), strMsg, "_size", ip, port)) ) {return;}



	string buffer = thebuf + theBufContent;
	theBufContent += buffer.length()+1;

	if ( !(VerifyTotalLen(theBufContent+buffer.length()+1, msgsize, strMsg, "buffer.length()", ip, port)) ) {return;}
	if ( !(VerifyData(buffer.length(), GENERAL_LARGE_FIELD_LEN, strMsg, "buffer", ip, port)) ) {return;}

	int member=0;

	size_t i = 0;
	vector<string> v;	
	bool more_member = true;

	while(i < buffer.length() && more_member){

		size_t delim = buffer.find_first_of(",;",i);	

		if(delim != -1){
			v.push_back(buffer.substr(i,delim));
		}
		
		//copy member
		if(buffer[delim] == ';' || delim == -1){
			switch (member)
			{
			case 0:
				{
					_did_num = v;
					break;
				}				
			case 1:
				{
					_tts_stg = v;
					break;
				}
			default:
				{
					more_member = false;
				}
				break;
			}
			v.clear();
		}
		//copy member end

		i = delim + 1;
	}
}

int SIPCCMsg_DIDControl_Response::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += sizeof(_size);	
	
	vector<string>::iterator it = _did_num.begin();

	ostringstream oss;
	while(it != _did_num.end()){
		oss << *it++;
		if(it != _did_num.end()){
			oss << ",";
		}else{
			oss << ";";
		}
	}

	/*
	it = _corp_name.begin();

	while(it != _corp_name.end()){
		oss << *it++;
		if(it != _corp_name.end()){
			oss << ",";
		}else{
			oss << ";";
		}
	}
	*/
	it = _tts_stg.begin();

	while(it != _tts_stg.end()){
		oss << *it++;
		if(it != _tts_stg.end()){
			oss << ",";
		}else{
			oss << ";";
		}
	}

	return oss.str().length();
}

int SIPCCMsg_DIDControl_QueryDIDConfig::FillBuf( char*& thebuf )
{	
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, _did_num.c_str(), _did_num.length()+1);
	theBufContent += _did_num.length()+1;

	return theBufContent;
}

void SIPCCMsg_DIDControl_QueryDIDConfig::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	string strMsg = "SIPCCMsg_DIDControl_QueryDIDConfig";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	_did_num = thebuf + theBufContent;
	theBufContent += _did_num.length()+1;

	if ( !(VerifyTotalLen(theBufContent+_did_num.length()+1, msgsize, strMsg, "_did_num.length()", ip, port)) ) {return;}
	if ( !(VerifyData(_did_num.length(), PHONENO_LEN, strMsg, "_did_num", ip, port)) ) {return;}
}

int SIPCCMsg_DIDControl_QueryDIDConfig::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += _did_num.length()+1;		

	return memSize;
}

void SIPCCMsg_OneKeySwitch_HeartBeatRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_HeartBeatRegister";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerIp", ip, port)) ) {return;}
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerPort", ip, port)) ) {return;}
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OneKeySwitch_HeartBeatRegister::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->ServerType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_HeartBeatRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ServerName.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetServerHeartBeatServer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_HeartBeatRegister";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->IsCtrl, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServer::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memmove(thebuf+theBufContent, &this->IsCtrl, sizeof(char));
	theBufContent += sizeof(char);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += sizeof(char);

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_HeartBeatRegister";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	size_t iSize = *(size_t*)(thebuf+theBufContent);
	theBufContent += sizeof(size_t);
	for (size_t i = 0; i < iSize; i++)
	{
		string sServerName = thebuf+theBufContent;
		theBufContent += sServerName.length() + 1;

		unsigned long iServerIp = *(unsigned long*)(thebuf+theBufContent);
		theBufContent += sizeof(unsigned long);

		unsigned short iServerPort = *(unsigned short*)(thebuf+theBufContent);
		theBufContent += sizeof(unsigned short);

		ServerList[sServerName] = make_pair(iServerIp, iServerPort);
	}
}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	*(size_t*)(thebuf+theBufContent) = ServerList.size();
	theBufContent += sizeof(size_t);
	for (map<string, pair<unsigned long, unsigned short> >::iterator it = ServerList.begin(); it != ServerList.end(); ++it)
	{
		memcpy(thebuf+theBufContent, it->first.c_str(), it->first.length()+1);
		theBufContent += it->first.length()+1;

		*(unsigned long*)(thebuf+theBufContent) = it->second.first;
		theBufContent += sizeof(unsigned long);

		*(unsigned short*)(thebuf+theBufContent) = it->second.second;
		theBufContent += sizeof(unsigned short);
	}

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

	memSize += sizeof(size_t);
	for (map<string, pair<unsigned long, unsigned short> >::iterator it = ServerList.begin(); it != ServerList.end(); ++it)
	{
		memSize += it->first.length()+1;
		memSize += sizeof(unsigned long);
		memSize += sizeof(unsigned short);
	}

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetClientHeartBeatServer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_HeartBeatRegister";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->IsCtrl, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_OneKeySwitch_GetClientHeartBeatServer::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memmove(thebuf+theBufContent, &this->IsCtrl, sizeof(char));
	theBufContent += sizeof(char);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetClientHeartBeatServer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += sizeof(char);

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetClientHeartBeatServerConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_HeartBeatRegister";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	size_t iSize = *(size_t*)(thebuf+theBufContent);
	theBufContent += sizeof(size_t);
	for (size_t i = 0; i < iSize; i++)
	{
		string sServerName = thebuf+theBufContent;
		theBufContent += sServerName.length() + 1;

		unsigned long iServerIp = *(unsigned long*)(thebuf+theBufContent);
		theBufContent += sizeof(unsigned long);

		unsigned short iServerPort = *(unsigned short*)(thebuf+theBufContent);
		theBufContent += sizeof(unsigned short);

		ServerList[sServerName] = make_pair(iServerIp, iServerPort);
	}
}

int SIPCCMsg_OneKeySwitch_GetClientHeartBeatServerConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	*(size_t*)(thebuf+theBufContent) = ServerList.size();
	theBufContent += sizeof(size_t);
	for (map<string, pair<unsigned long, unsigned short> >::iterator it = ServerList.begin(); it != ServerList.end(); ++it)
	{
		memcpy(thebuf+theBufContent, it->first.c_str(), it->first.length()+1);
		theBufContent += it->first.length()+1;

		*(unsigned long*)(thebuf+theBufContent) = it->second.first;
		theBufContent += sizeof(unsigned long);

		*(unsigned short*)(thebuf+theBufContent) = it->second.second;
		theBufContent += sizeof(unsigned short);
	}

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetClientHeartBeatServerConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

	memSize += sizeof(size_t);
	for (map<string, pair<unsigned long, unsigned short> >::iterator it = ServerList.begin(); it != ServerList.end(); ++it)
	{
		memSize += it->first.length()+1;
		memSize += sizeof(unsigned long);
		memSize += sizeof(unsigned short);
	}

	return memSize;
}

void SIPCCMsg_OneKeySwitch_ServerHeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GwManagerServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);


	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

    if(theBufContent == msgsize)
		return;

    memmove(&Service1ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service1Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&Service2ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service2Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&Service3ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service3Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&Service4ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&Service4Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&sendtime, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//isProxyRegister
	memmove(&this->isProxyRegister, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OneKeySwitch_ServerHeartBeat::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memmove(thebuf+theBufContent, &this->ServerType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->GwManagerServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);


	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);


   

	memmove(thebuf+theBufContent, &this->Service1ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service1Type, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->Service2ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service2Type, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->Service3ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service3Type, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->Service4ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service4Type, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->sendtime, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);


	//isProxyRegister
	memmove(thebuf+theBufContent, &this->isProxyRegister, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ServerHeartBeat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += GwName.length()+1;	
	memSize += ComputerSymbol.length()+1;	
	memSize += sizeof(int);
	memSize += sizeof(unsigned long);
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += sizeof(unsigned long);

	memSize += sizeof(int);		//isProxyRegister

	return memSize;
}

void SIPCCMsg_OneKeySwitch_ClientHeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	AgentName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AgentName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AgentName.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += AgentName.length()+1;

	ManagerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ManagerId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ManagerId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ManagerId.length()+1;

	AcdServerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AcdServerId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AcdServerId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += AcdServerId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GetConf, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	memmove(&this->ACDServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->UStateServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

    memmove(&this->GWManageServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->AreaCodeServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


}

int SIPCCMsg_OneKeySwitch_ClientHeartBeat::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, AgentName.c_str(), AgentName.length()+1);
	theBufContent += AgentName.length()+1;

	memcpy(thebuf+theBufContent, ManagerId.c_str(), ManagerId.length()+1);
	theBufContent += ManagerId.length()+1;

	memcpy(thebuf+theBufContent, AcdServerId.c_str(), AcdServerId.length()+1);
	theBufContent += AcdServerId.length()+1;

	memmove(thebuf+theBufContent, &this->AcdServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->AcdServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->GetConf, sizeof(char));
	theBufContent += sizeof(char);



	memmove(thebuf+theBufContent, &this->ACDServerID, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->UStateServerID, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->GWManageServerID, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->AreaCodeServerID, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ClientHeartBeat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += AgentName.length()+1;	
	memSize += ManagerId.length()+1;	
	memSize += AcdServerId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(char);
	memSize += sizeof(int);//ACDServerID
	memSize += sizeof(int);//UStateServerID
	memSize += sizeof(int);//GWManageServerID
	memSize += sizeof(int);//AreaCodeServerID


	return memSize;
}

void SIPCCMsg_OneKeySwitch_ClientHeartBeatConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;
}

int SIPCCMsg_OneKeySwitch_ClientHeartBeatConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ClientHeartBeatConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ServerName.length()+1;	

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetGwList::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;
}

int SIPCCMsg_OneKeySwitch_GetGwList::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetGwList::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetGwListConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GwManagerServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_OneKeySwitch_GetGwListConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memmove(thebuf+theBufContent, &this->GwManagerServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetGwListConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += GwName.length()+1;	
	memSize += ComputerSymbol.length()+1;	
	memSize += sizeof(unsigned long);

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetAcdList::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;
}

int SIPCCMsg_OneKeySwitch_GetAcdList::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetAcdList::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

	return memSize;
}

void SIPCCMsg_OneKeySwitch_GetAcdListConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	AcdServerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AcdServerId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AcdServerId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += AcdServerId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	size_t iCount = *(size_t*)(thebuf+theBufContent);
	theBufContent += sizeof(size_t);

	for (size_t i = 0; i < iCount; i++)
	{
		string s = thebuf+theBufContent;
		theBufContent += s.length() + 1;
		ManagerIdList.push_back(s);
	}
}

int SIPCCMsg_OneKeySwitch_GetAcdListConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, AcdServerId.c_str(), AcdServerId.length()+1);
	theBufContent += AcdServerId.length()+1;

	memmove(thebuf+theBufContent, &this->AcdServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->AcdServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	*(size_t*)(thebuf+theBufContent) = ManagerIdList.size();

	for (size_t i = 0; i < ManagerIdList.size(); i++)
	{
		memcpy(thebuf+theBufContent, ManagerIdList[i].c_str(), ManagerIdList[i].length()+1);
		theBufContent += ManagerIdList[i].length()+1;
	}

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetAcdListConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += AcdServerId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(size_t);
	for (size_t i = 0; i < ManagerIdList.size(); i++)
	{
		memSize += ManagerIdList[i].length()+1;
	}

	return memSize;
}

void SIPCCMsg_OneKeySwitch_SwitchCenter_Ctrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->UStateServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->UStateServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GwmanagerServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GwmanagerServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->DataCenterServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->DataCenterServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ACDServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ACDServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ProxyServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ProxyServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->TollServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->TollServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GuideServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GuideServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->MonitiorServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->MonitiorServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_OneKeySwitch_SwitchCenter_Ctrl::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memmove(thebuf+theBufContent, &this->UStateServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->UStateServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->GwmanagerServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->GwmanagerServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->DataCenterServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->DataCenterServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->ACDServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ACDServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->ProxyServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ProxyServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->TollServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->TollServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->GuideServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->GuideServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	///
	memmove(thebuf+theBufContent, &this->MonitiorServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);


	memmove(thebuf+theBufContent, &this->MonitiorServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchCenter_Ctrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	return memSize;
}

void SIPCCMsg_OneKeySwitch_SwitchAcd_Ctrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	ManagerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ManagerId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ManagerId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ManagerId.length()+1;

	AcdServerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AcdServerId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AcdServerId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += AcdServerId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// 
	AcdServerIp_Old = thebuf + theBufContent;
	theBufContent += AcdServerIp_Old.length()+1;
	
	AcdServerIP_New = thebuf + theBufContent;
	theBufContent += AcdServerIP_New.length()+1;
	
	AcdServerWanIP_New = thebuf + theBufContent;	
	theBufContent += AcdServerWanIP_New.length()+1;

	memmove(&this->ServiceID_Old, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->ServiceID_New, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->IsReload, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
		return;

	memmove(&this->indexnum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);//add code byj hyj

}

int SIPCCMsg_OneKeySwitch_SwitchAcd_Ctrl::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, ManagerId.c_str(), ManagerId.length()+1);
	theBufContent += ManagerId.length()+1;

	memcpy(thebuf+theBufContent, AcdServerId.c_str(), AcdServerId.length()+1);
	theBufContent += AcdServerId.length()+1;

	memmove(thebuf+theBufContent, &this->AcdServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->AcdServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//
	memcpy(thebuf+theBufContent, AcdServerIp_Old.c_str(), AcdServerIp_Old.length()+1);
	theBufContent += AcdServerIp_Old.length()+1;

	memcpy(thebuf+theBufContent, AcdServerIP_New.c_str(), AcdServerIP_New.length()+1);
	theBufContent += AcdServerIP_New.length()+1;

	memcpy(thebuf+theBufContent, AcdServerWanIP_New.c_str(), AcdServerWanIP_New.length()+1);
	theBufContent += AcdServerWanIP_New.length()+1;


	memmove(thebuf+theBufContent, &this->ServiceID_Old, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->ServiceID_New, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->IsReload, sizeof(int));
	theBufContent += sizeof(int);



	memmove(thebuf+theBufContent, &this->indexnum, sizeof(int));
	theBufContent += sizeof(int);//add code by hyj


	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchAcd_Ctrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += ManagerId.length()+1;
	memSize += AcdServerId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += AcdServerIp_Old.length()+1;	
	memSize += AcdServerIP_New.length()+1;
	memSize += AcdServerWanIP_New.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += sizeof(int);

	memSize += sizeof(int);//add code bhyj

	return memSize;
}

void SIPCCMsg_OneKeySwitch_SwitchRedirect_Ctrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

}

int SIPCCMsg_OneKeySwitch_SwitchRedirect_Ctrl::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchRedirect_Ctrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	return memSize;
}

void SIPCCMsg_OneKeySwitch_SwitchCenter::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->UStateServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->UStateServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GwmanagerServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GwmanagerServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->DataCenterServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->DataCenterServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ACDServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ACDServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ProxyServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ProxyServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->TollServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->TollServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GuideServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->GuideServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

///
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->MonitiorServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->MonitiorServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_OneKeySwitch_SwitchCenter::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memmove(thebuf+theBufContent, &this->UStateServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->UStateServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->GwmanagerServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->GwmanagerServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->DataCenterServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->DataCenterServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->ACDServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ACDServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->ProxyServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ProxyServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->TollServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->TollServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->GuideServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->GuideServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//
	memmove(thebuf+theBufContent, &this->MonitiorServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->MonitiorServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchCenter::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	return memSize;
}

void SIPCCMsg_OneKeySwitch_SwitchAcd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	AcdServerId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+AcdServerId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(AcdServerId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += AcdServerId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->AcdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OneKeySwitch_SwitchAcd::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, AcdServerId.c_str(), AcdServerId.length()+1);
	theBufContent += AcdServerId.length()+1;

	memmove(thebuf+theBufContent, &this->AcdServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->AcdServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchAcd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += AcdServerId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += sizeof(int); //ServiceID

	return memSize;
}

void SIPCCMsg_OneKeySwitch_SwitchRedirect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeat";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_HeartBeatRegister", "ServerType", ip, port)) ) {return;}
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

}

int SIPCCMsg_OneKeySwitch_SwitchRedirect::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchRedirect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	return memSize;
}

//Type_OneKeySwitch_UserLoginStateSvrConf
SIPCCMsg_OneKeySwitch_UserLoginStateSvrConf::SIPCCMsg_OneKeySwitch_UserLoginStateSvrConf()
{
	msgType = Type_OneKeySwitch_UserLoginStateSvrConf;

	GwName = "";
	ComputerSymbol = "";
	resultCode = 1;
	ServerName = "";

	ServiceType=0;
	ServiceID=0;

	handleId="";
	originalIP=0;
    originalPort=0;
}

void SIPCCMsg_OneKeySwitch_UserLoginStateSvrConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_UserLoginStateSvrConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	//resultCode
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "resultCode", ip, port)) ) {return;}
	memmove(&this->resultCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//ServerName
	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), GWNAME_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;


	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if(theBufContent == msgsize)
		return;
	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//handleId
	handleId = thebuf + theBufContent;
	theBufContent+= handleId.length()+1;

	//originalIP
	memmove(&originalIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(int);

	//originalPort
	memmove(&originalPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_OneKeySwitch_UserLoginStateSvrConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//resultCode
	memmove(thebuf+theBufContent, &this->resultCode, sizeof(int));
	theBufContent += sizeof(int);

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	 memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);



	//handleId 
	memcpy(thebuf+theBufContent, handleId .c_str(), handleId .length()+1);
	theBufContent += handleId .length()+1;


	//originalIP
	memmove(thebuf+theBufContent, &this->originalIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//originalPort
	memmove(thebuf+theBufContent, &this->originalPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_UserLoginStateSvrConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += sizeof(int);					//resultCode
	memSize += ServerName.length()+1;		//ServerName


	memSize += sizeof(int);//               servertype	
	memSize += sizeof(int );//               ServiceID;  
	memSize += handleId.length()+1;		//handleId

	memSize += sizeof(unsigned long);//               servertype	
	memSize += sizeof(unsigned short );//               ServiceID;  

	return memSize;
}

//Type_OneKeySwitch_ConfirmGW
SIPCCMsg_OneKeySwitch_ConfirmGW::SIPCCMsg_OneKeySwitch_ConfirmGW()
{
	msgType = Type_OneKeySwitch_ConfirmGW;

	GwName = "";
	ComputerSymbol = "";
	InvokeId = "";
}

void SIPCCMsg_OneKeySwitch_ConfirmGW::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ConfirmGW";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	//InvokeId
	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "InvokeId.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), INVOKEID_LEN, strMsg, "InvokeId", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

}

int SIPCCMsg_OneKeySwitch_ConfirmGW::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ConfirmGW::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += InvokeId.length()+1;			//InvokeId

	return memSize;
}

///Type_OneKeySwitch_HeartBeatConfirmConf
SIPCCMsg_OneKeySwitch_HeartBeatConfirmConf::SIPCCMsg_OneKeySwitch_HeartBeatConfirmConf()
{
	msgType = Type_OneKeySwitch_HeartBeatConfirmConf;
	invokeID = "";

	ServiceID = 0;
}

void SIPCCMsg_OneKeySwitch_HeartBeatConfirmConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//ServiceID
	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OneKeySwitch_HeartBeatConfirmConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	//ServiceID
	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_HeartBeatConfirmConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;

	memSize += sizeof(int);				//ServiceID
	return memSize;
}

///Type_OneKeySwitch_GetHeartBeatConf
SIPCCMsg_OneKeySwitch_GetHeartBeatConf::SIPCCMsg_OneKeySwitch_GetHeartBeatConf()
{
	msgType = Type_OneKeySwitch_GetHeartBeatConf;
	InvokeId = "";
	HeartBeatServerIP = 0;
	HeartBeatServerPort = 0;
	HeartBeatServerBackupIP = 0;
	HeartBeatServerBackupPort = 0;
    ServiceID=0;
    ServiceType=0;
	
	HeartBeatServerID=0;
	HeartBeatServerBackupID=0;
	operationMode=0;

}

void SIPCCMsg_OneKeySwitch_GetHeartBeatConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_GetHeartBeatConf";
	int theBufContent = AnalyzeMsgHead(thebuf);

	//InvokeId
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	//HeartBeatServerIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//HeartBeatServerBackupIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerBackupIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerBackupPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerBackupPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

    memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
  
	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	memmove(&this->HeartBeatServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->HeartBeatServerBackupID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if ( theBufContent >= msgsize)
	{
		return;
	}
    //operationMode
	memmove(&this->operationMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);



}

int SIPCCMsg_OneKeySwitch_GetHeartBeatConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	//HeartBeatServerIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//HeartBeatServerBackupIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerBackupPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->HeartBeatServerID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupID, sizeof(int));
	theBufContent += sizeof(int);

   //operationMode
	memmove(thebuf+theBufContent, &this->operationMode, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetHeartBeatConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;		//InvokeId
	memSize += sizeof(unsigned long);	//HeartBeatServerIP
	memSize += sizeof(unsigned short);	//HeartBeatServerPort
	memSize += sizeof(unsigned long);	//HeartBeatServerBackupIP
	memSize += sizeof(unsigned short);	//HeartBeatServerBackupPort
	memSize += sizeof(int);          	//ServiceID
	memSize += sizeof(int);          	//ServiceType

	memSize += sizeof(int);	//HeartBeatServerID
	memSize += sizeof(int);	//HeartBeatServerBackupID
   memSize += sizeof(int);//operationMode

	return memSize;
}

//Type_OneKeySwitch_GWLogout
SIPCCMsg_OneKeySwitch_GWLogout::SIPCCMsg_OneKeySwitch_GWLogout()
{
	msgType = Type_OneKeySwitch_GWLogout;

	GwName = "";
	ComputerSymbol = "";
}

void SIPCCMsg_OneKeySwitch_GWLogout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_GWLogout";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

}

int SIPCCMsg_OneKeySwitch_GWLogout::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GWLogout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol

	return memSize;
}

///Type_OneKeySwitch_RegisterConf
SIPCCMsg_OneKeySwitch_RegisterConf::SIPCCMsg_OneKeySwitch_RegisterConf()
{
	msgType = Type_OneKeySwitch_RegisterConf;
	ServerName = "";
}

void SIPCCMsg_OneKeySwitch_RegisterConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;
	theBufContent += ServerName.length()+1;
}

int SIPCCMsg_OneKeySwitch_RegisterConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_RegisterConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;
	return memSize;
}

///Type_OneKeySwitch_GWLogin
SIPCCMsg_OneKeySwitch_GWLogin::SIPCCMsg_OneKeySwitch_GWLogin()
{
	msgType = Type_OneKeySwitch_GWLogin;

	gwName = "";
	computerSymbol = "";
	trunkCount = 0;
	lanIP = 0;
	lanPort = 0;
	gwPartNo = "";
	natType = 0;

	natIP = 0;
	natPort = 0;
	natIP_backup=0;			//网关备份代理服务的公网IP
	natPort_backup=0;		//网关备份代理服务的端口号
	isProxyRegister=0;
}

void SIPCCMsg_OneKeySwitch_GWLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_GWLogin";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//gwName
	gwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwName.length()+1, msgsize, strMsg, "gwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwName.length(), GWNAME_LEN, strMsg, "gwName", ip, port)) ) {return;}
	theBufContent += gwName.length()+1;

	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+computerSymbol.length()+1, msgsize, strMsg, "computerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(computerSymbol.length(), COMSYMBOL_LEN, strMsg, "computerSymbol", ip, port)) ) {return;}
	theBufContent += computerSymbol.length()+1;

	//trunkCount
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "trunkCount", ip, port)) ) {return;}
	memmove(&this->trunkCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//lanIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "lanIP", ip, port)) ) {return;}
	memmove(&this->lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//lanPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "lanPort", ip, port)) ) {return;}
	memmove(&this->lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//gwPartNo
	gwPartNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+gwPartNo.length()+1, msgsize, strMsg, "gwPartNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(gwPartNo.length(), GWPARTNO_LEN, strMsg, "gwPartNo", ip, port)) ) {return;}
	theBufContent += gwPartNo.length()+1;

	//natType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "natType", ip, port)) ) {return;}
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(msgsize == theBufContent)
		return;

	//natIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "natIP", ip, port)) ) {return;}
	memmove(&this->natIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//natPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "natPort", ip, port)) ) {return;}
	memmove(&this->natPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	
	if(msgsize == theBufContent)
		return;
	memmove(&this->ConferenceAgentCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);



	if(msgsize == theBufContent)
		return;

	//natIP

	memmove(&natIP_backup, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//natPort
	
	memmove(&natPort_backup, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	
	//isProxyRegister
	memmove(&isProxyRegister, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OneKeySwitch_GWLogin::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//gwName
	memcpy(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += gwName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	//trunkCount
	memmove(thebuf+theBufContent, &this->trunkCount, sizeof(int));
	theBufContent += sizeof(int);

	//lanIP
	memmove(thebuf+theBufContent, &this->lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//lanPort
	memmove(thebuf+theBufContent, &this->lanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//gwPartNo
	memcpy(thebuf+theBufContent, gwPartNo.c_str(), gwPartNo.length()+1);
	theBufContent += gwPartNo.length()+1;

	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);

	//natIP
	memmove(thebuf+theBufContent, &this->natIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//natPort
	memmove(thebuf+theBufContent, &this->natPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


		//ConferenceAgentCount
	memmove(thebuf+theBufContent, &this->ConferenceAgentCount, sizeof(int));
	theBufContent += sizeof(int);



	//natIP_backup
	memmove(thebuf+theBufContent, &natIP_backup, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//natPort
	memmove(thebuf+theBufContent, &this->natPort_backup, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//isProxyRegister
	memmove(thebuf+theBufContent, &this->isProxyRegister, sizeof(int));
	theBufContent += sizeof(int);
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GWLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += gwName.length()+1;			//gwName
	memSize += computerSymbol.length()+1;	//computerSymbol
	memSize += sizeof(int);					//trunkCount
	memSize += sizeof(unsigned long);		//lanIP
	memSize += sizeof(unsigned short);		//lanPort
	memSize += gwPartNo.length()+1;			//gwPartNo
	memSize += sizeof(int);					//natType
	memSize += sizeof(unsigned long);		//natIP
	memSize += sizeof(unsigned short);		//natPort
	memSize += sizeof(int);		//ConferenceAgentCount


	memSize += sizeof(unsigned long);		//natIP_backup
	memSize += sizeof(unsigned short);		//natPort_backup
	memSize += sizeof(int);		//isProxyRegister

	return memSize;
}

///Type_OneKeySwitch_UserLogin
SIPCCMsg_OneKeySwitch_UserLogin::SIPCCMsg_OneKeySwitch_UserLogin()
{
	msgType = Type_OneKeySwitch_UserLogin;

	natType = NatType_Unknown;
	this->localIP = 0;
	this->localPort = 0;
	GwName = "";
	ComputerSymbol = "";
	allUserName = "";
	indexNum = 0;
	this->natIP = 0;
	this->natPort = 0;
	handleId="";
	totalIndex=0;
}

void SIPCCMsg_OneKeySwitch_UserLogin::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, "SIPCCMsg_OneKeySwitch_UserLogin", "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//natType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, "SIPCCMsg_OneKeySwitch_UserLogin", "natType", ip, port)) ) {return;}
	memmove(&this->natType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//localIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_UserLogin", "localIP", ip, port)) ) {return;}
	memmove(&this->localIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//localPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_UserLogin", "localPort", ip, port)) ) {return;}
	memmove(&this->localPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//GwName
	GwName = thebuf+theBufContent;
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf+theBufContent;
	theBufContent += ComputerSymbol.length()+1;

	//allUserName
	allUserName = thebuf+theBufContent;
	theBufContent += allUserName.length()+1;

	//indexNum
	memmove(&this->indexNum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(msgsize == theBufContent)
		return;

	//natIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, "SIPCCMsg_OneKeySwitch_UserLogin", "natIP", ip, port)) ) {return;}
	memmove(&this->natIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//natPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, "SIPCCMsg_OneKeySwitch_UserLogin", "natPort", ip, port)) ) {return;}
	memmove(&this->natPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	if(msgsize == theBufContent)
		return;

	//handleId
	handleId = thebuf + theBufContent;
	theBufContent+= handleId.length()+1;


	//totalIndex
	memmove(&totalIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);




}

int SIPCCMsg_OneKeySwitch_UserLogin::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//natType
	memmove(thebuf+theBufContent, &this->natType, sizeof(int));
	theBufContent += sizeof(int);

	//localIP
	memmove(thebuf+theBufContent, &this->localIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//localPort
	memmove(thebuf+theBufContent, &this->localPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//GwName
	memmove(thebuf+theBufContent, this->GwName.c_str(),GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memmove(thebuf+theBufContent, this->ComputerSymbol.c_str(),ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//allUserName
	memmove(thebuf+theBufContent, this->allUserName.c_str(),allUserName.length()+1);
	theBufContent += allUserName.length()+1;

	//indexNum
	memmove(thebuf+theBufContent, &this->indexNum, sizeof(int));
	theBufContent += sizeof(int);

	//natIP
	memmove(thebuf+theBufContent, &this->natIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//natPort
	memmove(thebuf+theBufContent, &this->natPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	//handleId 
	memcpy(thebuf+theBufContent, handleId .c_str(), handleId .length()+1);
	theBufContent += handleId .length()+1;


	//totalIndex
	memmove(thebuf+theBufContent, &totalIndex, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_UserLogin::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += sizeof(int);					//natType
	memSize += sizeof(unsigned long);		//localIP
	memSize += sizeof(unsigned short);		//localPort
	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += allUserName.length()+1;		//allUserName
	memSize += sizeof(int);					//indexNum
	memSize += sizeof(unsigned long);		//natIP
	memSize += sizeof(unsigned short);		//natPort

    memSize += handleId.length()+1;		//handleId
	memSize += sizeof(int);				//totalIndex

	return memSize;
}

///Type_OneKeySwitch_GetUSnGWMConf
SIPCCMsg_OneKeySwitch_GetUSnGWMConf::SIPCCMsg_OneKeySwitch_GetUSnGWMConf()
{
	msgType = Type_OneKeySwitch_GetUSnGWMConf;

	InvokeId = "";
	UStateServerIp = 0;
	UStateServerPort = 0;
	GWManageServerIp = 0;
	GWManageServerPort = 0;
}

void SIPCCMsg_OneKeySwitch_GetUSnGWMConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_GetUSnGWMConf";
	int theBufContent = AnalyzeMsgHead(thebuf);

	//InvokeId
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	//UStateServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "UStateServerIp", ip, port)) ) {return;}
	memmove(&this->UStateServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//UStateServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "UStateServerPort", ip, port)) ) {return;}
	memmove(&this->UStateServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//GWManageServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "GWManageServerIp", ip, port)) ) {return;}
	memmove(&this->GWManageServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//GWManageServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "GWManageServerPort", ip, port)) ) {return;}
	memmove(&this->GWManageServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_OneKeySwitch_GetUSnGWMConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	//UStateServerIp
	memmove(thebuf+theBufContent, &this->UStateServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//UStateServerPort
	memmove(thebuf+theBufContent, &this->UStateServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//GWManageServerIp
	memmove(thebuf+theBufContent, &this->GWManageServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//GWManageServerPort
	memmove(thebuf+theBufContent, &this->GWManageServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetUSnGWMConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += InvokeId.length()+1;		//InvokeId
	memSize += sizeof(unsigned long);	//UStateServerIp
	memSize += sizeof(unsigned short);	//UStateServerPort
	memSize += sizeof(unsigned long);	//GWManageServerIp
	memSize += sizeof(unsigned short);	//GWManageServerPort

	return memSize;
}

///Type_OneKeySwitch_LoadGWInfo
SIPCCMsg_OneKeySwitch_LoadGWInfo::SIPCCMsg_OneKeySwitch_LoadGWInfo()
{
	msgType = Type_OneKeySwitch_LoadGWInfo;
	ServerName = "";
}

void SIPCCMsg_OneKeySwitch_LoadGWInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;
	theBufContent += ServerName.length()+1;

	if(theBufContent == msgsize)
		return;

	GatewayID = thebuf + theBufContent;
	theBufContent += GatewayID.length()+1;
}

int SIPCCMsg_OneKeySwitch_LoadGWInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	memcpy(thebuf+theBufContent, GatewayID.c_str(), GatewayID.length()+1);
	theBufContent += GatewayID.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_LoadGWInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;
	memSize += GatewayID.length()+1;
	return memSize;
}

///Type_OneKeySwitch_ServerHeartBeatConf
SIPCCMsg_OneKeySwitch_ServerHeartBeatConf::SIPCCMsg_OneKeySwitch_ServerHeartBeatConf()
{
	msgType = Type_OneKeySwitch_ServerHeartBeatConf;
	resultCode = 0;
	ServiceID=0;
	sendtime=0;
}

void SIPCCMsg_OneKeySwitch_ServerHeartBeatConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_ServerHeartBeatConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ServiceID
    //if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "ServiceID", ip, port)) ) {return;}
	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
    

	//resultCode
	memmove(&this->resultCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//sendtime
	memmove(&this->sendtime, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_OneKeySwitch_ServerHeartBeatConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//ServiceID
	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	//resultCode
	memmove(thebuf+theBufContent, &this->resultCode, sizeof(int));
	theBufContent += sizeof(int);


	//sendtime
	memmove(thebuf+theBufContent, &this->sendtime, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);


	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ServerHeartBeatConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);				//resultCode
	memSize += sizeof(int);				//ServiceID
	memSize += sizeof(unsigned long);			//sendtime
	return memSize;
}

///Type_OneKeySwitch_Synchronization
SIPCCMsg_OneKeySwitch_Synchronization::SIPCCMsg_OneKeySwitch_Synchronization()
{
	msgType = Type_OneKeySwitch_Synchronization;
	invokeID = "";
}

void SIPCCMsg_OneKeySwitch_Synchronization::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;
}

int SIPCCMsg_OneKeySwitch_Synchronization::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_Synchronization::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeID.length()+1;
	return memSize;
}

///Type_OneKeySwitch_USRegister
SIPCCMsg_OneKeySwitch_USRegister::SIPCCMsg_OneKeySwitch_USRegister()
{
	msgType = Type_OneKeySwitch_USRegister;
	ServerName = "";
	ServerIp = 0;
	ServerPort = 0;
}

void SIPCCMsg_OneKeySwitch_USRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_USRegister";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ServerName
	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), GWNAME_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;

	//ServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "ServerIp", ip, port)) ) {return;}
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "ServerPort", ip, port)) ) {return;}
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

}

int SIPCCMsg_OneKeySwitch_USRegister::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	//ServerIp
	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_USRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ServerName.length()+1;	//ServerName
	memSize += sizeof(unsigned long);	//ServerIp
	memSize += sizeof(unsigned short);	//ServerPort

	return memSize;
}

///Type_OneKeySwitch_GWMRegister
SIPCCMsg_OneKeySwitch_GWMRegister::SIPCCMsg_OneKeySwitch_GWMRegister()
{
	msgType = Type_OneKeySwitch_GWMRegister;
	ServerName = "";
	ServerIp = 0;
	ServerPort = 0;
}

void SIPCCMsg_OneKeySwitch_GWMRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_GWMRegister";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ServerName
	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), GWNAME_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;

	//ServerIp
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsg, "ServerIp", ip, port)) ) {return;}
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsg, "ServerPort", ip, port)) ) {return;}
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

}

int SIPCCMsg_OneKeySwitch_GWMRegister::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	//ServerIp
	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//ServerPort
	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GWMRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ServerName.length()+1;	//ServerName
	memSize += sizeof(unsigned long);	//ServerIp
	memSize += sizeof(unsigned short);	//ServerPort

	return memSize;
}

//Type_OneKeySwitch_GWLoginConf
SIPCCMsg_OneKeySwitch_GWLoginConf::SIPCCMsg_OneKeySwitch_GWLoginConf()
{
	msgType = Type_OneKeySwitch_GWLoginConf;

	GwName = "";
	ComputerSymbol = "";
	ServerName = "";
    	
	 ServiceType=0;
	 ServiceID=0;

}

void SIPCCMsg_OneKeySwitch_GWLoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_GWLoginConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	if(theBufContent == msgsize)
		return;

	//ServerName
	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), GWNAME_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;

	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OneKeySwitch_GWLoginConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	 memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);


	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GWLoginConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += ServerName.length()+1;		//ServerName


	memSize += sizeof(int);//                servertype	
	memSize += sizeof(int );//               ServiceID;
	return memSize;
}

//Type_OneKeySwitch_SetTrunkDeviecList
SIPCCMsg_OneKeySwitch_SetTrunkDeviecList::SIPCCMsg_OneKeySwitch_SetTrunkDeviecList()
{
	msgType = Type_OneKeySwitch_SetTrunkDeviecList;

	GwName = "";
	ComputerSymbol = "";
	TrunkDeviceListStart = "";
	TrunkDeviceListEnd = "";
	bCanSelected = 0;
}

void SIPCCMsg_OneKeySwitch_SetTrunkDeviecList::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_SetTrunkDeviecList";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	//TrunkGroupDN
	TrunkGroupDN = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+TrunkGroupDN.length()+1, msgsize, strMsg, "TrunkGroupDN.length()", ip, port)) ) {return;}
	if ( !(VerifyData(TrunkGroupDN.length(), GWNAME_LEN, strMsg, "TrunkGroupDN", ip, port)) ) {return;}
	theBufContent += TrunkGroupDN.length()+1;

	//TrunkDeviceListStart
	TrunkDeviceListStart = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+TrunkDeviceListStart.length()+1, msgsize, strMsg, "TrunkDeviceListStart.length()", ip, port)) ) {return;}
	if ( !(VerifyData(TrunkDeviceListStart.length(), GWNAME_LEN, strMsg, "TrunkDeviceListStart", ip, port)) ) {return;}
	theBufContent += TrunkDeviceListStart.length()+1;

	//TrunkDeviceListEnd
	TrunkDeviceListEnd = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+TrunkDeviceListEnd.length()+1, msgsize, strMsg, "TrunkDeviceListEnd.length()", ip, port)) ) {return;}
	if ( !(VerifyData(TrunkDeviceListEnd.length(), GWNAME_LEN, strMsg, "TrunkDeviceListEnd", ip, port)) ) {return;}
	theBufContent += TrunkDeviceListEnd.length()+1;

	//bCanSelected
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bCanSelected", ip, port)) ) {return;}
	memmove(&this->bCanSelected, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_OneKeySwitch_SetTrunkDeviecList::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//TrunkGroupDN
	memcpy(thebuf+theBufContent, TrunkGroupDN.c_str(), TrunkGroupDN.length()+1);
	theBufContent += TrunkGroupDN.length()+1;

	//TrunkDeviceListStart
	memcpy(thebuf+theBufContent, TrunkDeviceListStart.c_str(), TrunkDeviceListStart.length()+1);
	theBufContent += TrunkDeviceListStart.length()+1;

	//TrunkDeviceListEnd
	memcpy(thebuf+theBufContent, TrunkDeviceListEnd.c_str(), TrunkDeviceListEnd.length()+1);
	theBufContent += TrunkDeviceListEnd.length()+1;

	//bCanSelected
	memmove(thebuf+theBufContent, &this->bCanSelected, sizeof(char));
	theBufContent += sizeof(char);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SetTrunkDeviecList::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += TrunkGroupDN.length()+1;		//TrunkGroupDN
	memSize += TrunkDeviceListStart.length()+1;		//TrunkDeviceListStart
	memSize += TrunkDeviceListEnd.length()+1;		//TrunkDeviceListEnd
	memSize += sizeof(char);				//bCanSelected

	return memSize;
}

//Type_Gateway_SetTrunkDeviecListConf
SIPCCMsg_Gateway_SetTrunkDeviecListConf::SIPCCMsg_Gateway_SetTrunkDeviecListConf()
{
	msgType = Type_Gateway_SetTrunkDeviecListConf;

	GwName = "";
	ComputerSymbol = "";
	bSucc = 0;
}

void SIPCCMsg_Gateway_SetTrunkDeviecListConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_SetTrunkDeviecList";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	//bSucc
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "bSucc", ip, port)) ) {return;}
	memmove(&this->bSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);
}

int SIPCCMsg_Gateway_SetTrunkDeviecListConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//bSucc
	memmove(thebuf+theBufContent, &this->bSucc, sizeof(char));
	theBufContent += sizeof(char);

	return theBufContent;
}

int SIPCCMsg_Gateway_SetTrunkDeviecListConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += sizeof(char);				//bSucc

	return memSize;
}

//////////////////////////////////////////////////////////////////////////


void SIPCCMsg_Licence_Query::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Licence_Query";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//LicenceType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "LicenceType", ip, port)) ) {return;}
	memmove(&this->LicenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//ServerName
	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), COMSYMBOL_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;

	//queryTag
	queryTag = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+queryTag.length()+1, msgsize, strMsg, "queryTag.length()", ip, port)) ) {return;}
	if ( !(VerifyData(queryTag.length(), QUERYTAG_LEN, strMsg, "queryTag", ip, port)) ) {return;}
	theBufContent += queryTag.length()+1;

	//sysTime
	if ( !(VerifyTotalLen(theBufContent+sizeof(time_t), msgsize, strMsg, "sysTime", ip, port)) ) {return;}
	memmove(&this->sysTime, thebuf+theBufContent, sizeof(time_t));
	theBufContent += sizeof(time_t);

	//countValue
	if ( !(VerifyTotalLen(theBufContent+sizeof(long), msgsize, strMsg, "countValue", ip, port)) ) {return;}
	memmove(&this->countValue, thebuf+theBufContent, sizeof(long));
	theBufContent += sizeof(long);

	if(theBufContent == msgsize)
		return;

	//countValue
	if ( !(VerifyTotalLen(theBufContent+sizeof(bool), msgsize, strMsg, "bStartQuery", ip, port)) ) {return;}
	memmove(&this->bStartQuery, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);

}

int SIPCCMsg_Licence_Query::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//LicenceType
	memmove(thebuf+theBufContent, &this->LicenceType, sizeof(int));
	theBufContent += sizeof(int);

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	//queryTag
	memcpy(thebuf+theBufContent, queryTag.c_str(), queryTag.length()+1);
	theBufContent += queryTag.length()+1;

	//sysTime
	memmove(thebuf+theBufContent, &this->sysTime, sizeof(time_t));
	theBufContent += sizeof(time_t);

	//countValue
	memmove(thebuf+theBufContent, &this->countValue, sizeof(long));
	theBufContent += sizeof(long);

	memmove(thebuf+theBufContent, &this->bStartQuery, sizeof(bool));
	theBufContent += sizeof(bool);

	return theBufContent;
}

int SIPCCMsg_Licence_Query::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += sizeof(int);					//LicenceType
	
	memSize += ServerName.length()+1;		//ServerName
	memSize += queryTag.length()+1;			//queryTag

	memSize += sizeof(time_t);					//sysTime
	memSize += sizeof(long);					//countValue

	memSize += sizeof(bool);

	return memSize;
}




void SIPCCMsg_Licence_QueryConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Licence_QueryConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//queryTag
	queryTag = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+queryTag.length()+1, msgsize, strMsg, "queryTag.length()", ip, port)) ) {return;}
	if ( !(VerifyData(queryTag.length(), QUERYTAG_LEN, strMsg, "queryTag", ip, port)) ) {return;}
	theBufContent += queryTag.length()+1;

	//LicenceConfirmPassed
	if ( !(VerifyTotalLen(theBufContent+sizeof(char), msgsize, strMsg, "LicenceConfirmPassed", ip, port)) ) {return;}
	memmove(&this->LicenceConfirmPassed, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	//FailedCause
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "FailedCause", ip, port)) ) {return;}
	memmove(&this->FailedCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_Licence_QueryConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	
	//queryTag
	memcpy(thebuf+theBufContent, queryTag.c_str(), queryTag.length()+1);
	theBufContent += queryTag.length()+1;

	//sysTime
	memmove(thebuf+theBufContent, &this->LicenceConfirmPassed, sizeof(char));
	theBufContent += sizeof(char);

	//FailedCause
	memmove(thebuf+theBufContent, &this->FailedCause, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Licence_QueryConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	
	memSize += queryTag.length()+1;			//queryTag

	memSize += sizeof(char);					//sysTime
	memSize += sizeof(int );					//FailedCause

	return memSize;
}
//
void SIPCCMsg_GCTI_MonitorDevice::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	monitorQueue = thebuf + theBufContent;	
	theBufContent += monitorQueue.length()+1;

	monitorEvent = thebuf + theBufContent;	
	theBufContent += monitorEvent.length()+1;

	monitoredDevice = thebuf + theBufContent;	
	theBufContent += monitoredDevice.length()+1;		
	
}

int SIPCCMsg_GCTI_MonitorDevice::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
	memcpy(thebuf+theBufContent, monitorQueue.c_str(), monitorQueue.length()+1);
	theBufContent += monitorQueue.length()+1;

	memcpy(thebuf+theBufContent, monitorEvent.c_str(), monitorEvent.length()+1);
	theBufContent += monitorEvent.length()+1;


	memcpy(thebuf+theBufContent, monitoredDevice.c_str(), monitoredDevice.length()+1);
	theBufContent += monitoredDevice.length()+1;
	return theBufContent;
}

int SIPCCMsg_GCTI_MonitorDevice::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize +=InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
	memSize += monitorQueue.length()+1;	
	memSize += monitorEvent.length()+1;	
	memSize += monitoredDevice.length()+1;	
	
	return memSize;
}
//
void SIPCCMsg_GCTI_AnswerCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&alertingCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	alertingCall.deviceID = thebuf + theBufContent;
	theBufContent += alertingCall.deviceID.length()+1;

	
}

int SIPCCMsg_GCTI_AnswerCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	

	memcpy(thebuf+theBufContent, &alertingCall.callID, sizeof(alertingCall.callID));
	theBufContent += sizeof(alertingCall.callID);

	memcpy(thebuf+theBufContent, alertingCall.deviceID.c_str(), alertingCall.deviceID.length()+1);
	theBufContent += alertingCall.deviceID.length()+1;	

	return theBufContent;
}

int SIPCCMsg_GCTI_AnswerCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
	memSize +=sizeof(alertingCall.callID);
	memSize += alertingCall.deviceID.length()+1;
	return memSize;
}
//
void SIPCCMsg_GCTI_MakeCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	callingDevice = thebuf + theBufContent;	
	theBufContent += callingDevice.length()+1;

	calledDevice = thebuf + theBufContent;	
	theBufContent += calledDevice.length()+1;

	PrivateData = thebuf + theBufContent;	
	theBufContent += PrivateData.length()+1;


	userData = thebuf + theBufContent;	
	theBufContent += userData.length()+1;

	
}

int SIPCCMsg_GCTI_MakeCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
	memcpy(thebuf+theBufContent, callingDevice.c_str(), callingDevice.length()+1);
	theBufContent += callingDevice.length()+1;

	memcpy(thebuf+theBufContent, calledDevice.c_str(), calledDevice.length()+1);
	theBufContent += calledDevice.length()+1;


	memcpy(thebuf+theBufContent, PrivateData.c_str(), PrivateData.length()+1);
	theBufContent += PrivateData.length()+1;

	memcpy(thebuf+theBufContent, userData.c_str(), userData.length()+1);
	theBufContent += userData.length()+1;

	return theBufContent;
}

int SIPCCMsg_GCTI_MakeCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);

	memSize += callingDevice.length()+1;	
	memSize += calledDevice.length()+1;	
	memSize += PrivateData.length()+1;
	memSize += userData.length()+1;
	
	return memSize;
}

void SIPCCMsg_GCTI_ClearConnection::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
 
	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memmove(&call.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);


	call.deviceID = thebuf + theBufContent;
	theBufContent += call.deviceID.length()+1;

	memmove(&ForTimeout, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);


	memmove(&FromSoftacd, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);
	
}

int SIPCCMsg_GCTI_ClearConnection::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
	memcpy(thebuf+theBufContent, &call.callID, sizeof(call.callID));
	theBufContent += sizeof(call.callID);

	memcpy(thebuf+theBufContent, call.deviceID.c_str(), call.deviceID.length()+1);
	theBufContent += call.deviceID.length()+1;


	memcpy(thebuf+theBufContent, &ForTimeout, sizeof(ForTimeout));
	theBufContent += sizeof(ForTimeout);

	memcpy(thebuf+theBufContent, &FromSoftacd, sizeof(FromSoftacd));
	theBufContent += sizeof(FromSoftacd);
	return theBufContent;
}

int SIPCCMsg_GCTI_ClearConnection::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;

    memSize +=sizeof(unsigned int);
	memSize +=sizeof(call.callID);
	memSize += call.deviceID.length()+1;
	memSize += sizeof(bool);
	memSize += sizeof(bool);

	return memSize;
}

void SIPCCMsg_GCTI_IVRReturnTransferToAgent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memmove(&activeCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	activeCall.deviceID = thebuf + theBufContent;
	theBufContent += activeCall.deviceID.length()+1;

	agentDevice = thebuf + theBufContent;	
	theBufContent += agentDevice.length()+1;

	privateData = thebuf + theBufContent;	
	theBufContent += privateData.length()+1;
	
}

int SIPCCMsg_GCTI_IVRReturnTransferToAgent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memcpy(thebuf+theBufContent, &activeCall.callID, sizeof(activeCall.callID));
	theBufContent += sizeof(activeCall.callID);

	memcpy(thebuf+theBufContent, activeCall.deviceID.c_str(), activeCall.deviceID.length()+1);
	theBufContent += activeCall.deviceID.length()+1;


	memcpy(thebuf+theBufContent, agentDevice.c_str(), agentDevice.length()+1);
	theBufContent += agentDevice.length()+1;

	memcpy(thebuf+theBufContent, privateData.c_str(), privateData.length()+1);
	theBufContent += privateData.length()+1;
	return theBufContent;
}

int SIPCCMsg_GCTI_IVRReturnTransferToAgent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int);
	memSize +=sizeof(activeCall.callID);
	memSize += activeCall.deviceID.length()+1;
	memSize += agentDevice.length()+1;
	memSize += privateData.length()+1;	

	return memSize;
}
void SIPCCMsg_GCTI_HoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&activeCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	activeCall.deviceID = thebuf + theBufContent;
	theBufContent += activeCall.deviceID.length()+1;

	waitMusic = thebuf + theBufContent;	
	theBufContent += waitMusic.length()+1;

	transedDevice = thebuf + theBufContent;	
	theBufContent += transedDevice.length()+1;

	NeedTrunkPreCon = thebuf + theBufContent;	
	theBufContent += NeedTrunkPreCon.length()+1;


	NeedCallerInfo = thebuf + theBufContent;	
	theBufContent += NeedCallerInfo.length()+1;

	CallerInfo = thebuf + theBufContent;	
	theBufContent += CallerInfo.length()+1;

	NeedTransferInfo = thebuf + theBufContent;	
	theBufContent += NeedTransferInfo.length()+1;

	TransferInfo = thebuf + theBufContent;		
	theBufContent += TransferInfo.length()+1;

	CallerPlayTimes = thebuf + theBufContent;	
	theBufContent += CallerPlayTimes.length()+1;

	TransferPlayTimes = thebuf + theBufContent;		
	theBufContent += TransferPlayTimes.length()+1;

	CallerNeedReturnIVR = thebuf + theBufContent;	
	theBufContent += CallerNeedReturnIVR.length()+1;

	TransferNeedReturnIVR = thebuf + theBufContent;	
	theBufContent += TransferNeedReturnIVR.length()+1;

	NeedHoldnWait = thebuf + theBufContent;	
	theBufContent += NeedHoldnWait.length()+1;

	PromptTimes = thebuf + theBufContent;	
	theBufContent += PromptTimes.length()+1;

	PromptMusicPath = thebuf + theBufContent;	
	theBufContent += PromptMusicPath.length()+1;
	
}

int SIPCCMsg_GCTI_HoldCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
	memcpy(thebuf+theBufContent, &activeCall.callID, sizeof(activeCall.callID));
	theBufContent += sizeof(activeCall.callID);

	memcpy(thebuf+theBufContent, activeCall.deviceID.c_str(), activeCall.deviceID.length()+1);
	theBufContent += activeCall.deviceID.length()+1;


	memcpy(thebuf+theBufContent, waitMusic.c_str(), waitMusic.length()+1);
	theBufContent += waitMusic.length()+1;

	memcpy(thebuf+theBufContent, transedDevice.c_str(), transedDevice.length()+1);
	theBufContent += transedDevice.length()+1;

	memcpy(thebuf+theBufContent, NeedTrunkPreCon.c_str(), NeedTrunkPreCon.length()+1);
	theBufContent += NeedTrunkPreCon.length()+1;

	memcpy(thebuf+theBufContent, NeedCallerInfo.c_str(), NeedCallerInfo.length()+1);
	theBufContent += NeedCallerInfo.length()+1;

	memcpy(thebuf+theBufContent, CallerInfo.c_str(), CallerInfo.length()+1);
	theBufContent += CallerInfo.length()+1;

	memcpy(thebuf+theBufContent, NeedTransferInfo.c_str(), NeedTransferInfo.length()+1);
	theBufContent += NeedTransferInfo.length()+1;

	memcpy(thebuf+theBufContent, TransferInfo.c_str(), TransferInfo.length()+1);
	theBufContent += TransferInfo.length()+1;

	memcpy(thebuf+theBufContent, CallerPlayTimes.c_str(), CallerPlayTimes.length()+1);
	theBufContent += CallerPlayTimes.length()+1;

	memcpy(thebuf+theBufContent, TransferPlayTimes.c_str(), TransferPlayTimes.length()+1);
	theBufContent += TransferPlayTimes.length()+1;

	memcpy(thebuf+theBufContent, CallerNeedReturnIVR.c_str(), CallerNeedReturnIVR.length()+1);
	theBufContent += CallerNeedReturnIVR.length()+1;

	memcpy(thebuf+theBufContent, TransferNeedReturnIVR.c_str(), CallerNeedReturnIVR.length()+1);
	theBufContent += TransferNeedReturnIVR.length()+1;

	memcpy(thebuf+theBufContent, NeedHoldnWait.c_str(), NeedHoldnWait.length()+1);
	theBufContent += NeedHoldnWait.length()+1;

	memcpy(thebuf+theBufContent, PromptTimes.c_str(), PromptTimes.length()+1);
	theBufContent += PromptTimes.length()+1;

	memcpy(thebuf+theBufContent, PromptMusicPath.c_str(), PromptMusicPath.length()+1);
	theBufContent += PromptTimes.length()+1;
	return theBufContent;
}

int SIPCCMsg_GCTI_HoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int);

	memSize +=sizeof(activeCall.callID);
	memSize += activeCall.deviceID.length()+1;
	memSize += waitMusic.length()+1;
	memSize += transedDevice.length()+1;
	memSize += NeedTrunkPreCon.length()+1;
	memSize += NeedCallerInfo.length()+1;
	memSize += CallerInfo.length()+1;
	memSize += NeedTransferInfo.length()+1;
	memSize += TransferInfo.length()+1;
	memSize += CallerPlayTimes.length()+1;
	memSize += TransferPlayTimes.length()+1;
	memSize += CallerNeedReturnIVR.length()+1;
	memSize += TransferNeedReturnIVR.length()+1;
	memSize += NeedHoldnWait.length()+1;
	memSize += PromptTimes.length()+1;
	memSize += PromptMusicPath.length()+1;
	return memSize;
}
void SIPCCMsg_GCTI_MonitorConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;


	memmove(&monitorCrossRefID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
}

int SIPCCMsg_GCTI_MonitorConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &monitorCrossRefID, sizeof(monitorCrossRefID));
	theBufContent += sizeof(monitorCrossRefID);

	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	return theBufContent;
}

int SIPCCMsg_GCTI_MonitorConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);
	memSize +=sizeof( unsigned int);
		
	return memSize;
}
void SIPCCMsg_GCTI_MakeCallConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;


	memmove(&newCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	newCall.deviceID = thebuf + theBufContent;
	theBufContent += newCall.deviceID.length()+1;

	ivrStationDN = thebuf + theBufContent;	
	theBufContent += ivrStationDN.length()+1;

	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
}

int SIPCCMsg_GCTI_MakeCallConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &newCall.callID, sizeof(newCall.callID));
	theBufContent += sizeof(newCall.callID);

	memcpy(thebuf+theBufContent, newCall.deviceID.c_str(), newCall.deviceID.length()+1);
	theBufContent += newCall.deviceID.length()+1;


	memcpy(thebuf+theBufContent, ivrStationDN.c_str(), ivrStationDN.length()+1);
	theBufContent += ivrStationDN.length()+1;

	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);
	return theBufContent;
}

int SIPCCMsg_GCTI_MakeCallConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(newCall.callID);
	memSize += newCall.deviceID.length()+1;
	memSize += ivrStationDN.length()+1;
	memSize += sizeof(unsigned int );	

	return memSize;
}
void SIPCCMsg_GCTI_UniversalFailureConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memmove(&error, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof(int);

	
}

int SIPCCMsg_GCTI_UniversalFailureConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, &error, sizeof(error));
	theBufContent += sizeof(error);

	return theBufContent;
}

int SIPCCMsg_GCTI_UniversalFailureConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;		
	memSize += sizeof(unsigned int);
	memSize += sizeof( int);	

	return memSize;
}
void SIPCCMsg_GCTI_DeliveredEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&alertingConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	alertingConnection.deviceID = thebuf + theBufContent;
	theBufContent += alertingConnection.deviceID.length()+1;



	memmove(&originatingConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	originatingConnection.deviceID = thebuf + theBufContent;
	theBufContent += originatingConnection.deviceID.length()+1;

	trunkGroupDevice = thebuf + theBufContent;	
	theBufContent += trunkGroupDevice.length()+1;

	lastRedirectionDevice = thebuf + theBufContent;	
	theBufContent += lastRedirectionDevice.length()+1;

	callerNo = thebuf + theBufContent;	
	theBufContent += callerNo.length()+1;

	calledNo = thebuf + theBufContent;	
	theBufContent += calledNo.length()+1;

	privateData = thebuf + theBufContent;	
	theBufContent += privateData.length()+1;


	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_DeliveredEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);

	memcpy(thebuf+theBufContent, &alertingConnection.callID, sizeof(alertingConnection.callID));
	theBufContent += sizeof(alertingConnection.callID);

	memcpy(thebuf+theBufContent, alertingConnection.deviceID.c_str(), alertingConnection.deviceID.length()+1);
	theBufContent += alertingConnection.deviceID.length()+1;


	memcpy(thebuf+theBufContent, &originatingConnection.callID, sizeof(originatingConnection.callID));
	theBufContent += sizeof(originatingConnection.callID);

	memcpy(thebuf+theBufContent, originatingConnection.deviceID.c_str(), originatingConnection.deviceID.length()+1);
	theBufContent += originatingConnection.deviceID.length()+1;


	memcpy(thebuf+theBufContent, trunkGroupDevice.c_str(), trunkGroupDevice.length()+1);
	theBufContent += trunkGroupDevice.length()+1;

	memcpy(thebuf+theBufContent, lastRedirectionDevice.c_str(), lastRedirectionDevice.length()+1);
	theBufContent += lastRedirectionDevice.length()+1;

	memcpy(thebuf+theBufContent, callerNo.c_str(), callerNo.length()+1);
	theBufContent += callerNo.length()+1;

	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;

	memcpy(thebuf+theBufContent, privateData.c_str(), privateData.length()+1);
	theBufContent += privateData.length()+1;

	


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);
	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_DeliveredEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(alertingConnection.callID);
	memSize += alertingConnection.deviceID.length()+1;

	memSize +=sizeof(originatingConnection.callID);
	memSize += originatingConnection.deviceID.length()+1;

	memSize += trunkGroupDevice.length()+1;
	memSize += lastRedirectionDevice.length()+1;
	memSize += callerNo.length()+1;
	memSize += calledNo.length()+1;
	memSize += privateData.length()+1;

	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_EstablishedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&establishedConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	establishedConnection.deviceID = thebuf + theBufContent;
	theBufContent += establishedConnection.deviceID.length()+1;



	memmove(&originatingConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	originatingConnection.deviceID = thebuf + theBufContent;
	theBufContent += originatingConnection.deviceID.length()+1;

	answeringAgent = thebuf + theBufContent;	
	theBufContent += answeringAgent.length()+1;
	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_EstablishedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);

	memcpy(thebuf+theBufContent, &establishedConnection.callID, sizeof(establishedConnection.callID));
	theBufContent += sizeof(establishedConnection.callID);

	memcpy(thebuf+theBufContent, establishedConnection.deviceID.c_str(), establishedConnection.deviceID.length()+1);
	theBufContent += establishedConnection.deviceID.length()+1;


	memcpy(thebuf+theBufContent, &originatingConnection.callID, sizeof(originatingConnection.callID));
	theBufContent += sizeof(originatingConnection.callID);

	memcpy(thebuf+theBufContent, originatingConnection.deviceID.c_str(), originatingConnection.deviceID.length()+1);
	theBufContent += originatingConnection.deviceID.length()+1;


	memcpy(thebuf+theBufContent, answeringAgent.c_str(), answeringAgent.length()+1);
	theBufContent += answeringAgent.length()+1;


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);
	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_EstablishedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(establishedConnection.callID);
	memSize += establishedConnection.deviceID.length()+1;

	memSize +=sizeof(originatingConnection.callID);
	memSize += originatingConnection.deviceID.length()+1;

	memSize += answeringAgent.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_NetworkReachedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&outBoundConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	outBoundConnection.deviceID = thebuf + theBufContent;
	theBufContent += outBoundConnection.deviceID.length()+1;



	memmove(&originatingConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	originatingConnection.deviceID = thebuf + theBufContent;
	theBufContent += originatingConnection.deviceID.length()+1;

	calledNo = thebuf + theBufContent;	
	theBufContent += calledNo.length()+1;
	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_NetworkReachedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);

	memcpy(thebuf+theBufContent, &outBoundConnection.callID, sizeof(outBoundConnection.callID));
	theBufContent += sizeof(outBoundConnection.callID);

	memcpy(thebuf+theBufContent, outBoundConnection.deviceID.c_str(), outBoundConnection.deviceID.length()+1);
	theBufContent += outBoundConnection.deviceID.length()+1;


	memcpy(thebuf+theBufContent, &originatingConnection.callID, sizeof(originatingConnection.callID));
	theBufContent += sizeof(originatingConnection.callID);

	memcpy(thebuf+theBufContent, originatingConnection.deviceID.c_str(), originatingConnection.deviceID.length()+1);
	theBufContent += originatingConnection.deviceID.length()+1;


	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);
	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_NetworkReachedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(outBoundConnection.callID);
	memSize += outBoundConnection.deviceID.length()+1;

	memSize +=sizeof(originatingConnection.callID);
	memSize += originatingConnection.deviceID.length()+1;

	memSize += calledNo.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_ServiceInitiated::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&initiatedConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	initiatedConnection.deviceID = thebuf + theBufContent;
	theBufContent += initiatedConnection.deviceID.length()+1;



	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_ServiceInitiated::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);

	memcpy(thebuf+theBufContent, &initiatedConnection.callID, sizeof(initiatedConnection.callID));
	theBufContent += sizeof(initiatedConnection.callID);

	memcpy(thebuf+theBufContent, initiatedConnection.deviceID.c_str(), initiatedConnection.deviceID.length()+1);
	theBufContent += initiatedConnection.deviceID.length()+1;

	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);
	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_ServiceInitiated::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(initiatedConnection.callID);
	memSize += initiatedConnection.deviceID.length()+1;	
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_HeldEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&heldConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	heldConnection.deviceID = thebuf + theBufContent;
	theBufContent += heldConnection.deviceID.length()+1;

	holdDevice = thebuf + theBufContent;	
	theBufContent += holdDevice.length()+1;
	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_HeldEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, &heldConnection.callID, sizeof(heldConnection.callID));
	theBufContent += sizeof(heldConnection.callID);

	memcpy(thebuf+theBufContent, heldConnection.deviceID.c_str(), heldConnection.deviceID.length()+1);
	theBufContent += heldConnection.deviceID.length()+1;


	

	memcpy(thebuf+theBufContent, holdDevice.c_str(), holdDevice.length()+1);
	theBufContent += holdDevice.length()+1;


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_HeldEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(heldConnection.callID);
	memSize += heldConnection.deviceID.length()+1;

	memSize += holdDevice.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_RetrievedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&retrievedConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	retrievedConnection.deviceID = thebuf + theBufContent;
	theBufContent += retrievedConnection.deviceID.length()+1;

	retrievingDevice = thebuf + theBufContent;	
	theBufContent += retrievingDevice.length()+1;
	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_RetrievedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, &retrievedConnection.callID, sizeof(retrievedConnection.callID));
	theBufContent += sizeof(retrievedConnection.callID);

	memcpy(thebuf+theBufContent, retrievedConnection.deviceID.c_str(), retrievedConnection.deviceID.length()+1);
	theBufContent += retrievedConnection.deviceID.length()+1;


	

	memcpy(thebuf+theBufContent, retrievingDevice.c_str(), retrievingDevice.length()+1);
	theBufContent += retrievingDevice.length()+1;


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_RetrievedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(retrievedConnection.callID);
	memSize += retrievedConnection.deviceID.length()+1;

	memSize += retrievingDevice.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_TransferredEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&callID, thebuf+theBufContent, sizeof( UINT));
	theBufContent += sizeof( UINT);


	transferringDevice = thebuf + theBufContent;
	theBufContent += transferringDevice.length()+1;

	transferredDevice = thebuf + theBufContent;
	theBufContent += transferredDevice.length()+1;


	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&listsize, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
		
	for (int  i = 0; i < listsize; i++)
	{
		
		UINT	callID=0;
		string	deviceID="";
		memmove(&callID, thebuf+theBufContent, sizeof(UINT));	
		theBufContent += sizeof(callID);		
		deviceID= thebuf + theBufContent;		
		theBufContent += deviceID.length()+1;
		GCTIConnectionID sconnectid;
		sconnectid.callID=callID;
		sconnectid.deviceID=deviceID;
		transferConnections.push_back(sconnectid);
	
	}


	
	
}

int SIPCCMsg_GCTI_TransferredEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);

	memcpy(thebuf+theBufContent, &callID, sizeof(callID));
	theBufContent += sizeof(callID);


    memcpy(thebuf+theBufContent, transferringDevice.c_str(), transferringDevice.length()+1);
	theBufContent += transferringDevice.length()+1;

	memcpy(thebuf+theBufContent, transferredDevice.c_str(), transferredDevice.length()+1);
	theBufContent += transferredDevice.length()+1;

	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);

	listsize=transferConnections.size();
	memcpy(thebuf+theBufContent, &listsize, sizeof(listsize));

	theBufContent += sizeof(listsize);

	for (list<GCTIConnectionID>::iterator it = transferConnections.begin(); it != transferConnections.end(); ++it)
	{
		memcpy(thebuf+theBufContent, &it->callID, sizeof(it->callID));
		theBufContent += sizeof(it->callID);
		memcpy(thebuf+theBufContent, it->deviceID.c_str(), it->deviceID.length()+1);
		theBufContent += it->deviceID.length()+1;
	}
	return theBufContent;
}

int SIPCCMsg_GCTI_TransferredEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(UINT );
	memSize += transferringDevice.length()+1;
	memSize += transferredDevice.length()+1;	
	memSize +=sizeof(int);
	memSize +=sizeof(int);

	memSize +=sizeof(int);
	
	for (list<GCTIConnectionID>::iterator it = transferConnections.begin(); it != transferConnections.end(); ++it)
	{
		memSize += sizeof(it->callID);
		memSize += it->deviceID.length()+1;
	}
	return memSize;
}
void SIPCCMsg_GCTI_ConnectionClearedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&droppedConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	droppedConnection.deviceID = thebuf + theBufContent;
	theBufContent += droppedConnection.deviceID.length()+1;

	releasingDevice = thebuf + theBufContent;	
	theBufContent += releasingDevice.length()+1;
	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_ConnectionClearedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, &droppedConnection.callID, sizeof(droppedConnection.callID));
	theBufContent += sizeof(droppedConnection.callID);

	memcpy(thebuf+theBufContent, droppedConnection.deviceID.c_str(), droppedConnection.deviceID.length()+1);
	theBufContent += droppedConnection.deviceID.length()+1;


	

	memcpy(thebuf+theBufContent, releasingDevice.c_str(), releasingDevice.length()+1);
	theBufContent += releasingDevice.length()+1;


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_ConnectionClearedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize += sizeof(unsigned int );

	memSize +=sizeof(droppedConnection.callID);
	memSize += droppedConnection.deviceID.length()+1;

	memSize += releasingDevice.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_FailedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&failingConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	failingConnection.deviceID = thebuf + theBufContent;
	theBufContent += failingConnection.deviceID.length()+1;

	callingDevice = thebuf + theBufContent;	
	theBufContent += callingDevice.length()+1;
	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_FailedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, &failingConnection.callID, sizeof(failingConnection.callID));
	theBufContent += sizeof(failingConnection.callID);

	memcpy(thebuf+theBufContent, failingConnection.deviceID.c_str(), failingConnection.deviceID.length()+1);
	theBufContent += failingConnection.deviceID.length()+1;


	

	memcpy(thebuf+theBufContent, callingDevice.c_str(), callingDevice.length()+1);
	theBufContent += callingDevice.length()+1;


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_FailedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize += sizeof(unsigned int );

	memSize +=sizeof(failingConnection.callID);
	memSize += failingConnection.deviceID.length()+1;

	memSize += callingDevice.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_OriginatedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&originatedConnection.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	originatedConnection.deviceID = thebuf + theBufContent;
	theBufContent += originatedConnection.deviceID.length()+1;

	calledNo = thebuf + theBufContent;	
	theBufContent += calledNo.length()+1;
	

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_OriginatedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, &originatedConnection.callID, sizeof(originatedConnection.callID));
	theBufContent += sizeof(originatedConnection.callID);

	memcpy(thebuf+theBufContent, originatedConnection.deviceID.c_str(), originatedConnection.deviceID.length()+1);
	theBufContent += originatedConnection.deviceID.length()+1;


	

	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;


	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_OriginatedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize += sizeof(unsigned int );

	memSize +=sizeof(originatedConnection.callID);
	memSize += originatedConnection.deviceID.length()+1;

	memSize += calledNo.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_ForceHangupEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	deviceID = thebuf + theBufContent;	
	theBufContent += deviceID.length()+1;
	
	memmove(&IsForce, thebuf+theBufContent, sizeof( bool));
	theBufContent += sizeof( bool);

	
}

int SIPCCMsg_GCTI_ForceHangupEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, deviceID.c_str(), deviceID.length()+1);
	theBufContent += deviceID.length()+1;


	memcpy(thebuf+theBufContent, &IsForce, sizeof(IsForce));
	theBufContent += sizeof(IsForce);
	return theBufContent;
}

int SIPCCMsg_GCTI_ForceHangupEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize += sizeof(unsigned int );
	
	memSize += deviceID.length()+1;	
	memSize += sizeof(bool );
	

	return memSize;
}
void SIPCCMsg_GCTI_SetAgentEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	deviceID = thebuf + theBufContent;	
	theBufContent += deviceID.length()+1;

	agentID = thebuf + theBufContent;	
	theBufContent += agentID.length()+1;
	
	
	
}

int SIPCCMsg_GCTI_SetAgentEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, deviceID.c_str(), deviceID.length()+1);
	theBufContent += deviceID.length()+1;

     memcpy(thebuf+theBufContent, agentID.c_str(), agentID.length()+1);
	theBufContent += agentID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_GCTI_SetAgentEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize += sizeof(unsigned int );
	
	memSize += deviceID.length()+1;
	memSize += agentID.length()+1;
	
	

	return memSize;
}
void SIPCCMsg_GCTI_TransferredToIVREvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	transferringDevice = thebuf + theBufContent;
	theBufContent += transferringDevice.length()+1;

	transferredDevice = thebuf + theBufContent;	
	theBufContent += transferredDevice.length()+1;
	
	privateData = thebuf + theBufContent;	
	theBufContent += privateData.length()+1;

	memmove(&localConnectionState, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_GCTI_TransferredToIVREvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, &callID, sizeof(callID));
	theBufContent += sizeof(callID);

	

	memcpy(thebuf+theBufContent, transferringDevice.c_str(), transferringDevice.length()+1);
	theBufContent += transferringDevice.length()+1;

	memcpy(thebuf+theBufContent, transferredDevice.c_str(), transferredDevice.length()+1);
	theBufContent += transferredDevice.length()+1;

	memcpy(thebuf+theBufContent, privateData.c_str(), privateData.length()+1);
	theBufContent += privateData.length()+1;

	memcpy(thebuf+theBufContent, &localConnectionState, sizeof(localConnectionState));
	theBufContent += sizeof(localConnectionState);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);
	return theBufContent;
}

int SIPCCMsg_GCTI_TransferredToIVREvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

    memSize += sizeof(unsigned int );
    memSize += sizeof(UINT );


	memSize += transferringDevice.length()+1;
	memSize += transferredDevice.length()+1;
	memSize += privateData.length()+1;
	
	memSize += sizeof(int );
	memSize += sizeof(int );	

	return memSize;
}
void SIPCCMsg_GCTI_ResetHoldCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
	ReHoldDevice = thebuf + theBufContent;
	theBufContent += ReHoldDevice.length()+1;

	
}

int SIPCCMsg_GCTI_ResetHoldCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	memcpy(thebuf+theBufContent, ReHoldDevice.c_str(), ReHoldDevice.length()+1);
	theBufContent += ReHoldDevice.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_GCTI_ResetHoldCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

    memSize += sizeof(unsigned int );
   

	memSize += ReHoldDevice.length()+1;

	
	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaPlay::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	
	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);
	
	playContent = thebuf + theBufContent;	
	theBufContent += playContent.length()+1;

	memmove(&canBeKeyBreak, thebuf+theBufContent, sizeof( bool));
	theBufContent += sizeof( bool);
	memmove(&loopCount, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);
	
	memmove(&mediaSender, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);
	
	
	dtmfString = thebuf + theBufContent;
	theBufContent += dtmfString.length()+1;

	
}

int SIPCCMsg_GCTI_DriverMediaPlay::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);


	memcpy(thebuf+theBufContent, playContent.c_str(), playContent.length()+1);
	theBufContent += playContent.length()+1;

	memcpy(thebuf+theBufContent, &canBeKeyBreak, sizeof(canBeKeyBreak));
	theBufContent += sizeof(canBeKeyBreak);

	memcpy(thebuf+theBufContent, &loopCount, sizeof(loopCount));
	theBufContent += sizeof(loopCount);

	memcpy(thebuf+theBufContent, &mediaSender, sizeof(mediaSender));
	theBufContent += sizeof(mediaSender);

	memcpy(thebuf+theBufContent, dtmfString.c_str(), dtmfString.length()+1);
	theBufContent += dtmfString.length()+1;

	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaPlay::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);

	memSize += channelID.length()+1;

	memSize += sizeof( int );
	memSize += playContent.length()+1;
	memSize += sizeof( bool );
	memSize += sizeof( int );
	memSize += sizeof( int );


	memSize += dtmfString.length()+1;

	
	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaPlayWithASR::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	 memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;


	memmove(&channelType, thebuf+theBufContent, sizeof( int));//2
	theBufContent += sizeof( int);

	memmove(&workMode, thebuf+theBufContent, sizeof( int));//3
	theBufContent += sizeof( int);

	memmove(&bargeInMode, thebuf+theBufContent, sizeof( int));//4
	theBufContent += sizeof( int);
	///

	memmove(&acceptDtmf, thebuf+theBufContent, sizeof( int));//5
	theBufContent += sizeof( int);

	memmove(&maxDigitNum, thebuf+theBufContent, sizeof( int));//6
	theBufContent += sizeof( int);

	memmove(&maxReceiveTime, thebuf+theBufContent, sizeof( int));//7
	theBufContent += sizeof( int);

	//
	playContent = thebuf + theBufContent;	
	theBufContent += playContent.length()+1;//8

	memmove(&playLoopCount, thebuf+theBufContent, sizeof( int));//9
	theBufContent += sizeof( int);
	//

	memmove(&maxBeginSilence, thebuf+theBufContent, sizeof( int));//10
	theBufContent += sizeof( int);

	memmove(&maxEndSilence, thebuf+theBufContent, sizeof( int));//11
	theBufContent += sizeof( int);

	memmove(&maxSpeech, thebuf+theBufContent, sizeof( int));//12
	theBufContent += sizeof( int);
   //
	memmove(&confidenceThreshold, thebuf+theBufContent, sizeof( int));//13
	theBufContent += sizeof( int);

	memmove(&bargeinThreshold, thebuf+theBufContent, sizeof( int));//14
	theBufContent += sizeof( int);

	memmove(&pruningThreshold, thebuf+theBufContent, sizeof( int));//15
	theBufContent += sizeof( int);

	//
	memmove(&nBest, thebuf+theBufContent, sizeof( int));//16
	theBufContent += sizeof( int);

	memmove(&speechType, thebuf+theBufContent, sizeof( int));//17
	theBufContent += sizeof( int);

	memmove(&listsize, thebuf+theBufContent, sizeof( int));//18
	theBufContent += sizeof( int);

	for (int  i = 0; i < listsize; i++)
	{
		
		int 	        grammarType;
		string			grammarName;	// 在static grammar时有效, dynamic grammar时不用
		string			grammarFileName;// 在static grammar时不用

		memmove(&grammarType, thebuf+theBufContent, sizeof(int));	
		theBufContent += sizeof(int);

		grammarName= thebuf + theBufContent;		
		theBufContent += grammarName.length()+1;
		grammarFileName= thebuf + theBufContent;		
		theBufContent += grammarFileName.length()+1;

		GCTISASRGrammar  SASRGrammar;
		SASRGrammar.grammarType=grammarType;
		SASRGrammar.grammarName=grammarName;
		SASRGrammar.grammarFileName=grammarFileName;
		grammarList.push_back(SASRGrammar);
	
	}


	
}

int SIPCCMsg_GCTI_DriverMediaPlayWithASR::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//1
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//2
	theBufContent += sizeof(int);
	memcpy(thebuf+theBufContent, &workMode, sizeof(int));//3
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &bargeInMode, sizeof(int));//4
	theBufContent += sizeof(int);
	//

	memcpy(thebuf+theBufContent, &acceptDtmf, sizeof(int));//5
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &maxDigitNum, sizeof(int));//6
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &maxReceiveTime, sizeof(int));//7
	theBufContent += sizeof(int);

	//
	memcpy(thebuf+theBufContent, playContent.c_str(), playContent.length()+1);
	theBufContent += playContent.length()+1;//8

	memcpy(thebuf+theBufContent, &playLoopCount, sizeof(int));//9
	theBufContent += sizeof(int);
//
	memcpy(thebuf+theBufContent, &maxBeginSilence, sizeof(int));//10
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &maxEndSilence, sizeof(int));//11
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &maxSpeech, sizeof(int));//12
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &confidenceThreshold, sizeof(int));//13
	theBufContent += sizeof(int);


	memcpy(thebuf+theBufContent, &bargeinThreshold, sizeof(int));//14
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &pruningThreshold, sizeof(int));//15
	theBufContent += sizeof(int);
//
	memcpy(thebuf+theBufContent, &nBest, sizeof(int));//16
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &speechType, sizeof(int));//17
	theBufContent += sizeof(int);

    listsize=grammarList.size();
	memcpy(thebuf+theBufContent, &listsize, sizeof(int));//18
	theBufContent += sizeof(int);

	for (list<GCTISASRGrammar>::iterator it = grammarList.begin(); it != grammarList.end(); ++it)
	{
		memcpy(thebuf+theBufContent, &it->grammarType, sizeof(it->grammarType));
		theBufContent += sizeof(int);
		memcpy(thebuf+theBufContent, it->grammarName.c_str(), it->grammarName.length()+1);
		theBufContent += it->grammarName.length()+1;

		memcpy(thebuf+theBufContent, it->grammarFileName.c_str(), it->grammarFileName.length()+1);
		theBufContent += it->grammarFileName.length()+1;
	}



	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaPlayWithASR::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);

   	memSize += channelID.length()+1;//1

	memSize +=sizeof( int );//2
	memSize +=sizeof( int );//3
	memSize +=sizeof( int );//4

	memSize +=sizeof( int );//5
	memSize +=sizeof( int );//6
	memSize +=sizeof( int );//7


   memSize += playContent.length()+1;//8
   memSize +=sizeof( int );//9
   //
   memSize +=sizeof( int );//10
   memSize +=sizeof( int );//11
   memSize +=sizeof( int );//12

   memSize +=sizeof( int );//13
   memSize +=sizeof( int );//14
   memSize +=sizeof( int );//15

   memSize +=sizeof( int );//16
   memSize +=sizeof( int );//17
  //

  	memSize +=sizeof(int);//列表长度//18
	
	for (list<GCTISASRGrammar>::iterator it = grammarList.begin(); it != grammarList.end(); ++it)
	{
		memSize += sizeof(it->grammarType);
		memSize += it->grammarName.length()+1;
		memSize += it->grammarFileName.length()+1;
	}
	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;


	memmove(&channelType, thebuf+theBufContent, sizeof( int));//2
	theBufContent += sizeof( int);

	
   
	recordFileName = thebuf + theBufContent;	//1
	theBufContent += recordFileName.length()+1;


	memmove(&maxRecordTime, thebuf+theBufContent, sizeof( int));//17
	theBufContent += sizeof( int);

	memmove(&bAttach, thebuf+theBufContent, sizeof( bool));//18
	theBufContent += sizeof( bool);

	
	
}

int SIPCCMsg_GCTI_DriverMediaRecord::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, recordFileName.c_str(), recordFileName.length()+1);
	theBufContent += recordFileName.length()+1;//

	memcpy(thebuf+theBufContent, &maxRecordTime, sizeof(int));//
	theBufContent += sizeof(int);

   
	memcpy(thebuf+theBufContent, &bAttach, sizeof(bool));//
	theBufContent += sizeof(bool);

	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
   	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	memSize += recordFileName.length()+1;
	memSize +=sizeof( int );//
	memSize +=sizeof( bool );//

	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaSendDTMF::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;


	memmove(&channelType, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	
   
	DTMFstring = thebuf + theBufContent;	//1
	theBufContent += DTMFstring.length()+1;


	
	
}

int SIPCCMsg_GCTI_DriverMediaSendDTMF::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, DTMFstring.c_str(), DTMFstring.length()+1);
	theBufContent += DTMFstring.length()+1;//

	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaSendDTMF::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);

   	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	memSize += DTMFstring.length()+1;
	

	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaReceiveDTMF::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;


	memmove(&channelType, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	memmove(&maxDigitNum, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	memmove(&maxReceiveTime, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	
   
	

	
	
}

int SIPCCMsg_GCTI_DriverMediaReceiveDTMF::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &maxDigitNum, sizeof(int));//
	theBufContent += sizeof(int);
	memcpy(thebuf+theBufContent, &maxReceiveTime, sizeof(int));//
	theBufContent += sizeof(int);
	

	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaReceiveDTMF::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
   	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	memSize +=sizeof( int );
	memSize +=sizeof( int );

	

	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaSendFax::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	 memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;


	memmove(&channelType, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	faxFileName = thebuf + theBufContent;	//1
	theBufContent += faxFileName.length()+1;

	
   
	

	
	
}

int SIPCCMsg_GCTI_DriverMediaSendFax::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	 memcpy(thebuf+theBufContent, faxFileName.c_str(), faxFileName.length()+1);//
	theBufContent += faxFileName.length()+1;
	

	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaSendFax::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int);
   	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	memSize += faxFileName.length()+1;

	


	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaReceiveFax::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;


	memmove(&channelType, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	faxFileName = thebuf + theBufContent;	//1
	theBufContent += faxFileName.length()+1;

	
   
	

	
	
}

int SIPCCMsg_GCTI_DriverMediaReceiveFax::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	 memcpy(thebuf+theBufContent, faxFileName.c_str(), faxFileName.length()+1);//
	theBufContent += faxFileName.length()+1;
	

	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaReceiveFax::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int);
	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	memSize += faxFileName.length()+1;

	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaCLRBuf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	 memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;


	memmove(&channelType, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	
	
}

int SIPCCMsg_GCTI_DriverMediaCLRBuf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	
	

	
	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaCLRBuf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int);
   	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	return memSize;
}
void SIPCCMsg_GCTI_DriverMediaStopWork::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	 memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	memmove(&mediaSender, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

}

int SIPCCMsg_GCTI_DriverMediaStopWork::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &mediaSender, sizeof(int));//
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_GCTI_DriverMediaStopWork::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);

   	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	memSize +=sizeof( int );
	return memSize;
}
void SIPCCMsg_GCTI_DriverSetCostStatus::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	 memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);



	channelID = thebuf + theBufContent;	//1
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));//
	theBufContent += sizeof( int);

	memmove(&CanCost, thebuf+theBufContent, sizeof( bool));//
	theBufContent += sizeof( bool);

}

int SIPCCMsg_GCTI_DriverSetCostStatus::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	
    memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);//
	theBufContent += channelID.length()+1;

	memcpy(thebuf+theBufContent, &channelType, sizeof(int));//
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &CanCost, sizeof(bool));//
	theBufContent += sizeof(bool);

	return theBufContent;
}

int SIPCCMsg_GCTI_DriverSetCostStatus::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int);

   	memSize += channelID.length()+1;

	memSize +=sizeof( int );
	memSize +=sizeof( bool );
	return memSize;
}
//
void SIPCCMsg_GCTI_TransferCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&heldCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	heldCall.deviceID = thebuf + theBufContent;
	theBufContent += heldCall.deviceID.length()+1;



	memmove(&activeCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	activeCall.deviceID = thebuf + theBufContent;
	theBufContent += activeCall.deviceID.length()+1;
	
}

int SIPCCMsg_GCTI_TransferCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	

	memcpy(thebuf+theBufContent, &heldCall.callID, sizeof(heldCall.callID));
	theBufContent += sizeof(heldCall.callID);

	memcpy(thebuf+theBufContent, heldCall.deviceID.c_str(), heldCall.deviceID.length()+1);
	theBufContent += heldCall.deviceID.length()+1;


	memcpy(thebuf+theBufContent, &activeCall.callID, sizeof(activeCall.callID));
	theBufContent += sizeof(activeCall.callID);

	memcpy(thebuf+theBufContent, activeCall.deviceID.c_str(), activeCall.deviceID.length()+1);
	theBufContent += activeCall.deviceID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_GCTI_TransferCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(heldCall.callID);
	memSize += heldCall.deviceID.length()+1;

	memSize +=sizeof(activeCall.callID);
	memSize += activeCall.deviceID.length()+1;

	return memSize;
}
///////////////////////////////////
/////Board ->event
void SIPCCMsg_Board_DriverConnectConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

}

int SIPCCMsg_Board_DriverConnectConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
		
	return theBufContent;
}

int SIPCCMsg_Board_DriverConnectConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );
	return memSize;
}

void SIPCCMsg_Board_DriverDisconnectConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

}

int SIPCCMsg_Board_DriverDisconnectConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
		
	return theBufContent;
}

int SIPCCMsg_Board_DriverDisconnectConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );
	return memSize;
}
void SIPCCMsg_Board_DriverTrunkOffHookConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

}

int SIPCCMsg_Board_DriverTrunkOffHookConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
		
	return theBufContent;
}

int SIPCCMsg_Board_DriverTrunkOffHookConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );
	return memSize;
}
int SIPCCMsg_Board_DriverTrunkOnHookConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);

	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;
		
	return theBufContent;
}

int SIPCCMsg_Board_DriverTrunkOnHookConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );
	memSize += channelID.length()+1;
	return memSize;
}
///
void SIPCCMsg_Board_DriverTrunkResetConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

}

int SIPCCMsg_Board_DriverTrunkResetConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
		
	return theBufContent;
}

int SIPCCMsg_Board_DriverTrunkResetConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );
	return memSize;
}
void SIPCCMsg_Board_DriverConferenceDestroyConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

}

int SIPCCMsg_Board_DriverConferenceDestroyConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
		
	return theBufContent;
}

int SIPCCMsg_Board_DriverConferenceDestroyConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );
	return memSize;
}
void SIPCCMsg_Board_DriverUniversalFailureConfEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

}

int SIPCCMsg_Board_DriverUniversalFailureConfEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
		
	return theBufContent;
}

int SIPCCMsg_Board_DriverUniversalFailureConfEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );
	return memSize;
}
void SIPCCMsg_Board_DriverReportTrunkStateEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
 // haead
	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	//
	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&status, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

}
///

int SIPCCMsg_Board_DriverReportTrunkStateEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);

	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);

	memcpy(thebuf+theBufContent, &status, sizeof(status));
	theBufContent += sizeof(status);

		
	return theBufContent;
}

int SIPCCMsg_Board_DriverReportTrunkStateEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );

	memSize +=sizeof( int );
	return memSize;
}
void SIPCCMsg_Board_DriverInBoundCallEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);


	callerNo = thebuf + theBufContent;	
	theBufContent += callerNo.length()+1;
	calledNo = thebuf + theBufContent;	
	theBufContent += calledNo.length()+1;
	privateData = thebuf + theBufContent;	
	theBufContent += privateData.length()+1;

}
///

int SIPCCMsg_Board_DriverInBoundCallEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);

	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);


	memcpy(thebuf+theBufContent, callerNo.c_str(), callerNo.length()+1);
	theBufContent += callerNo.length()+1;
	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);
	theBufContent += calledNo.length()+1;
	memcpy(thebuf+theBufContent, privateData.c_str(), privateData.length()+1);
	theBufContent += privateData.length()+1;	


		
	return theBufContent;
}

int SIPCCMsg_Board_DriverInBoundCallEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );


	memSize += callerNo.length()+1;
	memSize += calledNo.length()+1;	
	memSize += privateData.length()+1;	
	return memSize;
}
void SIPCCMsg_Board_DriverUserHangupEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);


	

}
int SIPCCMsg_Board_DriverUserHangupEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);


		
	return theBufContent;
}

int SIPCCMsg_Board_DriverUserHangupEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );


		
	return memSize;
}
void SIPCCMsg_Board_DriverDialRingingEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);


	

}
int SIPCCMsg_Board_DriverDialRingingEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);


		
	return theBufContent;
}

int SIPCCMsg_Board_DriverDialRingingEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );


		
	return memSize;
}
void SIPCCMsg_Board_DriverDialSuccessEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	strLocalIP = thebuf + theBufContent;	
	theBufContent += strLocalIP.length()+1;

	strVoiceSamplePath = thebuf + theBufContent;	
	theBufContent += strVoiceSamplePath.length()+1;


	

}
int SIPCCMsg_Board_DriverDialSuccessEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);

	memcpy(thebuf+theBufContent, strLocalIP.c_str(), strLocalIP.length()+1);
	theBufContent += strLocalIP.length()+1;	

	memcpy(thebuf+theBufContent, strVoiceSamplePath.c_str(), strVoiceSamplePath.length()+1);
	theBufContent += strVoiceSamplePath.length()+1;	



		
	return theBufContent;
}

int SIPCCMsg_Board_DriverDialSuccessEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );

	memSize += strLocalIP.length()+1;
	memSize += strVoiceSamplePath.length()+1;

		
	return memSize;
}
void SIPCCMsg_Board_DriverDialSuccessTollEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	

}
int SIPCCMsg_Board_DriverDialSuccessTollEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);

	



		
	return theBufContent;
}

int SIPCCMsg_Board_DriverDialSuccessTollEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );

	

		
	return memSize;
}
void SIPCCMsg_Board_DriverTrunkSeizedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	

	

}
int SIPCCMsg_Board_DriverTrunkSeizedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);

	



		
	return theBufContent;
}

int SIPCCMsg_Board_DriverTrunkSeizedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );

	

		
	return memSize;
}
void SIPCCMsg_Board_DriverFailedEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&error, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	strLocalIP = thebuf + theBufContent;	
	theBufContent += strLocalIP.length()+1;

	strVoiceSamplePath = thebuf + theBufContent;	
	theBufContent += strVoiceSamplePath.length()+1;


	

}
int SIPCCMsg_Board_DriverFailedEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);

	memcpy(thebuf+theBufContent, &error, sizeof(error));
	theBufContent += sizeof(error);

	memcpy(thebuf+theBufContent, strLocalIP.c_str(), strLocalIP.length()+1);
	theBufContent += strLocalIP.length()+1;	

	memcpy(thebuf+theBufContent, strVoiceSamplePath.c_str(), strVoiceSamplePath.length()+1);
	theBufContent += strVoiceSamplePath.length()+1;	



		
	return theBufContent;
}

int SIPCCMsg_Board_DriverFailedEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );

	memSize +=sizeof( int );
	memSize += strLocalIP.length()+1;
	memSize += strVoiceSamplePath.length()+1;

		
	return memSize;
}
void SIPCCMsg_Board_DriverMediaEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&mediaSender, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&oprType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	content = thebuf + theBufContent;	
	theBufContent += content.length()+1;


	

}
int SIPCCMsg_Board_DriverMediaEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;	


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);

	memcpy(thebuf+theBufContent, &mediaSender, sizeof(mediaSender));
	theBufContent += sizeof(mediaSender);

	memcpy(thebuf+theBufContent, &oprType, sizeof(oprType));
	theBufContent += sizeof(oprType);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);

	memcpy(thebuf+theBufContent, content.c_str(), content.length()+1);
	theBufContent += content.length()+1;	

	



		
	return theBufContent;
}

int SIPCCMsg_Board_DriverMediaEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof(unsigned int );

	memSize += channelID.length()+1;	
	memSize +=sizeof( int );

	memSize +=sizeof( int );
	memSize +=sizeof( int );
	memSize +=sizeof( int );

	memSize += content.length()+1;	
	


		
	return memSize;
}
void SIPCCMsg_GCTI_AgentTransferToIVR::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&activeCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	activeCall.deviceID = thebuf + theBufContent;
	theBufContent += activeCall.deviceID.length()+1
		;
	memmove(&bWaitReturn, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);

	privateData = thebuf + theBufContent;
	theBufContent += privateData.length()+1;


	
}

int SIPCCMsg_GCTI_AgentTransferToIVR::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	

	memcpy(thebuf+theBufContent, &activeCall.callID, sizeof(activeCall.callID));
	theBufContent += sizeof(activeCall.callID);

	memcpy(thebuf+theBufContent, activeCall.deviceID.c_str(), activeCall.deviceID.length()+1);
	theBufContent += activeCall.deviceID.length()+1;	

	memcpy(thebuf+theBufContent, &bWaitReturn, sizeof(bWaitReturn));
	theBufContent += sizeof(bWaitReturn);

	memcpy(thebuf+theBufContent, privateData.c_str(), privateData.length()+1);
	theBufContent += privateData.length()+1;	
	return theBufContent;
}

int SIPCCMsg_GCTI_AgentTransferToIVR::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
	memSize +=sizeof(activeCall.callID);
	memSize += activeCall.deviceID.length()+1;
	memSize +=sizeof(bool);
	memSize += privateData.length()+1;
	return memSize;
}
void SIPCCMsg_GCTI_AlternateCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&otherCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	otherCall.deviceID = thebuf + theBufContent;
	theBufContent += otherCall.deviceID.length()+1;



	memmove(&activeCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	activeCall.deviceID = thebuf + theBufContent;
	theBufContent += activeCall.deviceID.length()+1;
	
}

int SIPCCMsg_GCTI_AlternateCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	

	memcpy(thebuf+theBufContent, &otherCall.callID, sizeof(otherCall.callID));
	theBufContent += sizeof(otherCall.callID);

	memcpy(thebuf+theBufContent, otherCall.deviceID.c_str(), otherCall.deviceID.length()+1);
	theBufContent += otherCall.deviceID.length()+1;


	memcpy(thebuf+theBufContent, &activeCall.callID, sizeof(activeCall.callID));
	theBufContent += sizeof(activeCall.callID);

	memcpy(thebuf+theBufContent, activeCall.deviceID.c_str(), activeCall.deviceID.length()+1);
	theBufContent += activeCall.deviceID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_GCTI_AlternateCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(otherCall.callID);
	memSize += otherCall.deviceID.length()+1;

	memSize +=sizeof(activeCall.callID);
	memSize += activeCall.deviceID.length()+1;

	return memSize;
}
void SIPCCMsg_GCTI_ClearCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&call.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	call.deviceID = thebuf + theBufContent;
	theBufContent += call.deviceID.length()+1
		;

	
}

int SIPCCMsg_GCTI_ClearCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	

	memcpy(thebuf+theBufContent, &call.callID, sizeof(call.callID));
	theBufContent += sizeof(call.callID);

	memcpy(thebuf+theBufContent, call.deviceID.c_str(), call.deviceID.length()+1);
	theBufContent += call.deviceID.length()+1;	

	
	return theBufContent;
}

int SIPCCMsg_GCTI_ClearCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
	memSize +=sizeof(call.callID);
	memSize += call.deviceID.length()+1;
	
	return memSize;
}
void SIPCCMsg_GCTI_ReconnectCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uinvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&heldCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	heldCall.deviceID = thebuf + theBufContent;
	theBufContent += heldCall.deviceID.length()+1;



	memmove(&activeCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	activeCall.deviceID = thebuf + theBufContent;
	theBufContent += activeCall.deviceID.length()+1;
	
}

int SIPCCMsg_GCTI_ReconnectCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	

	memcpy(thebuf+theBufContent, &uinvokeId, sizeof(uinvokeId));
	theBufContent += sizeof(uinvokeId);
	

	memcpy(thebuf+theBufContent, &heldCall.callID, sizeof(heldCall.callID));
	theBufContent += sizeof(heldCall.callID);

	memcpy(thebuf+theBufContent, heldCall.deviceID.c_str(), heldCall.deviceID.length()+1);
	theBufContent += heldCall.deviceID.length()+1;


	memcpy(thebuf+theBufContent, &activeCall.callID, sizeof(activeCall.callID));
	theBufContent += sizeof(activeCall.callID);

	memcpy(thebuf+theBufContent, activeCall.deviceID.c_str(), activeCall.deviceID.length()+1);
	theBufContent += activeCall.deviceID.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_GCTI_ReconnectCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize +=sizeof(unsigned int );

	memSize +=sizeof(heldCall.callID);
	memSize += heldCall.deviceID.length()+1;

	memSize +=sizeof(activeCall.callID);
	memSize += activeCall.deviceID.length()+1;

	return memSize;
}
void SIPCCMsg_GCTI_RejectCal::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&call.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	call.deviceID = thebuf + theBufContent;
	theBufContent += call.deviceID.length()+1
		;



	
}

int SIPCCMsg_GCTI_RejectCal::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	

	memcpy(thebuf+theBufContent, &call.callID, sizeof(call.callID));
	theBufContent += sizeof(call.callID);

	memcpy(thebuf+theBufContent, call.deviceID.c_str(), call.deviceID.length()+1);
	theBufContent += call.deviceID.length()+1;	

	
	return theBufContent;
}

int SIPCCMsg_GCTI_RejectCal::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
	memSize +=sizeof(call.callID);
	memSize += call.deviceID.length()+1;
	
	return memSize;
}
void SIPCCMsg_GCTI_RetrieveCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	memmove(&heldCall.callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	heldCall.deviceID = thebuf + theBufContent;
	theBufContent += heldCall.deviceID.length()+1
		;



	
}

int SIPCCMsg_GCTI_RetrieveCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);
	

	memcpy(thebuf+theBufContent, &heldCall.callID, sizeof(heldCall.callID));
	theBufContent += sizeof(heldCall.callID);

	memcpy(thebuf+theBufContent, heldCall.deviceID.c_str(), heldCall.deviceID.length()+1);
	theBufContent += heldCall.deviceID.length()+1;	

	
	return theBufContent;
}

int SIPCCMsg_GCTI_RetrieveCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;
	memSize +=sizeof(unsigned int);
	memSize +=sizeof(heldCall.callID);
	memSize += heldCall.deviceID.length()+1;
	
	return memSize;
}

void SIPCCMsg_GCTI_MonitorStop::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memmove(&monitorCrossRefID_t, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	
	
	
}

int SIPCCMsg_GCTI_MonitorStop::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(uInvokeId));
	theBufContent += sizeof(uInvokeId);

	memcpy(thebuf+theBufContent, &monitorCrossRefID_t, sizeof(monitorCrossRefID_t));
	theBufContent += sizeof(monitorCrossRefID_t);


	
	return theBufContent;
}

int SIPCCMsg_GCTI_MonitorStop::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
    memSize += sizeof(unsigned int );
	memSize += sizeof(unsigned int );
	
	return memSize;
}



void SIPCCMsg_GCTI_SnapshotDevice::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&uInvokeId, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	device = thebuf + theBufContent;	
	theBufContent += device.length()+1;

	
	
	
}

int SIPCCMsg_GCTI_SnapshotDevice::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uInvokeId, sizeof(uInvokeId));
	theBufContent += sizeof(uInvokeId);

	memcpy(thebuf+theBufContent, device.c_str(), device.length()+1);
	theBufContent += device.length()+1;

	
	return theBufContent;
}

int SIPCCMsg_GCTI_SnapshotDevice::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += sizeof(unsigned int );
	memSize += device.length()+1;	
	
	return memSize;
}
void SIPCCMsg_Inner_AlertingRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	srcDeviceID = thebuf + theBufContent;	
	theBufContent += srcDeviceID.length()+1;

	destDeviceID = thebuf + theBufContent;	
	theBufContent += destDeviceID.length()+1;

	memmove(&callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	memmove(&cause, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	

	
}

int SIPCCMsg_Inner_AlertingRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, srcDeviceID.c_str(), srcDeviceID.length()+1);
	theBufContent += srcDeviceID.length()+1;

	memcpy(thebuf+theBufContent, destDeviceID.c_str(), destDeviceID.length()+1);
	theBufContent += destDeviceID.length()+1;

	memcpy(thebuf+theBufContent, &callID, sizeof(callID));
	theBufContent += sizeof(callID);

	memcpy(thebuf+theBufContent, &cause, sizeof(cause));
	theBufContent += sizeof(cause);


	
	return theBufContent;
}

int SIPCCMsg_Inner_AlertingRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);
	memSize += srcDeviceID.length()+1;	
	memSize += destDeviceID.length()+1;	
	memSize +=sizeof( UINT);
	memSize +=sizeof(int);
		
	return memSize;
}
void SIPCCMsg_Inner_MakeCallRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	srcDeviceID = thebuf + theBufContent;	
	theBufContent += srcDeviceID.length()+1;

	destDeviceID = thebuf + theBufContent;	
	theBufContent += destDeviceID.length()+1;

	memmove(&callID, thebuf+theBufContent, sizeof(UINT));
	theBufContent += sizeof(UINT);

	userData = thebuf + theBufContent;	
	theBufContent += userData.length()+1;
	


	
}

int SIPCCMsg_Inner_MakeCallRequest::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, srcDeviceID.c_str(), srcDeviceID.length()+1);
	theBufContent += srcDeviceID.length()+1;

	memcpy(thebuf+theBufContent, destDeviceID.c_str(), destDeviceID.length()+1);
	theBufContent += destDeviceID.length()+1;

	memcpy(thebuf+theBufContent, &callID, sizeof(callID));
	theBufContent += sizeof(callID);

	
	memcpy(thebuf+theBufContent, userData.c_str(), userData.length()+1);
	theBufContent += userData.length()+1;
	
	return theBufContent;
}

int SIPCCMsg_Inner_MakeCallRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);
	memSize += srcDeviceID.length()+1;	
	memSize += destDeviceID.length()+1;	
	memSize +=sizeof( UINT);
	memSize += userData.length()+1;	
		
	return memSize;
}
void SIPCCMsg_Inner_TimerEvent::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	memmove(&timerID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);


	
}

int SIPCCMsg_Inner_TimerEvent::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, &timerID, sizeof(timerID));
	theBufContent += sizeof(timerID);

	return theBufContent;
	
}

int SIPCCMsg_Inner_TimerEvent::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);
	memSize +=sizeof( unsigned int);;	
		
	return memSize;
}
void SIPCCMsg_Bord_DriverConnect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channel1_ID = thebuf + theBufContent;	
	theBufContent += channel1_ID.length()+1;
	
	memmove(&channel1_Type, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	channel2_ID = thebuf + theBufContent;	
	theBufContent += channel2_ID.length()+1;
	
	memmove(&channel2_Type, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);


	memmove(&connectType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	

	
}

int SIPCCMsg_Bord_DriverConnect::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, channel1_ID.c_str(), channel1_ID.length()+1);
	theBufContent += channel1_ID.length()+1;

	memcpy(thebuf+theBufContent, &channel1_Type, sizeof(channel1_Type));
	theBufContent += sizeof(channel1_Type);


	memcpy(thebuf+theBufContent, channel2_ID.c_str(), channel2_ID.length()+1);
	theBufContent += channel2_ID.length()+1;

	memcpy(thebuf+theBufContent, &channel2_Type, sizeof(channel2_Type));
	theBufContent += sizeof(channel2_Type);

	memcpy(thebuf+theBufContent, &connectType, sizeof(connectType));
	theBufContent += sizeof(connectType);




	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverConnect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += channel1_ID.length()+1;
	memSize +=sizeof(  int);

	memSize += channel2_ID.length()+1;
	memSize +=sizeof(  int);	
	memSize +=sizeof(  int);
	
		
	return memSize;
}



void SIPCCMsg_Bord_DriverDisconnect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	channel1_ID = thebuf + theBufContent;	
	theBufContent += channel1_ID.length()+1;
	
	memmove(&channel1_Type, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	channel2_ID = thebuf + theBufContent;	
	theBufContent += channel2_ID.length()+1;
	
	memmove(&channel2_Type, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);

	
}

int SIPCCMsg_Bord_DriverDisconnect::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, channel1_ID.c_str(), channel1_ID.length()+1);
	theBufContent += channel1_ID.length()+1;

	memcpy(thebuf+theBufContent, &channel1_Type, sizeof(channel1_Type));
	theBufContent += sizeof(channel1_Type);


	memcpy(thebuf+theBufContent, channel2_ID.c_str(), channel2_ID.length()+1);
	theBufContent += channel2_ID.length()+1;

	memcpy(thebuf+theBufContent, &channel2_Type, sizeof(channel2_Type));
	theBufContent += sizeof(channel2_Type);

	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverDisconnect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += channel1_ID.length()+1;
	memSize +=sizeof(  int);

	memSize += channel2_ID.length()+1;
	memSize +=sizeof(  int);

	return memSize;
}
void SIPCCMsg_Bord_DriverTrunkOffHook::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;//1

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);//2

		
}

int SIPCCMsg_Bord_DriverTrunkOffHook::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;//1


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);//2


	
	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverTrunkOffHook::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += channelID.length()+1;//1
	memSize +=sizeof(  int);//2
	
	
		
	return memSize;
}

void SIPCCMsg_Bord_DriverTrunkOnHook::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;//1

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);//2

		
}

int SIPCCMsg_Bord_DriverTrunkOnHook::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;//1


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);//2


	
	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverTrunkOnHook::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += channelID.length()+1;//1
	memSize +=sizeof(  int);//2
	
	
		
	return memSize;
}

void SIPCCMsg_Bord_DriverTrunkReset::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;//1

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);//2

		
}

int SIPCCMsg_Bord_DriverTrunkReset::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;//1


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);//2


	
	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverTrunkReset::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += channelID.length()+1;//1
	memSize +=sizeof(  int);//2
	
	
		
	return memSize;
}
//
void SIPCCMsg_Bord_DriverEchoRemoveCtrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
	channelID = thebuf + theBufContent;	
	theBufContent += channelID.length()+1;//1

	memmove(&channelType, thebuf+theBufContent, sizeof( int));
	theBufContent += sizeof( int);//2

	memmove(&allow, thebuf+theBufContent, sizeof( bool));
	theBufContent += sizeof( bool);//2
		
}

int SIPCCMsg_Bord_DriverEchoRemoveCtrl::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	memcpy(thebuf+theBufContent, channelID.c_str(), channelID.length()+1);
	theBufContent += channelID.length()+1;//1


	memcpy(thebuf+theBufContent, &channelType, sizeof(channelType));
	theBufContent += sizeof(channelType);//2


	memcpy(thebuf+theBufContent, &allow, sizeof(allow));
	theBufContent += sizeof(allow);//3


	
	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverEchoRemoveCtrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += channelID.length()+1;//1
	memSize +=sizeof( int);//2
	memSize +=sizeof( bool);//3
	
	
		
	return memSize;
}
//
void SIPCCMsg_Bord_DriverAddRecordForTH::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
	phoneNo = thebuf + theBufContent;	
	theBufContent += phoneNo.length()+1;//1

	
		
}

int SIPCCMsg_Bord_DriverAddRecordForTH::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	memcpy(thebuf+theBufContent, phoneNo.c_str(), phoneNo.length()+1);
	theBufContent += phoneNo.length()+1;//1

	
	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverAddRecordForTH::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += phoneNo.length()+1;//1
		
	return memSize;
}

//
void SIPCCMsg_Bord_DriverDelRecordForTH::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
	phoneNo = thebuf + theBufContent;	
	theBufContent += phoneNo.length()+1;//1

	
		
}

int SIPCCMsg_Bord_DriverDelRecordForTH::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	memcpy(thebuf+theBufContent, phoneNo.c_str(), phoneNo.length()+1);
	theBufContent += phoneNo.length()+1;//1

	
	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverDelRecordForTH::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += phoneNo.length()+1;//1
		
	return memSize;
}
//
void SIPCCMsg_Bord_DriverDelAllRecordForTH::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	
	
	
		
}

int SIPCCMsg_Bord_DriverDelAllRecordForTH::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	
	

	
	return theBufContent;
	
}

int SIPCCMsg_Bord_DriverDelAllRecordForTH::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	
	return memSize;
}
///
void SIPCCMsg_GCTI_Message::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	context = thebuf + theBufContent;	
	theBufContent += context.length()+1;

	
	strorigin = thebuf + theBufContent;	
	theBufContent += strorigin.length()+1;

	
		
}

int SIPCCMsg_GCTI_Message::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, context.c_str(), context.length()+1);
	theBufContent += context.length()+1;
		
	memcpy(thebuf+theBufContent, strorigin.c_str(), strorigin.length()+1);
	theBufContent += strorigin.length()+1;

	
	return theBufContent;
	
}

int SIPCCMsg_GCTI_Message::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += context.length()+1;
	memSize += strorigin.length()+1;
	return memSize;
}


///
void SIPCCMsg_Session_Message::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&uinvokeID, thebuf+theBufContent, sizeof(unsigned int));
	theBufContent += sizeof(unsigned int);

	context = thebuf + theBufContent;	
	theBufContent += context.length()+1;

	strType = thebuf + theBufContent;	
	theBufContent += strType.length()+1;

	strorigin = thebuf + theBufContent;	
	theBufContent += strorigin.length()+1;

	sSender = thebuf + theBufContent;	
	theBufContent += sSender.length()+1;

	sReceiver = thebuf + theBufContent;	
	theBufContent += sReceiver.length()+1;

	
		
}

int SIPCCMsg_Session_Message::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	
	memcpy(thebuf+theBufContent, &uinvokeID, sizeof(uinvokeID));
	theBufContent += sizeof(uinvokeID);

	memcpy(thebuf+theBufContent, context.c_str(), context.length()+1);
	theBufContent += context.length()+1;

	memcpy(thebuf+theBufContent, strType.c_str(), strType.length()+1);
	theBufContent += strType.length()+1;

	memcpy(thebuf+theBufContent, strorigin.c_str(), strorigin.length()+1);
	theBufContent += strorigin.length()+1;



	memcpy(thebuf+theBufContent, sSender.c_str(), sSender.length()+1);
	theBufContent += sSender.length()+1;

	memcpy(thebuf+theBufContent, sReceiver.c_str(), sReceiver.length()+1);
	theBufContent += sReceiver.length()+1;
		
	return theBufContent;
	
}

int SIPCCMsg_Session_Message::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize +=sizeof( unsigned int);

	memSize += context.length()+1;
	memSize += strType.length()+1;

	memSize += strorigin.length()+1;
	memSize += sSender.length()+1;	
	memSize += sReceiver.length()+1;

	return memSize;
}

//
///
void SIPCCMsg_SysManage_SwitchAcdConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	ManagerId = thebuf + theBufContent;	
	theBufContent += ManagerId.length()+1;

	AcdServerId = thebuf + theBufContent;	
	theBufContent += AcdServerId.length()+1;
	
	memmove(&AcdServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&AcdServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&bLoadFinished, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&OldServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&ManagerCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&indexNum, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	
		
}

int SIPCCMsg_SysManage_SwitchAcdConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;


	memcpy(thebuf+theBufContent, ManagerId.c_str(), ManagerId.length()+1);
	theBufContent += ManagerId.length()+1;
	

	memcpy(thebuf+theBufContent, AcdServerId.c_str(), AcdServerId.length()+1);
	theBufContent += AcdServerId.length()+1;
	

	memcpy(thebuf+theBufContent, &AcdServerIp, sizeof(AcdServerIp));
	theBufContent += sizeof(AcdServerIp);

	memcpy(thebuf+theBufContent, &AcdServerPort, sizeof(AcdServerPort));
	theBufContent += sizeof(AcdServerPort);

	memcpy(thebuf+theBufContent, &bLoadFinished, sizeof(bLoadFinished));
	theBufContent += sizeof(bLoadFinished);
	


	memcpy(thebuf+theBufContent, &ServiceID, sizeof(ServiceID));
	theBufContent += sizeof(ServiceID);
	
	memcpy(thebuf+theBufContent, &OldServiceID, sizeof(OldServiceID));
	theBufContent += sizeof(OldServiceID);

	memcpy(thebuf+theBufContent, &ManagerCount, sizeof(ManagerCount));
	theBufContent += sizeof(ManagerCount);

	memcpy(thebuf+theBufContent, &indexNum, sizeof(indexNum));
	theBufContent += sizeof(indexNum);

	return theBufContent;
	
}

int SIPCCMsg_SysManage_SwitchAcdConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += ManagerId.length()+1;	
	memSize += AcdServerId.length()+1;
	memSize +=sizeof( unsigned long);
	memSize +=sizeof( unsigned short);
	memSize +=sizeof( char);

	memSize +=sizeof( int);
	memSize +=sizeof( int);
	memSize +=sizeof( int);
	memSize +=sizeof( int);

	return memSize;
}
//
///
void SIPCCMsg_SysManage_AddTDDistributeServer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	serverName = thebuf + theBufContent;	
	theBufContent += serverName.length()+1;

	
	memmove(&lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(&serviceid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
		
}

int SIPCCMsg_SysManage_AddTDDistributeServer::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, serverName.c_str(), serverName.length()+1);
	theBufContent += serverName.length()+1;


	memcpy(thebuf+theBufContent, &lanIP, sizeof(lanIP));
	theBufContent += sizeof(lanIP);

	memcpy(thebuf+theBufContent, &lanPort, sizeof(lanPort));
	theBufContent += sizeof(lanPort);

	memcpy(thebuf+theBufContent, &wanIP, sizeof(wanIP));
	theBufContent += sizeof(wanIP);
	
	memcpy(thebuf+theBufContent, &wanPort, sizeof(wanPort));
	theBufContent += sizeof(wanPort);

	memcpy(thebuf+theBufContent, &serviceid, sizeof(serviceid));
	theBufContent += sizeof(serviceid);
		
	return theBufContent;
	
}

int SIPCCMsg_SysManage_AddTDDistributeServer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += serverName.length()+1;
	memSize +=sizeof( unsigned long);
	memSize +=sizeof( unsigned short);
	memSize +=sizeof( unsigned long);
	memSize +=sizeof( unsigned short);
	memSize +=sizeof( int);
	

	return memSize;
}
//
///
void SIPCCMsg_SysManage_AddGWtoTDDS::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);

	gwName = thebuf + theBufContent;	
	theBufContent += gwName.length()+1;

	computerSymbol = thebuf + theBufContent;	
	theBufContent += computerSymbol.length()+1;


	serverName = thebuf + theBufContent;	
	theBufContent += serverName.length()+1;

	memmove(&serviceid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


		
}

int SIPCCMsg_SysManage_AddGWtoTDDS::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += gwName.length()+1;


	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	memcpy(thebuf+theBufContent, serverName.c_str(), serverName.length()+1);
	theBufContent += serverName.length()+1;


	memcpy(thebuf+theBufContent, &serviceid, sizeof(serviceid));
	theBufContent += sizeof(serviceid);
	return theBufContent;
	
}

int SIPCCMsg_SysManage_AddGWtoTDDS::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gwName.length()+1;
	memSize += computerSymbol.length()+1;
	memSize += serverName.length()+1;
	memSize +=sizeof( int);

	return memSize;
}
///
void SIPCCMsg_TrunkData_DSLoadInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);


	serverName = thebuf + theBufContent;	
	theBufContent += serverName.length()+1;

	memmove(&serviceid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

		
}

int SIPCCMsg_TrunkData_DSLoadInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, serverName.c_str(), serverName.length()+1);
	theBufContent += serverName.length()+1;

	memcpy(thebuf+theBufContent, &serviceid, sizeof(serviceid));
	theBufContent += sizeof(serviceid);
	
	return theBufContent;
	
}

int SIPCCMsg_TrunkData_DSLoadInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype	
	memSize += serverName.length()+1;
	memSize +=sizeof( int);

	return memSize;
}
///
void SIPCCMsg_SysManage_AddTDCollectServer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);
	serverName = thebuf + theBufContent;	
	theBufContent += serverName.length()+1;

	memmove(&serverType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&serviceid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


		
}

int SIPCCMsg_SysManage_AddTDCollectServer::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, serverName.c_str(), serverName.length()+1);
	theBufContent += serverName.length()+1;


	memcpy(thebuf+theBufContent, &serverType, sizeof(serverType));
	theBufContent += sizeof(serverType);

	memcpy(thebuf+theBufContent, &lanIP, sizeof(lanIP));
	theBufContent += sizeof(lanIP);

	memcpy(thebuf+theBufContent, &lanPort, sizeof(lanPort));
	theBufContent += sizeof(lanPort);

	memcpy(thebuf+theBufContent, &wanIP, sizeof(wanIP));
	theBufContent += sizeof(wanIP);
	
	memcpy(thebuf+theBufContent, &wanPort, sizeof(wanPort));
	theBufContent += sizeof(wanPort);


	memcpy(thebuf+theBufContent, &serviceid, sizeof(serviceid));
	theBufContent += sizeof(serviceid);
		
	return theBufContent;
	
}

int SIPCCMsg_SysManage_AddTDCollectServer::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += serverName.length()+1;
	memSize +=sizeof( int);
	memSize +=sizeof( unsigned long);
	memSize +=sizeof( unsigned short);
	memSize +=sizeof( unsigned long);
	memSize +=sizeof( unsigned short);
	memSize +=sizeof( int);
	

	return memSize;
}
//
void SIPCCMsg_SysManage_AddComptoTDCS::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);

	managerid = thebuf + theBufContent;	
	theBufContent += managerid.length()+1;

	serverName = thebuf + theBufContent;	
	theBufContent += serverName.length()+1;
	memmove(&serviceid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
		
}

int SIPCCMsg_SysManage_AddComptoTDCS::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length()+1);
	theBufContent += managerid.length()+1;

	memcpy(thebuf+theBufContent, serverName.c_str(), serverName.length()+1);
	theBufContent += serverName.length()+1;

	memcpy(thebuf+theBufContent, &serviceid, sizeof(serviceid));
	theBufContent += sizeof(serviceid);
	
	return theBufContent;
	
}

int SIPCCMsg_SysManage_AddComptoTDCS::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	
	memSize += managerid.length()+1;

	memSize += serverName.length()+1;

	 memSize +=sizeof( int);

	return memSize;
}
///
void SIPCCMsg_SysManage_AddGWtoTDCS::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);

	gwName = thebuf + theBufContent;	
	theBufContent += gwName.length()+1;

	computerSymbol = thebuf + theBufContent;	
	theBufContent += computerSymbol.length()+1;


	serverName = thebuf + theBufContent;	
	theBufContent += serverName.length()+1;
	memmove(&serviceid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
		
}

int SIPCCMsg_SysManage_AddGWtoTDCS::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += gwName.length()+1;


	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	memcpy(thebuf+theBufContent, serverName.c_str(), serverName.length()+1);
	theBufContent += serverName.length()+1;

	memcpy(thebuf+theBufContent, &serviceid, sizeof(serviceid));
	theBufContent += sizeof(serviceid);


	
	return theBufContent;
	
}

int SIPCCMsg_SysManage_AddGWtoTDCS::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gwName.length()+1;
	memSize += computerSymbol.length()+1;
	memSize += serverName.length()+1;
	 memSize +=sizeof( int);

	return memSize;
}
///
void SIPCCMsg_SysManage_AddComptoConnNo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);

	managerid = thebuf + theBufContent;	
	theBufContent += managerid.length()+1;

	connectPhoneNoList = thebuf + theBufContent;	
	theBufContent += connectPhoneNoList.length()+1;

		
}

int SIPCCMsg_SysManage_AddComptoConnNo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length()+1);
	theBufContent += managerid.length()+1;


	memcpy(thebuf+theBufContent, connectPhoneNoList.c_str(), connectPhoneNoList.length()+1);
	theBufContent += connectPhoneNoList.length()+1;


	
	return theBufContent;
	
}

int SIPCCMsg_SysManage_AddComptoConnNo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += managerid.length()+1;
	memSize += connectPhoneNoList.length()+1;
	return memSize;
}
///

void SIPCCMsg_TrunkData_NotifyTrunkState::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Gateway_NotifyTrunkState";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	LineNo = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+LineNo.length()+1, msgsize, strMsg, "LineNo.length()", ip, port)) ) {return;}
	if ( !(VerifyData(LineNo.length(), USERLINENO_LEN, strMsg, "LineNo", ip, port)) ) {return;}
	theBufContent += LineNo.length()+1;

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "GroupId", ip, port)) ) {return;}
	memmove(&this->GroupId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "CallDirection", ip, port)) ) {return;}
	memmove(&this->CallDirection, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "LastState", ip, port)) ) {return;}
	memmove(&this->LastState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "NewState", ip, port)) ) {return;}
	memmove(&this->NewState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	managerid = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+managerid.length()+1, msgsize, strMsg, "managerid.length()", ip, port)) ) {return;}
	if ( !(VerifyData(managerid.length(), MANAGERID_LEN, strMsg, "managerid", ip, port)) ) {return;}
	theBufContent += managerid.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}
	
	if ( !(VerifyTotalLen(theBufContent+sizeof(time_t), msgsize, strMsg, "newStatetime.length()", ip, port)) ) {return;}
	memmove(&this->newStatetime, thebuf+theBufContent, sizeof(time_t));
	theBufContent += sizeof(time_t);



	if ( theBufContent >= msgsize )
	{
		return;
	}

	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "MappingName", ip, port)) ) {return;}
	memmove(&this->MappingName, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_TrunkData_NotifyTrunkState::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	memcpy(thebuf+theBufContent, LineNo.c_str(), LineNo.length()+1);
	theBufContent += LineNo.length()+1;

	memmove(thebuf+theBufContent, &this->GroupId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CallDirection, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->LastState, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->NewState, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length()+1);
	theBufContent += managerid.length()+1;

	memcpy(thebuf+theBufContent,&this->newStatetime, sizeof(time_t));
	theBufContent += sizeof(time_t);
	

	memmove(thebuf+theBufContent, &this->MappingName, sizeof(int));
	theBufContent += sizeof(int);


	return theBufContent;
}

int SIPCCMsg_TrunkData_NotifyTrunkState::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;
	memSize += LineNo.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += managerid.length()+1;
	memSize += sizeof(time_t);
	memSize += sizeof(int);//MappingName
	return memSize;
}

void SIPCCMsg_OutDial_CheckAlive::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	GwName = thebuf + theBufContent;
	theBufContent += GwName.length()+1;
}

int SIPCCMsg_OutDial_CheckAlive::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	return theBufContent;
}

int SIPCCMsg_OutDial_CheckAlive::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += GwName.length()+1;
	return memSize;
}

void SIPCCMsg_OutDial_CheckAliveConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	GwName = thebuf + theBufContent;
	theBufContent += GwName.length()+1;
}

int SIPCCMsg_OutDial_CheckAliveConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	return theBufContent;
}

int SIPCCMsg_OutDial_CheckAliveConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += GwName.length()+1;
	return memSize;
}

int SIPCCMsg_Timer_Synchronization::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	memset(thebuf, 0, GetMyMemSize());
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &ServiceLevel, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, currentDate.c_str(), currentDate.length() + 1);
	theBufContent += currentDate.length() + 1;

	return theBufContent;
}

void SIPCCMsg_Timer_Synchronization::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/)
{
	int iContentSize = AnalyzeMsgHead(thebuf);

	memmove((PVOID)&ServiceLevel, thebuf + iContentSize, sizeof(int));
	iContentSize += sizeof(int);

	currentDate = string(thebuf + iContentSize);
}

int SIPCCMsg_Timer_Synchronization::GetMyMemSize()
{
	return 3 * sizeof(int) + currentDate.size();
}

int SIPCCMsg_Timer_SynchronizationConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	memset(thebuf, 0, GetMyMemSize());
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &millisecond, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, (PVOID)currentDate.c_str(), currentDate.length() + 1);
	theBufContent += currentDate.length() + 1;

	return theBufContent;
}

void SIPCCMsg_Timer_SynchronizationConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/)
{
	int iContentSize = AnalyzeMsgHead(thebuf);

	memmove((PVOID)&millisecond, thebuf + iContentSize, sizeof(int));
	iContentSize += sizeof(int);

	currentDate = string(thebuf + iContentSize);
}

int SIPCCMsg_Timer_SynchronizationConf::GetMyMemSize()
{
	int iSize = 0;
	iSize += 3 * sizeof(int);
	iSize += currentDate.length() + 1;
	return iSize;
}

int SIPCCMsg_Client_ConferenceCall::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	memset(thebuf, 0, GetMyMemSize());
	int bytes = FillMsgHead(thebuf);

	memmove(thebuf+bytes, held_device_dn.c_str(), held_device_dn.length()+1);
	bytes += held_device_dn.length()+1;
	
	memmove(thebuf+bytes, preside_device_dn.c_str(), preside_device_dn.length()+1);
	bytes += preside_device_dn.length() + 1;

	memmove(thebuf+bytes, active_device_dn.c_str(), active_device_dn.length()+1);
	bytes += active_device_dn.length()+1;

	return bytes;
}

void SIPCCMsg_Client_ConferenceCall::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	int bytes = AnalyzeMsgHead(thebuf);

	held_device_dn = std::string(thebuf + bytes);
	bytes += held_device_dn.length()+1;

	preside_device_dn = std::string(thebuf + bytes);
	bytes += preside_device_dn.length()+1;

	active_device_dn = std::string(thebuf + bytes);
	bytes += active_device_dn.length()+1;
	
	return;
}

void SIPCCMsg_Client_ConferenceCall::ReleaseMemory()
{	
	return;
}

int SIPCCMsg_Client_ConferenceCall::GetMyMemSize()
{
	int iSize = 2 * sizeof(int);

	iSize += held_device_dn.length()+1;
	
	iSize += preside_device_dn.length()+1;	

	iSize += active_device_dn.length() + 1;
	

	return iSize;
}

int SIPCCMsg_Client_ConferenceCallConf::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	memset(thebuf, 0, GetMyMemSize());
	int bytes = FillMsgHead(thebuf);
	
	memmove(thebuf+bytes, &is_success, sizeof(is_success));
	bytes += sizeof(is_success);

	memmove(thebuf+bytes,conference_call_id.c_str(),conference_call_id.length()+1);
	bytes += conference_call_id.length()+1;

	memmove(thebuf+bytes, held_device_dn.c_str(), held_device_dn.length()+1);
	bytes += held_device_dn.length()+1;

	memmove(thebuf+bytes,preside_device_dn.c_str(),preside_device_dn.length()+1);
	bytes += preside_device_dn.length()+1;

	memmove(thebuf+bytes, active_device_dn.c_str(), active_device_dn.length()+1);
	bytes += held_device_dn.length()+1;

	memmove(thebuf+bytes, &held_device_address, sizeof(held_device_address));
	bytes += sizeof(preside_device_address);

	memmove(thebuf+bytes, &preside_device_address, sizeof(preside_device_address));
	bytes += sizeof(preside_device_address);

	memmove(thebuf+bytes, &active_device_address, sizeof(active_device_address));
	bytes += sizeof(active_device_address);

	return bytes;
}

void SIPCCMsg_Client_ConferenceCallConf::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	int bytes = AnalyzeMsgHead(thebuf);

	memmove(&is_success,thebuf + bytes,sizeof(bytes));
	bytes += sizeof(bytes);

	conference_call_id = std::string(thebuf+bytes);
	bytes += conference_call_id.length()+1;

	//held_device_dn = std::string(thebuf + bytes);
	//bytes += held_device_dn.length()+1;

	//memmove(&held_device_type,thebuf+bytes, sizeof(held_device_type));
	//bytes += sizeof(held_device_type);

	memmove(&held_device_address,thebuf+bytes,sizeof(held_device_address));
	bytes += sizeof(held_device_address);

	//conference_device_dn = std::string(thebuf + bytes);
	//bytes += conference_device_dn.length()+1;

	//memmove(&conference_device_type,thebuf + bytes,sizeof(conference_device_type));
	//bytes += sizeof(conference_device_type);

	memmove(&preside_device_address,thebuf+bytes,sizeof(preside_device_address));
	bytes += sizeof(preside_device_address);

	//active_device_dn = std::string(thebuf + bytes);
	//bytes += active_device_dn.length()+1;

	//memmove(&active_device_type,thebuf + bytes , sizeof(active_device_type));
	//bytes += sizeof(active_device_type);

	memmove(&active_device_address,thebuf+bytes,sizeof(active_device_address));
	bytes += sizeof(active_device_address);

	return;
}

void SIPCCMsg_Client_ConferenceCallConf::ReleaseMemory()
{
	return;
}

int SIPCCMsg_Client_ConferenceCallConf::GetMyMemSize()
{
	int iSize = 2 * sizeof(int);

	iSize += sizeof(is_success);
	iSize += conference_call_id.length()+1;

	iSize += held_device_dn.length()	+1;
	iSize += preside_device_dn.length()	+1;
	iSize += active_device_dn.length()	+1;

	iSize += sizeof(held_device_address);
	iSize += sizeof(preside_device_address);
	iSize += sizeof(active_device_address);

	return iSize;
}


int SIPCCMsg_Client_ConferenceCallEnd::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	memset(thebuf, 0, GetMyMemSize());
	int bytes = FillMsgHead(thebuf);

	memmove(thebuf + bytes,conference_call_id.c_str(),conference_call_id.length()+1);
	bytes += conference_call_id.length()+1;

	return bytes;
}

void SIPCCMsg_Client_ConferenceCallEnd::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	int bytes = AnalyzeMsgHead(thebuf);

	conference_call_id = std::string(thebuf+bytes);
	bytes += conference_call_id.length()+1;

	return;
}

void SIPCCMsg_Client_ConferenceCallEnd::ReleaseMemory()
{
	return;
}

int SIPCCMsg_Client_ConferenceCallEnd::GetMyMemSize()
{
	int iSize = 2 * sizeof(int);
	iSize += conference_call_id.length()+1;
	return iSize;
}

/// add code  by hyj 
//Type_OneKeySwitch_ServiceRegister
void SIPCCMsg_OneKeySwitch_ServiceRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;	
	theBufContent += ServerName.length()+1;

	memmove(&ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	


	memmove(&wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(&lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&ServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


}

int SIPCCMsg_OneKeySwitch_ServiceRegister::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;


	memmove(thebuf+theBufContent, &ServerType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &wanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &wanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	memmove(thebuf+theBufContent, &lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &lanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &ServerID, sizeof(int));
	theBufContent += sizeof(int);
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ServiceRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;
	memSize += sizeof(int);
  	
	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);


	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);//servier id

	return memSize;
}

//Type_OneKeySwitch_ServiceRegisterConf
void SIPCCMsg_OneKeySwitch_ServiceRegisterConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//beat sever  ip and port
	memmove(&HeartBeatServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&HeartBeatServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(&HeartBeatServerBackupIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&HeartBeatServerBackupIPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	 memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	 memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
    //server 1 
    memmove(&Service1ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&Service1Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int );


	memmove(&service1IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&service1Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	//server 2
	 memmove(&Service2ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&Service2Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int );


	memmove(&service2IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&service2Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	memmove(&this->HeartBeatServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->HeartBeatServerBackupID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	if ( theBufContent >= msgsize)
	{
		return;
	}
	//operationMode
	memmove(&operationMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	
	

}

int SIPCCMsg_OneKeySwitch_ServiceRegisterConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


    //
	memmove(thebuf+theBufContent, &HeartBeatServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &HeartBeatServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

    //
	memmove(thebuf+theBufContent, &HeartBeatServerBackupIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &HeartBeatServerBackupIPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	
	memmove(thebuf+theBufContent, &ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &ServiceType, sizeof(int));
	theBufContent += sizeof(int);

    //
	
	memmove(thebuf+theBufContent, &Service1ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &Service1Type, sizeof(int));
	theBufContent += sizeof(int);
   
	memmove(thebuf+theBufContent, &service1IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &service1Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	

	//
	memmove(thebuf+theBufContent, &Service2ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &Service2Type, sizeof(int));
	theBufContent += sizeof(int);
   
	memmove(thebuf+theBufContent, &service2IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &service2Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->HeartBeatServerID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupID, sizeof(int));
	theBufContent += sizeof(int);


	//operationMode


	memmove(thebuf+theBufContent, &this->operationMode, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ServiceRegisterConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
		
	memSize += sizeof( unsigned long );//HeartBeatServerIp;
	memSize += sizeof(unsigned short);// HeartBeatServerPort;
	memSize += sizeof(unsigned long);// HeartBeatServerBackupIp;
	memSize += sizeof(unsigned short);// HeartBeatServerBackupIPort;
    memSize += sizeof(int);//
	memSize += sizeof(int);///ServiceType
	memSize += sizeof(int);//Service1ID;//begin未定
	memSize += sizeof(int);//Service1Type;
	memSize += sizeof(unsigned long);// service1IP;
	memSize += sizeof(unsigned short);// service1Port;
	memSize += sizeof(int );//Service2ID
	memSize += sizeof(int );//Service2Type
	memSize += sizeof(unsigned long );//service2IP;
	memSize += sizeof(unsigned short );//service2Port;// end 未定

	memSize += sizeof(int);	//HeartBeatServerID
	memSize += sizeof(int);	//HeartBeatServerBackupID
    memSize += sizeof(int);//operationMode
	return memSize;
}
//
//Type_OneKeySwitch_ServiceConfirm
void SIPCCMsg_OneKeySwitch_ServiceConfirm::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);



	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;


	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	
	memmove(&serviceWanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&serviceLanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&servicePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	

}

int SIPCCMsg_OneKeySwitch_ServiceConfirm::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

    memmove(thebuf+theBufContent, &ServiceID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &ServiceType, sizeof(int));
	theBufContent += sizeof(int);

    //
	memmove(thebuf+theBufContent, &serviceWanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &serviceLanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &servicePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ServiceConfirm::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype		

	memSize += InvokeId.length()+1;	
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);	

	return memSize;
}
//SIPCCMsg_OneKeySwitch_ServiceConfirmConf
void SIPCCMsg_OneKeySwitch_ServiceConfirmConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


}

int SIPCCMsg_OneKeySwitch_ServiceConfirmConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;


     memmove(thebuf+theBufContent, &ServiceID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &ServiceType, sizeof(int));
	theBufContent += sizeof(int);
    
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ServiceConfirmConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype		

	memSize += InvokeId.length()+1;	

	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}
///Type_OneKeySwitch_GetHeartBeat
SIPCCMsg_OneKeySwitch_GetHeartBeat::SIPCCMsg_OneKeySwitch_GetHeartBeat()
{
	msgType = Type_OneKeySwitch_GetHeartBeat;
	InvokeId = "";
	HeartBeatServerIP = 0;
	HeartBeatServerPort = 0;
	HeartBeatServerBackupIP = 0;
	HeartBeatServerBackupPort = 0;
	ServiceID=0;
	ServiceType=0;
}

void SIPCCMsg_OneKeySwitch_GetHeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_GetHeartBeat";
	int theBufContent = AnalyzeMsgHead(thebuf);

	//InvokeId
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	//HeartBeatServerIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//HeartBeatServerBackupIP
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned long), msgsize, strMsgName, "HeartBeatServerBackupIP", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerBackupPort
	if ( !(VerifyTotalLen(theBufContent+sizeof(unsigned short), msgsize, strMsgName, "HeartBeatServerBackupPort", ip, port)) ) {return;}
	memmove(&this->HeartBeatServerBackupPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_OneKeySwitch_GetHeartBeat::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	//HeartBeatServerIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//HeartBeatServerBackupIP
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	//HeartBeatServerBackupPort
	memmove(thebuf+theBufContent, &this->HeartBeatServerBackupPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetHeartBeat::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;		//InvokeId
	memSize += sizeof(unsigned long);	//HeartBeatServerIP
	memSize += sizeof(unsigned short);	//HeartBeatServerPort
	memSize += sizeof(unsigned long);	//HeartBeatServerBackupIP
	memSize += sizeof(unsigned short);	//HeartBeatServerBackupPort

	memSize += sizeof(int);//               servertype	
	memSize += sizeof(int );//               ServiceID;

	return memSize;
}
//Type_OneKeySwitch_GetService
void SIPCCMsg_OneKeySwitch_GetService::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&GetServiceCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
 
	//server 1
	memmove(&Service1ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service1Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service1IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service1Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

    //server 2
	memmove(&Service2ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service2Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service2IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service2Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	 //server 3
	memmove(&Service3ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service3Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service3IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service3Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//server 4
	memmove(&Service4ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service4Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service4IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service4Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	//serviceInfoList
	serviceInfoList = thebuf + theBufContent;
	theBufContent += serviceInfoList.length() + 1;

}

int SIPCCMsg_OneKeySwitch_GetService::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;


	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

   
	memmove(thebuf+theBufContent, &this->GetServiceCount, sizeof(int));
	theBufContent += sizeof(int);


    //server 1
	memmove(thebuf+theBufContent, &this->Service1ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service1Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service1IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service1Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//server 2
	memmove(thebuf+theBufContent, &this->Service2ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service2Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service2IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service2Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//server 3
	memmove(thebuf+theBufContent, &this->Service3ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service3Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service3IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service3Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//server 4
	memmove(thebuf+theBufContent, &this->Service4ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service4Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service4IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service4Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//serviceInfoList
	memcpy(thebuf + theBufContent, serviceInfoList.c_str(), serviceInfoList.length() + 1);
	theBufContent += serviceInfoList.length() + 1;
    
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetService::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype		

	memSize += InvokeId.length()+1;	


	memSize += sizeof(int);//                ServiceID;//（自已）
	memSize += sizeof(int);//                ServiceType;//（自已）
	memSize += sizeof(int);//                GetServiceCount; //（第一次，第二次要几个，如果有取就是需要重新分配）
	memSize += sizeof(int );//               Service1ID;
	memSize += sizeof(int );//               Service1Type;
	memSize += sizeof(unsigned long);//      service1IP;
	memSize += sizeof(unsigned short );//    service1Port;
	memSize += sizeof(int );//               Service2ID;
	memSize += sizeof(int );//               Service2Type;
	memSize += sizeof(unsigned long  );//    service2IP;
	memSize += sizeof(unsigned short  );//   service2Port;
	memSize += sizeof(int );//               Service3ID;
	memSize += sizeof(int );//               Service3Type;
	memSize += sizeof(unsigned long );//     service3IP;
	memSize += sizeof(unsigned short );//    service3Port;
	memSize += sizeof(int   );//             Service4ID;
	memSize += sizeof(int );//               Service4Type;
	memSize += sizeof(unsigned long );//     service4IP;
	memSize += sizeof(unsigned short);//     service4Port;

	memSize += serviceInfoList.length() + 1;

	return memSize;
}


//Type_OneKeySwitch_GetServiceConf
void SIPCCMsg_OneKeySwitch_GetServiceConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;
	
	memmove(&SendServiceCount, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
 
	//server 1
	memmove(&Service1ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service1Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service1IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service1Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

    //server 2
	memmove(&Service2ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service2Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service2IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service2Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	 //server 3
	memmove(&Service3ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service3Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service3IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service3Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//server 4
	memmove(&Service4ID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	memmove(&Service4Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&service4IP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
    memmove(&service4Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	if ( theBufContent >= msgsize )
		return;

	//serviceInfoList
	serviceInfoList = thebuf + theBufContent;
	theBufContent += serviceInfoList.length() + 1;

}

int SIPCCMsg_OneKeySwitch_GetServiceConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;


	
   
	memmove(thebuf+theBufContent, &this->SendServiceCount, sizeof(int));
	theBufContent += sizeof(int);


    //server 1
	memmove(thebuf+theBufContent, &this->Service1ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service1Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service1IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service1Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//server 2
	memmove(thebuf+theBufContent, &this->Service2ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service2Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service2IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service2Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//server 3
	memmove(thebuf+theBufContent, &this->Service3ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service3Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service3IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service3Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//server 4
	memmove(thebuf+theBufContent, &this->Service4ID, sizeof(int));
	theBufContent += sizeof(int);
	memmove(thebuf+theBufContent, &this->Service4Type, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->service4IP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
	memmove(thebuf+theBufContent, &this->service4Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//serviceInfoList
	memcpy(thebuf + theBufContent, serviceInfoList.c_str(), serviceInfoList.length() + 1);
	theBufContent += serviceInfoList.length() + 1;
    
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetServiceConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype		

	memSize += InvokeId.length()+1;	


	memSize += sizeof(int);//                SendServiceCount;	
	memSize += sizeof(int );//               Service1ID;
	memSize += sizeof(int );//               Service1Type;
	memSize += sizeof(unsigned long);//      service1IP;
	memSize += sizeof(unsigned short );//    service1Port;
	memSize += sizeof(int );//               Service2ID;
	memSize += sizeof(int );//               Service2Type;
	memSize += sizeof(unsigned long  );//    service2IP;
	memSize += sizeof(unsigned short  );//   service2Port;
	memSize += sizeof(int );//               Service3ID;
	memSize += sizeof(int );//               Service3Type;
	memSize += sizeof(unsigned long );//     service3IP;
	memSize += sizeof(unsigned short );//    service3Port;
	memSize += sizeof(int   );//             Service4ID;
	memSize += sizeof(int );//               Service4Type;
	memSize += sizeof(unsigned long );//     service4IP;
	memSize += sizeof(unsigned short);//     service4Port;

	memSize += serviceInfoList.length() + 1;

	return memSize;
}

//Type_OneKeySwitch_ServiceTimeout
void SIPCCMsg_OneKeySwitch_ServiceTimeout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);


	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

	if ( theBufContent >= msgsize)
	{
		return;
	}

	memmove(&SelfServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&SelfServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	



	


}

int SIPCCMsg_OneKeySwitch_ServiceTimeout::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

    memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;
	


	//SelfServiceType
	memmove(thebuf+theBufContent, &this->SelfServiceType, sizeof(int));
	theBufContent += sizeof(int);

	//SelfServiceID
	memmove(thebuf+theBufContent, &this->SelfServiceID, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_ServiceTimeout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype	

	memSize += sizeof(int);//               servertype	
	memSize += sizeof(int );//               ServiceID;
	
	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	memSize += sizeof(int);//               SelfServiceType	
	memSize += sizeof(int );//               SelfServiceID;

	return memSize;
}
//Type_OneKeySwitch_SynchronizationRegister
void SIPCCMsg_OneKeySwitch_SynchronizationRegister::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;	
	theBufContent += ServerName.length()+1;

	memmove(&ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	


	memmove(&wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(&lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&ServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	InvokeId = thebuf + theBufContent;	

	theBufContent += InvokeId.length()+1;


	memmove(&needproxy, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(needproxy);


}

int SIPCCMsg_OneKeySwitch_SynchronizationRegister::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;


	memmove(thebuf+theBufContent, &ServerType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &wanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &wanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	memmove(thebuf+theBufContent, &lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &lanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &ServerID, sizeof(int));
	theBufContent += sizeof(int);



	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;



	memmove(thebuf+theBufContent, &ServerID, sizeof(needproxy));
	theBufContent += sizeof(needproxy);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SynchronizationRegister::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;
	memSize += sizeof(int);
  	
	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);


	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);//servier id

     memSize += InvokeId.length()+1;

	 memSize += sizeof(int);//needproxy
	return memSize;
}


////Type_OneKeySwitch_SynchronizationRegisterConf
void SIPCCMsg_OneKeySwitch_SynchronizationRegisterConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;


}

int SIPCCMsg_OneKeySwitch_SynchronizationRegisterConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SynchronizationRegisterConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

   memSize += InvokeId.length()+1;
	return memSize;
}

////Type_OneKeySwitch_LoadRegisterInfo
void SIPCCMsg_OneKeySwitch_LoadRegisterInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;


}

int SIPCCMsg_OneKeySwitch_LoadRegisterInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_LoadRegisterInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

   memSize += InvokeId.length()+1;
	return memSize;
}
//

//Type_SysManage_AddRegisterInfo
void SIPCCMsg_SysManage_AddRegisterInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);


	
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	ServerName = thebuf + theBufContent;	
	theBufContent += ServerName.length()+1;

	memmove(&ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(&lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&bLoad, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);


	if(theBufContent >= msgsize)
		return;

	memmove(&operationMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//needProxyRegister
	memmove(&needProxyRegister, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	

}

int SIPCCMsg_SysManage_AddRegisterInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;


	memmove(thebuf+theBufContent, &ServiceID, sizeof(int));
	theBufContent += sizeof(int);



	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;


	memmove(thebuf+theBufContent, &ServerType, sizeof(int));
	theBufContent += sizeof(int);



	
	memmove(thebuf+theBufContent, &wanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &wanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	memmove(thebuf+theBufContent, &lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &lanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	
	memmove(thebuf+theBufContent, &bLoad, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);



	memmove(thebuf+theBufContent, &operationMode, sizeof(int));
	theBufContent += sizeof(int);

	

	//needProxyRegister
	memmove(thebuf+theBufContent, &needProxyRegister, sizeof(int));
	theBufContent += sizeof(int);


	return theBufContent;
}

int SIPCCMsg_SysManage_AddRegisterInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype


	memSize += InvokeId.length()+1;
	memSize += sizeof(int);//servier id

	memSize += ServerName.length()+1;
	memSize += sizeof(int);
  	


	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);


	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(char);

	memSize += sizeof(int);//operationMode
	memSize += sizeof(int);		//needProxyRegister

	return memSize;
}
//Type_OneKeySwitch_AddRegisterInfoConf
void SIPCCMsg_OneKeySwitch_AddRegisterInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;


	memmove(&bLoad, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);



}

int SIPCCMsg_OneKeySwitch_AddRegisterInfoConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;


	memmove(thebuf+theBufContent, &bLoad, sizeof(unsigned char));
	theBufContent += sizeof(unsigned char);
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_AddRegisterInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

   memSize += InvokeId.length()+1;
   memSize +=sizeof(char);
	return memSize;
}
//

//Type_Client_ConferenceStart
SIPCCMsg_Client_ConferenceStart::SIPCCMsg_Client_ConferenceStart()
{
	msgType = Type_Client_ConferenceStart;
	firstName = "";
	firstLineNo = "";
	thirdName = "";
	conferenceType = -1;
	managerid="";

}

void SIPCCMsg_Client_ConferenceStart::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_ConferenceStart";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//firstName
	firstName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstName.length()+1, msgsize, strMsg, "firstName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstName.length(), USERLINENO_LEN, strMsg, "firstName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	firstLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstLineNo.length()+1, msgsize, strMsg, "firstLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstLineNo.length(), USERLINENO_LEN, strMsg, "firstLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	thirdName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+thirdName.length()+1, msgsize, strMsg, "thirdName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(thirdName.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "conferenceType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	


	managerid = thebuf+theBufContent;	
	theBufContent += ( managerid.length() + 1 );
}

int SIPCCMsg_Client_ConferenceStart::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//firstName
	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1 );
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1 );
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	memcpy(thebuf+theBufContent, thirdName.c_str(), thirdName.length() + 1 );
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);

    //managerid
	memcpy(thebuf+theBufContent, managerid .c_str(), managerid .length() + 1 );
	theBufContent += ( managerid .length() + 1 );

	return theBufContent;
}

int SIPCCMsg_Client_ConferenceStart::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += firstName.length() + 1;		//firstName
	memSize += firstLineNo.length() + 1;	//firstLineNo
	memSize += thirdName.length() + 1;		//thirdName
	memSize += sizeof(int);					//conferenceType
    memSize += managerid.length() + 1;		//managerid
	return memSize;
}

//Type_ACD_ConferenceStart
SIPCCMsg_ACD_ConferenceStart::SIPCCMsg_ACD_ConferenceStart()
{
	msgType = Type_ACD_ConferenceStart;
	firstName = "";
	firstLineNo = "";
	ConferencePort=0;
	thePartyLineNo="";	
    theOtherPartyLineNo="";

}

void SIPCCMsg_ACD_ConferenceStart::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_ConferenceStart";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//firstName
	firstName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstName.length()+1, msgsize, strMsg, "firstName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstName.length(), USERLINENO_LEN, strMsg, "firstName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	firstLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstLineNo.length()+1, msgsize, strMsg, "firstLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstLineNo.length(), USERLINENO_LEN, strMsg, "firstLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstLineNo.length() + 1 );

	memmove(&this->ConferencePort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
     
	//thePartyLineNo
	thePartyLineNo = thebuf+theBufContent;
	theBufContent += ( thePartyLineNo.length() + 1 );

	theOtherPartyLineNo = thebuf + theBufContent;
	theBufContent += theOtherPartyLineNo.length()+1;

}

int SIPCCMsg_ACD_ConferenceStart::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//firstName
	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1 );
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1 );
	theBufContent += ( firstLineNo.length() + 1 );



	memmove(thebuf+theBufContent, &this->ConferencePort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	//thePartyLineNo
	memcpy(thebuf+theBufContent, thePartyLineNo.c_str(), thePartyLineNo.length() + 1 );
	theBufContent += ( thePartyLineNo.length() + 1 );

   //	theOtherPartyLineNo	
	memcpy(thebuf+theBufContent, theOtherPartyLineNo.c_str(), theOtherPartyLineNo.length() + 1);
	theBufContent += theOtherPartyLineNo.length() + 1;

	return theBufContent;
}

int SIPCCMsg_ACD_ConferenceStart::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += firstName.length() + 1;		//firstName
	memSize += firstLineNo.length() + 1;	//firstLineNo
	memSize += sizeof(unsigned short);//ConferencePort
	memSize += thePartyLineNo.length() + 1;	//thePartyLineNo
	memSize += theOtherPartyLineNo.length() + 1;	//thePartyLineNo
	return memSize;
}

//Type_UState_ConferenceStart
SIPCCMsg_UState_ConferenceStart::SIPCCMsg_UState_ConferenceStart()
{
	msgType = Type_UState_ConferenceStart;
	firstName = "";
	firstLineNo = "";
	thirdName = "";
	conferenceType = -1;
	managerid="";

	gatewayName="";
	computerSymbol="";

}

void SIPCCMsg_UState_ConferenceStart::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_ConferenceStart";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//firstName
	firstName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstName.length()+1, msgsize, strMsg, "firstName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstName.length(), USERLINENO_LEN, strMsg, "firstName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	firstLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstLineNo.length()+1, msgsize, strMsg, "firstLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstLineNo.length(), USERLINENO_LEN, strMsg, "firstLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	thirdName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+thirdName.length()+1, msgsize, strMsg, "thirdName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(thirdName.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "conferenceType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	



	//managerid
	managerid = thebuf+theBufContent;	
	theBufContent += ( managerid.length() + 1 );

	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;

}

int SIPCCMsg_UState_ConferenceStart::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//firstName
	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1 );
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1 );
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	memcpy(thebuf+theBufContent, thirdName.c_str(), thirdName.length() + 1 );
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);

	 //managerid
	memcpy(thebuf+theBufContent, managerid .c_str(), managerid .length() + 1 );
	theBufContent += ( managerid .length() + 1 );


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_ConferenceStart::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += firstName.length() + 1;		//firstName
	memSize += firstLineNo.length() + 1;	//firstLineNo
	memSize += thirdName.length() + 1;		//thirdName
	memSize += sizeof(int);					//conferenceType
   memSize += managerid.length() + 1;		//managerid

   memSize += gatewayName.length()+1;			//gatewayName
   memSize += computerSymbol.length()+1;		//computerSymbol

	return memSize;
}

//Type_Client_ConferenceEnd
SIPCCMsg_Client_ConferenceEnd::SIPCCMsg_Client_ConferenceEnd()
{
	msgType = Type_Client_ConferenceEnd;
	firstName = "";
	firstLineNo = "";
	thirdName = "";
	conferenceType = -1;
	managerid="";

}

void SIPCCMsg_Client_ConferenceEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_Client_ConferenceEnd";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//firstName
	firstName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstName.length()+1, msgsize, strMsg, "firstName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstName.length(), USERLINENO_LEN, strMsg, "firstName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	firstLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstLineNo.length()+1, msgsize, strMsg, "firstLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstLineNo.length(), USERLINENO_LEN, strMsg, "firstLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	thirdName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+thirdName.length()+1, msgsize, strMsg, "thirdName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(thirdName.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "conferenceType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	
	//managerid
	managerid = thebuf+theBufContent;	
	theBufContent += ( managerid.length() + 1 );

}

int SIPCCMsg_Client_ConferenceEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//firstName
	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1 );
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1 );
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	memcpy(thebuf+theBufContent, thirdName.c_str(), thirdName.length() + 1 );
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);


	//managerid
	memcpy(thebuf+theBufContent, managerid .c_str(), managerid .length() + 1 );
	theBufContent += ( managerid .length() + 1 );

	return theBufContent;
}

int SIPCCMsg_Client_ConferenceEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += firstName.length() + 1;		//firstName
	memSize += firstLineNo.length() + 1;	//firstLineNo
	memSize += thirdName.length() + 1;		//thirdName
	memSize += sizeof(int);					//conferenceType
	memSize += managerid.length() + 1;		//managerid

	return memSize;
}

//Type_ACD_ConferenceEnd
SIPCCMsg_ACD_ConferenceEnd::SIPCCMsg_ACD_ConferenceEnd()
{
	msgType = Type_ACD_ConferenceEnd;
	firstName = "";
	firstLineNo = "";

}

void SIPCCMsg_ACD_ConferenceEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_ACD_ConferenceEnd";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//firstName
	firstName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstName.length()+1, msgsize, strMsg, "firstName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstName.length(), USERLINENO_LEN, strMsg, "firstName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	firstLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstLineNo.length()+1, msgsize, strMsg, "firstLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstLineNo.length(), USERLINENO_LEN, strMsg, "firstLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstLineNo.length() + 1 );	

}

int SIPCCMsg_ACD_ConferenceEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//firstName
	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1 );
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1 );
	theBufContent += ( firstLineNo.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_ACD_ConferenceEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += firstName.length() + 1;		//firstName
	memSize += firstLineNo.length() + 1;	//firstLineNo

	return memSize;
}

//Type_UState_ConferenceEnd
SIPCCMsg_UState_ConferenceEnd::SIPCCMsg_UState_ConferenceEnd()
{
	msgType = Type_UState_ConferenceEnd;
	firstName = "";
	firstLineNo = "";
	thirdName = "";
	conferenceType = -1;
	managerid="";

	gatewayName="";
	computerSymbol="";

}

void SIPCCMsg_UState_ConferenceEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_UState_ConferenceEnd";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//firstName
	firstName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstName.length()+1, msgsize, strMsg, "firstName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstName.length(), USERLINENO_LEN, strMsg, "firstName", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	firstLineNo = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+firstLineNo.length()+1, msgsize, strMsg, "firstLineNo.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(firstLineNo.length(), USERLINENO_LEN, strMsg, "firstLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	thirdName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+thirdName.length()+1, msgsize, strMsg, "thirdName.length()", ip, port, g_bIsACDServer)) ) {return;}
	if ( !(VerifyData(thirdName.length(), USERLINENO_LEN, strMsg, "userLineNo", ip, port, g_bIsACDServer)) ) {return;}
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "conferenceType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//managerid
	managerid = thebuf+theBufContent;	
	theBufContent += ( managerid.length() + 1 );


	if ( theBufContent >= msgsize)
	{
		return;
	}


	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent+= computerSymbol.length()+1;


}

int SIPCCMsg_UState_ConferenceEnd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//firstName
	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1 );
	theBufContent += ( firstName.length() + 1 );

	//firstLineNo
	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1 );
	theBufContent += ( firstLineNo.length() + 1 );

	//thirdName
	memcpy(thebuf+theBufContent, thirdName.c_str(), thirdName.length() + 1 );
	theBufContent += ( thirdName.length() + 1 );

	//conferenceType
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);

	 //managerid
	memcpy(thebuf+theBufContent, managerid .c_str(), managerid .length() + 1 );
	theBufContent += ( managerid .length() + 1 );


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	return theBufContent;
}

int SIPCCMsg_UState_ConferenceEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	memSize += firstName.length() + 1;		//firstName
	memSize += firstLineNo.length() + 1;	//firstLineNo
	memSize += thirdName.length() + 1;		//thirdName
	memSize += sizeof(int);					//conferenceType

	memSize += managerid.length() + 1;		//managerid

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol

	return memSize;
}
///
void SIPCCMsg_SysManage_GetServerList::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SysManage_GetServerList";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port, g_bIsACDServer)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	
	//ServerType
	if ( !(VerifyTotalLen(theBufContent+sizeof(int), msgsize, strMsg, "ServerType", ip, port, g_bIsACDServer)) ) {return;}
	memmove(&this->ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);	

}

int SIPCCMsg_SysManage_GetServerList::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	
	//ServerType
	memmove(thebuf+theBufContent, &this->ServerType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_SysManage_GetServerList::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype
	
	memSize += sizeof(int);					//serertype

	return memSize;
}
//////////////////////////////////////////////////////////////////////////////////
void SIPCCMsg_SysManage_GetServerListConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_SysManage_GetServerListConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+InvokeId.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(InvokeId.length(), GROUP_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += InvokeId.length()+1;

	size_t iSize = *(size_t*)(thebuf+theBufContent);
	theBufContent += sizeof(size_t);
	for (size_t i = 0; i < iSize; i++)
	{
		string sServerName = thebuf+theBufContent;
		theBufContent += sServerName.length() + 1;

		unsigned long iServerIp = *(unsigned long*)(thebuf+theBufContent);
		theBufContent += sizeof(unsigned long);

		unsigned short iServerPort = *(unsigned short*)(thebuf+theBufContent);
		theBufContent += sizeof(unsigned short);

		ServerList[sServerName] = make_pair(iServerIp, iServerPort);
	}
}

int SIPCCMsg_SysManage_GetServerListConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	*(size_t*)(thebuf+theBufContent) = ServerList.size();
	theBufContent += sizeof(size_t);
	for (map<string, pair<unsigned long, unsigned short> >::iterator it = ServerList.begin(); it != ServerList.end(); ++it)
	{
		memcpy(thebuf+theBufContent, it->first.c_str(), it->first.length()+1);
		theBufContent += it->first.length()+1;

		*(unsigned long*)(thebuf+theBufContent) = it->second.first;
		theBufContent += sizeof(unsigned long);

		*(unsigned short*)(thebuf+theBufContent) = it->second.second;
		theBufContent += sizeof(unsigned short);
	}

	return theBufContent;
}

int SIPCCMsg_SysManage_GetServerListConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

	memSize += sizeof(size_t);
	for (map<string, pair<unsigned long, unsigned short> >::iterator it = ServerList.begin(); it != ServerList.end(); ++it)
	{
		memSize += it->first.length()+1;
		memSize += sizeof(unsigned long);
		memSize += sizeof(unsigned short);
	}

	return memSize;
}
///////////////////////////////////////////////////////////////////////////////////////////////
//Type_OneKeySwitch_ServiceRegister
void SIPCCMsg_OneKeySwitch_HotAddService::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	ServerName = thebuf + theBufContent;	
	theBufContent += ServerName.length()+1;

	memmove(&ServerType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	


	memmove(&wanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&wanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(&lanIP, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&lanPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&ServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


}

int SIPCCMsg_OneKeySwitch_HotAddService::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;


	memmove(thebuf+theBufContent, &ServerType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &wanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &wanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);



	memmove(thebuf+theBufContent, &lanIP, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &lanPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &ServerID, sizeof(int));
	theBufContent += sizeof(int);
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_HotAddService::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += ServerName.length()+1;
	memSize += sizeof(int);
  	
	
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);


	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);//servier id

	return memSize;
}

void SIPCCMsg_CID_DialCmd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	TrunkGroupNum = thebuf + theBufContent;
	theBufContent += TrunkGroupNum.length()+1;

	CalleeNum = thebuf + theBufContent;
	theBufContent += CalleeNum.length()+1;

	CallerForSend = thebuf + theBufContent;
	theBufContent += CallerForSend.length()+1;

	ManagerId = thebuf + theBufContent;
	theBufContent += ManagerId.length()+1;

	UuiData_Task = thebuf + theBufContent;
	theBufContent += UuiData_Task.length()+1;

	UuiData_Phone = thebuf + theBufContent;
	theBufContent += UuiData_Phone.length()+1;

	OriginalCallee = thebuf + theBufContent;
	theBufContent += OriginalCallee.length()+1;
}

int SIPCCMsg_CID_DialCmd::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, TrunkGroupNum.c_str(), TrunkGroupNum.length() + 1);
	theBufContent += TrunkGroupNum.length() + 1;

	memcpy(thebuf+theBufContent, CalleeNum.c_str(), CalleeNum.length() + 1);
	theBufContent += CalleeNum.length() + 1;

	memcpy(thebuf+theBufContent, CallerForSend.c_str(), CallerForSend.length() + 1);
	theBufContent += CallerForSend.length() + 1;

	memcpy(thebuf+theBufContent, ManagerId.c_str(), ManagerId.length() + 1);
	theBufContent += ManagerId.length() + 1;

	memcpy(thebuf+theBufContent, UuiData_Task.c_str(), UuiData_Task.length() + 1);
	theBufContent += UuiData_Task.length() + 1;

	memcpy(thebuf+theBufContent, UuiData_Phone.c_str(), UuiData_Phone.length() + 1);
	theBufContent += UuiData_Phone.length() + 1;

	memcpy(thebuf+theBufContent, OriginalCallee.c_str(), OriginalCallee.length() + 1);
	theBufContent += OriginalCallee.length() + 1;

	return theBufContent;
}

int SIPCCMsg_CID_DialCmd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += TrunkGroupNum.length()+1;
	memSize += CalleeNum.length()+1;
	memSize += CallerForSend.length()+1;
	memSize += ManagerId.length()+1;
	memSize += UuiData_Task.length()+1;
	memSize += UuiData_Phone.length()+1;
	memSize += OriginalCallee.length()+1;
	return memSize;
}

void SIPCCMsg_CID_Result::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->TaskId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->PhoneId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	DialTime = thebuf + theBufContent;
	theBufContent += DialTime.length()+1;

	DialEndTime = thebuf + theBufContent;
	theBufContent += DialEndTime.length()+1;

	memmove(&this->IsDialSucc, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->DialFailCause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	TalkEndTime = thebuf + theBufContent;
	theBufContent += TalkEndTime.length()+1;

	memmove(&this->ExistKey, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	if (theBufContent >= msgsize)
	{
		return;
	}

	LogString = thebuf + theBufContent;
	theBufContent += LogString.length()+1;
}

int SIPCCMsg_CID_Result::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->TaskId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->PhoneId, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, DialTime.c_str(), DialTime.length() + 1);
	theBufContent += DialTime.length() + 1;

	memcpy(thebuf+theBufContent, DialEndTime.c_str(), DialEndTime.length() + 1);
	theBufContent += DialEndTime.length() + 1;

	memmove(thebuf+theBufContent, &this->IsDialSucc, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->DialFailCause, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, TalkEndTime.c_str(), TalkEndTime.length() + 1);
	theBufContent += TalkEndTime.length() + 1;

	memmove(thebuf+theBufContent, &this->ExistKey, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length() + 1);
	theBufContent += InvokeId.length() + 1;

	memcpy(thebuf+theBufContent, LogString.c_str(), LogString.length() + 1);
	theBufContent += LogString.length() + 1;

	return theBufContent;
}

int SIPCCMsg_CID_Result::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += DialTime.length()+1;
	memSize += DialEndTime.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += TalkEndTime.length()+1;
	memSize += sizeof(int);
	memSize += InvokeId.length()+1;
	memSize += LogString.length()+1;
	return memSize;
}
//////////////////////////////////////////////////////////////////////////////////////////////////////
//conference
//Type_Gateway_ConferenceStartConf
void SIPCCMsg_Gateway_ConferenceStartConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);




	firstName = thebuf + theBufContent;
	theBufContent += firstName.length()+1;

	firstLineNo = thebuf + theBufContent;
	theBufContent += firstLineNo.length()+1;


	thirdName = thebuf + theBufContent;
	theBufContent += thirdName.length()+1;
	

	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	managerid = thebuf + theBufContent;
	theBufContent += managerid.length()+1;

	memmove(&this->bSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	
	memmove(&this->firstConferencePort, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->secondConferencePort, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	firstPartyLineNo = thebuf + theBufContent;
	theBufContent += firstPartyLineNo.length()+1;

	secondPartyLineNo = thebuf + theBufContent;
	theBufContent += secondPartyLineNo.length()+1;
	
}

int SIPCCMsg_Gateway_ConferenceStartConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);




	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1);
	theBufContent += firstName.length() + 1;


	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1);
	theBufContent += firstLineNo.length() + 1;


	memcpy(thebuf+theBufContent, thirdName.c_str(), thirdName.length() + 1);
	theBufContent += thirdName.length() + 1;
    //
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;

	memmove(thebuf+theBufContent, &this->bSucc, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->firstConferencePort, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->secondConferencePort, sizeof(int));
	theBufContent += sizeof(int);
	


	memcpy(thebuf+theBufContent, firstPartyLineNo.c_str(), firstPartyLineNo.length() + 1);
	theBufContent += firstPartyLineNo.length() + 1;


	memcpy(thebuf+theBufContent, secondPartyLineNo.c_str(), secondPartyLineNo.length() + 1);
	theBufContent += secondPartyLineNo.length() + 1;

	return theBufContent;
}

int SIPCCMsg_Gateway_ConferenceStartConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += firstName.length()+1;
	memSize += firstLineNo.length()+1;
	memSize += thirdName.length()+1;	
	memSize += sizeof(int);
	memSize += managerid.length()+1;
	memSize += sizeof(char);	
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += firstPartyLineNo.length()+1;
	memSize += secondPartyLineNo.length()+1;

	return memSize;
}
//Type_ACD_ConferenceStartConf
void SIPCCMsg_ACD_ConferenceStartConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);




	firstName = thebuf + theBufContent;
	theBufContent += firstName.length()+1;

	firstLineNo = thebuf + theBufContent;
	theBufContent += firstLineNo.length()+1;


	thirdName = thebuf + theBufContent;
	theBufContent += thirdName.length()+1;
	

	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	managerid = thebuf + theBufContent;
	theBufContent += managerid.length()+1;

	memmove(&this->bSucc, thebuf+theBufContent, sizeof(char));
	theBufContent += sizeof(char);

	
	memmove(&this->ConferencePort, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	thePartyLineNo = thebuf + theBufContent;
	theBufContent += thePartyLineNo.length()+1;

	theOtherPartyLineNo = thebuf + theBufContent;
	theBufContent += theOtherPartyLineNo.length()+1;


}

int SIPCCMsg_ACD_ConferenceStartConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);




	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1);
	theBufContent += firstName.length() + 1;


	memcpy(thebuf+theBufContent, firstLineNo.c_str(), firstLineNo.length() + 1);
	theBufContent += firstLineNo.length() + 1;


	memcpy(thebuf+theBufContent, thirdName.c_str(), thirdName.length() + 1);
	theBufContent += thirdName.length() + 1;
    //
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;

	memmove(thebuf+theBufContent, &this->bSucc, sizeof(char));
	theBufContent += sizeof(char);

	memmove(thebuf+theBufContent, &this->ConferencePort, sizeof(int));
	theBufContent += sizeof(int);


	memcpy(thebuf+theBufContent, thePartyLineNo.c_str(), thePartyLineNo.length() + 1);
	theBufContent += thePartyLineNo.length() + 1;
	


	memcpy(thebuf+theBufContent, theOtherPartyLineNo.c_str(), theOtherPartyLineNo.length() + 1);
	theBufContent += theOtherPartyLineNo.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_ConferenceStartConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += firstName.length()+1;
	memSize += firstLineNo.length()+1;
	memSize += thirdName.length()+1;	
	memSize += sizeof(int);
	memSize += managerid.length()+1;
	memSize += sizeof(char);	
	memSize += sizeof(int);	
	memSize += thePartyLineNo.length()+1;

	memSize += theOtherPartyLineNo.length()+1;

	return memSize;
}

//Type_Gateway_UserLeaveConference
void SIPCCMsg_Gateway_UserLeaveConference::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);




	leaveUserName = thebuf + theBufContent;
	theBufContent += leaveUserName.length()+1;

	initiateAgentName = thebuf + theBufContent;
	theBufContent += initiateAgentName.length()+1;


	joinName = thebuf + theBufContent;
	theBufContent += joinName.length()+1;
	

	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	managerid = thebuf + theBufContent;
	theBufContent += managerid.length()+1;


}

int SIPCCMsg_Gateway_UserLeaveConference::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, leaveUserName.c_str(), leaveUserName.length() + 1);
	theBufContent += leaveUserName.length() + 1;


	memcpy(thebuf+theBufContent, initiateAgentName.c_str(), initiateAgentName.length() + 1);
	theBufContent += initiateAgentName.length() + 1;


	memcpy(thebuf+theBufContent, joinName.c_str(), joinName.length() + 1);
	theBufContent += joinName.length() + 1;
    //
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_Gateway_UserLeaveConference::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += leaveUserName.length()+1;
	memSize += initiateAgentName.length()+1;
	memSize += joinName.length()+1;	
	memSize += sizeof(int);
	memSize += managerid.length()+1;

	return memSize;
}
//Type_ACD_UserLeaveConference

void SIPCCMsg_ACD_UserLeaveConference::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	leaveUserName = thebuf + theBufContent;
	theBufContent += leaveUserName.length()+1;

	initiateAgentName = thebuf + theBufContent;
	theBufContent += initiateAgentName.length()+1;


	joinName = thebuf + theBufContent;
	theBufContent += joinName.length()+1;
	

	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	managerid = thebuf + theBufContent;
	theBufContent += managerid.length()+1;

}

int SIPCCMsg_ACD_UserLeaveConference::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, leaveUserName.c_str(), leaveUserName.length() + 1);
	theBufContent += leaveUserName.length() + 1;


	memcpy(thebuf+theBufContent, initiateAgentName.c_str(), initiateAgentName.length() + 1);
	theBufContent += initiateAgentName.length() + 1;


	memcpy(thebuf+theBufContent, joinName.c_str(), joinName.length() + 1);
	theBufContent += joinName.length() + 1;
    //
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;
	
	return theBufContent;
}

int SIPCCMsg_ACD_UserLeaveConference::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += leaveUserName.length()+1;
	memSize += initiateAgentName.length()+1;
	memSize += joinName.length()+1;	
	memSize += sizeof(int);
	memSize += managerid.length()+1;

	return memSize;
}
//Type_Record_StartConferenceRecord

void SIPCCMsg_Record_StartConferenceRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	CTID = thebuf + theBufContent;
	theBufContent += CTID.length()+1;

	conferenceRoomID = thebuf + theBufContent;
	theBufContent += conferenceRoomID.length()+1;


	
	memmove(&this->conferenceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	firstName = thebuf + theBufContent;
	theBufContent += firstName.length()+1;

	firstNickname = thebuf + theBufContent;
	theBufContent += firstNickname.length()+1;


	secondName = thebuf + theBufContent;
	theBufContent += secondName.length()+1;

	secondNickname = thebuf + theBufContent;
	theBufContent += secondNickname.length()+1;


	thirdName = thebuf + theBufContent;
	theBufContent += thirdName.length()+1;

	thirdNickname = thebuf + theBufContent;
	theBufContent += thirdNickname.length()+1;


	memmove(&this->conferenceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	managerid = thebuf + theBufContent;
	theBufContent += managerid.length()+1;

	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	recordFilePath = thebuf + theBufContent;
	theBufContent += recordFilePath.length()+1;

	beginTime = thebuf + theBufContent;
	theBufContent += beginTime.length()+1;

}

int SIPCCMsg_Record_StartConferenceRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, CTID.c_str(), CTID.length() + 1);
	theBufContent += CTID.length() + 1;


	memcpy(thebuf+theBufContent, conferenceRoomID.c_str(), conferenceRoomID.length() + 1);
	theBufContent += conferenceRoomID.length() + 1;


    memmove(thebuf+theBufContent, &this->conferenceID, sizeof(int));
	theBufContent += sizeof(int);

   //
	memcpy(thebuf+theBufContent, firstName.c_str(), firstName.length() + 1);
	theBufContent += firstName.length() + 1;

	memcpy(thebuf+theBufContent, firstNickname.c_str(), firstNickname.length() + 1);
	theBufContent += firstNickname.length() + 1;
	//

    memcpy(thebuf+theBufContent, secondName.c_str(), secondName.length() + 1);
	theBufContent += secondName.length() + 1;

	memcpy(thebuf+theBufContent, secondNickname.c_str(), secondNickname.length() + 1);
	theBufContent += secondNickname.length() + 1;
    //


	memcpy(thebuf+theBufContent, thirdName.c_str(), thirdName.length() + 1);
	theBufContent += thirdName.length() + 1;

	memcpy(thebuf+theBufContent, thirdNickname.c_str(), thirdNickname.length() + 1);
	theBufContent += thirdNickname.length() + 1;


    //
	memmove(thebuf+theBufContent, &this->conferenceType, sizeof(int));
	theBufContent += sizeof(int);


    //
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1);
	theBufContent += managerid.length() + 1;

///
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length() + 1);
	theBufContent += corpName.length() + 1;

	memcpy(thebuf+theBufContent, recordFilePath.c_str(), recordFilePath.length() + 1);
	theBufContent += recordFilePath.length() + 1;
	
//
	memcpy(thebuf+theBufContent, beginTime.c_str(), beginTime.length() + 1);
	theBufContent += beginTime.length() + 1;
	return theBufContent;
}

int SIPCCMsg_Record_StartConferenceRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += CTID.length()+1;
	memSize += conferenceRoomID.length()+1;
	memSize += sizeof(int);
	memSize += firstName.length()+1;
	memSize += firstNickname.length()+1;
	memSize += secondName.length()+1;
	memSize += secondNickname.length()+1;
	memSize += thirdName.length()+1;
	memSize += thirdNickname.length()+1;
	memSize += sizeof(int);
	memSize += managerid.length()+1;
	memSize += corpName.length()+1;//
	memSize += recordFilePath.length()+1;//recordFilePath
	memSize += beginTime.length()+1;//beginTime

	return memSize;
}

//Type_Record_StopConferenceRecord

void SIPCCMsg_Record_StopConferenceRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	CTID = thebuf + theBufContent;
	theBufContent += CTID.length()+1;

	conferenceRoomID = thebuf + theBufContent;
	theBufContent += conferenceRoomID.length()+1;

	
	memmove(&this->conferenceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_Record_StopConferenceRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);


	memcpy(thebuf+theBufContent, CTID.c_str(), CTID.length() + 1);
	theBufContent += CTID.length() + 1;


	memcpy(thebuf+theBufContent, conferenceRoomID.c_str(), conferenceRoomID.length() + 1);
	theBufContent += conferenceRoomID.length() + 1;


    memmove(thebuf+theBufContent, &this->conferenceID, sizeof(int));
	theBufContent += sizeof(int);

  


	
	return theBufContent;
}

int SIPCCMsg_Record_StopConferenceRecord::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += CTID.length()+1;
	memSize += conferenceRoomID.length()+1;
	memSize += sizeof(int);
	
	return memSize;
}

//Type_OneKeySwitch_GWLogOutConf
SIPCCMsg_OneKeySwitch_GWLogOutConf::SIPCCMsg_OneKeySwitch_GWLogOutConf()
{
	msgType = Type_OneKeySwitch_GWLogOutConf;

	GwName = "";
	ComputerSymbol = "";
	ServerName = "";
    	
	 ServiceType=0;
	 ServiceID=0;

}

void SIPCCMsg_OneKeySwitch_GWLogOutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsg = "SIPCCMsg_OneKeySwitch_GWLogOutConf";
	if ( !(VerifyTotalLen(HEAD_LEN, msgsize, strMsg, "MsgHead", ip, port)) ) {return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//GwName
	GwName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+GwName.length()+1, msgsize, strMsg, "GwName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(GwName.length(), GWNAME_LEN, strMsg, "GwName", ip, port)) ) {return;}
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ComputerSymbol.length()+1, msgsize, strMsg, "ComputerSymbol.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ComputerSymbol.length(), COMSYMBOL_LEN, strMsg, "ComputerSymbol", ip, port)) ) {return;}
	theBufContent += ComputerSymbol.length()+1;

	if(theBufContent == msgsize)
		return;

	//ServerName
	ServerName = thebuf + theBufContent;
	if ( !(VerifyTotalLen(theBufContent+ServerName.length()+1, msgsize, strMsg, "ServerName.length()", ip, port)) ) {return;}
	if ( !(VerifyData(ServerName.length(), GWNAME_LEN, strMsg, "ServerName", ip, port)) ) {return;}
	theBufContent += ServerName.length()+1;

	memmove(&ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OneKeySwitch_GWLogOutConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//ServerName
	memcpy(thebuf+theBufContent, ServerName.c_str(), ServerName.length()+1);
	theBufContent += ServerName.length()+1;

	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);


	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GWLogOutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += GwName.length()+1;			//GwName
	memSize += ComputerSymbol.length()+1;	//ComputerSymbol
	memSize += ServerName.length()+1;		//ServerName


	memSize += sizeof(int);//                servertype	
	memSize += sizeof(int);//               ServiceID;
	return memSize;
}

void SIPCCMsg_CID_CheckAlive::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&Id, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&GwCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&GwIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&GwPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&SendTime, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_CID_CheckAlive::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->Id, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->GwCode, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->GwIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->GwPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->SendTime, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	return theBufContent;
}

int SIPCCMsg_CID_CheckAlive::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);

	return memSize;
}

void SIPCCMsg_CID_CheckAliveConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&Id, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&CenterIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&CenterPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&GwCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&GwIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&GwPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(&SendTime, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);
}

int SIPCCMsg_CID_CheckAliveConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->Id, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CenterIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->CenterPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->GwCode, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->GwIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->GwPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	memmove(thebuf+theBufContent, &this->SendTime, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	return theBufContent;
}

int SIPCCMsg_CID_CheckAliveConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(unsigned long);
	return memSize;
}
///
void SIPCCMsg_OneKeySwitch_SwitchService_Ctrl::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	ManagerId = thebuf + theBufContent;	
	theBufContent += ManagerId.length()+1;

	
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// 
	

	memmove(&this->ServiceID_Old, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	memmove(&this->ServiceID_New, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&this->ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize)
	{
		return;
	}
	//gatewayName
	gatewayName = thebuf + theBufContent;
	theBufContent += gatewayName.length()+1;
	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent += computerSymbol.length()+1;

	

}

int SIPCCMsg_OneKeySwitch_SwitchService_Ctrl::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	memcpy(thebuf+theBufContent, ManagerId.c_str(), ManagerId.length()+1);
	theBufContent += ManagerId.length()+1;



	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->ServiceID_Old, sizeof(int));
	theBufContent += sizeof(int);


	memmove(thebuf+theBufContent, &this->ServiceID_New, sizeof(int));
	theBufContent += sizeof(int);

	//
	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);


	//gatewayName
	memcpy(thebuf+theBufContent, gatewayName.c_str(), gatewayName.length()+1);
	theBufContent += gatewayName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;


	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchService_Ctrl::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	memSize += ManagerId.length()+1;
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += gatewayName.length()+1;			//gatewayName
	memSize += computerSymbol.length()+1;		//computerSymbol


	return memSize;
}

//
///
void SIPCCMsg_OneKeySwitch_SwitchService_CtrlConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{		
	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	

}

int SIPCCMsg_OneKeySwitch_SwitchService_CtrlConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchService_CtrlConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	

	return memSize;
}
///
void SIPCCMsg_OneKeySwitch_SwitchService::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	
	int theBufContent = AnalyzeMsgHead(thebuf);

	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;


	
	memmove(&this->ServerIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	
	memmove(&this->ServerPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	// 
	

	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	

	memmove(&this->ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	

}

int SIPCCMsg_OneKeySwitch_SwitchService::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;




	memmove(thebuf+theBufContent, &this->ServerIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->ServerPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);


	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);


	//
	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);




	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchService::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	

	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);
	
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}


//
///
void SIPCCMsg_OneKeySwitch_SwitchServiceConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{		
	int theBufContent = AnalyzeMsgHead(thebuf);
	InvokeId = thebuf + theBufContent;	
	theBufContent += InvokeId.length()+1;

	

}

int SIPCCMsg_OneKeySwitch_SwitchServiceConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SwitchServiceConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;	
	return memSize;
}
///
void SIPCCMsg_Gateway_SubscribeTGStatus::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	

	memmove(&this->ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	

}

int SIPCCMsg_Gateway_SubscribeTGStatus::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	
	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	//
	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Gateway_SubscribeTGStatus::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);//ServiceID
	memSize += sizeof(int);//ServiceType

	return memSize;
}
///
void SIPCCMsg_TrunkData_NotifyTGStatus::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	
	int theBufContent = AnalyzeMsgHead(thebuf);

	ComputerSymbol = thebuf + theBufContent;
	theBufContent += ComputerSymbol.length()+1;

	GwName = thebuf + theBufContent;
	theBufContent += GwName.length()+1;

	
	memmove(&this->MappingName, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	
	

	memmove(&this->Occupancy, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	

}

int SIPCCMsg_TrunkData_NotifyTGStatus::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

    memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;
	

	memmove(thebuf+theBufContent, &this->MappingName, sizeof(int));
	theBufContent += sizeof(int);


	//
	memmove(thebuf+theBufContent, &this->Occupancy, sizeof(int));
	theBufContent += sizeof(int);


	return theBufContent;
}

int SIPCCMsg_TrunkData_NotifyTGStatus::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += ComputerSymbol.length()+1;
	memSize += GwName.length()+1;

	memSize += sizeof(int);
	memSize += sizeof(int);

	return memSize;
}
//
///Type_SysManage_AddDeptTGRoute
void SIPCCMsg_SysManage_AddDeptTGRoute::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddDeptTGRoute";
	
	int theBufContent = AnalyzeMsgHead(thebuf);

	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	deptName = thebuf + theBufContent;
	theBufContent += deptName.length()+1;

	
	deptAreaCode = thebuf + theBufContent;
	theBufContent += deptAreaCode.length()+1;

	tgName = thebuf + theBufContent;
	theBufContent += tgName.length()+1;


		
	memmove(&this->CMLocalLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	

	memmove(&this->CMLongLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&this->CULocalLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	

	memmove(&this->CULongLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&this->CTLocalLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	memmove(&this->CTLongLevel, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if(theBufContent == msgsize)
		return;

	//gwName
	gwName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+tgName.length()+1, msgsize, strMsgName, "gwName", ip, port)) ) {return;}
	if ( !(VerifyData(gwName.length(), GWNAME_LEN, strMsgName, "gwName", ip, port)) ) {return;}
	theBufContent += (gwName.length()+1);

	//computerSymbol
	computerSymbol = thebuf+theBufContent;	
	theBufContent += (computerSymbol.length()+1);

	mappingName = thebuf+theBufContent;
	if ( !(VerifyTotalLen(theBufContent+mappingName.length()+1, msgsize, strMsgName, "mappingName", ip, port)) ) {return;}
	if ( !(VerifyData(mappingName.length(), MAPPINGNAME_LEN, strMsgName, "mappingName", ip, port)) ) {return;}
	theBufContent += (mappingName.length()+1);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_AddDeptTGRoute::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;


	 memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;

     memcpy(thebuf+theBufContent, deptAreaCode.c_str(), deptAreaCode.length()+1);
	theBufContent += deptAreaCode.length()+1;

	 memcpy(thebuf+theBufContent, tgName.c_str(), tgName.length()+1);
	theBufContent += tgName.length()+1;

	memmove(thebuf+theBufContent, &this->CMLocalLevel, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CMLongLevel, sizeof(int));
	theBufContent += sizeof(int);

    //
	memmove(thebuf+theBufContent, &this->CULocalLevel, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CULongLevel, sizeof(int));
	theBufContent += sizeof(int);

	 //
	memmove(thebuf+theBufContent, &this->CTLocalLevel, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->CTLongLevel, sizeof(int));
	theBufContent += sizeof(int);

	//gwName
	memmove(thebuf+theBufContent, this->gwName.c_str(), gwName.length()+1);
	theBufContent += (gwName.length()+1);

	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length() + 1 );
	theBufContent += ( computerSymbol.length() + 1 );

	memcpy(thebuf+theBufContent, mappingName.c_str(), mappingName.length() + 1 );
	theBufContent += ( mappingName.length() + 1 );

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddDeptTGRoute::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += corpName.length()+1;
	memSize += deptName.length()+1;

	memSize += deptAreaCode.length()+1;
	memSize += tgName.length()+1;

	memSize += sizeof(int);//CMLocalLevel
	memSize += sizeof(int);//CMLongLevel
	memSize += sizeof(int);//CULocalLevel
	memSize += sizeof(int);//CULongLevel
	memSize += sizeof(int);//CTLocalLevel
	memSize += sizeof(int);//CTLongLevel

	memSize += (gwName.length()+1);		//gwName
	memSize += (computerSymbol.length()+1);		//computerSymbol
	memSize += (mappingName.length()+1);	//mappingName

	memSize += invokeID.length()+1;			//invokeID

	return memSize;
}

///Type_SysManage_DelDeptTGRoute
void SIPCCMsg_SysManage_DelDeptTGRoute::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddDeptTGRoute";

	int theBufContent = AnalyzeMsgHead(thebuf);

	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	deptName = thebuf + theBufContent;
	theBufContent += deptName.length()+1;

	operators = thebuf + theBufContent;
	theBufContent += operators.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_DelDeptTGRoute::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;

	memcpy(thebuf+theBufContent, operators.c_str(), operators.length()+1);
	theBufContent += operators.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_DelDeptTGRoute::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += corpName.length()+1;
	memSize += deptName.length()+1;
	memSize += operators.length()+1;

	memSize += invokeID.length()+1;			//invokeID

	return memSize;
}

///Type_Gateway_UnAnsweredCall
void SIPCCMsg_UnAnsweredAgentCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_UnAnsweredAgentCall";

	int theBufContent = AnalyzeMsgHead(thebuf);

	manageId = thebuf + theBufContent;
	theBufContent += manageId.length()+1;

	Keyword = thebuf + theBufContent;
	theBufContent += Keyword.length()+1;

	ExtNo = thebuf + theBufContent;
	theBufContent += ExtNo.length()+1;

	CustomerNo = thebuf + theBufContent;
	theBufContent += CustomerNo.length()+1;

	calledNo = thebuf + theBufContent;
	theBufContent += calledNo.length()+1;

	TransBeginTime = thebuf + theBufContent;
	theBufContent += TransBeginTime.length()+1;


	hangupTime = thebuf + theBufContent;
	theBufContent += hangupTime.length()+1;


	memmove(&ErrorType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;

	memmove(&CallType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_UnAnsweredAgentCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, manageId.c_str(), manageId.length()+1);//manageId
	theBufContent += manageId.length()+1;

	memcpy(thebuf+theBufContent, Keyword.c_str(), Keyword.length()+1);//Keyword
	theBufContent += Keyword.length()+1;

	memcpy(thebuf+theBufContent, ExtNo.c_str(), ExtNo.length()+1);//ExtNo
	theBufContent += ExtNo.length()+1;


	memcpy(thebuf+theBufContent, CustomerNo.c_str(), CustomerNo.length()+1);//CustomerNo
	theBufContent += CustomerNo.length()+1;


	memcpy(thebuf+theBufContent, calledNo.c_str(), calledNo.length()+1);//calledNo
	theBufContent += calledNo.length()+1;

	memcpy(thebuf+theBufContent, TransBeginTime.c_str(), TransBeginTime.length()+1);//TransBeginTime
	theBufContent += TransBeginTime.length()+1;


	memcpy(thebuf+theBufContent, hangupTime.c_str(), hangupTime.length()+1);//hangupTime
	theBufContent += hangupTime.length()+1;


	memmove(thebuf+theBufContent, &ErrorType, sizeof(int));//ErrorType
	theBufContent += sizeof(int);


	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);//invokeId
	theBufContent += invokeId.length()+1;

	memmove(thebuf+theBufContent, &CallType, sizeof(int));//CallType
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_UnAnsweredAgentCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += manageId.length()+1;     //manageId
	memSize += Keyword.length()+1;      //Keyword
	memSize += ExtNo.length()+1;        //ExtNo
	memSize += CustomerNo.length()+1;   //CustomerNo
	memSize += calledNo.length()+1;     //calledNo
	memSize += TransBeginTime.length()+1;//TransBeginTime
	memSize += hangupTime.length()+1;    //hangupTime
	memSize +=sizeof(int);               //ErrorType
	memSize += invokeId.length()+1;      //invokeId
	memSize +=sizeof(int);               //CallType

	return memSize;
}

SIPCCMsg_DataTrans_SwitchPort::SIPCCMsg_DataTrans_SwitchPort()
{
	msgType = Type_DataTrans_SwitchPort;

	channelIndex = -1;
}

void SIPCCMsg_DataTrans_SwitchPort::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->channelIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_DataTrans_SwitchPort::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->channelIndex, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_DataTrans_SwitchPort::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);

	return memSize;
}

SIPCCMsg_DataTrans_SwitchPortConf::SIPCCMsg_DataTrans_SwitchPortConf()
{
	msgType = Type_DataTrans_SwitchPortConf;

	ResultCode = 0;
}

void SIPCCMsg_DataTrans_SwitchPortConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->ResultCode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_DataTrans_SwitchPortConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->ResultCode, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_DataTrans_SwitchPortConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);

	return memSize;
}

//Type_SysManage_AddGWIADG
SIPCCMsg_SysManage_AddGWIADG::SIPCCMsg_SysManage_AddGWIADG()
{
	msgType = Type_SysManage_AddGWIADG;
	IADGName="";
	IADGAreaCode="";
	gwName="";
	corpName="";
	mappingName="";

	invokeID = "";
}

void SIPCCMsg_SysManage_AddGWIADG::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddGWIADG";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//IADGName
	IADGName = thebuf + theBufContent;
	theBufContent += IADGName.length()+1;

	//IADGAreaCode
	IADGAreaCode = thebuf + theBufContent;
	theBufContent += IADGAreaCode.length()+1;

	//gwName
	gwName = thebuf + theBufContent;
	theBufContent += gwName.length()+1;

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	//mappingName
	mappingName = thebuf + theBufContent;
	theBufContent += mappingName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_AddGWIADG::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//IADGName
	memcpy(thebuf+theBufContent, IADGName.c_str(), IADGName.length()+1);
	theBufContent += IADGName.length()+1;

	//IADGAreaCode
	memcpy(thebuf+theBufContent, IADGAreaCode.c_str(), IADGAreaCode.length()+1);
	theBufContent += IADGAreaCode.length()+1;

	//gwName
	memcpy(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += gwName.length()+1;

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//mappingName
	memcpy(thebuf+theBufContent, mappingName.c_str(), mappingName.length()+1);
	theBufContent += mappingName.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddGWIADG::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += IADGName.length()+1;		//IADGName
	memSize += IADGAreaCode.length()+1;	//IADGAreaCode
	memSize += gwName.length()+1;		//gwName
	memSize += corpName.length()+1;		//corpName
	memSize += mappingName.length()+1;	//mappingName

	memSize += invokeID.length()+1;		//invokeID

	return memSize;
}

//Type_SysManage_DelGWIADG
SIPCCMsg_SysManage_DelGWIADG::SIPCCMsg_SysManage_DelGWIADG()
{
	msgType = Type_SysManage_DelGWIADG;
	
	IADGName="";
	corpName="";

	invokeID = "";
}

void SIPCCMsg_SysManage_DelGWIADG::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_DelGWIADG";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//IADGName
	IADGName = thebuf + theBufContent;
	theBufContent += IADGName.length()+1;

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_DelGWIADG::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//IADGName
	memcpy(thebuf+theBufContent, IADGName.c_str(), IADGName.length()+1);
	theBufContent += IADGName.length()+1;

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_DelGWIADG::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += IADGName.length()+1;		//IADGName
	memSize += corpName.length()+1;		//corpName

	memSize += invokeID.length()+1;		//invokeID

	return memSize;
}

//Type_SysManage_AddIAD
SIPCCMsg_SysManage_AddIAD::SIPCCMsg_SysManage_AddIAD()
{
	msgType = Type_SysManage_AddIAD;

	IADGName="";
	IADName="";
	corpName="";

	invokeID = "";
}

void SIPCCMsg_SysManage_AddIAD::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddIAD";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//IADGName
	IADGName = thebuf + theBufContent;
	theBufContent += IADGName.length()+1;

	//IADName
	IADName = thebuf + theBufContent;
	theBufContent += IADName.length()+1;

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_AddIAD::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//IADGName
	memcpy(thebuf+theBufContent, IADGName.c_str(), IADGName.length()+1);
	theBufContent += IADGName.length()+1;

	//IADName
	memcpy(thebuf+theBufContent, IADName.c_str(), IADName.length()+1);
	theBufContent += IADName.length()+1;

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddIAD::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += IADGName.length()+1;		//IADGName
	memSize += IADName.length()+1;		//IADName
	memSize += corpName.length()+1;		//corpName

	memSize += invokeID.length()+1;			//invokeID

	return memSize;
}

//Type_SysManage_DelIAD
SIPCCMsg_SysManage_DelIAD::SIPCCMsg_SysManage_DelIAD()
{
	msgType = Type_SysManage_DelIAD;

	IADGName="";
	IADName="";
	corpName="";

	invokeID = "";
}

void SIPCCMsg_SysManage_DelIAD::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_DelIAD";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//IADGName
	IADGName = thebuf + theBufContent;
	theBufContent += IADGName.length()+1;

	//IADName
	IADName = thebuf + theBufContent;
	theBufContent += IADName.length()+1;

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_DelIAD::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//IADGName
	memcpy(thebuf+theBufContent, IADGName.c_str(), IADGName.length()+1);
	theBufContent += IADGName.length()+1;

	//IADName
	memcpy(thebuf+theBufContent, IADName.c_str(), IADName.length()+1);
	theBufContent += IADName.length()+1;

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_DelIAD::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += IADGName.length()+1;		//IADGName
	memSize += IADName.length()+1;		//IADName
	memSize += corpName.length()+1;		//corpName

	memSize += invokeID.length()+1;		//invokeID

	return memSize;
}
//Type_OneKeySwitch_SynchronizationTimeout
SIPCCMsg_OneKeySwitch_SynchronizationTimeout::SIPCCMsg_OneKeySwitch_SynchronizationTimeout()
{
	msgType = Type_OneKeySwitch_SynchronizationTimeout;

	InvokeId="";
	ServiceID=0;
	GwName="";
	ComputerSymbol="";
	ServiceType=0;
}

void SIPCCMsg_OneKeySwitch_SynchronizationTimeout::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_SynchronizationTimeout";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//InvokeId
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;

	//ServiceID
	memmove(&this->ServiceID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//GwName
	GwName = thebuf + theBufContent;
	theBufContent += GwName.length()+1;
	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	theBufContent += ComputerSymbol.length()+1;

	//ServiceType
	memmove(&this->ServiceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OneKeySwitch_SynchronizationTimeout::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	//ServiceID
	memmove(thebuf+theBufContent, &this->ServiceID, sizeof(int));
	theBufContent += sizeof(int);

	//GwName
	memcpy(thebuf+theBufContent, GwName.c_str(), GwName.length()+1);
	theBufContent += GwName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//ServiceType
	memmove(thebuf+theBufContent, &this->ServiceType, sizeof(int));
	theBufContent += sizeof(int);
	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SynchronizationTimeout::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;		//InvokeId
	memSize += sizeof(int);		//ServiceID
	memSize += GwName.length()+1;		//GwName
	memSize += ComputerSymbol.length()+1;		//ComputerSymbol
	memSize += sizeof(int);		//ServiceType


	return memSize;
}



////Type_OneKeySwitch_SynchronizationTimeoutConf
SIPCCMsg_OneKeySwitch_SynchronizationTimeoutConf::SIPCCMsg_OneKeySwitch_SynchronizationTimeoutConf()
{
	msgType = Type_OneKeySwitch_SynchronizationTimeoutConf;

	InvokeId="";
    bTimeout=0;
}

void SIPCCMsg_OneKeySwitch_SynchronizationTimeoutConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_SynchronizationTimeoutConf";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//InvokeId
	InvokeId = thebuf + theBufContent;
	theBufContent += InvokeId.length()+1;
    //bTimeout
	memmove(&this->bTimeout, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OneKeySwitch_SynchronizationTimeoutConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//InvokeId
	memcpy(thebuf+theBufContent, InvokeId.c_str(), InvokeId.length()+1);
	theBufContent += InvokeId.length()+1;

	//bTimeout
	memmove(thebuf+theBufContent, &this->bTimeout, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SynchronizationTimeoutConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += InvokeId.length()+1;		//InvokeId
	memSize += sizeof(int);		//bTimeout

	return memSize;
}

//Type_SysManage_AddSkillGroup
SIPCCMsg_SysManage_AddSkillGroup::SIPCCMsg_SysManage_AddSkillGroup()
{
	msgType = Type_SysManage_AddSkillGroup;

	managerid="";
	SGId="";
	SGName="";
	invokeID="";
	generalConfiguration="";
}

void SIPCCMsg_SysManage_AddSkillGroup::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddSkillGroup";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//managerid
	managerid = thebuf + theBufContent;
	theBufContent += managerid.length()+1;

	//SGId
	SGId = thebuf + theBufContent;
	theBufContent += SGId.length()+1;

	//SGName
	SGName = thebuf + theBufContent;
	theBufContent += SGName.length()+1;

	//invokeID
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;

	if(theBufContent >= msgsize)
	{
		return;
	}
	//generalConfiguration
	generalConfiguration = thebuf + theBufContent;
	theBufContent += generalConfiguration.length()+1;

}

int SIPCCMsg_SysManage_AddSkillGroup::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//managerid
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length()+1);
	theBufContent += managerid.length()+1;

	//SGId
	memcpy(thebuf+theBufContent, SGId.c_str(), SGId.length()+1);
	theBufContent += SGId.length()+1;

	//SGName
	memcpy(thebuf+theBufContent, SGName.c_str(), SGName.length()+1);
	theBufContent += SGName.length()+1;

	//invokeID
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;


	
	//generalConfiguration
	memcpy(thebuf+theBufContent, invokeID.c_str(), generalConfiguration.length()+1);
	theBufContent += generalConfiguration.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddSkillGroup::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += managerid.length()+1;	//managerid
	memSize += SGId.length()+1;			//SGId
	memSize += SGName.length()+1;		//SGName
	memSize += invokeID.length()+1;		//invokeID
	memSize += generalConfiguration.length()+1;		//generalConfiguration

	return memSize;
}

//Type_SysManage_DelSkillGroup
SIPCCMsg_SysManage_DelSkillGroup::SIPCCMsg_SysManage_DelSkillGroup()
{
	msgType = Type_SysManage_DelSkillGroup;

	SGId="";
	SGName="";
	invokeID="";
}

void SIPCCMsg_SysManage_DelSkillGroup::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_DelSkillGroup";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//SGId
	SGId = thebuf + theBufContent;
	theBufContent += SGId.length()+1;

	//SGName
	SGName = thebuf + theBufContent;
	theBufContent += SGName.length()+1;

	//invokeID
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;

}

int SIPCCMsg_SysManage_DelSkillGroup::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//SGId
	memcpy(thebuf+theBufContent, SGId.c_str(), SGId.length()+1);
	theBufContent += SGId.length()+1;

	//SGName
	memcpy(thebuf+theBufContent, SGName.c_str(), SGName.length()+1);
	theBufContent += SGName.length()+1;

	//invokeID
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_DelSkillGroup::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += SGId.length()+1;			//SGId
	memSize += SGName.length()+1;		//SGName
	memSize += invokeID.length()+1;		//invokeID

	return memSize;
}
//Type_OneKeySwitch_SyncHeatBeatRelation
SIPCCMsg_OneKeySwitch_SyncHeatBeatRelation::SIPCCMsg_OneKeySwitch_SyncHeatBeatRelation()
{
	msgType = Type_OneKeySwitch_SyncHeatBeatRelation;

	serverid=0;
	servertype=0;
	GatewayName="";
	ComputerSymbol="";
	HeatBeatID1=0;
	HeatBeatID2=0;
	Type=0;
}

void SIPCCMsg_OneKeySwitch_SyncHeatBeatRelation::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_SyncHeatBeatRelation";

	int theBufContent = AnalyzeMsgHead(thebuf);


   //serverid
	memmove(&this->serverid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


    //servertype
	memmove(&this->servertype, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//GatewayName
	GatewayName = thebuf + theBufContent;
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	theBufContent += ComputerSymbol.length()+1;



	//HeatBeatID1
	memmove(&this->HeatBeatID1, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//HeatBeatID2
	memmove(&this->HeatBeatID2, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//Type
	memmove(&this->Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	

}

int SIPCCMsg_OneKeySwitch_SyncHeatBeatRelation::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);



	//serverid
	memmove(thebuf+theBufContent, &this->serverid, sizeof(int));
	theBufContent += sizeof(int);


	//servertype
	memmove(thebuf+theBufContent, &this->servertype, sizeof(int));
	theBufContent += sizeof(int);
	//GatewayName
	memcpy(thebuf+theBufContent, GatewayName.c_str(), GatewayName.length()+1);
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//HeatBeatID1
	memmove(thebuf+theBufContent, &this->HeatBeatID1, sizeof(int));
	theBufContent += sizeof(int);
	//HeatBeatID2
	memmove(thebuf+theBufContent, &this->HeatBeatID2, sizeof(int));
	theBufContent += sizeof(int);
	//Type
	memmove(thebuf+theBufContent, &this->Type, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SyncHeatBeatRelation::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype


	memSize += sizeof(int);		//serverid
	memSize += sizeof(int);		//servertype
	memSize += GatewayName.length()+1;		//GatewayName
	memSize += ComputerSymbol.length()+1;		//ComputerSymbol
	
	memSize += sizeof(int);	    //HeatBeatID1
	memSize += sizeof(int);    //HeatBeatID2
	memSize += sizeof(int);		//Type

	return memSize;
}
///////////
//Type_OneKeySwitch_SyncHeatBeatRelationConfirm
SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirm::SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirm()
{
	msgType = Type_OneKeySwitch_SyncHeatBeatRelationConfirm;
	serverid=0;
	servertype=0;
	
}

void SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirm::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirm";

	int theBufContent = AnalyzeMsgHead(thebuf);


	//serverid
	memmove(&this->serverid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//servertype
	memmove(&this->servertype, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirm::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);



	//serverid
	memmove(thebuf+theBufContent, &this->serverid, sizeof(int));
	theBufContent += sizeof(int);


	//servertype
	memmove(thebuf+theBufContent, &this->servertype, sizeof(int));
	theBufContent += sizeof(int);
	

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirm::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype


	memSize += sizeof(int);		//serverid
	memSize += sizeof(int);		//servertype	

	return memSize;
}

//Type_OneKeySwitch_SyncHeatBeatRelationConfirmconf
SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirmconf::SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirmconf()
{
	msgType = Type_OneKeySwitch_SyncHeatBeatRelationConfirmconf;

	serverid=0;
	servertype=0;
	GatewayName="";
	ComputerSymbol="";
	HeatBeatID1=0;
	HeatBeatID2=0;
	Type=0;
}

void SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirmconf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirmconf";

	int theBufContent = AnalyzeMsgHead(thebuf);


	//serverid
	memmove(&this->serverid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//servertype
	memmove(&this->servertype, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//GatewayName
	GatewayName = thebuf + theBufContent;
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	theBufContent += ComputerSymbol.length()+1;



	//HeatBeatID1
	memmove(&this->HeatBeatID1, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//HeatBeatID2
	memmove(&this->HeatBeatID2, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//Type
	memmove(&this->Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);



}

int SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirmconf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);



	//serverid
	memmove(thebuf+theBufContent, &this->serverid, sizeof(int));
	theBufContent += sizeof(int);


	//servertype
	memmove(thebuf+theBufContent, &this->servertype, sizeof(int));
	theBufContent += sizeof(int);
	//GatewayName
	memcpy(thebuf+theBufContent, GatewayName.c_str(), GatewayName.length()+1);
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//HeatBeatID1
	memmove(thebuf+theBufContent, &this->HeatBeatID1, sizeof(int));
	theBufContent += sizeof(int);
	//HeatBeatID2
	memmove(thebuf+theBufContent, &this->HeatBeatID2, sizeof(int));
	theBufContent += sizeof(int);
	//Type
	memmove(thebuf+theBufContent, &this->Type, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_SyncHeatBeatRelationConfirmconf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype


	memSize += sizeof(int);		//serverid
	memSize += sizeof(int);		//servertype
	memSize += GatewayName.length()+1;		//GatewayName
	memSize += ComputerSymbol.length()+1;		//ComputerSymbol

	memSize += sizeof(int);	    //HeatBeatID1
	memSize += sizeof(int);    //HeatBeatID2
	memSize += sizeof(int);		//Type

	return memSize;
}
//////////////////////////////////////////////////////////////////////////
//Type_OneKeySwitch_GetServerHeartBeatServerInfo
SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfo::SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfo()
{
	msgType = Type_OneKeySwitch_GetServerHeartBeatServerInfo;

	serverid=0;
	servertype=0;
	GatewayName="";
	ComputerSymbol="";	
	Type=0;
}

void SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfo";

	int theBufContent = AnalyzeMsgHead(thebuf);


	//serverid
	memmove(&this->serverid, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);


	//servertype
	memmove(&this->servertype, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//GatewayName
	GatewayName = thebuf + theBufContent;
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	ComputerSymbol = thebuf + theBufContent;
	theBufContent += ComputerSymbol.length()+1;

	//Type
	memmove(&this->Type, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);



}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);



	//serverid
	memmove(thebuf+theBufContent, &this->serverid, sizeof(int));
	theBufContent += sizeof(int);


	//servertype
	memmove(thebuf+theBufContent, &this->servertype, sizeof(int));
	theBufContent += sizeof(int);
	//GatewayName
	memcpy(thebuf+theBufContent, GatewayName.c_str(), GatewayName.length()+1);
	theBufContent += GatewayName.length()+1;

	//ComputerSymbol
	memcpy(thebuf+theBufContent, ComputerSymbol.c_str(), ComputerSymbol.length()+1);
	theBufContent += ComputerSymbol.length()+1;

	//Type
	memmove(thebuf+theBufContent, &this->Type, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(int);		//serverid
	memSize += sizeof(int);		//servertype
	memSize += GatewayName.length()+1;		//GatewayName
	memSize += ComputerSymbol.length()+1;		//ComputerSymbol
	
	memSize += sizeof(int);		//Type

	return memSize;
}
//////////////////////////////////////////////////////////////////////////
//Type_OneKeySwitch_GetServerHeartBeatServerInfoConf
SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfoConf::SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfoConf()
{
	msgType = Type_OneKeySwitch_GetServerHeartBeatServerInfoConf;

	HeatBeatServerIP1=0;
	HeatBeatServerPort1=0;
	HeatBeatServerIP2=0;
	HeatBeatServerPort2=0;
}

void SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfoConf";

	int theBufContent = AnalyzeMsgHead(thebuf);


	//HeatBeatServerIP1
	memmove(&this->HeatBeatServerIP1, thebuf+theBufContent, sizeof(long));
	theBufContent += sizeof(long);


	//HeatBeatServerPort1
	memmove(&this->HeatBeatServerPort1, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
	//HeatBeatServerIP2
	memmove(&this->HeatBeatServerIP2, thebuf+theBufContent, sizeof(long));
	theBufContent += sizeof(long);


	//HeatBeatServerPort2
	memmove(&this->HeatBeatServerPort2, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);



}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfoConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);



	//HeatBeatServerIP1
	memmove(thebuf+theBufContent, &this->HeatBeatServerIP1, sizeof(long));
	theBufContent += sizeof(long);

	//HeatBeatServerPort1
	memmove(thebuf+theBufContent, &this->HeatBeatServerPort1, sizeof(int));
	theBufContent += sizeof(int);

	//HeatBeatServerIP2
	memmove(thebuf+theBufContent, &this->HeatBeatServerIP2, sizeof(long));
	theBufContent += sizeof(long);
    //HeatBeatServerPort2
	memmove(thebuf+theBufContent, &this->HeatBeatServerPort2, sizeof(int));
	theBufContent += sizeof(int);


	

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_GetServerHeartBeatServerInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += sizeof(long);		//HeatBeatServerIP1
	memSize += sizeof(int);		//HeatBeatServerPort1
	memSize += sizeof(long);		//HeatBeatServerIP2
	memSize += sizeof(int);		//HeatBeatServerPort2

	return memSize;
}

//Type_SysManage_AddBanCall
SIPCCMsg_SysManage_AddBanCall::SIPCCMsg_SysManage_AddBanCall()
{
	msgType = Type_SysManage_AddBanCall;

	corpName="";
	deptName="";
	startTime="";
	endTime="";
	invokeID="";
}

void SIPCCMsg_SysManage_AddBanCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_AddBanCall";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	//deptName
	deptName = thebuf + theBufContent;
	theBufContent += deptName.length()+1;

	//startTime
	startTime = thebuf + theBufContent;
	theBufContent += startTime.length()+1;

	//endTime
	endTime = thebuf + theBufContent;
	theBufContent += endTime.length()+1;

	//invokeID
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;

}

int SIPCCMsg_SysManage_AddBanCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//deptName
	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;

	//startTime
	memcpy(thebuf+theBufContent, startTime.c_str(), startTime.length()+1);
	theBufContent += startTime.length()+1;

	//endTime
	memcpy(thebuf+theBufContent, endTime.c_str(), endTime.length()+1);
	theBufContent += endTime.length()+1;

	//invokeID
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddBanCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += corpName.length()+1;		//corpName
	memSize += deptName.length()+1;		//deptName
	memSize += startTime.length()+1;	//startTime
	memSize += endTime.length()+1;		//endTime
	memSize += invokeID.length()+1;		//invokeID

	return memSize;
}

//Type_SysManage_DelBanCall
SIPCCMsg_SysManage_DelBanCall::SIPCCMsg_SysManage_DelBanCall()
{
	msgType = Type_SysManage_DelBanCall;

	corpName="";
	deptName="";
	invokeID="";
}

void SIPCCMsg_SysManage_DelBanCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_DelBanCall";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	//deptName
	deptName = thebuf + theBufContent;
	theBufContent += deptName.length()+1;

	//invokeID
	invokeID = thebuf + theBufContent;
	theBufContent += invokeID.length()+1;

}

int SIPCCMsg_SysManage_DelBanCall::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//deptName
	memcpy(thebuf+theBufContent, deptName.c_str(), deptName.length()+1);
	theBufContent += deptName.length()+1;

	//invokeID
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_DelBanCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += corpName.length()+1;		//corpName
	memSize += deptName.length()+1;		//deptName
	memSize += invokeID.length()+1;		//invokeID

	return memSize;
}
////add code by hyj 2013-8-30
//Type_SysManage_AddAreaBan
SIPCCMsg_SysManage_AddAreaBan::SIPCCMsg_SysManage_AddAreaBan()
{
	msgType = Type_SysManage_AddAreaBan;

	corpName="";
	tgName="";
	callerNoForSend="";
	calleeAreaCode="";
	calleeType=0;
	ManagerTel="";

	invokeID = "";
}

void SIPCCMsg_SysManage_AddAreaBan::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "Type_SysManage_AddAreaBan";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	//tagName
	tgName = thebuf + theBufContent;
	theBufContent += tgName.length()+1;

	//callerNoForSend
	callerNoForSend = thebuf + theBufContent;
	theBufContent += callerNoForSend.length()+1;


	//calleeAreaCode
	calleeAreaCode = thebuf + theBufContent;
	theBufContent += calleeAreaCode.length()+1;
	//calleeType
	memmove(&this->calleeType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//ManagerTel
	ManagerTel = thebuf + theBufContent;
	theBufContent += ManagerTel.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_AddAreaBan::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//tagName
	memcpy(thebuf+theBufContent, tgName.c_str(), tgName.length()+1);
	theBufContent += tgName.length()+1;

	//callerNoForSend
	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;


	//calleeAreaCode
	memcpy(thebuf+theBufContent, calleeAreaCode.c_str(), calleeAreaCode.length()+1);
	theBufContent += calleeAreaCode.length()+1;


	//calleeType
	memmove(thebuf+theBufContent, &this->calleeType, sizeof(int));
	theBufContent += sizeof(int);

	//ManagerTel
	memcpy(thebuf+theBufContent, ManagerTel.c_str(), ManagerTel.length()+1);
	theBufContent += ManagerTel.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddAreaBan::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += corpName.length()+1;		//corpName
	memSize += tgName.length()+1;		//tagName
	memSize += callerNoForSend.length()+1;		//callerNoForSend
	memSize += calleeAreaCode.length()+1;		//calleeAreaCode
	memSize += sizeof(int);		  //calleeType
	memSize += ManagerTel.length()+1;		//ManagerTel

	memSize += invokeID.length()+1;			//invokeID

	return memSize;
}


////
//Type_SysManage_DelAreaBan
SIPCCMsg_SysManage_DelAreaBan::SIPCCMsg_SysManage_DelAreaBan()
{
	msgType = Type_SysManage_DelAreaBan;

	corpName="";
	tgName="";
	callerNoForSend="";
	
	invokeID = "";
}

void SIPCCMsg_SysManage_DelAreaBan::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	string strMsgName = "SIPCCMsg_SysManage_DelAreaBan";

	int theBufContent = AnalyzeMsgHead(thebuf);

	//corpName
	corpName = thebuf + theBufContent;
	theBufContent += corpName.length()+1;

	//tagName
	tgName = thebuf + theBufContent;
	theBufContent += tgName.length()+1;

	//callerNoForSend
	callerNoForSend = thebuf + theBufContent;
	theBufContent += callerNoForSend.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;

}

int SIPCCMsg_SysManage_DelAreaBan::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//corpName
	memcpy(thebuf+theBufContent, corpName.c_str(), corpName.length()+1);
	theBufContent += corpName.length()+1;

	//tagName
	memcpy(thebuf+theBufContent, tgName.c_str(), tgName.length()+1);
	theBufContent += tgName.length()+1;

	//callerNoForSend
	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;	

	return theBufContent;
}

int SIPCCMsg_SysManage_DelAreaBan::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += corpName.length()+1;		//corpName
	memSize += tgName.length()+1;		//tagName
	memSize += callerNoForSend.length()+1;		//callerNoForSend

	memSize += invokeID.length()+1;			//invokeID

	return memSize;
}

//Class_ClientCapture
SIPCCMsg_ClientCapture::SIPCCMsg_ClientCapture()
{
	msgClass = Class_ClientCapture;
	strAgentId="";
	iLineNo=-1;
}

//SIPCCMsg_ClientCapture_SessionEnd
SIPCCMsg_ClientCapture_SessionEnd::SIPCCMsg_ClientCapture_SessionEnd()
{
	msgType = Type_ClientCapture_SessionEnd;
	strAgentId = "";
}

void SIPCCMsg_ClientCapture_SessionEnd::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_ClientCapture_SessionEnd";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strAgentId=thebuf+theBufContent;
	if (!(VerifyTotalLen(theBufContent+strAgentId.length()+1,msgsize,strMsg,"strAgentId.length()",ip,port))){return;}
	if (!(VerifyData(strAgentId.length(),INVOKEID_LEN,strMsg,"strAgentId",ip,port))){return;}
	theBufContent+=(strAgentId.length()+1);

	if (theBufContent==msgsize)
		return;

	if (!VerifyTotalLen(theBufContent+sizeof(int),msgsize,strMsg,"iLineNo",ip,port)){return;}
	memmove(&this->iLineNo,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
}

int SIPCCMsg_ClientCapture_SessionEnd::FillBuf(char*& thebuf)
{
	if (thebuf==NULL)
	{
		thebuf = new char[GetMyMemSize()];
	}
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent,strAgentId.c_str(),strAgentId.length()+1);
	theBufContent += (strAgentId.length()+1);

	memmove(thebuf+theBufContent,&this->iLineNo,sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_ClientCapture_SessionEnd::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += strAgentId.length()+1;
	memSize += sizeof(int);

	return memSize;
}

//SIPCCMsg_ClientCapture_SRSend
SIPCCMsg_ClientCapture_SRSend::SIPCCMsg_ClientCapture_SRSend()
{
	msgType = Type_ClientCapture_SRSend;
	strAgentId="";
	iLineNo=-1;
	srSendTime=0;
	srRecvTime=0;
}

void SIPCCMsg_ClientCapture_SRSend::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0 */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_ClientCapture_SRSend";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strAgentId=thebuf+theBufContent;
	if (!(VerifyTotalLen(theBufContent+strAgentId.length()+1,msgsize,strMsg,"strAgentId.length()",ip,port))){return;}
	if (!(VerifyData(strAgentId.length(),INVOKEID_LEN,strMsg,"strAgentId",ip,port))){return;}
	theBufContent+=(strAgentId.length()+1);

	if (theBufContent==msgsize)
		return;

	if (!VerifyTotalLen(theBufContent+sizeof(int),msgsize,strMsg,"iLineNo",ip,port)){return;}
	memmove(&this->iLineNo,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

	if (theBufContent==msgsize)
		return;


	if (!(VerifyTotalLen(theBufContent+sizeof(LONGLONG),msgsize,strMsg,"srSendTime",ip,port))){return;}
	memmove(&this->srSendTime,thebuf+theBufContent,sizeof(LONGLONG));
	theBufContent+=sizeof(LONGLONG);

	if (theBufContent==msgsize)
		return;

	if (!(VerifyTotalLen(theBufContent+sizeof(LONGLONG),msgsize,strMsg,"srRecvTime",ip,port))){return;}
	memmove(&this->srRecvTime,thebuf+theBufContent,sizeof(LONGLONG));
	theBufContent+=sizeof(LONGLONG);
}

int SIPCCMsg_ClientCapture_SRSend::FillBuf(char*& thebuf)
{
	if(thebuf==NULL)
		thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent,strAgentId.c_str(),strAgentId.length()+1);
	theBufContent += (strAgentId.length()+1);

	memmove(thebuf+theBufContent,&this->iLineNo,sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent,&this->srSendTime,sizeof(LONGLONG));
	theBufContent += sizeof(LONGLONG);

	memmove(thebuf+theBufContent,&this->srRecvTime,sizeof(LONGLONG));
	theBufContent += sizeof(LONGLONG);

	return theBufContent;
}

int SIPCCMsg_ClientCapture_SRSend::GetMyMemSize()
{
	int memSize = 2*sizeof(int);

	memSize += strAgentId.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(LONGLONG);
	memSize += sizeof(LONGLONG);

	return memSize;
}

//SIPCCMsg_ClientCapture_RRSend
SIPCCMsg_ClientCapture_RRSend::SIPCCMsg_ClientCapture_RRSend()
{
	msgType = Type_ClientCapture_RRSend;
	strAgentId="";
	iLineNo=-1;
	srSendTime=0;
	rrRecvTime=0;
	srDelayTime=0;
}

void SIPCCMsg_ClientCapture_RRSend::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0 */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_ClientCapture_RRSend";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strAgentId=thebuf+theBufContent;
	if (!(VerifyTotalLen(theBufContent+strAgentId.length()+1,msgsize,strMsg,"strAgentId.length()",ip,port))){return;}
	if (!(VerifyData(strAgentId.length(),INVOKEID_LEN,strMsg,"strAgentId",ip,port))){return;}
	theBufContent+=(strAgentId.length()+1);

	if (theBufContent==msgsize)
		return;

	if (!VerifyTotalLen(theBufContent+sizeof(int),msgsize,strMsg,"iLineNo",ip,port)){return;}
	memmove(&this->iLineNo,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

	if (theBufContent==msgsize)
		return;

	if (!(VerifyTotalLen(theBufContent+sizeof(LONGLONG),msgsize,strMsg,"srSendTime",ip,port))){return;}
	memmove(&this->srSendTime,thebuf+theBufContent,sizeof(LONGLONG));
	theBufContent+=sizeof(LONGLONG);

	if (theBufContent==msgsize)
		return;

	if (!(VerifyTotalLen(theBufContent+sizeof(LONGLONG),msgsize,strMsg,"rrSendTime",ip,port))){return ;}
	memmove(&this->rrRecvTime,thebuf+theBufContent,sizeof(LONGLONG));
	theBufContent+=sizeof(LONGLONG);

	if (theBufContent==msgsize)
		return;

	if (!(VerifyTotalLen(theBufContent+sizeof(LONGLONG),msgsize,strMsg,"srDelayTime",ip,port))){return;}
	memmove(&this->srDelayTime,thebuf+theBufContent,sizeof(LONGLONG));
	theBufContent+=sizeof(LONGLONG);
}

int SIPCCMsg_ClientCapture_RRSend::FillBuf(char*& thebuf)
{
	if(thebuf==NULL)
		thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent,strAgentId.c_str(),strAgentId.length()+1);
	theBufContent += (strAgentId.length()+1);

	memmove(thebuf+theBufContent,&this->iLineNo,sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent,&this->srSendTime,sizeof(LONGLONG));
	theBufContent += sizeof(LONGLONG);

	memmove(thebuf+theBufContent,&this->rrRecvTime,sizeof(LONGLONG));
	theBufContent += sizeof(LONGLONG);

	memmove(thebuf+theBufContent,&this->srDelayTime,sizeof(LONGLONG));
	theBufContent += sizeof(LONGLONG);

	return theBufContent;
}

int SIPCCMsg_ClientCapture_RRSend::GetMyMemSize()
{
	int memSize = 2*sizeof(int);

	memSize += strAgentId.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(LONGLONG);

	memSize += sizeof(LONGLONG);
	memSize += sizeof(LONGLONG);

	return memSize;
}

//SIPCCMsg_ClientCapture_GetRtpStatistics
SIPCCMsg_ClientCapture_GetRtpStatistics::SIPCCMsg_ClientCapture_GetRtpStatistics()
{
	msgType = Type_ClientCapture_GetRtpStatistics;
	strAgentId = "";
	iLineNo = -1;
}

void SIPCCMsg_ClientCapture_GetRtpStatistics::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_ClientCapture_GetRtpStatistics";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	strAgentId=thebuf+theBufContent;
	if (!(VerifyTotalLen(theBufContent+strAgentId.length()+1,msgsize,strMsg,"strAgentId.length()",ip,port))){return;}
	if (!(VerifyData(strAgentId.length(),INVOKEID_LEN,strMsg,"strAgentId",ip,port))){return;}
	theBufContent+=(strAgentId.length()+1);

	if (theBufContent==msgsize)
		return;

	if (!VerifyTotalLen(theBufContent+sizeof(int),msgsize,strMsg,"iLineNo",ip,port)){return;}
	memmove(&this->iLineNo,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

}

int SIPCCMsg_ClientCapture_GetRtpStatistics::FillBuf(char*& thebuf)
{
	if (thebuf==NULL)
	{
		thebuf = new char[GetMyMemSize()];
	}
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent,strAgentId.c_str(),strAgentId.length()+1);
	theBufContent += (strAgentId.length()+1);

	memmove(thebuf+theBufContent,&this->iLineNo,sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_ClientCapture_GetRtpStatistics::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += strAgentId.length()+1;
	memSize += sizeof(int);

	return memSize;
}
///////////////////////////////////////////////////////////////////////////
//Type_WebService_QueryCalloutInfo
SIPCCMsg_WebService_QueryCalloutInfo::SIPCCMsg_WebService_QueryCalloutInfo()
{
	msgType = Type_WebService_QueryCalloutInfo;
	agentId = "";
	handleId = "";
}

void SIPCCMsg_WebService_QueryCalloutInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_WebService_QueryCalloutInfo";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	agentId=thebuf+theBufContent;	
	theBufContent+=(agentId.length()+1);


	handleId=thebuf+theBufContent;	
	theBufContent+=(handleId.length()+1);


}

int SIPCCMsg_WebService_QueryCalloutInfo::FillBuf(char*& thebuf)
{
	
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);	
	

	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += (agentId.length()+1);

	memcpy(thebuf+theBufContent,handleId.c_str(),handleId.length()+1);
	theBufContent += (handleId.length()+1);


	

	return theBufContent;
}

int SIPCCMsg_WebService_QueryCalloutInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += agentId.length()+1;
	memSize += handleId.length()+1;
	
	return memSize;
}


//SIPCCMsg_WebService_QueryCalloutInfoConf
SIPCCMsg_WebService_QueryCalloutInfoConf::SIPCCMsg_WebService_QueryCalloutInfoConf()
{
	msgType = Type_WebService_QueryCalloutInfoConf;
	corpName = "";
	managerid = "";
	deptName = "";
	agentRealNo = "";
	handleId = "";
	
}

void SIPCCMsg_WebService_QueryCalloutInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_WebService_QueryCalloutInfoConf";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//corpName
	corpName=thebuf+theBufContent;	
	theBufContent+=(corpName.length()+1);

	//managerid
	managerid=thebuf+theBufContent;	
	theBufContent+=(managerid.length()+1);


	

	//deptName
	deptName=thebuf+theBufContent;	
	theBufContent+=(deptName.length()+1);

	//agentRealNo
	agentRealNo=thebuf+theBufContent;	
	theBufContent+=(agentRealNo.length()+1);


	//handleId
	handleId=thebuf+theBufContent;	
	theBufContent+=(handleId.length()+1);


}

int SIPCCMsg_WebService_QueryCalloutInfoConf::FillBuf(char*& thebuf)
{
	
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

   


	//corpName
	memcpy(thebuf+theBufContent,corpName.c_str(),corpName.length()+1);
	theBufContent += (corpName.length()+1);


	//managerid
	memcpy(thebuf+theBufContent,managerid.c_str(),managerid.length()+1);
	theBufContent += (managerid.length()+1);

	//deptName
	memcpy(thebuf+theBufContent,deptName.c_str(),deptName.length()+1);
	theBufContent += (deptName.length()+1);

	//agentRealNo
	memcpy(thebuf+theBufContent,agentRealNo.c_str(),agentRealNo.length()+1);
	theBufContent += (agentRealNo.length()+1);


	//handleId
	memcpy(thebuf+theBufContent,handleId.c_str(),handleId.length()+1);
	theBufContent += (handleId.length()+1);
	


	return theBufContent;
}

int SIPCCMsg_WebService_QueryCalloutInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += corpName.length()+1;//corpName
	memSize += managerid.length()+1;//managerid
	memSize += deptName.length()+1;//deptName
	memSize += agentRealNo.length()+1;//agentRealNo
	memSize += handleId.length()+1;//handleId

	return memSize;
}

//SIPCCMsg_WebService_HangupCall
SIPCCMsg_WebService_HangupCall::SIPCCMsg_WebService_HangupCall()
{
	msgType = Type_WebService_HangupCall;
	agentId="";
	station="";
	operationTime="";
	event="";
	hangpuCallType=0;

	ucid="";				//invokeid
}

void SIPCCMsg_WebService_HangupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_WebService_HangupCall";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentId
	agentId=thebuf+theBufContent;	
	theBufContent+=(agentId.length()+1);

	//station
	station=thebuf+theBufContent;	
	theBufContent+=(station.length()+1);


	//operationTime
	operationTime=thebuf+theBufContent;	
	theBufContent+=(operationTime.length()+1);

	//event
	event=thebuf+theBufContent;	
	theBufContent+=(event.length()+1);	

	//hangpuCallType
	memmove(&this->hangpuCallType,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

	if (theBufContent==msgsize)
		return;

	//ucid
	ucid=thebuf+theBufContent;	
	theBufContent+=(ucid.length()+1);

}

int SIPCCMsg_WebService_HangupCall::FillBuf(char*& thebuf)
{

	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//agentId
	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += (agentId.length()+1);

	//station
	memcpy(thebuf+theBufContent,station.c_str(),station.length()+1);
	theBufContent += (station.length()+1);

	//operationTime
	memcpy(thebuf+theBufContent,operationTime.c_str(),operationTime.length()+1);
	theBufContent += (operationTime.length()+1);

	//event
	memcpy(thebuf+theBufContent,event.c_str(),event.length()+1);
	theBufContent += (event.length()+1);


	//hangpuCallType
	memmove(thebuf+theBufContent,&this->hangpuCallType,sizeof(int));
	theBufContent += sizeof(int);
	

	//ucid
	memcpy(thebuf+theBufContent,ucid.c_str(),ucid.length()+1);
	theBufContent += (ucid.length()+1);
	return theBufContent;
}

int SIPCCMsg_WebService_HangupCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += agentId.length()+1;//agentId
	memSize += station.length()+1;//station
	memSize += operationTime.length()+1;//operationTime
	memSize += event.length()+1;//event
	memSize+= sizeof(int);//hangpuCallType

	memSize += ucid.length()+1;//ucid
	return memSize;
}
///////////////////////////////////////////////////////////////////////////////////
//SIPCCMsg_WebService_RecordInfo
SIPCCMsg_WebService_RecordInfo::SIPCCMsg_WebService_RecordInfo()
{
	msgType = Type_WebService_RecordInfo;

	 agentId="";

	 station="";

	operationTime="";

	event="";

	recordId="";			//invokeid

	RecordType=0;			//1是录音开始，2是录音结束；

}

void SIPCCMsg_WebService_RecordInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_WebService_RecordInfo";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//agentId
	agentId=thebuf+theBufContent;	
	theBufContent+=(agentId.length()+1);

	//station
	station=thebuf+theBufContent;	
	theBufContent+=(station.length()+1);


	//operationTime
	operationTime=thebuf+theBufContent;	
	theBufContent+=(operationTime.length()+1);

	//event
	event=thebuf+theBufContent;	
	theBufContent+=(event.length()+1);	

	//recordId
	recordId=thebuf+theBufContent;	
	theBufContent+=(recordId.length()+1);	

	//RecordType
	memmove(&this->RecordType,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

}

int SIPCCMsg_WebService_RecordInfo::FillBuf(char*& thebuf)
{
	
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//agentId
	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += (agentId.length()+1);

	//station
	memcpy(thebuf+theBufContent,station.c_str(),station.length()+1);
	theBufContent += (station.length()+1);

	//operationTime
	memcpy(thebuf+theBufContent,operationTime.c_str(),operationTime.length()+1);
	theBufContent += (operationTime.length()+1);

	//event
	memcpy(thebuf+theBufContent,event.c_str(),event.length()+1);
	theBufContent += (event.length()+1);


	//recordId
	memcpy(thebuf+theBufContent,recordId.c_str(),recordId.length()+1);
	theBufContent += (recordId.length()+1);


	//RecordType
	memmove(thebuf+theBufContent,&this->RecordType,sizeof(int));
	theBufContent += sizeof(int);
	return theBufContent;
}

int SIPCCMsg_WebService_RecordInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += agentId.length()+1;//agentId
	memSize += station.length()+1;//station
	memSize += operationTime.length()+1;//operationTime
	memSize += event.length()+1;//event
	memSize += recordId.length()+1;//recordId
	memSize+= sizeof(int);//RecordType
	return memSize;
}
//////
//SIPCCMsg_WebService_DialingCall
SIPCCMsg_WebService_DialingCall::SIPCCMsg_WebService_DialingCall()
{
	msgType = Type_WebService_DialingCall;

	ani="";				//主叫号码

	dnis="";				//被叫号码

	ucid="";				//invokeid

	director=0;				//呼叫方向，0是呼入，1是呼出

	agentId="";				//座席工号

	station="";				//分机

	operationTime="";		//操作时间

	event = "";				//事件

	userData = "";

}

void SIPCCMsg_WebService_DialingCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_WebService_DialingCall";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ani
	ani=thebuf+theBufContent;	
	theBufContent+=(ani.length()+1);

	//dnis
	dnis=thebuf+theBufContent;	
	theBufContent+=(dnis.length()+1);


	//ucid
	ucid=thebuf+theBufContent;	
	theBufContent+=(ucid.length()+1);


	//director
	memmove(&this->director,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

	//agentId
	agentId=thebuf+theBufContent;	
	theBufContent+=(agentId.length()+1);	

	//station
	station=thebuf+theBufContent;	
	theBufContent+=(station.length()+1);	

	//operationTime
	operationTime=thebuf+theBufContent;	
	theBufContent+=(operationTime.length()+1);

	//event
	event=thebuf+theBufContent;	
	theBufContent+=(event.length()+1);

	if (theBufContent==msgsize)
		return;

	//userData
	userData=thebuf+theBufContent;	
	theBufContent+=(userData.length()+1);

}

int SIPCCMsg_WebService_DialingCall::FillBuf(char*& thebuf)
{
	
	thebuf = new char[GetMyMemSize()];

	int theBufContent = FillMsgHead(thebuf);
	//ani
	memcpy(thebuf+theBufContent,ani.c_str(),ani.length()+1);
	theBufContent += (ani.length()+1);

	//dnis
	memcpy(thebuf+theBufContent,dnis.c_str(),dnis.length()+1);
	theBufContent += (dnis.length()+1);

	//ucid
	memcpy(thebuf+theBufContent,ucid.c_str(),ucid.length()+1);
	theBufContent += (ucid.length()+1);


	//director
	memmove(thebuf+theBufContent,&this->director,sizeof(int));
	theBufContent += sizeof(int);
	
	//agentId
	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += (agentId.length()+1);


	
	//station
	memcpy(thebuf+theBufContent,station.c_str(),station.length()+1);
	theBufContent += (station.length()+1);


	//operationTime
	memcpy(thebuf+theBufContent,operationTime.c_str(),operationTime.length()+1);
	theBufContent += (operationTime.length()+1);

	//event
	memcpy(thebuf+theBufContent,event.c_str(),event.length()+1);
	theBufContent += (event.length()+1);

	//userData
	memcpy(thebuf+theBufContent,userData.c_str(), userData.length()+1);
	theBufContent += (userData.length()+1);

	return theBufContent;
}

int SIPCCMsg_WebService_DialingCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += ani.length()+1;//ani
	memSize += dnis.length()+1;//dnis
	memSize += ucid.length()+1;//ucid
	memSize+= sizeof(int);//director

	memSize += agentId.length()+1;//agentId
	memSize += station.length()+1;//station
	memSize += operationTime.length()+1;//operationTime
	memSize += event.length()+1;//event

	memSize += userData.length()+1;	//userData
	return memSize;
}
///////
/////
//SIPCCMsg_WebService_RingingCall
SIPCCMsg_WebService_RingingCall::SIPCCMsg_WebService_RingingCall()
{
	msgType = Type_WebService_RingingCall;

	ani="";				//主叫号码

	dnis="";				//被叫号码

	ucid="";				//invokeid

	director=0;				//呼叫方向，0是呼入，1是呼出
	ivrTrack="";

	agentId="";				//座席工号

	station="";				//分机

	operationTime="";		//操作时间

	string event;				//事件

}

void SIPCCMsg_WebService_RingingCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_WebService_RingingCall";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ani
	ani=thebuf+theBufContent;	
	theBufContent+=(ani.length()+1);

	//dnis
	dnis=thebuf+theBufContent;	
	theBufContent+=(dnis.length()+1);


	//ucid
	ucid=thebuf+theBufContent;	
	theBufContent+=(ucid.length()+1);


	//director
	memmove(&this->director,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);


	//ivrTrack
	ivrTrack=thebuf+theBufContent;	
	theBufContent+=(ivrTrack.length()+1);	

	//agentId
	agentId=thebuf+theBufContent;	
	theBufContent+=(agentId.length()+1);	

	//station
	station=thebuf+theBufContent;	
	theBufContent+=(station.length()+1);	

	//operationTime
	operationTime=thebuf+theBufContent;	
	theBufContent+=(operationTime.length()+1);

	//event
	event=thebuf+theBufContent;	
	theBufContent+=(event.length()+1);

}

int SIPCCMsg_WebService_RingingCall::FillBuf(char*& thebuf)
{
	
	thebuf = new char[GetMyMemSize()];

	int theBufContent = FillMsgHead(thebuf);
	//ani
	memcpy(thebuf+theBufContent,ani.c_str(),ani.length()+1);
	theBufContent += (ani.length()+1);

	//dnis
	memcpy(thebuf+theBufContent,dnis.c_str(),dnis.length()+1);
	theBufContent += (dnis.length()+1);

	//ucid
	memcpy(thebuf+theBufContent,ucid.c_str(),ucid.length()+1);
	theBufContent += (ucid.length()+1);


	//director
	memmove(thebuf+theBufContent,&this->director,sizeof(int));
	theBufContent += sizeof(int);

    
	//ivrTrack
	memcpy(thebuf+theBufContent,ivrTrack.c_str(),ivrTrack.length()+1);
	theBufContent += (ivrTrack.length()+1);


	//agentId
	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += (agentId.length()+1);



	//station
	memcpy(thebuf+theBufContent,station.c_str(),station.length()+1);
	theBufContent += (station.length()+1);


	//operationTime
	memcpy(thebuf+theBufContent,operationTime.c_str(),operationTime.length()+1);
	theBufContent += (operationTime.length()+1);

	//event
	memcpy(thebuf+theBufContent,event.c_str(),event.length()+1);
	theBufContent += (event.length()+1);
	return theBufContent;
}

int SIPCCMsg_WebService_RingingCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += ani.length()+1;//ani
	memSize += dnis.length()+1;//dnis
	memSize += ucid.length()+1;//ucid
	memSize+= sizeof(int);//director

	memSize += ivrTrack.length()+1;//ivrTrack
	memSize += agentId.length()+1;//agentId
	memSize += station.length()+1;//station
	memSize += operationTime.length()+1;//operationTime
	memSize += event.length()+1;//event
	return memSize;
}

//SIPCCMsg_WebService_TalkingCall
SIPCCMsg_WebService_TalkingCall::SIPCCMsg_WebService_TalkingCall()
{
	msgType = Type_WebService_TalkingCall;

	ani="";				//主叫号码

	dnis="";				//被叫号码

	ucid="";				//invokeid
	
	agentId="";				//座席工号

	station="";				//分机

	operationTime="";		//操作时间

	string event;				//事件

}

void SIPCCMsg_WebService_TalkingCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	string strMsg="SIPCCMsg_WebService_TalkingCall";
	if (!(VerifyTotalLen(HEAD_LEN,msgsize,strMsg,"MsgHead",ip,port))){return;}
	int theBufContent = AnalyzeMsgHead(thebuf);

	//ani
	ani=thebuf+theBufContent;	
	theBufContent+=(ani.length()+1);

	//dnis
	dnis=thebuf+theBufContent;	
	theBufContent+=(dnis.length()+1);


	//ucid
	ucid=thebuf+theBufContent;	
	theBufContent+=(ucid.length()+1);


	
	//agentId
	agentId=thebuf+theBufContent;	
	theBufContent+=(agentId.length()+1);	

	//station
	station=thebuf+theBufContent;	
	theBufContent+=(station.length()+1);	

	//operationTime
	operationTime=thebuf+theBufContent;	
	theBufContent+=(operationTime.length()+1);

	//event
	event=thebuf+theBufContent;	
	theBufContent+=(event.length()+1);

}

int SIPCCMsg_WebService_TalkingCall::FillBuf(char*& thebuf)
{
	
    thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);
	//ani
	memcpy(thebuf+theBufContent,ani.c_str(),ani.length()+1);
	theBufContent += (ani.length()+1);

	//dnis
	memcpy(thebuf+theBufContent,dnis.c_str(),dnis.length()+1);
	theBufContent += (dnis.length()+1);

	//ucid
	memcpy(thebuf+theBufContent,ucid.c_str(),ucid.length()+1);
	theBufContent += (ucid.length()+1);


	


	//agentId
	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += (agentId.length()+1);



	//station
	memcpy(thebuf+theBufContent,station.c_str(),station.length()+1);
	theBufContent += (station.length()+1);


	//operationTime
	memcpy(thebuf+theBufContent,operationTime.c_str(),operationTime.length()+1);
	theBufContent += (operationTime.length()+1);

	//event
	memcpy(thebuf+theBufContent,event.c_str(),event.length()+1);
	theBufContent += (event.length()+1);
	return theBufContent;
}

int SIPCCMsg_WebService_TalkingCall::GetMyMemSize()
{
	int memSize = 2*sizeof(int);
	memSize += ani.length()+1;//ani
	memSize += dnis.length()+1;//dnis
	memSize += ucid.length()+1;//ucid
	
	memSize += agentId.length()+1;//agentId
	memSize += station.length()+1;//station
	memSize += operationTime.length()+1;//operationTime
	memSize += event.length()+1;//event
	return memSize;
}

///Type_SysManage_AddRecInfo
SIPCCMsg_SysManage_AddRecInfo::SIPCCMsg_SysManage_AddRecInfo()
{
	msgType = Type_SysManage_AddRecInfo;
	gwName = "";
	computerSymbol = "";

	recServerID = 0;
	recSymbol = "";
	recServerIP = "";
	recFilePath = "";
	recPathMode = 0;

	recServerID_Backup = 0;
	recSymbol_Backup = "";
	recServerIP_Backup = "";
	recFilePath_Backup = "";
	recPathMode_Backup = 0;

	invokeID = "";
}

void SIPCCMsg_SysManage_AddRecInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//gwName
	gwName = thebuf + theBufContent;
	theBufContent += gwName.length()+1;

	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent += computerSymbol.length()+1;

	//recServerID
	memmove(&this->recServerID, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol
	recSymbol = thebuf + theBufContent;
	theBufContent += recSymbol.length()+1;

	//recServerIP
	recServerIP = thebuf + theBufContent;
	theBufContent += recServerIP.length()+1;

	//recFilePath
	recFilePath = thebuf + theBufContent;
	theBufContent += recFilePath.length()+1;

	//recPathMode
	memmove(&this->recPathMode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//recServerID_Backup
	memmove(&this->recServerID_Backup, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol_Backup
	recSymbol_Backup = thebuf + theBufContent;
	theBufContent += recSymbol_Backup.length()+1;

	//recServerIP_Backup
	recServerIP_Backup = thebuf + theBufContent;
	theBufContent += recServerIP_Backup.length()+1;

	//recFilePath_Backup
	recFilePath_Backup = thebuf + theBufContent;
	theBufContent += recFilePath_Backup.length()+1;

	//recPathMode_Backup
	memmove(&this->recPathMode_Backup, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_AddRecInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//gwName
	memcpy(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += gwName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	//recServerID
	memmove(thebuf+theBufContent, &this->recServerID, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol
	memcpy(thebuf+theBufContent, recSymbol.c_str(), recSymbol.length()+1);
	theBufContent += recSymbol.length()+1;

	//recServerIP
	memcpy(thebuf+theBufContent, recServerIP.c_str(), recServerIP.length()+1);
	theBufContent += recServerIP.length()+1;

	//recFilePath
	memcpy(thebuf+theBufContent, recFilePath.c_str(), recFilePath.length()+1);
	theBufContent += recFilePath.length()+1;

	//recPathMode
	memmove(thebuf+theBufContent, &this->recPathMode, sizeof(int));
	theBufContent += sizeof(int);

	//recServerID_Backup
	memmove(thebuf+theBufContent, &this->recServerID_Backup, sizeof(int));
	theBufContent += sizeof(int);

	//recSymbol_Backup
	memcpy(thebuf+theBufContent, recSymbol_Backup.c_str(), recSymbol_Backup.length()+1);
	theBufContent += recSymbol_Backup.length()+1;

	//recServerIP_Backup
	memcpy(thebuf+theBufContent, recServerIP_Backup.c_str(), recServerIP_Backup.length()+1);
	theBufContent += recServerIP_Backup.length()+1;

	//recFilePath_Backup
	memcpy(thebuf+theBufContent, recFilePath_Backup.c_str(), recFilePath_Backup.length()+1);
	theBufContent += recFilePath_Backup.length()+1;

	//recPathMode_Backup
	memmove(thebuf+theBufContent, &this->recPathMode_Backup, sizeof(int));
	theBufContent += sizeof(int);

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_AddRecInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gwName.length()+1;				//gwName
	memSize += computerSymbol.length()+1;		//computerSymbol

	memSize += sizeof(int);						//recServerID
	memSize += recSymbol.length()+1;			//recSymbol
	memSize += recServerIP.length()+1;			//recServerIP
	memSize += recFilePath.length()+1;			//recFilePath
	memSize += sizeof(int);						//recPathMode
	
	memSize += sizeof(int);						//recServerID_Backup
	memSize += recSymbol_Backup.length()+1;		//recSymbol_Backup
	memSize += recServerIP_Backup.length()+1;	//recServerIP_Backup
	memSize += recFilePath_Backup.length()+1;	//recFilePath_Backup
	memSize += sizeof(int);						//recPathMode_Backup

	memSize += invokeID.length()+1;			//invokeID

	return memSize;
}

///Type_SysManage_DelRecInfo
SIPCCMsg_SysManage_DelRecInfo::SIPCCMsg_SysManage_DelRecInfo()
{
	msgType = Type_SysManage_DelRecInfo;
	gwName = "";
	computerSymbol = "";

	invokeID = "";
}

void SIPCCMsg_SysManage_DelRecInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//gwName
	gwName = thebuf + theBufContent;
	theBufContent += gwName.length()+1;

	//computerSymbol
	computerSymbol = thebuf + theBufContent;
	theBufContent += computerSymbol.length()+1;

	if ( theBufContent >= msgsize )
	{
		return;
	}

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length() + 1;
}

int SIPCCMsg_SysManage_DelRecInfo::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//gwName
	memcpy(thebuf+theBufContent, gwName.c_str(), gwName.length()+1);
	theBufContent += gwName.length()+1;

	//computerSymbol
	memcpy(thebuf+theBufContent, computerSymbol.c_str(), computerSymbol.length()+1);
	theBufContent += computerSymbol.length()+1;

	//invokeID
	memmove(thebuf+theBufContent, this->invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_DelRecInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += gwName.length()+1;				//gwName
	memSize += computerSymbol.length()+1;		//computerSymbol

	memSize += invokeID.length()+1;			//invokeID

	return memSize;
}

///Type_Gateway_InsertDateOperation
SIPCCMsg_Gateway_InsertDateOperation::SIPCCMsg_Gateway_InsertDateOperation()
{
	msgType = Type_Gateway_InsertDateOperation;
	tableName = "";
	fieldNameList = "";
	valueNameList = "";
}

void SIPCCMsg_Gateway_InsertDateOperation::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//tableName
	tableName = thebuf + theBufContent;
	theBufContent += tableName.length()+1;

	//fieldNameList
	fieldNameList = thebuf + theBufContent;
	theBufContent += fieldNameList.length()+1;

	//valueNameList
	valueNameList = thebuf + theBufContent;
	theBufContent += valueNameList.length()+1;
}

int SIPCCMsg_Gateway_InsertDateOperation::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//tableName
	memcpy(thebuf+theBufContent, tableName.c_str(), tableName.length()+1);
	theBufContent += tableName.length()+1;

	//fieldNameList
	memcpy(thebuf+theBufContent, fieldNameList.c_str(), fieldNameList.length()+1);
	theBufContent += fieldNameList.length()+1;

	//valueNameList
	memcpy(thebuf+theBufContent, valueNameList.c_str(), valueNameList.length()+1);
	theBufContent += valueNameList.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_InsertDateOperation::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype
	memSize += tableName.length()+1;			//tableName
	memSize += fieldNameList.length()+1;		//fieldNameList
	memSize += valueNameList.length()+1;		//valueNameList

	return memSize;
}

//voice recognition
SIPCCMsg_VoiceRecognition::SIPCCMsg_VoiceRecognition()
{
	msgClass=Class_VoiceRecognition;
}

SIPCCMsg_VoiceRecognition_RequestRec::SIPCCMsg_VoiceRecognition_RequestRec()
{
	msgType=Type_VoiceRecognition_RequestRecognition;
	strInvokeId="";
	strRecFile="";
	strKeywords="";
}

void SIPCCMsg_VoiceRecognition_RequestRec::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	strInvokeId=thebuf+theBufContent;
	theBufContent+=strInvokeId.length()+1;

	strRecFile=thebuf+theBufContent;
	theBufContent+=strRecFile.length()+1;

	strKeywords=thebuf+theBufContent;
	theBufContent+=strKeywords.length()+1;
}

int SIPCCMsg_VoiceRecognition_RequestRec::FillBuf(char*& thebuf)
{
	thebuf=new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent,strInvokeId.c_str(),strInvokeId.length()+1);
	theBufContent += strInvokeId.length()+1;

	memcpy(thebuf+theBufContent,strRecFile.c_str(),strRecFile.length()+1);
	theBufContent += strRecFile.length()+1;

	memcpy(thebuf+theBufContent,strKeywords.c_str(),strKeywords.length()+1);
	theBufContent += strKeywords.length()+1;

	return theBufContent;
}

int SIPCCMsg_VoiceRecognition_RequestRec::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += strInvokeId.length()+1;
	memSize += strRecFile.length()+1;
	memSize += strKeywords.length()+1;

	return memSize;
}

SIPCCMsg_VoiceRecognition_ResponseRec::SIPCCMsg_VoiceRecognition_ResponseRec()
{
	msgType=Type_VoiceRecognition_ResponseRecognition;
	strInvokeId="";
	strRetKwCount="";
}

void SIPCCMsg_VoiceRecognition_ResponseRec::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	strInvokeId=thebuf+theBufContent;
	theBufContent+=strInvokeId.length()+1;

	strRetKwCount=thebuf+theBufContent;
	theBufContent+=strRetKwCount.length()+1;

}

int SIPCCMsg_VoiceRecognition_ResponseRec::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent,strInvokeId.c_str(),strInvokeId.length()+1);
	theBufContent += strInvokeId.length()+1;

	memcpy(thebuf+theBufContent,strRetKwCount.c_str(),strRetKwCount.length()+1);
	theBufContent += strRetKwCount.length()+1;

	return theBufContent;
}

int SIPCCMsg_VoiceRecognition_ResponseRec::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += strInvokeId.length()+1;
	memSize += strRetKwCount.length()+1;

	return memSize;
}

SIPCCMsg_VoiceRecognition_AudioPacket::SIPCCMsg_VoiceRecognition_AudioPacket()
{
	msgType=Type_voiceRecognition_AudioPacket;
	strInvokeId="";
	lineNo=-1;
	endPacket=false;
	packetSeq=0;
	audioLength=0;
	audioData="";
}

void SIPCCMsg_VoiceRecognition_AudioPacket::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0 */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	strInvokeId=thebuf+theBufContent;
	theBufContent+=strInvokeId.length()+1;

	memmove(&this->lineNo,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

	memmove(&this->endPacket,thebuf+theBufContent,sizeof(bool));
	theBufContent+=sizeof(bool);

	memmove(&this->packetSeq,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

	memmove(&this->audioLength,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

//	audioData=thebuf+theBufContent;
	audioData.assign(thebuf+theBufContent,audioLength);
	theBufContent+=audioData.length()+1;
}

int SIPCCMsg_VoiceRecognition_AudioPacket::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent,strInvokeId.c_str(),strInvokeId.length()+1);
	theBufContent+=strInvokeId.length()+1;

	memmove(thebuf+theBufContent,&this->lineNo,sizeof(int));
	theBufContent+=sizeof(int);

	memmove(thebuf+theBufContent,&this->endPacket,sizeof(bool));
	theBufContent+=sizeof(bool);

	memmove(thebuf+theBufContent,&this->packetSeq,sizeof(int));
	theBufContent+=sizeof(int);

	memmove(thebuf+theBufContent,&this->audioLength,sizeof(int));
	theBufContent+=sizeof(int);

	memcpy(thebuf+theBufContent,audioData.c_str(),audioData.length()+1);
	theBufContent+=audioData.length()+1;

	return theBufContent;
}

int SIPCCMsg_VoiceRecognition_AudioPacket::GetMyMemSize()
{
	int memSize=2*sizeof(int);
	memSize += strInvokeId.length()+1;
	memSize += sizeof(int);
	memSize += sizeof(bool);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += audioData.length()+1;

	return memSize;
}
//////////////////////////////////////////////////////////////////////////
//Type_WebService_InterfaceToMessage
SIPCCMsg_WebService_InterfaceToMessage::SIPCCMsg_WebService_InterfaceToMessage()
{
	msgType=Type_WebService_InterfaceToMessage;

	interfaceType=0;			    //接口类型

	interfaceContent="";		//拼好的XML格式的接口参数

	handleId="";

	agentId="";         ;
}

void SIPCCMsg_WebService_InterfaceToMessage::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//interfaceType
	memmove(&this->interfaceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

    //interfaceContent
	interfaceContent=thebuf+theBufContent;
	theBufContent+=interfaceContent.length()+1;

	//handleId
	handleId=thebuf+theBufContent;
	theBufContent+=handleId.length()+1;

	//agentId
	agentId=thebuf+theBufContent;
	theBufContent+=agentId.length()+1;

}

int SIPCCMsg_WebService_InterfaceToMessage::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);


	//interfaceType
	memmove(thebuf+theBufContent, &this->interfaceType, sizeof(int));
	theBufContent += sizeof(int);


   //interfaceContent
	memcpy(thebuf+theBufContent,interfaceContent.c_str(),interfaceContent.length()+1);
	theBufContent += interfaceContent.length()+1;

	//handleId
	memcpy(thebuf+theBufContent,handleId.c_str(),handleId.length()+1);
	theBufContent += handleId.length()+1;

	
	//agentId
	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += agentId.length()+1;


	return theBufContent;
}

int SIPCCMsg_WebService_InterfaceToMessage::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize+= sizeof(int);//interfaceType
	memSize += interfaceContent.length()+1;	//interfaceContent
	memSize += handleId.length()+1;
	memSize += agentId.length()+1;

	return memSize;
}
/////////////////////////////////////////////////////////////////////////

//Type_WebService_InterfaceToMessageConf
SIPCCMsg_WebService_InterfaceToMessageConf::SIPCCMsg_WebService_InterfaceToMessageConf()
{
	msgType=Type_WebService_InterfaceToMessageConf;	
	handleId="";

	    
}

void SIPCCMsg_WebService_InterfaceToMessageConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	
	//handleId
	handleId=thebuf+theBufContent;
	theBufContent+=handleId.length()+1;

}

int SIPCCMsg_WebService_InterfaceToMessageConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);


	//handleId
	memcpy(thebuf+theBufContent,handleId.c_str(),handleId.length()+1);
	theBufContent += handleId.length()+1;


	return theBufContent;
}

int SIPCCMsg_WebService_InterfaceToMessageConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);
	memSize += handleId.length()+1;
	return memSize;
}

//SIPCCMsg_WebService_HeartBeat
SIPCCMsg_WebService_HeartBeat::SIPCCMsg_WebService_HeartBeat()
{
	msgType=Type_WebService_HeartBeat;

	 handleId="";

	agentId="";		//Client WebService正在服务的座席名

	lanIP_Client="";		//Client WebService的内网IP

	wanIP_Client="";	//Client WebService的公网IP

	port_Client="";		//Client WebService的UDP使用端口号

}

void SIPCCMsg_WebService_HeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//handleId
	handleId=thebuf+theBufContent;
	theBufContent+=handleId.length()+1; 
	//agentId
	agentId=thebuf+theBufContent;
	theBufContent+=agentId.length()+1; 

	//lanIP_Client
	lanIP_Client=thebuf+theBufContent;
	theBufContent+=lanIP_Client.length()+1; 


	//wanIP_Client
	wanIP_Client=thebuf+theBufContent;
	theBufContent+=wanIP_Client.length()+1;


	//port_Client
	port_Client=thebuf+theBufContent;
	theBufContent+=port_Client.length()+1; 



}

int SIPCCMsg_WebService_HeartBeat::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);


	//handleId
	memcpy(thebuf+theBufContent,handleId.c_str(),handleId.length()+1);
	theBufContent += handleId.length()+1;

	//agentId
	memcpy(thebuf+theBufContent,agentId.c_str(),agentId.length()+1);
	theBufContent += agentId.length()+1;



	//lanIP_Client
	memcpy(thebuf+theBufContent,lanIP_Client.c_str(),lanIP_Client.length()+1);
	theBufContent += lanIP_Client.length()+1;


	//wanIP_Client
	memcpy(thebuf+theBufContent,wanIP_Client.c_str(),wanIP_Client.length()+1);
	theBufContent += wanIP_Client.length()+1;


	//port_Client
	memcpy(thebuf+theBufContent,port_Client.c_str(),port_Client.length()+1);
	theBufContent += port_Client.length()+1;


	return theBufContent;
}

int SIPCCMsg_WebService_HeartBeat::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += handleId.length()+1;
	memSize += agentId.length()+1;
	memSize += lanIP_Client.length()+1;
	memSize += wanIP_Client.length()+1;
	memSize += port_Client.length()+1;

	return memSize;
}
//////////////
//Type_WebService_HeartBeatConf
SIPCCMsg_WebService_HeartBeatConf::SIPCCMsg_WebService_HeartBeatConf()
{
	msgType=Type_WebService_HeartBeatConf;

	handleId="";

	

}

void SIPCCMsg_WebService_HeartBeatConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//handleId
	handleId=thebuf+theBufContent;
	theBufContent+=handleId.length()+1; 




}

int SIPCCMsg_WebService_HeartBeatConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);


	//handleId
	memcpy(thebuf+theBufContent,handleId.c_str(),handleId.length()+1);
	theBufContent += handleId.length()+1;


	return theBufContent;
}

int SIPCCMsg_WebService_HeartBeatConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += handleId.length()+1;	
	return memSize;
}


//////////////////////
//SIPCCMsg_ACD_SMSInfo
SIPCCMsg_ACD_SMSInfo::SIPCCMsg_ACD_SMSInfo()
{
	msgType=Type_ACD_SMSInfo;

	sHandleId="";

	sChannelType="";

	iNonsync=0;				//默认为0

	iEventType=-1;			//默认为-1

	sManagerid="";

	sAgentid="";

	sMobilePhoneNo="";

	sCallId="";
}

void SIPCCMsg_ACD_SMSInfo::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//sHandleId
	sHandleId=thebuf+theBufContent;
	theBufContent+=sHandleId.length()+1; 
	//sChannelType
	sChannelType=thebuf+theBufContent;
	theBufContent+=sChannelType.length()+1;

	//iNonsync
	memmove(&this->iNonsync,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
	//iEventType
	memmove(&this->iEventType,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);


	//sManagerid
	sManagerid=thebuf+theBufContent;
	theBufContent+=sManagerid.length()+1;

	//sAgentid
	sAgentid=thebuf+theBufContent;
	theBufContent+=sAgentid.length()+1;


	//sMobilePhoneNo
	sMobilePhoneNo=thebuf+theBufContent;
	theBufContent+=sMobilePhoneNo.length()+1;


	//sCallId
	sCallId=thebuf+theBufContent;
	theBufContent+=sCallId.length()+1;




}

int SIPCCMsg_ACD_SMSInfo::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);


	//sHandleId
	memcpy(thebuf+theBufContent,sHandleId.c_str(),sHandleId.length()+1);
	theBufContent += sHandleId.length()+1;

	//sChannelType
	memcpy(thebuf+theBufContent,sChannelType.c_str(),sChannelType.length()+1);
	theBufContent += sChannelType.length()+1;

    //iNonsync
	memmove(thebuf+theBufContent,&this->iNonsync,sizeof(int));
	theBufContent+=sizeof(int);

    //iEventType
	memmove(thebuf+theBufContent,&this->iEventType,sizeof(int));
	theBufContent+=sizeof(int);
	
	//sChannelType
	memcpy(thebuf+theBufContent,sManagerid.c_str(),sManagerid.length()+1);
	theBufContent += sManagerid.length()+1;



	//sAgentid
	memcpy(thebuf+theBufContent,sAgentid.c_str(),sAgentid.length()+1);
	theBufContent += sAgentid.length()+1;


	//sMobilePhoneNo
	memcpy(thebuf+theBufContent,sMobilePhoneNo.c_str(),sMobilePhoneNo.length()+1);
	theBufContent += sMobilePhoneNo.length()+1;
	

	//sCallId
	memcpy(thebuf+theBufContent,sCallId.c_str(),sCallId.length()+1);
	theBufContent += sCallId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_SMSInfo::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sHandleId.length()+1;
	memSize += sChannelType.length()+1;
	memSize += sizeof(int);//iNonsync
	memSize += sizeof(int);//iEventType
	memSize += sManagerid.length()+1;
	memSize += sAgentid.length()+1;
	memSize += sMobilePhoneNo.length()+1;
	memSize += sCallId.length()+1;

	return memSize;
}
//////////////////////
//SIPCCMsg_ACD_SMSInfoConf
SIPCCMsg_PhoneSearch_SMSInfoConf::SIPCCMsg_PhoneSearch_SMSInfoConf()
{
	msgType=Type_PhoneSearch_SMSInfoConf;

	sHandleId="";
	bSucc=0;

}

void SIPCCMsg_PhoneSearch_SMSInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//sHandleId
	sHandleId=thebuf+theBufContent;
	theBufContent+=sHandleId.length()+1; 	
	//bSucc
	memmove(&this->bSucc,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
}

int SIPCCMsg_PhoneSearch_SMSInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);
	//sHandleId
	memcpy(thebuf+theBufContent,sHandleId.c_str(),sHandleId.length()+1);
	theBufContent += sHandleId.length()+1;
	//bSucc
	memmove(thebuf+theBufContent,&this->bSucc,sizeof(int));
	theBufContent+=sizeof(int);
	
	return theBufContent;
}

int SIPCCMsg_PhoneSearch_SMSInfoConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sHandleId.length()+1;	
	memSize += sizeof(int);//bSucc
	return memSize;
}
//////////////

///Type_ACD_RefreshSkillGroupConf
SIPCCMsg_ACD_RefreshSkillGroupConf::SIPCCMsg_ACD_RefreshSkillGroupConf()
{
	msgType=Type_ACD_RefreshSkillGroupConf;

	sInvokeId = "";
	sSGId = "";
	bLoad = 1;

}

void SIPCCMsg_ACD_RefreshSkillGroupConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//sInvokeId
	sInvokeId=thebuf+theBufContent;
	theBufContent+=sInvokeId.length()+1; 	

	//sSGId
	sSGId=thebuf+theBufContent;
	theBufContent+=sSGId.length()+1; 

	//bLoad
	memmove(&this->bLoad,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
}

int SIPCCMsg_ACD_RefreshSkillGroupConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//sInvokeId
	memcpy(thebuf+theBufContent,sInvokeId.c_str(),sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	//sSGId
	memcpy(thebuf+theBufContent,sSGId.c_str(),sSGId.length()+1);
	theBufContent += sSGId.length()+1;

	//bLoad
	memmove(thebuf+theBufContent,&this->bLoad,sizeof(int));
	theBufContent+=sizeof(int);

	return theBufContent;
}

int SIPCCMsg_ACD_RefreshSkillGroupConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sInvokeId.length()+1;		//sInvokeId
	memSize += sSGId.length()+1;			//sSGId
	memSize += sizeof(int);					//bSucc

	return memSize;
}

///Type_ACD_NotifyACDLicenceConf
SIPCCMsg_ACD_NotifyACDLicenceConf::SIPCCMsg_ACD_NotifyACDLicenceConf()
{
	msgType = Type_ACD_NotifyACDLicenceConf;

	sInvokeId = "";

}

void SIPCCMsg_ACD_NotifyACDLicenceConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//sInvokeId
	sInvokeId=thebuf+theBufContent;
	theBufContent+=sInvokeId.length()+1; 	

}

int SIPCCMsg_ACD_NotifyACDLicenceConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//sInvokeId
	memcpy(thebuf+theBufContent,sInvokeId.c_str(),sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_NotifyACDLicenceConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sInvokeId.length()+1;		//sInvokeId

	return memSize;
}

///Type_Guide_RefreshKeywordConf
SIPCCMsg_Guide_RefreshKeywordConf::SIPCCMsg_Guide_RefreshKeywordConf()
{
	msgType=Type_Guide_RefreshKeywordConf;

	sInvokeId = "";
	sKeyword = "";
	bLoad = 1;

}

void SIPCCMsg_Guide_RefreshKeywordConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//sInvokeId
	sInvokeId=thebuf+theBufContent;
	theBufContent+=sInvokeId.length()+1; 	

	//sKeyword
	sKeyword=thebuf+theBufContent;
	theBufContent+=sKeyword.length()+1; 

	//bLoad
	memmove(&this->bLoad,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
}

int SIPCCMsg_Guide_RefreshKeywordConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//sInvokeId
	memcpy(thebuf+theBufContent,sInvokeId.c_str(),sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	//sKeyword
	memcpy(thebuf+theBufContent,sKeyword.c_str(),sKeyword.length()+1);
	theBufContent += sKeyword.length()+1;

	//bLoad
	memmove(thebuf+theBufContent,&this->bLoad,sizeof(int));
	theBufContent+=sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Guide_RefreshKeywordConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sInvokeId.length()+1;		//sInvokeId
	memSize += sKeyword.length()+1;			//sKeyword
	memSize += sizeof(int);					//bSucc

	return memSize;
}

///Type_ServerProxy_LoadServerInfoConfConf
SIPCCMsg_ServerProxy_LoadServerInfoConfConf::SIPCCMsg_ServerProxy_LoadServerInfoConfConf()
{
	msgType=Type_ServerProxy_LoadServerInfoConfConf;

	sInvokeId = "";
	sManagerId = "";
	bLoad = 1;

}

void SIPCCMsg_ServerProxy_LoadServerInfoConfConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//sInvokeId
	sInvokeId=thebuf+theBufContent;
	theBufContent+=sInvokeId.length()+1; 	

	//sManagerId
	sManagerId=thebuf+theBufContent;
	theBufContent+=sManagerId.length()+1; 

	//bLoad
	memmove(&this->bLoad,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
}

int SIPCCMsg_ServerProxy_LoadServerInfoConfConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//sInvokeId
	memcpy(thebuf+theBufContent,sInvokeId.c_str(),sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	//sManagerId
	memcpy(thebuf+theBufContent,sManagerId.c_str(),sManagerId.length()+1);
	theBufContent += sManagerId.length()+1;

	//bLoad
	memmove(thebuf+theBufContent,&this->bLoad,sizeof(int));
	theBufContent+=sizeof(int);

	return theBufContent;
}

int SIPCCMsg_ServerProxy_LoadServerInfoConfConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sInvokeId.length()+1;		//sInvokeId
	memSize += sManagerId.length()+1;		//sManagerId
	memSize += sizeof(int);					//bSucc

	return memSize;
}

///Type_OneKeySwitch_RefreshGatewayInfoConf
SIPCCMsg_OneKeySwitch_RefreshGatewayInfoConf::SIPCCMsg_OneKeySwitch_RefreshGatewayInfoConf()
{
	msgType=Type_OneKeySwitch_RefreshGatewayInfoConf;

	sInvokeId = "";
	sGatewayName = "";
	bLoad = 1;

}

void SIPCCMsg_OneKeySwitch_RefreshGatewayInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//sInvokeId
	sInvokeId=thebuf+theBufContent;
	theBufContent+=sInvokeId.length()+1; 	

	//sGatewayName
	sGatewayName=thebuf+theBufContent;
	theBufContent+=sGatewayName.length()+1; 

	//bLoad
	memmove(&this->bLoad,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
}

int SIPCCMsg_OneKeySwitch_RefreshGatewayInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//sInvokeId
	memcpy(thebuf+theBufContent,sInvokeId.c_str(),sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	//sGatewayName
	memcpy(thebuf+theBufContent,sGatewayName.c_str(),sGatewayName.length()+1);
	theBufContent += sGatewayName.length()+1;

	//bLoad
	memmove(thebuf+theBufContent,&this->bLoad,sizeof(int));
	theBufContent+=sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_RefreshGatewayInfoConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sInvokeId.length()+1;		//sInvokeId
	memSize += sGatewayName.length()+1;		//sGatewayName
	memSize += sizeof(int);					//bSucc

	return memSize;
}

///Type_OneKeySwitch_RefreshRegisterInfoConf
SIPCCMsg_OneKeySwitch_RefreshRegisterInfoConf::SIPCCMsg_OneKeySwitch_RefreshRegisterInfoConf()
{
	msgType=Type_OneKeySwitch_RefreshRegisterInfoConf;

	sInvokeId = "";
	iServiceId = 0;
	bLoad = 1;

}

void SIPCCMsg_OneKeySwitch_RefreshRegisterInfoConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//sInvokeId
	sInvokeId=thebuf+theBufContent;
	theBufContent+=sInvokeId.length()+1; 	

	//iServiceId
	memmove(&this->iServiceId,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int); 

	//bLoad
	memmove(&this->bLoad,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
}

int SIPCCMsg_OneKeySwitch_RefreshRegisterInfoConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//sInvokeId
	memcpy(thebuf+theBufContent,sInvokeId.c_str(),sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	//iServiceId
	memmove(thebuf+theBufContent,&this->iServiceId,sizeof(int));
	theBufContent+=sizeof(int);

	//bLoad
	memmove(thebuf+theBufContent,&this->bLoad,sizeof(int));
	theBufContent+=sizeof(int);

	return theBufContent;
}

int SIPCCMsg_OneKeySwitch_RefreshRegisterInfoConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += sInvokeId.length()+1;		//sInvokeId
	memSize += sizeof(int);					//iServiceId
	memSize += sizeof(int);					//bSucc

	return memSize;
}

///Type_Gateway_UnAnsweredCallConf
SIPCCMsg_Gateway_UnAnsweredCallConf::SIPCCMsg_Gateway_UnAnsweredCallConf()
{
	msgType = Type_Gateway_UnAnsweredCallConf;

	invokeId = "";
}

void SIPCCMsg_Gateway_UnAnsweredCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	invokeId = thebuf + theBufContent;	

	theBufContent += invokeId.length()+1;
}

int SIPCCMsg_Gateway_UnAnsweredCallConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_Gateway_UnAnsweredCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeId.length()+1;

	return memSize;
}

///Type_Gateway_UnAnsweredCallConf
void SIPCCMsg_UnAnsweredAgentCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	invokeId = thebuf + theBufContent;
	theBufContent += invokeId.length()+1;

}

int SIPCCMsg_UnAnsweredAgentCallConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);//invokeId
	theBufContent += invokeId.length()+1;	

	return theBufContent;
}

int SIPCCMsg_UnAnsweredAgentCallConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeId.length()+1;      //invokeId	

	return memSize;
}

///Type_Gateway_InsertDateOperationConf
void SIPCCMsg_Gateway_InsertDateOperationConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);
	invokeId = thebuf + theBufContent;

	theBufContent += invokeId.length()+1;

}
//
int SIPCCMsg_Gateway_InsertDateOperationConf::FillBuf(char*&  thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);//invokeId
	theBufContent += invokeId.length()+1;	

	return theBufContent;
}

int SIPCCMsg_Gateway_InsertDateOperationConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeId.length()+1;      //invokeId	

	return memSize;
}

//SIPCCMsg_Record_AgentTestStartRecord
SIPCCMsg_Record_AgentTestStartRecord::SIPCCMsg_Record_AgentTestStartRecord()
{
	msgType=Type_Record_AgentTestStartRecord;

	invokeID="";
	cSeq=0;
	PresideAgentAccount="";

}

void SIPCCMsg_Record_AgentTestStartRecord::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//invokeID
	invokeID=thebuf+theBufContent;
	theBufContent+=invokeID.length()+1; 

	//cSeq
	memmove(&this->cSeq,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);

	//PresideAgentAccount
	PresideAgentAccount=thebuf+theBufContent;
	theBufContent+=PresideAgentAccount.length()+1; 	
}

int SIPCCMsg_Record_AgentTestStartRecord::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);
	//invokeID
	memcpy(thebuf+theBufContent,invokeID.c_str(),invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	//cSeq
	memmove(thebuf+theBufContent,&this->cSeq,sizeof(int));
	theBufContent+=sizeof(int);
	//PresideAgentAccount
	memcpy(thebuf+theBufContent,PresideAgentAccount.c_str(),PresideAgentAccount.length()+1);
	theBufContent += PresideAgentAccount.length()+1;

	return theBufContent;
}

int SIPCCMsg_Record_AgentTestStartRecord::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += invokeID.length()+1;	
	memSize += sizeof(int);//cSeq
	memSize += PresideAgentAccount.length()+1;	
	return memSize;
}
//////////////
//////////////////////
//SIPCCMsg_Record_AgentTestStartRecordConf
SIPCCMsg_Record_AgentTestStartRecordConf::SIPCCMsg_Record_AgentTestStartRecordConf()
{
	msgType=Type_Record_AgentTestStartRecordConf;

	invokeID="";
	cSeq=0;
	PresideAgentAccount="";

}

void SIPCCMsg_Record_AgentTestStartRecordConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//invokeID
	invokeID=thebuf+theBufContent;
	theBufContent+=invokeID.length()+1; 	
	//cSeq
	memmove(&this->cSeq,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
	//PresideAgentAccount
	PresideAgentAccount=thebuf+theBufContent;
	theBufContent+=PresideAgentAccount.length()+1; 	
}

int SIPCCMsg_Record_AgentTestStartRecordConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);
	//invokeID
	memcpy(thebuf+theBufContent,invokeID.c_str(),invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	//cSeq
	memmove(thebuf+theBufContent,&this->cSeq,sizeof(int));
	theBufContent+=sizeof(int);
	//PresideAgentAccount
	memcpy(thebuf+theBufContent,PresideAgentAccount.c_str(),PresideAgentAccount.length()+1);
	theBufContent += PresideAgentAccount.length()+1;

	return theBufContent;
}

int SIPCCMsg_Record_AgentTestStartRecordConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += invokeID.length()+1;	
	memSize += sizeof(int);//cSeq
	memSize += PresideAgentAccount.length()+1;	
	return memSize;
}
//////////////
//////////////////////
//SIPCCMsg_Record_AgentTestStartPlayback
SIPCCMsg_Record_AgentTestStartPlayback::SIPCCMsg_Record_AgentTestStartPlayback()
{
	msgType=Type_Record_AgentTestStartPlayback;

	invokeID="";
	cSeq=0;
	PresideAgentAccount="";

}

void SIPCCMsg_Record_AgentTestStartPlayback::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//invokeID
	invokeID=thebuf+theBufContent;
	theBufContent+=invokeID.length()+1; 	
	//cSeq
	memmove(&this->cSeq,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
	//PresideAgentAccount
	PresideAgentAccount=thebuf+theBufContent;
	theBufContent+=PresideAgentAccount.length()+1; 	
}

int SIPCCMsg_Record_AgentTestStartPlayback::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);
	//invokeID
	memcpy(thebuf+theBufContent,invokeID.c_str(),invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	//cSeq
	memmove(thebuf+theBufContent,&this->cSeq,sizeof(int));
	theBufContent+=sizeof(int);
	//PresideAgentAccount
	memcpy(thebuf+theBufContent,PresideAgentAccount.c_str(),PresideAgentAccount.length()+1);
	theBufContent += PresideAgentAccount.length()+1;

	return theBufContent;
}

int SIPCCMsg_Record_AgentTestStartPlayback::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += invokeID.length()+1;	
	memSize += sizeof(int);//cSeq
	memSize += PresideAgentAccount.length()+1;	
	return memSize;
}
//////////////
//////////////////////
//SIPCCMsg_Record_AgentTestStartPlaybackConf
SIPCCMsg_Record_AgentTestStartPlaybackConf::SIPCCMsg_Record_AgentTestStartPlaybackConf()
{
	msgType=Type_Record_AgentTestStartPlaybackConf;

	invokeID="";
	cSeq=0;
	PresideAgentAccount="";

}

void SIPCCMsg_Record_AgentTestStartPlaybackConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent=AnalyzeMsgHead(thebuf);


	//invokeID
	invokeID=thebuf+theBufContent;
	theBufContent+=invokeID.length()+1; 	
	//cSeq
	memmove(&this->cSeq,thebuf+theBufContent,sizeof(int));
	theBufContent+=sizeof(int);
	//PresideAgentAccount
	PresideAgentAccount=thebuf+theBufContent;
	theBufContent+=PresideAgentAccount.length()+1; 	
}

int SIPCCMsg_Record_AgentTestStartPlaybackConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);
	//invokeID
	memcpy(thebuf+theBufContent,invokeID.c_str(),invokeID.length()+1);
	theBufContent += invokeID.length()+1;
	//cSeq
	memmove(thebuf+theBufContent,&this->cSeq,sizeof(int));
	theBufContent+=sizeof(int);
	//PresideAgentAccount
	memcpy(thebuf+theBufContent,PresideAgentAccount.c_str(),PresideAgentAccount.length()+1);
	theBufContent += PresideAgentAccount.length()+1;

	return theBufContent;
}

int SIPCCMsg_Record_AgentTestStartPlaybackConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += invokeID.length()+1;	
	memSize += sizeof(int);//cSeq
	memSize += PresideAgentAccount.length()+1;	
	return memSize;
}

///Type_Client_SendErrCodeInfo
SIPCCMsg_Client_SendErrCodeInfo::SIPCCMsg_Client_SendErrCodeInfo()
{
	msgType = Type_Client_SendErrCodeInfo;
	errcode=0;
}

void SIPCCMsg_Client_SendErrCodeInfo::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip, unsigned short port )
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//errcode
	memmove(&this->errcode, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//managerid
	managerid = thebuf+theBufContent;
	theBufContent += ( managerid.length() + 1 );

	//agentname
	agentname = thebuf+theBufContent;
	theBufContent += ( agentname.length() + 1 );
}

int SIPCCMsg_Client_SendErrCodeInfo::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//errcode
	memmove(thebuf+theBufContent, &this->errcode, sizeof(int));
	theBufContent += sizeof(int);

	//managerid
	memcpy(thebuf+theBufContent, managerid.c_str(), managerid.length() + 1 );
	theBufContent += ( managerid.length() + 1 );

	//agentname
	memcpy(thebuf+theBufContent, agentname.c_str(), agentname.length() + 1 );
	theBufContent += ( agentname.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_Client_SendErrCodeInfo::GetMyMemSize()
{
	int memSize = 2*sizeof(int);//msgclass+msgtype
	memSize += sizeof(int);			//errcode
	memSize += managerid.length() + 1;	//managerid
	memSize += agentname.length() + 1;	//agentname

	return memSize;
}

///Type_SysManage_LoadGWCorpInfoConf
SIPCCMsg_SysManage_LoadGWCorpInfoConf::SIPCCMsg_SysManage_LoadGWCorpInfoConf()
{
	msgType = Type_SysManage_LoadGWCorpInfoConf;
	
	invokeId = "";
}

void SIPCCMsg_SysManage_LoadGWCorpInfoConf::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip, unsigned short port )
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//invokeId
	invokeId = thebuf+theBufContent;
	theBufContent += ( invokeId.length() + 1 );
}

int SIPCCMsg_SysManage_LoadGWCorpInfoConf::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//invokeId
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1 );
	theBufContent += ( invokeId.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_SysManage_LoadGWCorpInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeId.length() + 1;	//invokeId

	return memSize;
}

///Type_SysManage_LoadConfigInfoConf
SIPCCMsg_SysManage_LoadConfigInfoConf::SIPCCMsg_SysManage_LoadConfigInfoConf()
{
	msgType = Type_SysManage_LoadConfigInfoConf;

	invokeId = "";
}

void SIPCCMsg_SysManage_LoadConfigInfoConf::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip, unsigned short port )
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	//invokeId
	invokeId = thebuf+theBufContent;
	theBufContent += ( invokeId.length() + 1 );
}

int SIPCCMsg_SysManage_LoadConfigInfoConf::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	//invokeId
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length() + 1 );
	theBufContent += ( invokeId.length() + 1 );

	return theBufContent;
}

int SIPCCMsg_SysManage_LoadConfigInfoConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += invokeId.length() + 1;	//invokeId

	return memSize;
}

////////////////////////////////////////////////////////////////////
// TTS Request
int SIPCCMsg_TTS_Request::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, sInvokeId.c_str(), sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	memcpy(thebuf+theBufContent, &nIndex, sizeof(int));
	theBufContent += sizeof(nIndex);

	memcpy(thebuf+theBufContent, &nType, sizeof(int));
	theBufContent += sizeof(nType);

	memcpy(thebuf+theBufContent, sRequestText.c_str(), sRequestText.length()+1);
	theBufContent += sRequestText.length()+1;

	return theBufContent;
}

void SIPCCMsg_TTS_Request::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	sInvokeId = thebuf + theBufContent;
	theBufContent += sInvokeId.length()+1;

	memmove(&nIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&nType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	sRequestText = thebuf + theBufContent;
	theBufContent += sRequestText.length()+1;
}

int SIPCCMsg_TTS_Request::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sInvokeId.length()+1;
	memSize +=sizeof(int);
	memSize +=sizeof(int);
	memSize += sRequestText.length()+1;

	return memSize;
}
// TTS Result
int SIPCCMsg_TTS_Result::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, sInvokeId.c_str(), sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	memcpy(thebuf+theBufContent, &nIndex, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, &nType, sizeof(int));
	theBufContent += sizeof(int);

	memcpy(thebuf+theBufContent, sPathFileName.c_str(), sPathFileName.length()+1);
	theBufContent += sPathFileName.length()+1;

	memcpy(thebuf+theBufContent, &bSuccess, sizeof(bool));
	theBufContent += sizeof(bool);

	return theBufContent;
}

void SIPCCMsg_TTS_Result::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	sInvokeId = thebuf + theBufContent;
	theBufContent += sInvokeId.length()+1;

	memmove(&nIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&nType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	sPathFileName = thebuf + theBufContent;
	theBufContent += sPathFileName.length()+1;

	memmove(&bSuccess, thebuf+theBufContent, sizeof(bool));
	theBufContent += sizeof(bool);
}

int SIPCCMsg_TTS_Result::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sInvokeId.length()+1;
	memSize +=sizeof(int);
	memSize +=sizeof(int);
	memSize += sPathFileName.length()+1;
	memSize +=sizeof(bool);

	return memSize;
}

// TTS Cancel
int SIPCCMsg_TTS_Cancel::FillBuf( char*& thebuf )
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memcpy(thebuf+theBufContent, sInvokeId.c_str(), sInvokeId.length()+1);
	theBufContent += sInvokeId.length()+1;

	memcpy(thebuf+theBufContent, &nIndex, sizeof(nIndex));
	theBufContent += sizeof(nIndex);

	return theBufContent;
}

void SIPCCMsg_TTS_Cancel::AnalyzeBuf( char* thebuf, int msgsize, unsigned long ip/*=0*/, unsigned short port/*=0*/ )
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	sInvokeId = thebuf + theBufContent;
	theBufContent += sInvokeId.length()+1;

	memmove(&nIndex, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_TTS_Cancel::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sInvokeId.length()+1;
	memSize +=sizeof(int);

	return memSize;
}


///Type_SysManage_AgentInfoChange
SIPCCMsg_SysManage_AgentInfoChange::SIPCCMsg_SysManage_AgentInfoChange()
{
	msgType = Type_SysManage_AgentInfoChange;
	cause = ForceLogoutCause_SwitchDept;
}

void SIPCCMsg_SysManage_AgentInfoChange::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{

	int theBufContent = AnalyzeMsgHead(thebuf);

	agentName = thebuf + theBufContent;
	theBufContent += ( agentName.length() + 1 );

	//cause
	memmove(&this->cause, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_SysManage_AgentInfoChange::FillBuf(char*&  thebuf)
{

	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove( thebuf + theBufContent, agentName.c_str(), agentName.length() + 1 );
	theBufContent += ( agentName.length() + 1 );

	//cause
	memmove(thebuf+theBufContent,&(this->cause), sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_SysManage_AgentInfoChange::GetMyMemSize()
{
	int memSize = 2*sizeof(int);			//msgclass+msgtype

	memSize += ( agentName.length() + 1 );		//agentName
	memSize += sizeof(int);						//cause

	return memSize;
}

///Type_Redirect_GetService
SIPCCMsg_Redirect_GetService::SIPCCMsg_Redirect_GetService()
{
	msgType=Type_Redirect_GetService;

	domainName = "";
	queryServiceList = "";
	identifyingCode = "";
	netPath = "";
	serviceType = 0;

}

void SIPCCMsg_Redirect_GetService::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//domainName
	domainName = thebuf+theBufContent;
	theBufContent += domainName.length()+1; 	

	//queryServiceList
	queryServiceList = thebuf+theBufContent;
	theBufContent += queryServiceList.length()+1; 

	//identifyingCode
	identifyingCode = thebuf+theBufContent;
	theBufContent += identifyingCode.length()+1; 	

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

	//serviceType
	memmove(&this->serviceType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Redirect_GetService::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//domainName
	memcpy(thebuf+theBufContent, domainName.c_str(), domainName.length()+1);
	theBufContent += domainName.length()+1;

	//queryServiceList
	memcpy(thebuf+theBufContent, queryServiceList.c_str(), queryServiceList.length()+1);
	theBufContent += queryServiceList.length()+1;

	//identifyingCode
	memcpy(thebuf+theBufContent, identifyingCode.c_str(), identifyingCode.length()+1);
	theBufContent += identifyingCode.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	//serviceType
	memmove(thebuf+theBufContent, &this->serviceType, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Redirect_GetService::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += domainName.length()+1;		//domainName
	memSize += queryServiceList.length()+1;	//queryServiceList
	memSize += identifyingCode.length()+1;	//identifyingCode
	memSize += netPath.length()+1;			//netPath
	memSize += sizeof(int);					//serviceType

	return memSize;
}

///Type_Redirect_GetServiceConf
SIPCCMsg_Redirect_GetServiceConf::SIPCCMsg_Redirect_GetServiceConf()
{
	msgType = Type_Redirect_GetServiceConf;

	serviceList = "";
	redisList = "";
	netPath = "";

}

void SIPCCMsg_Redirect_GetServiceConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//serviceList
	serviceList = thebuf+theBufContent;
	theBufContent += serviceList.length()+1; 	

	//redisList
	redisList = thebuf+theBufContent;
	theBufContent += redisList.length()+1; 	

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

}

int SIPCCMsg_Redirect_GetServiceConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//serviceList
	memcpy(thebuf+theBufContent, serviceList.c_str(), serviceList.length()+1);
	theBufContent += serviceList.length()+1;

	//redisList
	memcpy(thebuf+theBufContent, redisList.c_str(), redisList.length()+1);
	theBufContent += redisList.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_Redirect_GetServiceConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += serviceList.length()+1;		//serviceList
	memSize += redisList.length()+1;		//redisList
	memSize += netPath.length()+1;			//netPath

	return memSize;
}

///Type_CClient_Login
SIPCCMsg_CClient_Login::SIPCCMsg_CClient_Login()
{
	msgType = Type_CClient_Login;

	account = "";
	password = "";

}

void SIPCCMsg_CClient_Login::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//password
	password = thebuf+theBufContent;
	theBufContent += password.length()+1; 	

}

int SIPCCMsg_CClient_Login::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//password
	memcpy(thebuf+theBufContent, password.c_str(), password.length()+1);
	theBufContent += password.length()+1;

	return theBufContent;
}

int SIPCCMsg_CClient_Login::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;		//account
	memSize += password.length()+1;		//password

	return memSize;
}

///Type_CClient_HeartBeat
SIPCCMsg_CClient_HeartBeat::SIPCCMsg_CClient_HeartBeat()
{
	msgType = Type_CClient_HeartBeat;

	account = "";

	curState = -1;

}

void SIPCCMsg_CClient_HeartBeat::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 

	if(theBufContent == msgsize)
		return;

	//curState
	memmove(&this->curState, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_CClient_HeartBeat::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//curState
	memmove(thebuf+theBufContent, &(this->curState), sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_CClient_HeartBeat::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;		//account
	memSize += sizeof(int);				//curState

	return memSize;
}

///Type_CClient_CMakeCall
SIPCCMsg_CClient_CMakeCall::SIPCCMsg_CClient_CMakeCall()
{
	msgType = Type_CClient_CMakeCall;

	account = "";
	targetName = "";
	targetType = 0;
	callerNoForSend = "";
	uuiDate = "";
	
}

void SIPCCMsg_CClient_CMakeCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//targetName
	targetName = thebuf+theBufContent;
	theBufContent += targetName.length()+1; 

	//targetType
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1; 	

	//uuiDate
	uuiDate = thebuf+theBufContent;
	theBufContent += uuiDate.length()+1; 
	
}

int SIPCCMsg_CClient_CMakeCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//targetName
	memcpy(thebuf+theBufContent, targetName.c_str(), targetName.length()+1);
	theBufContent += targetName.length()+1;

	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);

	//callerNoForSend
	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;

	//uuiDate
	memcpy(thebuf+theBufContent, uuiDate.c_str(), uuiDate.length()+1);
	theBufContent += uuiDate.length()+1;

	return theBufContent;
}

int SIPCCMsg_CClient_CMakeCall::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;			//account
	memSize += targetName.length()+1;		//targetName
	memSize += sizeof(int);					//targetType
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += uuiDate.length()+1;			//uuiDate	

	return memSize;
}

///Type_CClient_CallArrived
SIPCCMsg_CClient_CallArrived::SIPCCMsg_CClient_CallArrived()
{
	msgType = Type_CClient_CallArrived;

	callID = "";
	callerName = "";
	calledName = "";
	calledNickname = "";
	netPath = "";

}

void SIPCCMsg_CClient_CallArrived::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

	//callerName
	callerName = thebuf+theBufContent;
	theBufContent += callerName.length()+1; 

	//calledName
	calledName = thebuf+theBufContent;
	theBufContent += calledName.length()+1; 

	//calledNickname
	calledNickname = thebuf+theBufContent;
	theBufContent += calledNickname.length()+1; 	

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

	if (theBufContent >= msgsize)
		return;

	//audioStreamDescription
	theBufContent += audioStreamDescription.Deserialize(thebuf + theBufContent, msgsize - theBufContent);
}

int SIPCCMsg_CClient_CallArrived::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//callerName
	memcpy(thebuf+theBufContent, callerName.c_str(), callerName.length()+1);
	theBufContent += callerName.length()+1;

	//calledName
	memcpy(thebuf+theBufContent, calledName.c_str(), calledName.length()+1);
	theBufContent += calledName.length()+1;

	//calledNickname
	memcpy(thebuf+theBufContent, calledNickname.c_str(), calledNickname.length()+1);
	theBufContent += calledNickname.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	//audioStreamDescription
	theBufContent += audioStreamDescription.Serialize(thebuf + theBufContent, audioStreamDescription.GetMemSize());

	return theBufContent;
}

int SIPCCMsg_CClient_CallArrived::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += callerName.length()+1;		//callerName
	memSize += calledName.length()+1;		//calledName
	memSize += calledNickname.length()+1;	//calledNickname
	memSize += netPath.length()+1;			//netPath	
	memSize += audioStreamDescription.GetMemSize();		//audioStreamDescription

	return memSize;
}

///Type_CClient_CallAnswered
SIPCCMsg_CClient_CallAnswered::SIPCCMsg_CClient_CallAnswered()
{
	msgType = Type_CClient_CallAnswered;

	callID = "";
	callerName = "";
	calledName = "";
	netPath = "";

}

void SIPCCMsg_CClient_CallAnswered::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

	//callerName
	callerName = thebuf+theBufContent;
	theBufContent += callerName.length()+1; 

	//calledName
	calledName = thebuf+theBufContent;
	theBufContent += calledName.length()+1;  	

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

}

int SIPCCMsg_CClient_CallAnswered::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//callerName
	memcpy(thebuf+theBufContent, callerName.c_str(), callerName.length()+1);
	theBufContent += callerName.length()+1;

	//calledName
	memcpy(thebuf+theBufContent, calledName.c_str(), calledName.length()+1);
	theBufContent += calledName.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_CClient_CallAnswered::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += callerName.length()+1;		//callerName
	memSize += calledName.length()+1;		//calledName
	memSize += netPath.length()+1;			//netPath	

	return memSize;
}

///Type_CClient_HangupCall
SIPCCMsg_CClient_HangupCall::SIPCCMsg_CClient_HangupCall()
{
	msgType = Type_CClient_HangupCall;

	account = "";
	targetName = "";
	targetType = 0;
	callID = "";

}

void SIPCCMsg_CClient_HangupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//targetName
	targetName = thebuf+theBufContent;
	theBufContent += targetName.length()+1; 

	//targetType
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

}

int SIPCCMsg_CClient_HangupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//targetName
	memcpy(thebuf+theBufContent, targetName.c_str(), targetName.length()+1);
	theBufContent += targetName.length()+1;

	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	return theBufContent;
}

int SIPCCMsg_CClient_HangupCall::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;			//account
	memSize += targetName.length()+1;		//targetName
	memSize += sizeof(int);					//targetType
	memSize += callID.length()+1;			//callID

	return memSize;
}

///Type_CClient_HangupCallConf
SIPCCMsg_CClient_HangupCallConf::SIPCCMsg_CClient_HangupCallConf()
{
	msgType = Type_CClient_HangupCallConf;

	callID = "";
	account = "";
	result = 0;
	
}

void SIPCCMsg_CClient_HangupCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//result
	memmove(&this->result, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_CClient_HangupCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//result
	memmove(thebuf+theBufContent, &this->result, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_CClient_HangupCallConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += account.length()+1;			//account
	memSize += sizeof(int);					//result

	return memSize;
}

///Type_Login_CCLoginConf
SIPCCMsg_Login_CCLoginConf::SIPCCMsg_Login_CCLoginConf()
{
	msgType = Type_Login_CCLoginConf;

	cause = "";
	loginResult = 0;

}

void SIPCCMsg_Login_CCLoginConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//cause
	cause = thebuf+theBufContent;
	theBufContent += cause.length()+1; 	

	//loginResult
	memmove(&this->loginResult, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_Login_CCLoginConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//cause
	memcpy(thebuf+theBufContent, cause.c_str(), cause.length()+1);
	theBufContent += cause.length()+1;

	//loginResult
	memmove(thebuf+theBufContent, &this->loginResult, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_Login_CCLoginConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += cause.length()+1;		//cause
	memSize += sizeof(int);				//loginResult

	return memSize;
}

///Type_CProxy_HeartBeatConf
SIPCCMsg_CProxy_HeartBeatConf::SIPCCMsg_CProxy_HeartBeatConf()
{
	msgType = Type_CProxy_HeartBeatConf;

	account = "";

}

void SIPCCMsg_CProxy_HeartBeatConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

}

int SIPCCMsg_CProxy_HeartBeatConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_HeartBeatConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;		//account

	return memSize;
}

///Type_CProxy_CMakeCallConf
SIPCCMsg_CProxy_CMakeCallConf::SIPCCMsg_CProxy_CMakeCallConf()
{
	msgType = Type_CProxy_CMakeCallConf;

	account = "";
	result = -1;
	cause = "";

}

void SIPCCMsg_CProxy_CMakeCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//result
	memmove(&this->result, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//cause
	cause = thebuf+theBufContent;
	theBufContent += cause.length()+1; 	

}

int SIPCCMsg_CProxy_CMakeCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//result
	memmove(thebuf+theBufContent, &this->result, sizeof(int));
	theBufContent += sizeof(int);

	//cause
	memcpy(thebuf+theBufContent, cause.c_str(), cause.length()+1);
	theBufContent += cause.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CMakeCallConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;			//account
	memSize += sizeof(int);					//result
	memSize += cause.length()+1;			//cause	

	return memSize;
}

///Type_CProxy_CMakeCall
SIPCCMsg_CProxy_CMakeCall::SIPCCMsg_CProxy_CMakeCall()
{
	msgType = Type_CProxy_CMakeCall;

	account = "";
	targetName = "";
	targetType = 0;
	callerNoForSend = "";
	uuiDate = "";
	netPath = "";

	targetPosition = "";

}

void SIPCCMsg_CProxy_CMakeCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//targetName
	targetName = thebuf+theBufContent;
	theBufContent += targetName.length()+1; 

	//targetType
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1; 	

	//uuiDate
	uuiDate = thebuf+theBufContent;
	theBufContent += uuiDate.length()+1; 

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

	if(theBufContent >= msgsize)
		return;

	//targetPosition
	targetPosition = thebuf+theBufContent;
	theBufContent += targetPosition.length()+1; 

}

int SIPCCMsg_CProxy_CMakeCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//targetName
	memcpy(thebuf+theBufContent, targetName.c_str(), targetName.length()+1);
	theBufContent += targetName.length()+1;

	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);

	//callerNoForSend
	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;

	//uuiDate
	memcpy(thebuf+theBufContent, uuiDate.c_str(), uuiDate.length()+1);
	theBufContent += uuiDate.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	//targetPosition
	memcpy(thebuf+theBufContent, targetPosition.c_str(), targetPosition.length()+1);
	theBufContent += targetPosition.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CMakeCall::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;			//account
	memSize += targetName.length()+1;		//targetName
	memSize += sizeof(int);					//targetType
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += uuiDate.length()+1;			//uuiDate
	memSize += netPath.length()+1;			//netPath
	memSize += targetPosition.length() + 1;	//targetPosition

	return memSize;
}

///Type_CProxy_CallDelivered
SIPCCMsg_CProxy_CallDelivered::SIPCCMsg_CProxy_CallDelivered()
{
	msgType = Type_CProxy_CallDelivered;

	callID = "";
	callerName = "";
	keyword = "";
	uuiDate = "";
	netPath = "";

}

void SIPCCMsg_CProxy_CallDelivered::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

	//callerName
	callerName = thebuf+theBufContent;
	theBufContent += callerName.length()+1; 

	//keyword
	keyword = thebuf+theBufContent;
	theBufContent += keyword.length()+1; 	

	//uuiDate
	uuiDate = thebuf+theBufContent;
	theBufContent += uuiDate.length()+1; 

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

}

int SIPCCMsg_CProxy_CallDelivered::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//callerName
	memcpy(thebuf+theBufContent, callerName.c_str(), callerName.length()+1);
	theBufContent += callerName.length()+1;

	//keyword
	memcpy(thebuf+theBufContent, keyword.c_str(), keyword.length()+1);
	theBufContent += keyword.length()+1;

	//uuiDate
	memcpy(thebuf+theBufContent, uuiDate.c_str(), uuiDate.length()+1);
	theBufContent += uuiDate.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CallDelivered::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += callerName.length()+1;		//callerName
	memSize += keyword.length()+1;			//keyword
	memSize += uuiDate.length()+1;			//uuiDate
	memSize += netPath.length()+1;			//netPath

	return memSize;
}

///Type_CProxy_CallArrived
SIPCCMsg_CProxy_CallArrived::SIPCCMsg_CProxy_CallArrived()
{
	msgType = Type_CProxy_CallArrived;

	callID = "";
	callerName = "";
	calledName = "";
	calledNickname = "";
	netPath = "";

}

void SIPCCMsg_CProxy_CallArrived::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

	//callerName
	callerName = thebuf+theBufContent;
	theBufContent += callerName.length()+1; 

	//calledName
	calledName = thebuf+theBufContent;
	theBufContent += calledName.length()+1; 

	//calledNickname
	calledNickname = thebuf+theBufContent;
	theBufContent += calledNickname.length()+1; 	

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

}

int SIPCCMsg_CProxy_CallArrived::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//callerName
	memcpy(thebuf+theBufContent, callerName.c_str(), callerName.length()+1);
	theBufContent += callerName.length()+1;

	//calledName
	memcpy(thebuf+theBufContent, calledName.c_str(), calledName.length()+1);
	theBufContent += calledName.length()+1;

	//calledNickname
	memcpy(thebuf+theBufContent, calledNickname.c_str(), calledNickname.length()+1);
	theBufContent += calledNickname.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CallArrived::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += callerName.length()+1;		//callerName
	memSize += calledName.length()+1;		//calledName
	memSize += calledNickname.length()+1;	//calledNickname
	memSize += netPath.length()+1;			//netPath	

	return memSize;
}

///Type_CProxy_CallAnswered
SIPCCMsg_CProxy_CallAnswered::SIPCCMsg_CProxy_CallAnswered()
{
	msgType = Type_CProxy_CallAnswered;

	callID = "";
	callerName = "";
	calledName = "";

}

void SIPCCMsg_CProxy_CallAnswered::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

	//callerName
	callerName = thebuf+theBufContent;
	theBufContent += callerName.length()+1; 

	//calledName
	calledName = thebuf+theBufContent;
	theBufContent += calledName.length()+1;  	 

}

int SIPCCMsg_CProxy_CallAnswered::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//callerName
	memcpy(thebuf+theBufContent, callerName.c_str(), callerName.length()+1);
	theBufContent += callerName.length()+1;

	//calledName
	memcpy(thebuf+theBufContent, calledName.c_str(), calledName.length()+1);
	theBufContent += calledName.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CallAnswered::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += callerName.length()+1;		//callerName
	memSize += calledName.length()+1;		//calledName	

	return memSize;
}

///Type_CProxy_CallStart
SIPCCMsg_CProxy_CallStart::SIPCCMsg_CProxy_CallStart()
{
	msgType = Type_CProxy_CallStart;

	callID = "";
	callerName = "";
	netPath = "";

}

void SIPCCMsg_CProxy_CallStart::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

	//callerName
	callerName = thebuf+theBufContent;
	theBufContent += callerName.length()+1; 

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

}

int SIPCCMsg_CProxy_CallStart::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//callerName
	memcpy(thebuf+theBufContent, callerName.c_str(), callerName.length()+1);
	theBufContent += callerName.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CallStart::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += callerName.length()+1;		//callerName
	memSize += netPath.length()+1;			//netPath	

	return memSize;
}

///Type_CProxy_QueryGW
SIPCCMsg_CProxy_QueryGW::SIPCCMsg_CProxy_QueryGW()
{
	msgType = Type_CProxy_QueryGW;

	callerName = "";
	callerNoForSend = "";

	sPrefix = "";
	sPhoneNum = "";
	sAreaCode = "";
	iMatchResult = 0;  

}

void SIPCCMsg_CProxy_QueryGW::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callerName
	callerName = thebuf+theBufContent;
	theBufContent += callerName.length()+1; 

	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1; 

	if ( theBufContent >= msgsize)
	{
		return;
	}

	//sPrefix
	sPrefix = thebuf+theBufContent;
	theBufContent += (sPrefix.length()+1);

	//sPhoneNum
	sPhoneNum = thebuf+theBufContent;
	theBufContent += (sPhoneNum.length()+1);

	//sAreaCode
	sAreaCode = thebuf+theBufContent;
	theBufContent += (sAreaCode.length()+1);

	//iMatchResult
	memmove(&this->iMatchResult, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_CProxy_QueryGW::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callerName
	memcpy(thebuf+theBufContent, callerName.c_str(), callerName.length()+1);
	theBufContent += callerName.length()+1;

	//callerNoForSend
	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;

	//sPrefix
	memmove(thebuf+theBufContent, this->sPrefix.c_str(), this->sPrefix.length()+1);
	theBufContent += (this->sPrefix.length()+1);

	//sPhoneNum
	memmove(thebuf+theBufContent, this->sPhoneNum.c_str(), this->sPhoneNum.length()+1);
	theBufContent += (this->sPhoneNum.length()+1);

	//sAreaCode
	memmove(thebuf+theBufContent, this->sAreaCode.c_str(), this->sAreaCode.length()+1);
	theBufContent += (this->sAreaCode.length()+1);

	//iMatchResult
	memmove(thebuf+theBufContent, &this->iMatchResult, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_CProxy_QueryGW::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callerName.length()+1;			//callerName
	memSize += callerNoForSend.length()+1;		//callerNoForSend	

	memSize += (this->sPrefix.length() + 1);	//sPrefix
	memSize += (this->sPhoneNum.length() + 1);	//sPhoneNum
	memSize += (this->sAreaCode.length() + 1);	//sAreaCode
	memSize += sizeof(int);						//iMatchResult

	return memSize;
}

///Type_CProxy_CMakeCall2
SIPCCMsg_CProxy_CMakeCall2::SIPCCMsg_CProxy_CMakeCall2()
{
	msgType = Type_CProxy_CMakeCall2;

	callID = "";
	account = "";
	targetName = "";
	targetType = 0;
	uuiDate = "";
	nickname = "";
	callerNoForSend = "";
	invokeID = "";
	netPath = "";

	targetPosition = "";

}

void SIPCCMsg_CProxy_CMakeCall2::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//targetName
	targetName = thebuf+theBufContent;
	theBufContent += targetName.length()+1; 

	//targetType
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//uuiDate
	uuiDate = thebuf+theBufContent;
	theBufContent += uuiDate.length()+1;

	//nickname
	nickname = thebuf+theBufContent;
	theBufContent += nickname.length()+1;

	//callerNoForSend
	callerNoForSend = thebuf+theBufContent;
	theBufContent += callerNoForSend.length()+1; 	

	//invokeID
	invokeID = thebuf+theBufContent;
	theBufContent += invokeID.length()+1;  

	//netPath
	netPath = thebuf+theBufContent;
	theBufContent += netPath.length()+1; 

	if(theBufContent >= msgsize)
		return;

	//targetPosition
	targetPosition = thebuf+theBufContent;
	theBufContent += targetPosition.length()+1;

}

int SIPCCMsg_CProxy_CMakeCall2::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//targetName
	memcpy(thebuf+theBufContent, targetName.c_str(), targetName.length()+1);
	theBufContent += targetName.length()+1;

	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);

	//uuiDate
	memcpy(thebuf+theBufContent, uuiDate.c_str(), uuiDate.length()+1);
	theBufContent += uuiDate.length()+1;

	//nickname
	memcpy(thebuf+theBufContent, nickname.c_str(), nickname.length()+1);
	theBufContent += nickname.length()+1;

	//callerNoForSend
	memcpy(thebuf+theBufContent, callerNoForSend.c_str(), callerNoForSend.length()+1);
	theBufContent += callerNoForSend.length()+1;

	//invokeID
	memcpy(thebuf+theBufContent, invokeID.c_str(), invokeID.length()+1);
	theBufContent += invokeID.length()+1;

	//netPath
	memcpy(thebuf+theBufContent, netPath.c_str(), netPath.length()+1);
	theBufContent += netPath.length()+1;

	//targetPosition
	memcpy(thebuf+theBufContent, targetPosition.c_str(), targetPosition.length()+1);
	theBufContent += targetPosition.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CMakeCall2::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += account.length()+1;			//account
	memSize += targetName.length()+1;		//targetName
	memSize += sizeof(int);					//targetType
	memSize += uuiDate.length()+1;			//uuiDate
	memSize += nickname.length()+1;			//nickname
	memSize += callerNoForSend.length()+1;	//callerNoForSend
	memSize += invokeID.length()+1;			//invokeID
	memSize += netPath.length()+1;			//netPath
	memSize += targetPosition.length()+1;	//targetPosition

	return memSize;
}

///Type_CProxy_HangupCall
SIPCCMsg_CProxy_HangupCall::SIPCCMsg_CProxy_HangupCall()
{
	msgType = Type_CProxy_HangupCall;

	account = "";
	targetName = "";
	targetType = 0;
	callID = "";

}

void SIPCCMsg_CProxy_HangupCall::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//targetName
	targetName = thebuf+theBufContent;
	theBufContent += targetName.length()+1; 

	//targetType
	memmove(&this->targetType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 	

}

int SIPCCMsg_CProxy_HangupCall::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//targetName
	memcpy(thebuf+theBufContent, targetName.c_str(), targetName.length()+1);
	theBufContent += targetName.length()+1;

	//targetType
	memmove(thebuf+theBufContent, &this->targetType, sizeof(int));
	theBufContent += sizeof(int);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_HangupCall::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += account.length()+1;			//account
	memSize += targetName.length()+1;		//targetName
	memSize += sizeof(int);					//targetType
	memSize += callID.length()+1;			//callID

	return memSize;
}

///Type_CProxy_HangupCallConf
SIPCCMsg_CProxy_HangupCallConf::SIPCCMsg_CProxy_HangupCallConf()
{
	msgType = Type_CProxy_HangupCallConf;

	callID = "";
	account = "";

}

void SIPCCMsg_CProxy_HangupCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

}

int SIPCCMsg_CProxy_HangupCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_HangupCallConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += account.length()+1;			//account

	return memSize;
}

///Type_CProxy_CallHanguped
SIPCCMsg_CProxy_CallHanguped::SIPCCMsg_CProxy_CallHanguped()
{
	msgType = Type_CProxy_CallHanguped;

	callID = "";
	account = "";
	userName = "";

}

void SIPCCMsg_CProxy_CallHanguped::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 	

	//userName
	userName = thebuf+theBufContent;
	theBufContent += userName.length()+1; 

}

int SIPCCMsg_CProxy_CallHanguped::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	//userName
	memcpy(thebuf+theBufContent, userName.c_str(), userName.length()+1);
	theBufContent += userName.length()+1;

	return theBufContent;
}

int SIPCCMsg_CProxy_CallHanguped::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += account.length()+1;			//account
	memSize += userName.length()+1;			//userName

	return memSize;
}

///Type_SysManage_RefreshRedis
SIPCCMsg_SysManage_RefreshRedis::SIPCCMsg_SysManage_RefreshRedis()
{
	msgType = Type_SysManage_RefreshRedis;

	invokeId = "";
	ACDServerList = "";
	corpList = "";
	forceRefresh = 0;	

}

void SIPCCMsg_SysManage_RefreshRedis::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//invokeId
	invokeId = thebuf+theBufContent;
	theBufContent += invokeId.length()+1; 	

	//ACDServerList
	ACDServerList = thebuf+theBufContent;
	theBufContent += ACDServerList.length()+1; 

	//corpList
	corpList = thebuf+theBufContent;
	theBufContent += corpList.length()+1; 	

	//forceRefresh
	memmove(&this->forceRefresh, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

}

int SIPCCMsg_SysManage_RefreshRedis::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//invokeId
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	//ACDServerList
	memcpy(thebuf+theBufContent, ACDServerList.c_str(), ACDServerList.length()+1);
	theBufContent += ACDServerList.length()+1;

	//corpList
	memcpy(thebuf+theBufContent, corpList.c_str(), corpList.length()+1);
	theBufContent += corpList.length()+1;

	//forceRefresh
	memmove(thebuf+theBufContent, &this->forceRefresh, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_SysManage_RefreshRedis::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += invokeId.length()+1;			//invokeId
	memSize += ACDServerList.length()+1;	//ACDServerList
	memSize += corpList.length()+1;			//corpList
	memSize += sizeof(int);					//forceRefresh

	return memSize;
}

///Type_SysManage_RefreshRedisConf
SIPCCMsg_SysManage_RefreshRedisConf::SIPCCMsg_SysManage_RefreshRedisConf()
{
	msgType = Type_SysManage_RefreshRedisConf;

	invokeId = "";

}

void SIPCCMsg_SysManage_RefreshRedisConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//invokeId
	invokeId = thebuf+theBufContent;
	theBufContent += invokeId.length()+1;

}

int SIPCCMsg_SysManage_RefreshRedisConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//invokeId
	memcpy(thebuf+theBufContent, invokeId.c_str(), invokeId.length()+1);
	theBufContent += invokeId.length()+1;

	return theBufContent;
}

int SIPCCMsg_SysManage_RefreshRedisConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += invokeId.length()+1;			//invokeId

	return memSize;
}

//HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH
//void SIPCCMsg_RouteSelect_Register::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
//{
//	int theBufContent = AnalyzeMsgHead(thebuf);
//
//	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(&this->Id, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(&this->Type, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(&this->Ip, thebuf+theBufContent, sizeof(unsigned long));
//	theBufContent += sizeof(unsigned long);
//
//	memmove(&this->MainPort, thebuf+theBufContent, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//
//	memmove(&this->TestPort, thebuf+theBufContent, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//}
//
//int SIPCCMsg_RouteSelect_Register::FillBuf(char*& thebuf)
//{
//	thebuf = new char[GetMyMemSize()];
//	int theBufContent = FillMsgHead(thebuf);
//
//	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(thebuf+theBufContent, &this->Id, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(thebuf+theBufContent, &this->Type, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(thebuf+theBufContent, &this->Ip, sizeof(unsigned long));
//	theBufContent += sizeof(unsigned long);
//
//	memmove(thebuf+theBufContent, &this->MainPort, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//
//	memmove(thebuf+theBufContent, &this->TestPort, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//
//	return theBufContent;
//}
//
//int SIPCCMsg_RouteSelect_Register::GetMyMemSize()
//{
//	int memSize = 2*sizeof(int);		//msgclass+msgtype
//
//	memSize += sizeof(int);
//	memSize += sizeof(int);
//	memSize += sizeof(int);
//	memSize += sizeof(unsigned long);
//	memSize += sizeof(unsigned short);
//	memSize += sizeof(unsigned short);
//	return memSize;
//}
//
//void SIPCCMsg_RouteSelect_AddGw::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
//{
//	int theBufContent = AnalyzeMsgHead(thebuf);
//
//	memmove(&this->Id, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(&this->Type, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(&this->Ip, thebuf+theBufContent, sizeof(unsigned long));
//	theBufContent += sizeof(unsigned long);
//
//	memmove(&this->MainPort, thebuf+theBufContent, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//
//	memmove(&this->TestPort, thebuf+theBufContent, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//}
//
//int SIPCCMsg_RouteSelect_AddGw::FillBuf(char*& thebuf)
//{
//	thebuf = new char[GetMyMemSize()];
//	int theBufContent = FillMsgHead(thebuf);
//
//	memmove(thebuf+theBufContent, &this->Id, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(thebuf+theBufContent, &this->Type, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(thebuf+theBufContent, &this->Ip, sizeof(unsigned long));
//	theBufContent += sizeof(unsigned long);
//
//	memmove(thebuf+theBufContent, &this->MainPort, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//
//	memmove(thebuf+theBufContent, &this->TestPort, sizeof(unsigned short));
//	theBufContent += sizeof(unsigned short);
//
//	return theBufContent;
//}
//
//int SIPCCMsg_RouteSelect_AddGw::GetMyMemSize()
//{
//	int memSize = 2*sizeof(int);		//msgclass+msgtype
//
//	memSize += sizeof(int);
//	memSize += sizeof(int);
//	memSize += sizeof(unsigned long);
//	memSize += sizeof(unsigned short);
//	memSize += sizeof(unsigned short);
//	return memSize;
//}
//
//void SIPCCMsg_RouteSelect_RegisterConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
//{
//	int theBufContent = AnalyzeMsgHead(thebuf);
//
//	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	int count;
//	memmove(&count, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	for (int i = 0; i < count; i++)
//	{
//		S_RouteSelect_Node node;
//		int id;
//
//		memmove(&id, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.Id, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.Ip, thebuf+theBufContent, sizeof(unsigned long));
//		theBufContent += sizeof(unsigned long);
//
//		memmove(&node.MainPort, thebuf+theBufContent, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//
//		memmove(&node.TestPort, thebuf+theBufContent, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//
//		OtherServerMap[id] = node;
//	}
//
//	memmove(&count, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	for (int i = 0; i < count; i++)
//	{
//		S_RouteSelect_Node node;
//		int id;
//
//		memmove(&id, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.Id, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.Ip, thebuf+theBufContent, sizeof(unsigned long));
//		theBufContent += sizeof(unsigned long);
//
//		memmove(&node.MainPort, thebuf+theBufContent, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//
//		memmove(&node.TestPort, thebuf+theBufContent, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//
//		GatewayMap[id] = node;
//	}
//}
//
//int SIPCCMsg_RouteSelect_RegisterConf::FillBuf(char*& thebuf)
//{
//	thebuf = new char[GetMyMemSize()];
//	int theBufContent = FillMsgHead(thebuf);
//
//	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
//	theBufContent += sizeof(int);
//
//	int iSize = OtherServerMap.size();
//	memmove(thebuf+theBufContent, &iSize, sizeof(int));
//	theBufContent += sizeof(int);
//
//	for (map<int, S_RouteSelect_Node>::iterator it = OtherServerMap.begin()
//		; it != OtherServerMap.end(); ++it)
//	{
//		int Id = it->first;
//		S_RouteSelect_Node& node = it->second;
//
//		memmove(thebuf+theBufContent, &Id, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.Id, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.Ip, sizeof(unsigned long));
//		theBufContent += sizeof(unsigned long);
//
//		memmove(thebuf+theBufContent, &node.MainPort, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//
//		memmove(thebuf+theBufContent, &node.TestPort, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//	}
//
//	iSize = GatewayMap.size();
//	memmove(thebuf+theBufContent, &iSize, sizeof(int));
//	theBufContent += sizeof(int);
//
//	for (map<int, S_RouteSelect_Node>::iterator it = GatewayMap.begin()
//		; it != GatewayMap.end(); ++it)
//	{
//		S_RouteSelect_Node node = it->second;
//		int Id = it->first;
//
//		memmove(thebuf+theBufContent, &Id, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.Id, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.Ip, sizeof(unsigned long));
//		theBufContent += sizeof(unsigned long);
//
//		memmove(thebuf+theBufContent, &node.MainPort, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//
//		memmove(thebuf+theBufContent, &node.TestPort, sizeof(unsigned short));
//		theBufContent += sizeof(unsigned short);
//	}
//
//	return theBufContent;
//}
//
//int SIPCCMsg_RouteSelect_RegisterConf::GetMyMemSize()
//{
//	int memSize = 2*sizeof(int);		//msgclass+msgtype
//
//	memSize += sizeof(int);
//
//	memSize += sizeof(int);
//
//	memSize += sizeof(int) * OtherServerMap.size();
//	memSize += sizeof(int) * OtherServerMap.size();
//	memSize += sizeof(int) * OtherServerMap.size();
//	memSize += sizeof(unsigned long) * OtherServerMap.size();
//	memSize += sizeof(unsigned short) * OtherServerMap.size();
//	memSize += sizeof(unsigned short) * OtherServerMap.size();
//
//	memSize += sizeof(int);
//
//	memSize += sizeof(int) * GatewayMap.size();
//	memSize += sizeof(int) * GatewayMap.size();
//	memSize += sizeof(int) * GatewayMap.size();
//	memSize += sizeof(unsigned long) * GatewayMap.size();
//	memSize += sizeof(unsigned short) * GatewayMap.size();
//	memSize += sizeof(unsigned short) * GatewayMap.size();
//
//	return memSize;
//}
//
//void SIPCCMsg_RouteSelect_NetTestReport::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
//{
//	int theBufContent = AnalyzeMsgHead(thebuf);
//
//	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(&this->Id, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	int count;
//	memmove(&count, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//
//	for (int i = 0; i < count; i++)
//	{
//		int destId;
//		S_RouteSelect_TestReportNode node;
//
//		memmove(&destId, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.LocalId, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.DestId, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.LostRate, thebuf+theBufContent, sizeof(double));
//		theBufContent += sizeof(double);
//
//		memmove(&node.DelayAvg, thebuf+theBufContent, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(&node.DelayVariance, thebuf+theBufContent, sizeof(double));
//		theBufContent += sizeof(double);
//
//		ReportMap[destId] = node;
//	}
//}
//
//int SIPCCMsg_RouteSelect_NetTestReport::FillBuf(char*& thebuf)
//{
//	thebuf = new char[GetMyMemSize()];
//	int theBufContent = FillMsgHead(thebuf);
//
//	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
//	theBufContent += sizeof(int);
//
//	memmove(thebuf+theBufContent, &this->Id, sizeof(int));
//	theBufContent += sizeof(int);
//
//	int iSize = ReportMap.size();
//	memmove(thebuf+theBufContent, &iSize, sizeof(int));
//	theBufContent += sizeof(int);
//
//	for (map<int, S_RouteSelect_TestReportNode>::iterator it = ReportMap.begin()
//		; it != ReportMap.end(); ++it)
//	{
//		int id = it->first;
//		S_RouteSelect_TestReportNode node = it->second;
//
//		memmove(thebuf+theBufContent, &id, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.LocalId, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.DestId, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.LostRate, sizeof(double));
//		theBufContent += sizeof(double);
//
//		memmove(thebuf+theBufContent, &node.DelayAvg, sizeof(int));
//		theBufContent += sizeof(int);
//
//		memmove(thebuf+theBufContent, &node.DelayVariance, sizeof(double));
//		theBufContent += sizeof(double);
//	}
//
//	return theBufContent;
//}
//
//int SIPCCMsg_RouteSelect_NetTestReport::GetMyMemSize()
//{
//	int memSize = 2*sizeof(int);		//msgclass+msgtype
//
//	memSize += sizeof(int);
//	memSize += sizeof(int);
//
//	memSize += sizeof(int);
//	memSize += sizeof(int) * ReportMap.size();
//	memSize += sizeof(int) * ReportMap.size();
//	memSize += sizeof(int) * ReportMap.size();
//	memSize += sizeof(int) * ReportMap.size();
//	memSize += sizeof(double) * ReportMap.size();
//	memSize += sizeof(int) * ReportMap.size();
//	memSize += sizeof(double) * ReportMap.size();
//
//	return memSize;
//}
//
//void SIPCCMsg_RouteSelect_NetTestReportConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
//{
//	int theBufContent = AnalyzeMsgHead(thebuf);
//
//	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
//	theBufContent += sizeof(int);
//}
//
//int SIPCCMsg_RouteSelect_NetTestReportConf::FillBuf(char*& thebuf)
//{
//	thebuf = new char[GetMyMemSize()];
//	int theBufContent = FillMsgHead(thebuf);
//
//	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
//	theBufContent += sizeof(int);
//
//	return theBufContent;
//}
//
//int SIPCCMsg_RouteSelect_NetTestReportConf::GetMyMemSize()
//{
//	int memSize = 2*sizeof(int);		//msgclass+msgtype
//
//	memSize += sizeof(int);
//
//	return memSize;
//}

void SIPCCMsg_RouteSelect_RouteSelect::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	CallId = thebuf + theBufContent;
	theBufContent += (CallId.length() + 1);

	memmove(&this->DestGwId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	int count;
	memmove(&count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	for (int i = 0; i < count; i++)
	{
		int destId;
		S_RouteSelect_TestReportNode node;

		memmove(&destId, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.LocalId, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.DestId, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.LostRate, thebuf+theBufContent, sizeof(double));
		theBufContent += sizeof(double);

		memmove(&node.DelayAvg, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.DelayVariance, thebuf+theBufContent, sizeof(double));
		theBufContent += sizeof(double);

		ReportMap[destId] = node;
	}
}

int SIPCCMsg_RouteSelect_RouteSelect::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, CallId.c_str(), CallId.length()+1);
	theBufContent += CallId.length()+1;

	memmove(thebuf+theBufContent, &this->DestGwId, sizeof(int));
	theBufContent += sizeof(int);

	int iSize = ReportMap.size();
	memmove(thebuf+theBufContent, &iSize, sizeof(int));
	theBufContent += sizeof(int);

	for (map<int, S_RouteSelect_TestReportNode>::iterator it = ReportMap.begin()
		; it != ReportMap.end(); ++it)
	{
		int id = it->first;
		S_RouteSelect_TestReportNode node = it->second;

		memmove(thebuf+theBufContent, &id, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.LocalId, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.DestId, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.LostRate, sizeof(double));
		theBufContent += sizeof(double);

		memmove(thebuf+theBufContent, &node.DelayAvg, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.DelayVariance, sizeof(double));
		theBufContent += sizeof(double);
	}

	return theBufContent;
}

int SIPCCMsg_RouteSelect_RouteSelect::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += CallId.length() + 1;
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int) * ReportMap.size();
	memSize += sizeof(int) * ReportMap.size();
	memSize += sizeof(int) * ReportMap.size();
	memSize += sizeof(int) * ReportMap.size();
	memSize += sizeof(double) * ReportMap.size();
	memSize += sizeof(int) * ReportMap.size();
	memSize += sizeof(double) * ReportMap.size();

	return memSize;
}

void SIPCCMsg_RouteSelect_RouteSelectConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	int count;
	memmove(&count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	for (int i = 0; i < count; i++)
	{
// 		int id;
// 		memmove(&id, thebuf+theBufContent, sizeof(int));
// 		theBufContent += sizeof(int);
// 		RouteList.push_back(id);

		S_RouteSelect_Node node;
		
		memmove(&node.Id, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(&node.Ip, thebuf+theBufContent, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);
		
		memmove(&node.MainPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
		
		memmove(&node.TestPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
		
		RouteList.push_back(node);
	}
}

int SIPCCMsg_RouteSelect_RouteSelectConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	int iSize = RouteList.size();
	memmove(thebuf+theBufContent, &iSize, sizeof(int));
	theBufContent += sizeof(int);

	for (list<S_RouteSelect_Node>::iterator it = RouteList.begin(); it != RouteList.end(); ++it)
	{
// 		int id = *it; 
// 		memmove(thebuf+theBufContent, &id, sizeof(int));
// 		theBufContent += sizeof(int);

		S_RouteSelect_Node& node = *it;
		
		memmove(thebuf+theBufContent, &node.Id, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
		theBufContent += sizeof(int);
		
		memmove(thebuf+theBufContent, &node.Ip, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);
		
		memmove(thebuf+theBufContent, &node.MainPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
		
		memmove(thebuf+theBufContent, &node.TestPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
	}

	return theBufContent;
}

int SIPCCMsg_RouteSelect_RouteSelectConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += sizeof(int);
	//memSize += sizeof(int) * RouteList.size();

	memSize += sizeof(int) * RouteList.size();
	memSize += sizeof(int) * RouteList.size();
	memSize += sizeof(unsigned long) * RouteList.size();
	memSize += sizeof(unsigned short) * RouteList.size();
	memSize += sizeof(unsigned short) * RouteList.size();

	return memSize;
}

void SIPCCMsg_RouteSelect_RouteRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	CallId = thebuf + theBufContent;
	theBufContent += (CallId.length() + 1);

	memmove(&this->DestType, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->GwIp, thebuf+theBufContent, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(&this->GwPort, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	int count;
	memmove(&count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	for (int i = 0; i < count; i++)
	{
		S_RouteSelect_Node node;

		memmove(&node.Id, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.Ip, thebuf+theBufContent, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);

		memmove(&node.MainPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);

		memmove(&node.TestPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);

		OtherServerList.push_back(node);
	}

}

int SIPCCMsg_RouteSelect_RouteRequest::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, CallId.c_str(), CallId.length()+1);
	theBufContent += CallId.length()+1;

	memmove(thebuf+theBufContent, &this->DestType, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->GwIp, sizeof(unsigned long));
	theBufContent += sizeof(unsigned long);

	memmove(thebuf+theBufContent, &this->GwPort, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	int iSize = OtherServerList.size();
	memmove(thebuf+theBufContent, &iSize, sizeof(int));
	theBufContent += sizeof(int);

	for (list<S_RouteSelect_Node>::iterator it = OtherServerList.begin()
		; it != OtherServerList.end(); ++it)
	{
		S_RouteSelect_Node& node = *it;

		memmove(thebuf+theBufContent, &node.Id, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.Ip, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);

		memmove(thebuf+theBufContent, &node.MainPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);

		memmove(thebuf+theBufContent, &node.TestPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
	}

	return theBufContent;
}

int SIPCCMsg_RouteSelect_RouteRequest::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += CallId.length() + 1;
	memSize += sizeof(int);
	memSize += sizeof(unsigned long);
	memSize += sizeof(unsigned short);

	memSize += sizeof(int);
//	memSize += sizeof(int) * OtherServerList.size();
	memSize += sizeof(int) * OtherServerList.size();
	memSize += sizeof(int) * OtherServerList.size();
	memSize += sizeof(unsigned long) * OtherServerList.size();
	memSize += sizeof(unsigned short) * OtherServerList.size();
	memSize += sizeof(unsigned short) * OtherServerList.size();

	return memSize;
}

void SIPCCMsg_RouteSelect_RouteRequestConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->Succ, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->ChannelId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->Port, thebuf+theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
}

int SIPCCMsg_RouteSelect_RouteRequestConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->Succ, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ChannelId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->Port, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_RouteSelect_RouteRequestConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(int);
	memSize += sizeof(unsigned short);

	return memSize;
}

void SIPCCMsg_RouteSelect_RouteStop::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	memmove(&this->ChannelId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	int count;
	memmove(&count, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);

	for (int i = 0; i < count; i++)
	{
		S_RouteSelect_Node node;

		memmove(&node.Id, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.Type, thebuf+theBufContent, sizeof(int));
		theBufContent += sizeof(int);

		memmove(&node.Ip, thebuf+theBufContent, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);

		memmove(&node.MainPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);

		memmove(&node.TestPort, thebuf+theBufContent, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);

		OtherServerList.push_back(node);
	}
}

int SIPCCMsg_RouteSelect_RouteStop::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	memmove(thebuf+theBufContent, &this->ChannelId, sizeof(int));
	theBufContent += sizeof(int);

	int iSize = OtherServerList.size();
	memmove(thebuf+theBufContent, &iSize, sizeof(int));
	theBufContent += sizeof(int);

	for (list<S_RouteSelect_Node>::iterator it = OtherServerList.begin()
		; it != OtherServerList.end(); ++it)
	{
		S_RouteSelect_Node& node = *it;

		memmove(thebuf+theBufContent, &node.Id, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.Type, sizeof(int));
		theBufContent += sizeof(int);

		memmove(thebuf+theBufContent, &node.Ip, sizeof(unsigned long));
		theBufContent += sizeof(unsigned long);

		memmove(thebuf+theBufContent, &node.MainPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);

		memmove(thebuf+theBufContent, &node.TestPort, sizeof(unsigned short));
		theBufContent += sizeof(unsigned short);
	}

	return theBufContent;
}

int SIPCCMsg_RouteSelect_RouteStop::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);
	memSize += sizeof(int);

	memSize += sizeof(int);
	memSize += sizeof(int) * OtherServerList.size();
	memSize += sizeof(int) * OtherServerList.size();
	memSize += sizeof(unsigned long) * OtherServerList.size();
	memSize += sizeof(unsigned short) * OtherServerList.size();
	memSize += sizeof(unsigned short) * OtherServerList.size();

	return memSize;
}

void SIPCCMsg_RouteSelect_RouteStopConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead(thebuf);

	memmove(&this->InvokeId, thebuf+theBufContent, sizeof(int));
	theBufContent += sizeof(int);
}

int SIPCCMsg_RouteSelect_RouteStopConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead(thebuf);

	memmove(thebuf+theBufContent, &this->InvokeId, sizeof(int));
	theBufContent += sizeof(int);

	return theBufContent;
}

int SIPCCMsg_RouteSelect_RouteStopConf::GetMyMemSize()
{
	int memSize = 2*sizeof(int);		//msgclass+msgtype

	memSize += sizeof(int);

	return memSize;
}
//HHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHHH

///Type_ACD_CHangupCallConf
SIPCCMsg_ACD_CHangupCallConf::SIPCCMsg_ACD_CHangupCallConf()
{
	msgType = Type_ACD_CHangupCallConf;

	callID = "";
	agentName = "";
	keyword = "";

	account = "";
}

void SIPCCMsg_ACD_CHangupCallConf::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip/* =0  */, unsigned short port/* =0 */)
{
	int theBufContent=AnalyzeMsgHead(thebuf);

	//callID
	callID = thebuf+theBufContent;
	theBufContent += callID.length()+1; 

	//agentName
	agentName = thebuf+theBufContent;
	theBufContent += agentName.length()+1; 	

	//keyword
	keyword = thebuf+theBufContent;
	theBufContent += keyword.length()+1; 

	if ( theBufContent >= msgsize )
		return;

	//account
	account = thebuf+theBufContent;
	theBufContent += account.length()+1; 
}

int SIPCCMsg_ACD_CHangupCallConf::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent=FillMsgHead(thebuf);

	//callID
	memcpy(thebuf+theBufContent, callID.c_str(), callID.length()+1);
	theBufContent += callID.length()+1;

	//agentName
	memcpy(thebuf+theBufContent, agentName.c_str(), agentName.length()+1);
	theBufContent += agentName.length()+1;

	//keyword
	memcpy(thebuf+theBufContent, keyword.c_str(), keyword.length()+1);
	theBufContent += keyword.length()+1;

	//account
	memcpy(thebuf+theBufContent, account.c_str(), account.length()+1);
	theBufContent += account.length()+1;

	return theBufContent;
}

int SIPCCMsg_ACD_CHangupCallConf::GetMyMemSize()
{
	int memSize=2*sizeof(int);

	memSize += callID.length()+1;			//callID
	memSize += agentName.length()+1;		//agentName
	memSize += keyword.length()+1;			//keyword

	memSize += account.length()+1;			//account

	return memSize;
}
uint64_t Ntoh::ntohll(uint64_t num){
	uint64_t temp = 0;
	char* pTemp =(char*)&temp;
	char* pNum =(char*)&num;
	
	for(int i=0;i<4;i++){
		memcpy(pTemp+i,pNum+3-i,sizeof(char));
	}
	return temp;
}

uint64_t Hton::htonll(uint64_t num){
	return Ntoh::ntohll(num);
}



int SIPCCMessage::FillMsgHead_net(char*& thebuf)
{
	int iMsgHeadMemSize = 2*sizeof(int);
	
	int theBufContent = 0;
	//msgClass
	int t = host_to_network_long(msgClass);
	memmove(thebuf+theBufContent,&(t), sizeof(int));
	theBufContent += sizeof(int);
	//msgType
	t = host_to_network_long(msgType);
	memmove(thebuf+theBufContent, &(t), sizeof(int));
	theBufContent += sizeof(int);
	
	return theBufContent;
}

int SIPCCMessage::AnalyzeMsgHead_net(char* thebuf)
{
	int theBufContent = 0;
	
	//msgCalss
	int t;
	memmove(&t,(thebuf+theBufContent), sizeof(int));
	msgClass = network_to_host_long(t);
	theBufContent += sizeof(int);
	//msgType
	memmove(&t,(thebuf+theBufContent), sizeof(int));
	msgType = network_to_host_long(t);
	theBufContent += sizeof(int);
	
	return theBufContent;
}




///Type_FileTransfer
SIPCCMsg_FileTransfer::SIPCCMsg_FileTransfer()
{
	//msgClass = Class_FileTransfer;   hqh 2016.1.25
    msgType = Type_FileTransfer;
}

void SIPCCMsg_FileTransfer::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
    int theBufContent = AnalyzeMsgHead(thebuf);
}

int SIPCCMsg_FileTransfer::FillBuf(char*& thebuf)
{
    thebuf = new char[GetMyMemSize()];
    int theBufContent = FillMsgHead(thebuf);

    return theBufContent;
}

int SIPCCMsg_FileTransfer::GetMyMemSize()
{
    int memSize = 2 * sizeof(int);
    return memSize;
}

///Type_FileTransfer_UploadRequest
SIPCCMsg_FileTransfer_UploadRequest::SIPCCMsg_FileTransfer_UploadRequest()
{
    msgType = Type_FileTransfer_UploadRequest;
}

void SIPCCMsg_FileTransfer_UploadRequest::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
    int theBufContent = AnalyzeMsgHead(thebuf);

    //agentID
    agentID = thebuf + theBufContent;
    theBufContent += agentID.length() + 1;

    //agentName
    description = thebuf + theBufContent;
    theBufContent += description.length() + 1;

    //address
    address = thebuf + theBufContent;
    theBufContent += address.length() + 1;
}

int SIPCCMsg_FileTransfer_UploadRequest::FillBuf(char*& thebuf)
{
    thebuf = new char[GetMyMemSize()];
    int theBufContent = FillMsgHead(thebuf);

    //agentID
    memcpy(thebuf + theBufContent, agentID.c_str(), agentID.length() + 1);
    theBufContent += agentID.length() + 1;

    //description
    memcpy(thebuf + theBufContent, description.c_str(), description.length() + 1);
    theBufContent += description.length() + 1;

    //address
    memcpy(thebuf + theBufContent, address.c_str(), address.length() + 1);
    theBufContent += address.length() + 1;

    return theBufContent;
}

int SIPCCMsg_FileTransfer_UploadRequest::GetMyMemSize()
{
    int memSize = 2 * sizeof(int);

    memSize += agentID.length() + 1;			//agentID
    memSize += description.length() + 1;		//description
    memSize += address.length() + 1;		    //address

    return memSize;
}


///Type_FileTransfer_StartUpload
SIPCCMsg_FileTransfer_StartUpload::SIPCCMsg_FileTransfer_StartUpload()
{
    msgType = Type_FileTransfer_StartUpload;
    fileSize = 0;
    createTime = 0;
    lastModifyTime = 0;
}

void SIPCCMsg_FileTransfer_StartUpload::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead_net(thebuf);

	memmove(&this->InfoLen, thebuf + theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	InfoLen = network_to_host_short(InfoLen);

    //agentID
    agentID = thebuf + theBufContent;
    theBufContent += agentID.length() + 1;

    //fileName
    fileName = thebuf + theBufContent;
    theBufContent += fileName.length() + 1;

    //fileSize
    fileSize = Ntoh::ntohll(*reinterpret_cast<uint64_t*>(thebuf + theBufContent));
    theBufContent += sizeof(uint64_t);

    //createTime
    createTime = Ntoh::ntohll(*reinterpret_cast<uint64_t*>(thebuf + theBufContent));
    theBufContent += sizeof(uint64_t);

    //lastModifyTime
    lastModifyTime = Ntoh::ntohll(*reinterpret_cast<uint64_t*>(thebuf + theBufContent));
    theBufContent += sizeof(uint64_t);
}

int SIPCCMsg_FileTransfer_StartUpload::FillBuf(char*& thebuf)
{
    thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead_net(thebuf);

	InfoLen = GetMyMemSize() - theBufContent - sizeof(unsigned short);
	unsigned short t = host_to_network_short(InfoLen);
	memmove(thebuf + theBufContent, &t, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

    //agentID
    memcpy(thebuf + theBufContent, agentID.c_str(), agentID.length() + 1);
    theBufContent += agentID.length() + 1;

    //fileName
    memcpy(thebuf + theBufContent, fileName.c_str(), fileName.length() + 1);
    theBufContent += fileName.length() + 1;

    //fileSize
    *reinterpret_cast<uint64_t*>(thebuf + theBufContent) = Hton::htonll(fileSize);
    theBufContent += sizeof(fileSize);

    //createTime
    *reinterpret_cast<uint64_t*>(thebuf + theBufContent) = Hton::htonll(createTime);
    theBufContent += sizeof(createTime);

    //lastModifyTime
    *reinterpret_cast<uint64_t*>(thebuf + theBufContent) = Hton::htonll(lastModifyTime);
    theBufContent += sizeof(lastModifyTime);

    return theBufContent;
}

int SIPCCMsg_FileTransfer_StartUpload::GetMyMemSize()
{
	int memSize = 2 * sizeof(int);
	memSize += sizeof(unsigned short);

    memSize += agentID.length() + 1;			//agentID
    memSize += fileName.length() + 1;		    //fileName
    memSize += sizeof(fileSize);		        //fileSize
    memSize += sizeof(createTime);		        //createTime
    memSize += sizeof(lastModifyTime);		    //lastModifyTime

    return memSize;
}

///Type_FileTransfer_UploadCompleted
SIPCCMsg_FileTransfer_UploadCompleted::SIPCCMsg_FileTransfer_UploadCompleted()
{
	msgType = Type_FileTransfer_UploadCompleted;
}

void SIPCCMsg_FileTransfer_UploadCompleted::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead_net(thebuf);

	memmove(&this->InfoLen, thebuf + theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	InfoLen = network_to_host_short(InfoLen);
}

int SIPCCMsg_FileTransfer_UploadCompleted::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead_net(thebuf);

	InfoLen = GetMyMemSize() - theBufContent - sizeof(unsigned short);
	unsigned short t = host_to_network_short(InfoLen);
	memmove(thebuf + theBufContent, &t, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	return theBufContent;
}

int SIPCCMsg_FileTransfer_UploadCompleted::GetMyMemSize()
{
	int memSize = 2 * sizeof(int);
	memSize += sizeof(unsigned short);

	return memSize;
}

///Type_FileTransfer_FileData
SIPCCMsg_FileTransfer_FileData::SIPCCMsg_FileTransfer_FileData()
{
	msgType = Type_FileTransfer_FileData;
	dataLen = 0;
}

void SIPCCMsg_FileTransfer_FileData::AnalyzeBuf(char* thebuf, int msgsize, unsigned long ip, unsigned short port)
{
	int theBufContent = AnalyzeMsgHead_net(thebuf);

	memmove(&this->InfoLen, thebuf + theBufContent, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);
	InfoLen = network_to_host_short(InfoLen);

	//dataLen
	dataLen = network_to_host_long(*reinterpret_cast<unsigned int*>(thebuf + theBufContent));
	theBufContent += sizeof(dataLen);
}

int SIPCCMsg_FileTransfer_FileData::FillBuf(char*& thebuf)
{
	thebuf = new char[GetMyMemSize()];
	int theBufContent = FillMsgHead_net(thebuf);

	InfoLen = GetMyMemSize() - theBufContent - sizeof(unsigned short);
	unsigned short t = host_to_network_short(InfoLen);
	memmove(thebuf + theBufContent, &t, sizeof(unsigned short));
	theBufContent += sizeof(unsigned short);

	//dataLen
	*reinterpret_cast<unsigned int*>(thebuf + theBufContent) = host_to_network_long(dataLen);
	theBufContent += sizeof(dataLen);

	return theBufContent;
}

int SIPCCMsg_FileTransfer_FileData::GetMyMemSize()
{
	int memSize = 2 * sizeof(int);
	memSize += sizeof(unsigned short);

	memSize += sizeof(dataLen);		    //dataLen

	return memSize;
}
